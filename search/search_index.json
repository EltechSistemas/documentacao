{"config":{"lang":["pt"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to MkDocs","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/","title":"CGS - Parcelamento (Eltech)","text":""},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para c\u00e1lculo e gera\u00e7\u00e3o de parcelas de condi\u00e7\u00f5es de pagamento, considerando datas de vencimento, ajustes por dias da semana, feriados, valores m\u00ednimos por parcela e configura\u00e7\u00f5es espec\u00edficas do m\u00f3dulo CGS.</p>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente as parcelas de uma condi\u00e7\u00e3o de pagamento, aplicando regras de vencimento, descontos, juros, multas e valida\u00e7\u00f5es de valores m\u00ednimos por parcela.</p>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Financeiro</li> <li>Faturamento</li> <li>Cr\u00e9dito e Cobran\u00e7a</li> </ul>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Abe30</code> - Condi\u00e7\u00f5es de pagamento - <code>Abe3001</code> - Parcelas da condi\u00e7\u00e3o de pagamento - <code>Abe3002</code> - Dias complementares (ajustes de vencimento) - <code>Eaa01</code> - Documentos fiscais - <code>Abb01</code> - Documentos da central (data de emiss\u00e3o)</p>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o dtBase LocalDate Sim Data base para c\u00e1lculo das parcelas abe30id Long Sim ID da condi\u00e7\u00e3o de pagamento valor BigDecimal Sim Valor total a ser parcelado eaa01 Eaa01 N\u00e3o Documento fiscal relacionado"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o dos par\u00e2metros obrigat\u00f3rios</li> <li>Carregamento da condi\u00e7\u00e3o de pagamento (Abe30)</li> <li>Defini\u00e7\u00e3o da data de emiss\u00e3o (do documento ou atual)</li> </ul>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#2-calculo-dos-ajustes-de-data","title":"2. C\u00e1lculo dos Ajustes de Data","text":"<ul> <li>Aplica\u00e7\u00e3o de dias adicionais conforme dia da semana da data base</li> <li>C\u00e1lculo de vencimentos nominais para cada parcela</li> <li>Ajustes por vencimentos fixos e dias espec\u00edficos</li> <li>Tratamento de meses com menos dias (ex: fevereiro)</li> <li>Aplica\u00e7\u00e3o de ajustes complementares (Abe3002)</li> </ul>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#3-calculo-dos-valores-das-parcelas","title":"3. C\u00e1lculo dos Valores das Parcelas","text":"<ul> <li>Distribui\u00e7\u00e3o percentual do valor total</li> <li>C\u00e1lculo do saldo para \u00faltima parcela</li> <li>Aplica\u00e7\u00e3o de juros, multas e encargos</li> <li>C\u00e1lculo de descontos por antecipa\u00e7\u00e3o</li> </ul>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#4-validacoes-e-regras-especiais","title":"4. Valida\u00e7\u00f5es e Regras Especiais","text":"<ul> <li>Verifica\u00e7\u00e3o de valor m\u00ednimo por parcela</li> <li>Op\u00e7\u00e3o de agrupamento em parcela \u00fanica</li> <li>C\u00e1lculo de comiss\u00f5es na \u00faltima parcela</li> <li>Valida\u00e7\u00e3o de documentos financeiros</li> </ul>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#configuracao-de-vencimentos","title":"Configura\u00e7\u00e3o de Vencimentos","text":"<ul> <li>Dias base: Ajustes por dia da semana na data base (abe30diasDtBase1-7)</li> <li>Vencimentos fixos: Datas espec\u00edficas por parcela (dt_vcto_fixo)</li> <li>Dias do m\u00eas: Vencimento em dia espec\u00edfico do m\u00eas (diavcto)</li> <li>Ajustes complementares: Regras por faixa de dias (Abe3002)</li> <li>M\u00eas refer\u00eancia: Ajustes para m\u00eas corrente ou seguinte</li> </ul>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#calculo-financeiro","title":"C\u00e1lculo Financeiro","text":"<ul> <li>Juros: Percentual aplicado sobre o valor da parcela</li> <li>Multa: Percentual ou valor fixo (vlr_fixo)</li> <li>Desconto: Percentual com limite temporal (dias_dtlimite)</li> <li>Encargos: Valores adicionais fixos</li> </ul>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#validacoes-de-parcelas","title":"Valida\u00e7\u00f5es de Parcelas","text":"<ul> <li>Valor m\u00ednimo: Configur\u00e1vel por condi\u00e7\u00e3o de pagamento (abe30vmpValor)</li> <li>Op\u00e7\u00f5es: </li> <li>0 - Agrupar em uma parcela quando valor m\u00ednimo n\u00e3o for atingido</li> <li>1 - Validar valor m\u00ednimo e interromper se n\u00e3o atingido</li> <li>Documentos financeiros: </li> <li>Tipo 1 - Gera na data de vencimento</li> <li>Tipo 2 - Gera na data de emiss\u00e3o</li> </ul>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de parcelamento.</p>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#obterdiasadicionaisadatalocaldate-data-abe30-abe30-int-qualdata","title":"<code>obterDiasAdicionaisAData(LocalDate data, Abe30 abe30, int qualData)</code>","text":"<p>Calcula dias adicionais baseado no dia da semana: - 0: Dias para data base (abe30diasDtBase1-7) - 1: Dias para vencimento nominal (abe30diasVctoN1-7)</p>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#buscarcondicaopagamentoporidlong-abe30id","title":"<code>buscarCondicaoPagamentoPorId(Long abe30id)</code>","text":"<p>Busca a condi\u00e7\u00e3o de pagamento pelo ID.</p>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#buscarparcelaspeloidcondicaopagamentolong-abe30id","title":"<code>buscarParcelasPeloIdCondicaoPagamento(Long abe30id)</code>","text":"<p>Busca as parcelas configuradas para a condi\u00e7\u00e3o de pagamento.</p>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#buscardiacomplementarpeloidcondicaopagamentolong-abe30id","title":"<code>buscarDiaComplementarPeloIdCondicaoPagamento(Long abe30id)</code>","text":"<p>Busca ajustes complementares de dias (Abe3002).</p>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#montarparceladtolocaldate-data-bigdecimal-valor-integer-docfinanc-abe3001-abe3001-tablemap-cposlivres","title":"<code>montarParcelaDto(LocalDate data, BigDecimal valor, Integer docFinanc, Abe3001 abe3001, TableMap cposLivres)</code>","text":"<p>Monta o DTO da parcela com todos os dados calculados.</p>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>ParcelaDto: - <code>vctoN</code> - Data de vencimento nominal - <code>valor</code> - Valor da parcela - <code>criaDoc</code> - Tipo de documento financeiro (1 ou 2) - <code>abf15id</code> - ID do portador - <code>abf16id</code> - ID da opera\u00e7\u00e3o - <code>abf01id</code> - ID do banco - <code>abf40id</code> - ID da forma de pagamento - <code>cposLivres</code> - Campos livres (juros, multa, desconto, etc.)</p> <p>Lista de Parcelas: - Retornada no par\u00e2metro <code>listaParcelas</code></p>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios de data - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.dto.cgs</code> - DTOs do m\u00f3dulo CGS - <code>sam.model</code> - Entidades do sistema - <code>java.time</code> - Manipula\u00e7\u00e3o de datas</p> <p>M\u00f3dulo: CGS (Condi\u00e7\u00f5es Gerais do Sistema)</p>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#tratamento-de-datas","title":"Tratamento de Datas","text":"<ul> <li>Ajustes autom\u00e1ticos para finais de semana</li> <li>Tratamento especial para fevereiro (meses com menos dias)</li> <li>Suporte a vencimentos fixos e vari\u00e1veis</li> <li>Ajustes por faixas de dias (inicial-final)</li> </ul>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#campos-livres-json","title":"Campos Livres (JSON)","text":"<ul> <li><code>juros</code> - Valor calculado de juros</li> <li><code>multa</code> - Valor calculado de multa</li> <li><code>encargos</code> - Encargos adicionais</li> <li><code>desconto</code> - Valor de desconto por antecipa\u00e7\u00e3o</li> <li><code>dtLimiteDesc</code> - Data limite para desconto</li> <li><code>nomevcto</code> - Nome personalizado do vencimento</li> </ul>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#validacoes-de-negocio","title":"Valida\u00e7\u00f5es de Neg\u00f3cio","text":"<ul> <li>Interrup\u00e7\u00e3o se valor m\u00ednimo n\u00e3o for atingido (op\u00e7\u00e3o 1)</li> <li>C\u00e1lculo preciso de saldos para evitar diferen\u00e7as</li> <li>Suporte a condi\u00e7\u00f5es complexas de pagamento</li> <li>Op\u00e7\u00e3o de agrupamento em parcela \u00fanica quando valor m\u00ednimo n\u00e3o \u00e9 atingido</li> </ul>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#json-da-abe30-configuracoes","title":"JSON da Abe30 (Configura\u00e7\u00f5es)","text":"<ul> <li><code>juros</code> - Percentual de juros</li> <li><code>multa</code> - Percentual de multa</li> <li><code>vlr_fixo</code> - Valor fixo de multa</li> <li><code>vlr_desc_tx</code> - Taxa de desconto</li> <li><code>dias_dtlimite</code> - Dias limite para desconto</li> <li><code>encargos</code> - Encargos adicionais</li> <li><code>desconto</code> - Desconto padr\u00e3o</li> </ul>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#json-da-abe3001-parcelas","title":"JSON da Abe3001 (Parcelas)","text":"<ul> <li><code>vcto_nome</code> - Nome do vencimento</li> <li><code>refparc</code> - Refer\u00eancia da parcela</li> <li><code>diavcto</code> - Dia espec\u00edfico do m\u00eas</li> <li><code>dt_vcto_fixo</code> - Data fixa de vencimento</li> </ul>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#json-da-abe3002-ajustes-complementares","title":"JSON da Abe3002 (Ajustes Complementares)","text":"<ul> <li><code>diai</code> - Dia inicial da faixa</li> <li><code>diaf</code> - Dia final da faixa</li> <li><code>diavcto</code> - Dia de vencimento</li> <li><code>refmes</code> - Refer\u00eancia de m\u00eas (0=corrente, 1=seguinte)</li> <li><code>dia_inicial</code> - Dia inicial para ajuste</li> <li><code>dia_final</code> - Dia final para ajuste</li> <li><code>dia_data</code> - Dia de ajuste</li> <li><code>mes_data</code> - M\u00eas de ajuste (0=corrente, 1=seguinte)</li> </ul>"},{"location":"ELTECH/formulas/cgs/CGS_Parcelamento/#logica-de-agrupamento-em-parcela-unica","title":"L\u00f3gica de Agrupamento em Parcela \u00danica","text":"<ul> <li>Quando <code>abe30vmpOpcao = 0</code> e valor da parcela &lt; valor m\u00ednimo</li> <li>Soma todas as parcelas em uma \u00fanica</li> <li>Usa data da primeira parcela (ou emiss\u00e3o se docFinan = 2)</li> <li>Mant\u00e9m campos livres da primeira parcela</li> <li>Aplica valida\u00e7\u00e3o de valor m\u00ednimo ao total agrupado</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 01/12/2025 \u00e0s 15:20 Autor: Bruno Tipo: F\u00f3rmula de Condi\u00e7\u00e3o de Pagamento Vers\u00e3o: 1.0</p>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/","title":"SCE - Importar Itens de Lan\u00e7amentos XLSX","text":""},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para importa\u00e7\u00e3o de itens de lan\u00e7amentos de estoque a partir de arquivo Excel (XLSX), permitindo carga em massa de movimenta\u00e7\u00f5es de estoque com dados como tipo de item, c\u00f3digo, quantidade, valor, lote, s\u00e9rie, validade e fabrica\u00e7\u00e3o.</p>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Facilitar a importa\u00e7\u00e3o de m\u00faltiplos itens de lan\u00e7amentos de estoque atrav\u00e9s de planilha Excel, validando os dados e convertendo-os para o formato DTO do sistema.</p>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento de Estoque</li> <li>Almoxarifado</li> <li>Log\u00edstica</li> <li>Controle de Invent\u00e1rio</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Abm01</code> - Itens cadastrais - <code>Aba20</code> - Reposit\u00f3rio de avisos - <code>Aba2001</code> - Itens do reposit\u00f3rio de avisos</p> <p>Estrutura do Arquivo Excel (XLSX): | Coluna | Campo | Tipo | Descri\u00e7\u00e3o | |--------|-------|------|-----------| | A | Tipo do Item | Integer | Tipo do item (refer\u00eancia a abm01tipo) | | B | C\u00f3digo do Item | String | C\u00f3digo do item (refer\u00eancia a abm01codigo) | | C | Quantidade | BigDecimal | Quantidade a ser lan\u00e7ada | | D | Valor | BigDecimal | Valor unit\u00e1rio do item | | E | Lote | String | N\u00famero do lote (opcional) | | F | S\u00e9rie | String | N\u00famero de s\u00e9rie (opcional) | | G | Validade | LocalDate | Data de validade (opcional) | | H | Fabrica\u00e7\u00e3o | LocalDate | Data de fabrica\u00e7\u00e3o (opcional) |</p>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o arquivo MultipartFile Sim Arquivo Excel (XLSX) com os dados dos itens"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#1-leitura-do-arquivo-excel","title":"1. Leitura do Arquivo Excel","text":"<ul> <li>Abertura do arquivo XLSX como InputStream</li> <li>Cria\u00e7\u00e3o do workbook Apache POI</li> <li>Sele\u00e7\u00e3o da primeira planilha (sheet)</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#2-processamento-das-linhas","title":"2. Processamento das Linhas","text":"<ul> <li>Itera\u00e7\u00e3o a partir da linha 2 (ignora cabe\u00e7alho)</li> <li>Para cada linha com dados na coluna A:</li> <li>Leitura dos valores das c\u00e9lulas</li> <li>Busca do item no sistema pelo tipo e c\u00f3digo</li> <li>Convers\u00e3o dos dados para DTO</li> <li>Coleta de erros em caso de exce\u00e7\u00f5es</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#3-validacao-e-conversao","title":"3. Valida\u00e7\u00e3o e Convers\u00e3o","text":"<ul> <li>Valida\u00e7\u00e3o da exist\u00eancia do item no cadastro (Abm01)</li> <li>Convers\u00e3o de tipos (num\u00e9rico para BigDecimal, data para LocalDate)</li> <li>Tratamento de valores opcionais (lote, s\u00e9rie, datas)</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#4-registro-de-avisos","title":"4. Registro de Avisos","text":"<ul> <li>Busca do reposit\u00f3rio \"Avisos Itens Lctos\" (Aba20)</li> <li>Cria\u00e7\u00e3o de itens de aviso para cada mensagem de erro</li> <li>Persist\u00eancia dos avisos no banco de dados</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#5-retorno-dos-dados","title":"5. Retorno dos Dados","text":"<ul> <li>Lista de itens convertidos para DTO</li> <li>DTOs prontos para processamento em lote</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>O item deve existir no cadastro (Abm01) com tipo e c\u00f3digo correspondentes</li> <li>Campos obrigat\u00f3rios: tipo, c\u00f3digo, quantidade e valor</li> <li>Campos opcionais: lote, s\u00e9rie, validade, fabrica\u00e7\u00e3o</li> <li>Em caso de erro, o processamento continua com as demais linhas</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#formato-do-arquivo","title":"Formato do Arquivo","text":"<ul> <li>Extens\u00e3o: .xlsx (Excel)</li> <li>Formato de datas: conforme configura\u00e7\u00e3o do Excel</li> <li>Cabe\u00e7alho na primeira linha (ignorada no processamento)</li> <li>Suporte a caracteres especiais em strings</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#tratamento-de-erros","title":"Tratamento de Erros","text":"<ul> <li>Erros por item s\u00e3o coletados em lista de mensagens</li> <li>Mensagens s\u00e3o registradas no reposit\u00f3rio \"Avisos Itens Lctos\"</li> <li>Processamento continua mesmo com erros em linhas espec\u00edficas</li> <li>Exce\u00e7\u00f5es s\u00e3o capturadas e registradas com identifica\u00e7\u00e3o do item</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de importa\u00e7\u00e3o.</p>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#processos-internos","title":"Processos Internos","text":"<ul> <li>Leitura do arquivo Excel com Apache POI</li> <li>Convers\u00e3o de c\u00e9lulas para tipos Java apropriados</li> <li>Busca de itens no banco de dados</li> <li>Cria\u00e7\u00e3o de DTOs <code>ItemSCEDto</code></li> <li>Registro de avisos em reposit\u00f3rio espec\u00edfico</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>ItemSCEDto: - <code>abm01id</code> - ID do item encontrado - <code>quantidade</code> - Quantidade do item - <code>valor</code> - Valor unit\u00e1rio - <code>lote</code> - N\u00famero do lote (opcional) - <code>serie</code> - N\u00famero de s\u00e9rie (opcional) - <code>validade</code> - Data de validade (opcional) - <code>fabricacao</code> - Data de fabrica\u00e7\u00e3o (opcional)</p> <p>Par\u00e2metros de Retorno: - <code>itensLctos</code>: Lista de <code>ItemSCEDto</code> com os itens importados</p> <p>Registro de Avisos: - Itens com erros s\u00e3o registrados no reposit\u00f3rio \"Avisos Itens Lctos\" (Aba20) - Cada aviso cont\u00e9m a mensagem de erro e \u00edndice do item</p>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>apache.poi</code> - Manipula\u00e7\u00e3o de arquivos Excel (XSSFWorkbook) - <code>commons.io</code> - Utilit\u00e1rios de I/O (FileUtils) - <code>springframework</code> - MultipartFile para upload - <code>sam.dto.sce</code> - DTOs do m\u00f3dulo SCE - <code>sam.model</code> - Entidades do sistema</p> <p>M\u00f3dulo: SCE (Sistema de Controle de Estoque)</p>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#tratamento-de-arquivos","title":"Tratamento de Arquivos","text":"<ul> <li>Suporte apenas a formato XLSX (Excel 2007+)</li> <li>Uso de Apache POI para manipula\u00e7\u00e3o eficiente</li> <li>Stream processing para arquivos grandes</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#performance","title":"Performance","text":"<ul> <li>Processamento linha a linha para evitar carga de mem\u00f3ria</li> <li>Transa\u00e7\u00e3o \u00fanica para persist\u00eancia dos avisos</li> <li>Busca de itens em lote otimizada</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#seguranca","title":"Seguran\u00e7a","text":"<ul> <li>Valida\u00e7\u00e3o de tipos de dados</li> <li>Tratamento de valores nulos</li> <li>Captura de exce\u00e7\u00f5es para evitar falha total</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_ImportarItensLctosXlsx/#formato-de-datas","title":"Formato de Datas","text":"<ul> <li>Convers\u00e3o autom\u00e1tica de datas do Excel para LocalDate</li> <li>Suporte a c\u00e9lulas vazias em datas opcionais</li> <li>Formato conforme configura\u00e7\u00e3o regional do Excel</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 11/12/2025 \u00e0s 13:45 Autor: Bruno Tipo: F\u00f3rmula de Importa\u00e7\u00e3o de Itens de Lan\u00e7amentos Vers\u00e3o: 1.0</p>"},{"location":"ELTECH/formulas/sce/SCE_InventarioFiscal/","title":"SCE - Invent\u00e1rio Fiscal","text":""},{"location":"ELTECH/formulas/sce/SCE_InventarioFiscal/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Classe que calcula valores de invent\u00e1rio fiscal de itens, determinando pre\u00e7o unit\u00e1rio, total e saldo cont\u00e1bil. Busca hist\u00f3rico de invent\u00e1rios anteriores, aplica taxas de grupo de invent\u00e1rio e comp\u00f5e campos JSON para integra\u00e7\u00e3o com o m\u00f3dulo de contabilidade.</p>"},{"location":"ELTECH/formulas/sce/SCE_InventarioFiscal/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Garantir c\u00e1lculo correto dos valores de invent\u00e1rio fiscal, incluindo: - Pre\u00e7o unit\u00e1rio e total do item - Saldo cont\u00e1bil do grupo - Aplica\u00e7\u00e3o de regras fiscais espec\u00edficas por tipo de item - Integra\u00e7\u00e3o com invent\u00e1rios anteriores e contas cont\u00e1beis</p>"},{"location":"ELTECH/formulas/sce/SCE_InventarioFiscal/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Controladoria</li> <li>Departamento Fiscal</li> <li>Auditoria Interna</li> <li>Gest\u00e3o de Estoque</li> <li>Equipes de TI respons\u00e1veis por regras de neg\u00f3cio cont\u00e1bil</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_InventarioFiscal/#parametros-e-campos-principais","title":"\u2699\ufe0f Par\u00e2metros e Campos Principais","text":"Campo / Par\u00e2metro Tipo Descri\u00e7\u00e3o bcb11 Bcb11 Item do invent\u00e1rio sendo processado dtIni LocalDate Data inicial do per\u00edodo de c\u00e1lculo dtFin LocalDate Data final do per\u00edodo de c\u00e1lculo aac10 Aac10 Empresa ativa abm01 Abm01 Item cadastrado no sistema abm0101 Abm0101 Configura\u00e7\u00e3o do item por empresa abm12 Abm12 Configura\u00e7\u00e3o fiscal do item preco_livre BigDecimal Pre\u00e7o livre definido na configura\u00e7\u00e3o do item bcb11.bcb11unit BigDecimal Pre\u00e7o unit\u00e1rio calculado bcb11.bcb11total BigDecimal Pre\u00e7o total calculado bcb11.bcb11json TableMap Campos adicionais em JSON para integra\u00e7\u00e3o cont\u00e1bil"},{"location":"ELTECH/formulas/sce/SCE_InventarioFiscal/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Carrega item (<code>Bcb11</code>) e datas de refer\u00eancia (<code>dtIni</code>, <code>dtFin</code>).</li> <li>Busca empresa ativa (<code>Aac10</code>) e dados do item (<code>Abm01</code>, <code>Abm0101</code>, <code>Abm12</code>).</li> <li>Valida exist\u00eancia de configura\u00e7\u00e3o fiscal; interrompe execu\u00e7\u00e3o se inexistente.</li> <li>Obt\u00e9m taxa do grupo de invent\u00e1rio do item (<code>obterTaxaGrupoInventarioItem</code>).</li> <li>Calcula pre\u00e7o unit\u00e1rio:<ul> <li>Aplica taxa se houver</li> <li>Busca hist\u00f3rico de invent\u00e1rios anteriores se unit\u00e1rio = 0</li> </ul> </li> <li>Calcula total (<code>bcb11total</code>) e arredonda para 2 casas decimais.</li> <li>Atualiza JSON do item (<code>bcb11json</code>) com saldos cont\u00e1beis.</li> <li>Busca saldo do grupo ou saldo da conta, se necess\u00e1rio (<code>buscarSaldoDoGrupo</code>, <code>buscarSaldoConta</code>).</li> </ol>"},{"location":"ELTECH/formulas/sce/SCE_InventarioFiscal/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":"<ul> <li>Tipo fiscal do item determina regras de c\u00e1lculo (exceto 7, 8, 9, 99).</li> <li>Itens pr\u00f3prios e de terceiros t\u00eam valida\u00e7\u00f5es de grupo de invent\u00e1rio.</li> <li>Pre\u00e7o unit\u00e1rio pode ser: pre\u00e7o m\u00e9dio, \u00faltimo unit\u00e1rio de sa\u00edda ou maior pre\u00e7o unit\u00e1rio.</li> <li>Hist\u00f3rico de invent\u00e1rio anterior \u00e9 usado quando n\u00e3o h\u00e1 valor calculado.</li> <li>Campos JSON atualizam saldos cont\u00e1beis do item para o invent\u00e1rio fiscal.</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_InventarioFiscal/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Sa\u00edda Descri\u00e7\u00e3o Campos atualizados em <code>Bcb11</code> Inclui <code>unit</code>, <code>total</code> e <code>json</code> para integra\u00e7\u00e3o cont\u00e1bil"},{"location":"ELTECH/formulas/sce/SCE_InventarioFiscal/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<ul> <li>Entidades: <code>Aac10</code>, <code>Abm01</code>, <code>Abm0101</code>, <code>Abm11</code>, <code>Abm12</code>, <code>Abm40</code>, <code>Bcb10</code>, <code>Bcb11</code>, <code>Bcc01</code>, <code>Bcc02</code>, <code>Ebb02</code></li> <li>Framework: <code>FormulaBase</code> (classe base)</li> <li>Utilit\u00e1rios: <code>TableMap</code>, <code>Criterions</code>, <code>Fields</code>, <code>Joins</code>, <code>Parametro</code>, <code>SCE5520Service</code>, <code>SCEService</code></li> <li>Manipula\u00e7\u00e3o de datas: <code>LocalDate</code>, <code>DateTimeFormatter</code></li> <li>Sess\u00e3o de banco de dados via <code>getSession()</code> e <code>getAcessoAoBanco()</code></li> <li>M\u00e9todos de arredondamento e valida\u00e7\u00e3o fiscal integrados ao sistema</li> </ul>"},{"location":"ELTECH/formulas/sce/SCE_InventarioFiscal/#metodos-principais","title":"\ud83d\udccc M\u00e9todos Principais","text":"M\u00e9todo Descri\u00e7\u00e3o <code>executar()</code> M\u00e9todo principal que calcula unit\u00e1rio, total e atualiza JSON do invent\u00e1rio <code>buscarUnitarioLancamento(Long, LocalDate)</code> Retorna pre\u00e7o unit\u00e1rio baseado em hist\u00f3rico e configura\u00e7\u00e3o do item <code>buscarSaldoConta(LocalDate, Abm40)</code> Retorna saldo cont\u00e1bil de uma conta na data do invent\u00e1rio <code>buscarSaldoDoGrupo(Long)</code> Retorna saldo do grupo de invent\u00e1rio em JSON <code>obterTaxaGrupoInventarioItem(Long, Integer)</code> Retorna taxa de ajuste do grupo de invent\u00e1rio do item <code>obterCampoGrupoInventarioItem(Long)</code> Retorna tipo de c\u00e1lculo do grupo de invent\u00e1rio <code>ultimnoUnitatioSaida(Long)</code> Retorna \u00faltimo pre\u00e7o unit\u00e1rio de sa\u00edda do item <code>maiorPrecoUnitario(Long)</code> Retorna maior pre\u00e7o unit\u00e1rio de sa\u00edda do item <code>precoMedioUnit(Long)</code> Retorna pre\u00e7o m\u00e9dio unit\u00e1rio baseado no hist\u00f3rico <code>buscarItemInventarioAnterior(Long)</code> Busca pre\u00e7o unit\u00e1rio de invent\u00e1rios anteriores <code>obterTipoFormula()</code> Retorna tipo da f\u00f3rmula: <code>FormulaTipo.INVENTARIO</code>"},{"location":"ELTECH/formulas/scf/SCF_Movimento/","title":"SCF_Movimento.md","text":""},{"location":"ELTECH/formulas/scf/SCF_Movimento/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de c\u00e1lculo de movimento financeiro para o SCF (Sistema de Controle Financeiro) da Linhasita, respons\u00e1vel pelo processamento de juros, multas, encargos e descontos em t\u00edtulos financeiros.</p>"},{"location":"ELTECH/formulas/scf/SCF_Movimento/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente os valores l\u00edquidos de t\u00edtulos financeiros considerando encargos, descontos e condi\u00e7\u00f5es de pagamento, garantindo a correta apura\u00e7\u00e3o financeira.</p>"},{"location":"ELTECH/formulas/scf/SCF_Movimento/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Financeiro</li> <li>Tesouraria</li> <li>Cr\u00e9dito e Cobran\u00e7a</li> <li>Contabilidade</li> </ul>"},{"location":"ELTECH/formulas/scf/SCF_Movimento/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - F\u00f3rmula <code>SCF_Movimento</code> - C\u00e1lculo de movimento financeiro</p> <p>Localiza\u00e7\u00e3o: <code>eltech/formulas/scf/</code></p>"},{"location":"ELTECH/formulas/scf/SCF_Movimento/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>DAA1001</code> - Movimentos financeiros - <code>DAA01</code> - T\u00edtulos a receber/pagar</p> <p>Entidades Envolvidas: - <code>Daa1001</code> - Movimento financeiro - <code>Daa01</code> - T\u00edtulo principal - <code>SCFService</code> - Servi\u00e7o de c\u00e1lculos financeiros</p>"},{"location":"ELTECH/formulas/scf/SCF_Movimento/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o daa1001 Daa1001 Sim Movimento financeiro a ser calculado"},{"location":"ELTECH/formulas/scf/SCF_Movimento/#campos-calculados","title":"\ud83d\udccb Campos Calculados","text":"Campo Descri\u00e7\u00e3o Tipo daa1001liquido Valor l\u00edquido do movimento BigDecimal jurosq Juros quitados BigDecimal multaq Multa quitada BigDecimal encargosq Encargos quitados BigDecimal descontoq Desconto aplicado BigDecimal"},{"location":"ELTECH/formulas/scf/SCF_Movimento/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o Inicial</li> <li>Obt\u00e9m movimento financeiro (DAA1001)</li> <li>Recupera t\u00edtulo principal relacionado (DAA01)</li> <li> <p>Inicializa mapa JSON para campos livres</p> </li> <li> <p>C\u00e1lculo de Dias em Atraso</p> </li> <li>Utiliza servi\u00e7o SCF para calcular dias de atraso</li> <li>Aplica juros somente se houver atraso</li> <li> <p>Aplica multa somente se houver atraso</p> </li> <li> <p>Processamento de Encargos</p> </li> <li>Encargos aplicados independente de atraso</li> <li> <p>Considera valor fixo cadastrado</p> </li> <li> <p>Aplica\u00e7\u00e3o de Descontos</p> </li> <li>Verifica data limite para desconto</li> <li>Aplica desconto somente se pagamento dentro do prazo</li> <li> <p>Desconsidera desconto se fora do prazo</p> </li> <li> <p>Ajuste para Pagamento Parcial</p> </li> <li>Calcula fator proporcional para pagamentos parciais</li> <li>Aplica propor\u00e7\u00e3o aos valores de JMED</li> <li> <p>Mant\u00e9m consist\u00eancia nos c\u00e1lculos</p> </li> <li> <p>C\u00e1lculo do Valor L\u00edquido</p> </li> <li>Soma valor principal com encargos quitados</li> <li>Subtrai descontos aplicados</li> <li>Arredondamento preciso para 2 casas decimais</li> </ol>"},{"location":"ELTECH/formulas/scf/SCF_Movimento/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/formulas/scf/SCF_Movimento/#condicoes-de-aplicacao","title":"Condi\u00e7\u00f5es de Aplica\u00e7\u00e3o","text":"<ul> <li>Juros: Aplicados apenas quando h\u00e1 dias em atraso (diasAtraso &gt; 0)</li> <li>Multa: Aplicada apenas quando h\u00e1 dias em atraso</li> <li>Encargos: Aplicados independente da situa\u00e7\u00e3o</li> <li>Desconto: Aplicado apenas se pagamento at\u00e9 data limite</li> </ul>"},{"location":"ELTECH/formulas/scf/SCF_Movimento/#calculos-especificos","title":"C\u00e1lculos Espec\u00edficos","text":"<ul> <li>Juros: <code>juros * diasAtraso</code> (acumulativo)</li> <li>Multa: Valor fixo conforme cadastro</li> <li>Desconto: Valor fixo, condicionado \u00e0 data</li> <li>Pagamento Parcial: Proporcionalidade nos encargos</li> </ul>"},{"location":"ELTECH/formulas/scf/SCF_Movimento/#tratamento-de-valores","title":"Tratamento de Valores","text":"<ul> <li>Desconto Quitado: Convertido para negativo (desconto \u00e9 redu\u00e7\u00e3o)</li> <li>Arredondamento: Sempre para 2 casas decimais</li> <li>Valor L\u00edquido: Soma alg\u00e9brica de todos os componentes</li> </ul>"},{"location":"ELTECH/formulas/scf/SCF_Movimento/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Servi\u00e7os: - <code>SCFService</code> - Servi\u00e7o especializado em c\u00e1lculos financeiros - <code>calculaDiasDeAtraso()</code> - M\u00e9todo para c\u00e1lculo preciso de dias</p> <p>Bibliotecas: - <code>java.time</code> - Manipula\u00e7\u00e3o de datas e per\u00edodos - <code>multitec.utils</code> - Utilit\u00e1rios e c\u00e1lculos</p>"},{"location":"ELTECH/formulas/scf/SCF_Movimento/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Suporte a pagamentos parciais com proporcionalidade</li> <li>C\u00e1lculo autom\u00e1tico de dias de atraso</li> <li>Valida\u00e7\u00e3o de datas para aplica\u00e7\u00e3o de descontos</li> <li>Campos livres (JSON) para flexibilidade nas configura\u00e7\u00f5es</li> <li>Arredondamento preciso em todas as etapas</li> <li>Integra\u00e7\u00e3o com servi\u00e7o especializado SCF</li> <li>Tratamento de valores nulos e casos extremos</li> </ul>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/","title":"SGC - Lan\u00e7amento Cont\u00e1bil","text":""},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para processamento e formata\u00e7\u00e3o autom\u00e1tica do hist\u00f3rico de lan\u00e7amentos cont\u00e1beis no Sistema de Gest\u00e3o Cont\u00e1bil (SGC), substituindo coringas por informa\u00e7\u00f5es din\u00e2micas do documento.</p>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar a gera\u00e7\u00e3o do hist\u00f3rico cont\u00e1bil substituindo placeholders (<code>$1</code>, <code>$2</code>, etc.) por dados reais do documento, central, entidade e eventos relacionados.</p>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Cont\u00e1bil</li> <li>Tesouraria</li> <li>Controladoria</li> <li>Analistas Financeiros</li> </ul>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Ebb05</code> - Lan\u00e7amentos cont\u00e1beis - <code>Abb01</code> - Cabe\u00e7alho de documentos (central) - <code>Aah01</code> - Tipos de documento - <code>Abe01</code> - Entidades (clientes/fornecedores) - <code>Abh21</code> - Eventos cont\u00e1beis - <code>Eca01</code> - Classifica\u00e7\u00e3o patrimonial - <code>Eba02</code> - Planilha de lan\u00e7amento programado</p> <p>Entidades Envolvidas: - <code>Ebb05</code> - Lan\u00e7amento cont\u00e1bil - <code>Abb01</code> - Documento central - <code>Aah01</code> - Tipo de documento - <code>Abe01</code> - Entidade - <code>Abh21</code> - Evento - <code>Eca01</code> - Classifica\u00e7\u00e3o patrimonial - <code>Eba02</code> - Lan\u00e7amento programado</p>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o ebb05 Ebb05 Sim Lan\u00e7amento cont\u00e1bil a ser processado abh21 Abh21 N\u00e3o Evento cont\u00e1bil associado"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#1-inicializacao","title":"1. Inicializa\u00e7\u00e3o","text":"<ul> <li>Obt\u00e9m o lan\u00e7amento cont\u00e1bil (Ebb05)</li> <li>Verifica exist\u00eancia de hist\u00f3rico para processamento</li> <li>Inicializa vari\u00e1veis de entidades relacionadas</li> </ul>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#2-busca-de-dados-da-central","title":"2. Busca de Dados da Central","text":"<ul> <li>Recupera dados do documento central (Abb01)</li> <li>Busca tipo de documento (Aah01) relacionado</li> <li>Obt\u00e9m dados da entidade (Abe01) vinculada</li> <li>Recupera classifica\u00e7\u00e3o patrimonial (Eca01) se existir</li> <li>Busca dados do lan\u00e7amento programado (Eba02)</li> </ul>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#3-busca-de-dados-do-evento","title":"3. Busca de Dados do Evento","text":"<ul> <li>Recupera informa\u00e7\u00f5es do evento cont\u00e1bil (Abh21)</li> <li>Prioriza evento passado como par\u00e2metro</li> <li>Fallback para evento vinculado ao lan\u00e7amento</li> </ul>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#4-processamento-de-coringas","title":"4. Processamento de Coringas","text":"<p>Substitui placeholders no hist\u00f3rico por valores reais:</p> Coringa Descri\u00e7\u00e3o Fonte <code>$1</code> Nome abreviado do documento Aah01.aah01na <code>$2</code> N\u00famero do documento Abb01.abb01num <code>$3</code> S\u00e9rie do documento Abb01.abb01serie <code>$4</code> Data do documento (dd/MM/yyyy) Abb01.abb01data <code>$5</code> Nome da entidade Abe01.abe01nome <code>$6</code> Parcela do documento Abb01.abb01parcela <code>$7</code> Nome da classifica\u00e7\u00e3o patrimonial Eca01.eca01nome <code>$8</code> Observa\u00e7\u00e3o do SGC Eba02.eba02json.obs_sgc <code>$9</code> Nome do evento Abh21.abh21nome"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#5-atualizacao-do-historico","title":"5. Atualiza\u00e7\u00e3o do Hist\u00f3rico","text":"<ul> <li>Aplica todas as substitui\u00e7\u00f5es</li> <li>Atualiza o campo <code>ebb05historico</code> com o resultado final</li> </ul>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Processa apenas se <code>ebb05historico</code> n\u00e3o for nulo</li> <li>Considera central apenas se <code>ebb05.ebb05central</code> existir</li> <li>Trata valores nulos com strings vazias para evitar erros</li> </ul>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#formatacao-de-dados","title":"Formata\u00e7\u00e3o de Dados","text":"<ul> <li>Datas: Formato \"dd/MM/yyyy\"</li> <li>N\u00fameros: Convers\u00e3o direta para string</li> <li>Campos JSON: Acesso ao campo <code>obs_sgc</code> espec\u00edfico</li> <li>Valores Nulos: Substitu\u00eddos por string vazia</li> </ul>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#prioridade-de-eventos","title":"Prioridade de Eventos","text":"<ol> <li>Evento passado como par\u00e2metro (<code>abh21</code>)</li> <li>Evento vinculado ao lan\u00e7amento (<code>ebb05.abh21id</code>)</li> </ol>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de formata\u00e7\u00e3o do hist\u00f3rico.</p>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#buscas-no-banco","title":"Buscas no Banco","text":"<ul> <li>Consultas otimizadas com <code>getAcessoAoBanco().buscarRegistroUnico()</code></li> <li>Filtros por ID das entidades</li> <li>Aplica\u00e7\u00e3o de <code>WHERE</code> padr\u00e3o para entidade Abe01</li> </ul>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Ebb05 (Lan\u00e7amento Cont\u00e1bil): - <code>ebb05historico</code> - Hist\u00f3rico formatado com coringas substitu\u00eddos</p>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.model</code> - Entidades do sistema - <code>sam.server.samdev</code> - Base de f\u00f3rmula e utilit\u00e1rios - <code>java.time.format</code> - Formata\u00e7\u00e3o de datas</p> <p>Entidades: - <code>FormulaBase</code> - Classe base para f\u00f3rmulas - <code>Parametro</code> - Par\u00e2metros de consulta ao banco</p>"},{"location":"ELTECH/formulas/sgc/SGC_LancamentoContabil/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Utiliza <code>DateTimeFormatter</code> para formata\u00e7\u00e3o consistente de datas</li> <li>Processamento seguro de valores nulos em todas as substitui\u00e7\u00f5es</li> <li>Consultas otimizadas com busca \u00fanica por entidade</li> <li>Suporte a campos JSON para observa\u00e7\u00f5es customizadas</li> <li>Integra\u00e7\u00e3o com sistema de lan\u00e7amentos programados (Eba02)</li> <li>Compat\u00edvel com classifica\u00e7\u00e3o patrimonial (Eca01)</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 23/10/2025 10:48 Autor: Bruno Tipo: F\u00f3rmula de Lan\u00e7amento Cont\u00e1bil (LCTO_SGC) Vers\u00e3o: 1.0</p>"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/","title":"SGC_LancamentoContabil.md","text":""},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de formata\u00e7\u00e3o autom\u00e1tica de hist\u00f3rico cont\u00e1bil para o SGC (Sistema de Gest\u00e3o Cont\u00e1bil), processando coringas din\u00e2micos para compor o hist\u00f3rico dos lan\u00e7amentos cont\u00e1beis.</p>"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar a constru\u00e7\u00e3o do hist\u00f3rico cont\u00e1bil atrav\u00e9s da substitui\u00e7\u00e3o de coringas por informa\u00e7\u00f5es din\u00e2micas do documento fiscal, entidade, classifica\u00e7\u00e3o patrimonial e eventos.</p>"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Cont\u00e1bil</li> <li>Financeiro</li> <li>Faturamento</li> <li>Controladoria</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - F\u00f3rmula <code>SGC_LancamentoContabil</code> - Formata\u00e7\u00e3o de hist\u00f3rico cont\u00e1bil</p> <p>Localiza\u00e7\u00e3o: <code>eltech/formulas/sgc/</code></p>"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EBB05</code> - Lan\u00e7amentos cont\u00e1beis - <code>AAH01</code> - Tipos de documento - <code>ABE01</code> - Entidades/Clientes - <code>ABB01</code> - Documentos fiscais - <code>ABH21</code> - Eventos cont\u00e1beis - <code>ECA01</code> - Classifica\u00e7\u00e3o patrimonial - <code>EBA02</code> - Planilha de lan\u00e7amento programado</p> <p>Entidades Envolvidas: - <code>Ebb05</code> - Lan\u00e7amento cont\u00e1bil - <code>Aah01</code> - Tipo de documento - <code>Abe01</code> - Entidade - <code>Abb01</code> - Documento fiscal - <code>Abh21</code> - Evento - <code>Eca01</code> - Classifica\u00e7\u00e3o patrimonial - <code>Eba02</code> - Lan\u00e7amento programado</p>"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o ebb05 Ebb05 Sim Lan\u00e7amento cont\u00e1bil a ser processado abh21 Abh21 N\u00e3o Evento cont\u00e1bil (alternativo)"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#saidas-do-processo","title":"\ud83d\udccb Sa\u00eddas do Processo","text":"Campo Descri\u00e7\u00e3o Tipo ebb05historico Hist\u00f3rico cont\u00e1bil formatado String"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Inicializa\u00e7\u00e3o</li> <li>Obt\u00e9m lan\u00e7amento cont\u00e1bil (EBB05)</li> <li>Verifica exist\u00eancia de hist\u00f3rico</li> <li> <p>Inicializa entidades relacionadas</p> </li> <li> <p>Busca de Dados Relacionados</p> </li> <li>Tipo de documento (AAH01) atrav\u00e9s do documento central</li> <li>Entidade (ABE01) do documento</li> <li>Classifica\u00e7\u00e3o patrimonial (ECA01) quando aplic\u00e1vel</li> <li>Planilha de lan\u00e7amento programado (EBA02)</li> <li> <p>Evento cont\u00e1bil (ABH21)</p> </li> <li> <p>Processamento de Coringas</p> </li> <li>Substitui coringas por valores din\u00e2micos</li> <li>Aplica formata\u00e7\u00e3o espec\u00edfica para cada tipo de dado</li> <li> <p>Mant\u00e9m valores vazios para dados n\u00e3o encontrados</p> </li> <li> <p>Atualiza\u00e7\u00e3o do Hist\u00f3rico</p> </li> <li>Atribui hist\u00f3rico formatado ao lan\u00e7amento</li> <li>Preserva estrutura original do hist\u00f3rico</li> </ol>"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#coringas-suportados","title":"Coringas Suportados","text":"Coringa Descri\u00e7\u00e3o Fonte $1 Nome abreviado do documento AAH01.aah01na $2 N\u00famero do documento ABB01.abb01num $3 S\u00e9rie do documento ABB01.abb01serie $4 Data do documento (dd/MM/yyyy) ABB01.abb01data $5 Nome da entidade ABE01.abe01nome $6 Parcela do documento ABB01.abb01parcela $7 Nome da classifica\u00e7\u00e3o patrimonial ECA01.eca01nome $8 Observa\u00e7\u00e3o SGC (CampoLivre) EBA02.eba02json.obs_sgc $9 Nome do evento ABH21.abh21nome"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Hist\u00f3rico \u00e9 obrigat\u00f3rio para processamento</li> <li>Dados nulos s\u00e3o substitu\u00eddos por string vazia</li> <li>Formata\u00e7\u00e3o de data padr\u00e3o brasileiro (dd/MM/yyyy)</li> <li>Consultas aplicam where padr\u00e3o do sistema para seguran\u00e7a</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#comportamento-do-sistema","title":"\ud83c\udfa8 Comportamento do Sistema","text":"<ul> <li>Processamento Condicional: Apenas executa se hist\u00f3rico existir</li> <li>Toler\u00e2ncia a Nulos: Substitui dados n\u00e3o encontrados por string vazia</li> <li>Busca Otimizada: Consultas espec\u00edficas apenas para dados necess\u00e1rios</li> <li>Formata\u00e7\u00e3o Consistente: Datas no formato brasileiro</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>sam.dicdados</code> - Defini\u00e7\u00e3o de tipos de f\u00f3rmula - <code>sam.model.entities</code> - Entidades do sistema - <code>sam.server.samdev.formula</code> - Framework de f\u00f3rmulas</p> <p>Consultas: - Busca de tipo de documento por ID - Busca de entidade com where padr\u00e3o - Busca de classifica\u00e7\u00e3o patrimonial - Busca de lan\u00e7amento programado por documento central - Busca de evento cont\u00e1bil</p>"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Tipo de F\u00f3rmula: <code>LCTO_SGC</code> - Espec\u00edfico para lan\u00e7amentos cont\u00e1beis do SGC</li> <li>Tratamento de Nulos: Robustez contra dados incompletos</li> <li>Performance: Consultas diretas apenas quando necess\u00e1rio</li> <li>Flexibilidade: Suporte a coringas din\u00e2micos e expans\u00edvel</li> <li>Seguran\u00e7a: Aplica\u00e7\u00e3o de where padr\u00e3o em consultas de entidade</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#metodos-principais","title":"\ud83d\udd04 M\u00e9todos Principais","text":""},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de formata\u00e7\u00e3o do hist\u00f3rico.</p>"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#obtertipoformula","title":"<code>obterTipoFormula()</code>","text":"<p>Define o tipo espec\u00edfico da f\u00f3rmula para o sistema SGC.</p>"},{"location":"ELTECH/formulas/sgt/SGC_LancamentoContabil/#estrutura-do-historico","title":"\ud83d\udca1 Estrutura do Hist\u00f3rico","text":"<p>O sistema permite templates flex\u00edveis como: - \"Fatura \\$1 n\u00ba \\$2 s\u00e9rie \\$3 - \\$5\" - \"Classifica\u00e7\u00e3o: \\$7 - Evento: \\$9\" - \"Parcela \\$6 - Obs: \\$8\"</p> <p>Sendo automaticamente expandido para: \"Fatura NF n\u00ba 12345 s\u00e9rie 1 - Cliente XYZ Ltda\"</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/","title":"SGT_Apuracao_EFD_ICMSDifAliq.md","text":""},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de apura\u00e7\u00e3o autom\u00e1tica do ICMS Diferencial de Al\u00edquota (DIFAL) e Fundo de Combate \u00e0 Pobreza (FCP) para a EFD-ICMS/IPI no SGT (Sistema de Gest\u00e3o Tribut\u00e1ria).</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Realizar a apura\u00e7\u00e3o mensal autom\u00e1tica dos valores de ICMS DIFAL e FCP por estado, gerando os registros cont\u00e1beis necess\u00e1rios para a escritura\u00e7\u00e3o fiscal digital.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Controladoria</li> <li>Gest\u00e3o Tribut\u00e1ria</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - F\u00f3rmula <code>SGT_Apuracao_EFD_ICMSDifAliq</code> - Apura\u00e7\u00e3o de ICMS DIFAL/FCP</p> <p>Localiza\u00e7\u00e3o: <code>eltech/formulas/sgt/</code></p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EDB01</code> - Apura\u00e7\u00f5es fiscais - <code>EAA01</code> - Documentos fiscais - <code>EAA0103</code> - Itens de documentos fiscais - <code>EAA01035</code> - Ajustes fiscais - <code>ABB01</code> - Documentos fiscais - <code>AAG02</code> - Estados/UFs - <code>AAC10</code> - Empresas</p> <p>Entidades Envolvidas: - <code>Edb01</code> - Apura\u00e7\u00e3o fiscal - <code>Eaa01</code> - Documento fiscal - <code>Eaa0103</code> - Item de documento fiscal - <code>Eaa01035</code> - Ajuste fiscal - <code>Aac10</code> - Empresa - <code>Aag02</code> - Estado/UF</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o edb01 Edb01 Sim Per\u00edodo de apura\u00e7\u00e3o (ano/m\u00eas)"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#saidas-do-processo","title":"\ud83d\udccb Sa\u00eddas do Processo","text":"Campo Descri\u00e7\u00e3o Tipo edb01 Apura\u00e7\u00e3o fiscal gerada Edb01 edb01json Campos de apura\u00e7\u00e3o DIFAL/FCP TableMap"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Inicializa\u00e7\u00e3o</li> <li>Obt\u00e9m per\u00edodo de apura\u00e7\u00e3o (EDB01)</li> <li>Define datas inicial e final do m\u00eas</li> <li> <p>Seleciona alinhamento \"0031\" para estrutura de campos</p> </li> <li> <p>Processamento por Estado</p> </li> <li>Identifica estados envolvidos (UF da empresa ou todos)</li> <li>Verifica se \u00e9 primeira apura\u00e7\u00e3o para cada estado</li> <li> <p>Determina se estado \u00e9 da empresa ou destino</p> </li> <li> <p>Apura\u00e7\u00e3o do DIFAL</p> </li> <li>Calcula saldo credor anterior</li> <li>Processa sa\u00eddas com d\u00e9bito</li> <li>Aplica ajustes de d\u00e9bito e cr\u00e9dito</li> <li> <p>Calcula saldo devedor e valor a recolher</p> </li> <li> <p>Apura\u00e7\u00e3o do FCP</p> </li> <li>Repete estrutura do DIFAL para Fundo de Combate \u00e0 Pobreza</li> <li> <p>Calcula valores espec\u00edficos do FCP</p> </li> <li> <p>Persist\u00eancia dos Resultados</p> </li> <li>Armazena valores nos campos JSON da apura\u00e7\u00e3o</li> <li>Persiste apenas apura\u00e7\u00f5es com valores relevantes</li> <li>Aplica where padr\u00e3o do sistema</li> </ol>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#campos-de-apuracao-difal","title":"Campos de Apura\u00e7\u00e3o DIFAL","text":"Campo Descri\u00e7\u00e3o sdoCredAntDifal Saldo credor anterior - DIFAL debDifal Sa\u00eddas com d\u00e9bito - DIFAL ajuDebDifal Ajustes de d\u00e9bito - DIFAL credDifal Cr\u00e9ditos do ICMS - DIFAL ajuCredDifal Ajustes de cr\u00e9dito - DIFAL sdoDevDifal Saldo devedor antes das dedu\u00e7\u00f5es - DIFAL deducoesDifal Dedu\u00e7\u00f5es - DIFAL vlrRecolDifal Valor recolhido ou a recolher - DIFAL sdoCredDifal Saldo credor a transportar - DIFAL extraDifal Valores extra-apura\u00e7\u00e3o - DIFAL"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#campos-de-apuracao-fcp","title":"Campos de Apura\u00e7\u00e3o FCP","text":"Campo Descri\u00e7\u00e3o sdoCredAntFcp Saldo credor anterior - FCP debFcp Sa\u00eddas com d\u00e9bito - FCP ajuDebFcp Ajustes de d\u00e9bito - FCP credFcp Entradas com cr\u00e9dito - FCP ajuCredFcp Ajustes de cr\u00e9dito - FCP sdoDevFcp Saldo devedor antes das dedu\u00e7\u00f5es - FCP deducoesFcp Dedu\u00e7\u00f5es - FCP vlrRecolFcp Valor recolhido ou a recolher - FCP sdoCredFcp Saldo credor a transportar - FCP extraFcp Valores extra-apura\u00e7\u00e3o - FCP"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#validacoes-e-regras","title":"Valida\u00e7\u00f5es e Regras","text":"<ul> <li>Estados \"EX\" (Exterior) s\u00e3o ignorados</li> <li>Primeira apura\u00e7\u00e3o considera valores do primeiro per\u00edodo</li> <li>Campos com valor zero n\u00e3o geram apura\u00e7\u00e3o</li> <li>Aplica\u00e7\u00e3o de where padr\u00e3o em todas as consultas</li> <li>Documentos cancelados s\u00e3o exclu\u00eddos dos c\u00e1lculos</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Crit\u00e9rios e consultas - <code>multitec.utils</code> - Utilit\u00e1rios e cole\u00e7\u00f5es - <code>sam.dicdados</code> - Defini\u00e7\u00e3o de tipos de f\u00f3rmula</p> <p>Consultas: - Saldo credor anterior por estado - Total de imposto DIFAL/FCP por opera\u00e7\u00e3o - Ajustes de d\u00e9bito e cr\u00e9dito - Valores extra-apura\u00e7\u00e3o - Modelos de documentos por registro</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#modelos-de-documentos","title":"Modelos de Documentos","text":"<ul> <li>Registro C100: 01, 1B, 04, 55, 65</li> <li>Registro D100: 07, 08, 8B, 09, 10, 11, 26, 27, 57, 67, 63</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#codigos-de-ajuste","title":"C\u00f3digos de Ajuste","text":"<ul> <li>Terceiro d\u00edgito: 2 (ICMS), 3 (FCP)</li> <li>Quarto d\u00edgito: </li> <li>0,1 (D\u00e9bito)</li> <li>2,3 (Cr\u00e9dito/Dedu\u00e7\u00e3o)</li> <li>5 (Extra-apura\u00e7\u00e3o)</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#tratamento-de-estados","title":"Tratamento de Estados","text":"<ul> <li>UF da Empresa: Considera campo vl_icms_uf_rem</li> <li>UF Destino: Considera campo vl_icms_uf_dest</li> <li>FCP: Sempre utiliza campo vl_fcp_uf_dest</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#metodos-principais","title":"\ud83d\udd04 M\u00e9todos Principais","text":""},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra toda a apura\u00e7\u00e3o.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#buscartotalimpostodifalfcp","title":"<code>buscarTotalImpostoDifalFcp()</code>","text":"<p>Calcula totais de imposto para DIFAL e FCP.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#buscarajustesdebitosicmsdifalfcp","title":"<code>buscarAjustesDebitosICMSDifalFcp()</code>","text":"<p>Busca ajustes de d\u00e9bito para ICMS e FCP.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#buscarajustescreditosicmsdifalfcp","title":"<code>buscarAjustesCreditosICMSDifalFcp()</code>","text":"<p>Busca ajustes de cr\u00e9dito para ICMS e FCP.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#buscarsaldocredoranterior","title":"<code>buscarSaldoCredorAnterior()</code>","text":"<p>Obt\u00e9m saldo credor do per\u00edodo anterior.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#estrutura-de-calculo","title":"\ud83d\udca1 Estrutura de C\u00e1lculo","text":"<p>Saldo Devedor = (Sa\u00eddas com D\u00e9bito + Ajustes D\u00e9bito) - (Saldo Credor Anterior + Cr\u00e9ditos + Ajustes Cr\u00e9dito)</p> <p>Valor a Recolher = Saldo Devedor - Dedu\u00e7\u00f5es</p> <p>Saldo Credor = (Saldo Credor Anterior + Cr\u00e9ditos + Ajustes Cr\u00e9dito) - (Sa\u00eddas com D\u00e9bito + Ajustes D\u00e9bito)</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#validacoes-fiscais","title":"\u26a0\ufe0f Valida\u00e7\u00f5es Fiscais","text":"<ul> <li>Apenas documentos com indicador EFD ICMS = 1</li> <li>Exclus\u00e3o de documentos cancelados</li> <li>Filtro por situa\u00e7\u00e3o fiscal v\u00e1lida para EFD</li> <li>Considera\u00e7\u00e3o apenas de endere\u00e7os principais</li> <li>Valida\u00e7\u00e3o de modelos de documento permitidos</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/","title":"SGT - Apura\u00e7\u00e3o de Receita PIS/COFINS","text":""},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para apura\u00e7\u00e3o de receita e c\u00e1lculo da Contribui\u00e7\u00e3o Previdenci\u00e1ria sobre Receita Bruta (PIS/COFINS), considerando diferentes classifica\u00e7\u00f5es de receita e atividades econ\u00f4micas.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Realizar a apura\u00e7\u00e3o completa da receita bruta para fins de PIS/COFINS, classificando as receitas por tipo (tributada, n\u00e3o-tributada, exporta\u00e7\u00e3o, cumulativa) e calculando a base de c\u00e1lculo da contribui\u00e7\u00e3o previdenci\u00e1ria.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Controladoria</li> <li>Gestores Tribut\u00e1rios</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos fiscais de entrada/sa\u00edda - <code>Eaa0103</code> - Itens de documentos fiscais - <code>Abb01</code> - Cabe\u00e7alho de documentos - <code>Aah01</code> - Tipos de documento - <code>Abb10</code> - Opera\u00e7\u00f5es fiscais - <code>Aac10</code> - Empresas - <code>Abg02</code> - Atividades econ\u00f4micas - <code>Abc10</code> - Plano de contas cont\u00e1bil - <code>Edb10</code> - Per\u00edodo de apura\u00e7\u00e3o - <code>Edb1001</code> - Receita por empresa - <code>Edb10011</code> - Detalhe por atividade</p> <p>Entidades Envolvidas: - <code>Edb10</code> - Per\u00edodo de apura\u00e7\u00e3o - <code>Edb1001</code> - Receita por empresa - <code>Edb10011</code> - Detalhe por atividade econ\u00f4mica - <code>Aac10</code> - Empresa - <code>Abg02</code> - Atividade econ\u00f4mica - <code>Abc10</code> - Conta cont\u00e1bil</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o edb10 Edb10 Sim Per\u00edodo de apura\u00e7\u00e3o com m\u00eas/ano alinApur String Sim C\u00f3digo do alinhamento (0044) <p>Campos do Alinhamento: - <code>vlRecTotEst</code> - Valor total da receita do estabelecimento - <code>vlRecAtivEstab</code> - Valor da receita da atividade do estabelecimento - <code>vlExc</code> - Valor das exclus\u00f5es - <code>aliqCont</code> - Al\u00edquota da contribui\u00e7\u00e3o</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Seleciona alinhamento de apura\u00e7\u00e3o (0044)</li> <li>Busca matriz e filiais da empresa ativa</li> <li>Obt\u00e9m campos do alinhamento para c\u00e1lculo</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#2-apuracao-da-receita-por-classificacao","title":"2. Apura\u00e7\u00e3o da Receita por Classifica\u00e7\u00e3o","text":"<ul> <li>Busca receitas do per\u00edodo por empresa</li> <li>Classifica em 4 categorias:</li> <li>1 - Tributada: Receitas sujeitas \u00e0 tributa\u00e7\u00e3o</li> <li>2 - N\u00e3o-Tributada: Receitas isentas ou n\u00e3o-tributadas</li> <li>3 - Exporta\u00e7\u00e3o: Receitas de exporta\u00e7\u00e3o</li> <li>4 - Cumulativa: Receitas do regime cumulativo</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#3-calculo-da-contribuicao-previdenciaria-p100","title":"3. C\u00e1lculo da Contribui\u00e7\u00e3o Previdenci\u00e1ria (P100)","text":"<ul> <li>Processa receitas por atividade econ\u00f4mica</li> <li>Aplica al\u00edquotas espec\u00edficas por atividade</li> <li>Considera devolu\u00e7\u00f5es e exclus\u00f5es</li> <li>Calcula base de c\u00e1lculo e contribui\u00e7\u00e3o</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#4-consolidacao-dos-resultados","title":"4. Consolida\u00e7\u00e3o dos Resultados","text":"<ul> <li>Totaliza receitas por categoria</li> <li>Calcula totais para o per\u00edodo</li> <li>Preenche entidades do modelo (Edb10, Edb1001, Edb10011)</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#classificacao-de-receitas","title":"Classifica\u00e7\u00e3o de Receitas","text":"<ul> <li>Classe 1: Receitas tributadas</li> <li>Classe 2: Receitas n\u00e3o-tributadas  </li> <li>Classe 3: Receitas de exporta\u00e7\u00e3o</li> <li>Classe 4: Receitas do regime cumulativo</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#calculos-financeiros","title":"C\u00e1lculos Financeiros","text":"<ul> <li>Base de C\u00e1lculo: Receita da atividade - Exclus\u00f5es</li> <li>Contribui\u00e7\u00e3o: Base de c\u00e1lculo \u00d7 Al\u00edquota</li> <li>Receita Total: Soma de todas as receitas do estabelecimento</li> <li>Receita com CP: Receitas com contribui\u00e7\u00e3o previdenci\u00e1ria</li> <li>Receita sem CP: Receitas sem contribui\u00e7\u00e3o previdenci\u00e1ria</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#filtros-de-periodo","title":"Filtros de Per\u00edodo","text":"<ul> <li>Considera documentos do m\u00eas/ano informado</li> <li>Apenas documentos n\u00e3o cancelados</li> <li>Apenas documentos com indicador EFD Contribuinte = 1</li> <li>Opera\u00e7\u00f5es fiscais do tipo 1 (entrada/sa\u00edda)</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#tratamento-de-devolucoes","title":"Tratamento de Devolu\u00e7\u00f5es","text":"<ul> <li>Considera opera\u00e7\u00f5es fiscais do tipo 4 (devolu\u00e7\u00e3o)</li> <li>Ajusta valores de exclus\u00f5es nas atividades</li> <li>Mant\u00e9m demais dados da atividade original</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de apura\u00e7\u00e3o.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#selecionargcporempresalong-aac10id-string-tabela","title":"<code>selecionarGCPorEmpresa(Long aac10id, String tabela)</code>","text":"<p>Busca o grupo de empresas para a tabela especificada.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#buscarmatrizefiliais","title":"<code>buscarMatrizEFiliais()</code>","text":"<p>Retorna lista da matriz e todas suas filiais.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#buscarreceitainteger-mes-integer-ano-long-gcea","title":"<code>buscarReceita(Integer mes, Integer ano, Long gcEA)</code>","text":"<p>Busca receitas classificadas por tipo.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#buscarreceitap100integer-mes-integer-ano-string-campos","title":"<code>buscarReceitaP100(Integer mes, Integer ano, String... campos)</code>","text":"<p>Busca receitas para c\u00e1lculo da contribui\u00e7\u00e3o P100.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#buscardevolucoesp100integer-mes-integer-ano-string-campos","title":"<code>buscarDevolucoesP100(Integer mes, Integer ano, String... campos)</code>","text":"<p>Busca devolu\u00e7\u00f5es para ajuste do c\u00e1lculo P100.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Edb10 (Per\u00edodo): - <code>edb10rbTrib</code> - Receita tributada - <code>edb10rbNaoTrib</code> - Receita n\u00e3o-tributada - <code>edb10rbExp</code> - Receita de exporta\u00e7\u00e3o - <code>edb10rbCumul</code> - Receita cumulativa - <code>edb10rbTotal</code> - Receita total - <code>edb10rbAtivCP</code> - Receita com contribui\u00e7\u00e3o previdenci\u00e1ria - <code>edb10rbAtivSemCP</code> - Receita sem contribui\u00e7\u00e3o previdenci\u00e1ria</p> <p>Edb1001 (Por Empresa): - <code>edb1001empresa</code> - Empresa - <code>edb1001rb</code> - Receita bruta da empresa</p> <p>Edb10011 (Por Atividade): - <code>edb10011ativ</code> - Atividade econ\u00f4mica - <code>edb10011rb</code> - Receita bruta - <code>edb10011exc</code> - Exclus\u00f5es - <code>edb10011aliq</code> - Al\u00edquota - <code>edb10011cprb</code> - Contribui\u00e7\u00e3o previdenci\u00e1ria - <code>edb10011cta</code> - Conta cont\u00e1bil</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multitec.utils</code> - Utilit\u00e1rios e datas - <code>multiorm</code> - Criteria e fields - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.model</code> - Entidades do sistema</p> <p>Entidades: - <code>FormulaBase</code> - Classe base para f\u00f3rmulas - <code>TableMap</code> - Estrutura de dados para resultados - <code>Parametro</code> - Par\u00e2metros de consulta</p>"},{"location":"ELTECH/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Utiliza JSON fields para campos din\u00e2micos (<code>eaa0103json</code>)</li> <li>Processa matriz e filiais consolidamente</li> <li>Suporte a m\u00faltiplas atividades econ\u00f4micas por empresa</li> <li>C\u00e1lculos com precis\u00e3o decimal (2 casas)</li> <li>Consultas SQL otimizadas com agrega\u00e7\u00f5es</li> <li>Tratamento espec\u00edfico para devolu\u00e7\u00f5es</li> <li>Al\u00edquotas vari\u00e1veis por atividade econ\u00f4mica</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 05/09 \u00e0s 16:00 Autor: Bruno Tipo: F\u00f3rmula de Apura\u00e7\u00e3o Vers\u00e3o: 1.0</p>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/","title":"SGT - Leiaute 15/2021 Contribui\u00e7\u00f5es (EFD Contribui\u00e7\u00f5es)","text":""},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para gera\u00e7\u00e3o do arquivo EFD Contribui\u00e7\u00f5es (PIS/COFINS) no formato Leiaute 15/2021, contemplando todos os blocos obrigat\u00f3rios para escritura\u00e7\u00e3o fiscal digital.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar arquivo digital da EFD Contribui\u00e7\u00f5es conforme legisla\u00e7\u00e3o vigente, consolidando informa\u00e7\u00f5es de documentos fiscais, apura\u00e7\u00f5es, cr\u00e9ditos e demais opera\u00e7\u00f5es sujeitas \u00e0 tributa\u00e7\u00e3o PIS/COFINS.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Escritura\u00e7\u00e3o Fiscal Digital</li> <li>Auditoria Fiscal</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens de documentos fiscais - <code>Abb01</code> - Cabe\u00e7alho de documentos - <code>Aah01</code> - Tipos de documento - <code>Abe01</code> - Entidades - <code>Abm01</code> - Itens (produtos/servi\u00e7os) - <code>Edb10</code> - Per\u00edodo de apura\u00e7\u00e3o - <code>Edb11</code> - Opera\u00e7\u00f5es de cr\u00e9dito - <code>Edb12</code> - Reten\u00e7\u00f5es na fonte - <code>Edb13</code> - Dedu\u00e7\u00f5es diversas - <code>Edb14</code> - Cr\u00e9ditos por incorpora\u00e7\u00e3o/fus\u00e3o/cis\u00e3o - <code>Ecb01</code> - Bens do ativo imobilizado</p> <p>Blocos Gerados: - Bloco 0 - Abertura, identifica\u00e7\u00e3o e refer\u00eancias - Bloco A - Documentos fiscais - servi\u00e7os - Bloco C - Documentos fiscais I - mercadorias (ICMS/IPI) - Bloco D - Documentos fiscais II - servi\u00e7os (ICMS) - Bloco F - Demais documentos e opera\u00e7\u00f5es - Bloco M - Apura\u00e7\u00e3o do PIS/COFINS - Bloco 1 - Opera\u00e7\u00f5es extempor\u00e2neas - Bloco 9 - Controle e encerramento</p>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o dtInicial LocalDate Sim Data inicial do per\u00edodo dtFinal LocalDate Sim Data final do per\u00edodo situacao Integer Sim Situa\u00e7\u00e3o da escritura\u00e7\u00e3o (0-normal, 9-retificadora) numRecibo String N\u00e3o N\u00famero do recibo (para retifica\u00e7\u00e3o) aliqPisF150 BigDecimal N\u00e3o Al\u00edquota PIS para registro F150 aliqCofinsF150 BigDecimal N\u00e3o Al\u00edquota COFINS para registro F150"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o de par\u00e2metros e per\u00edodo</li> <li>Busca da empresa matriz e filiais</li> <li>Verifica\u00e7\u00e3o da apura\u00e7\u00e3o de receita do per\u00edodo</li> <li>Sele\u00e7\u00e3o do alinhamento EFD (0051)</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#2-geracao-dos-blocos","title":"2. Gera\u00e7\u00e3o dos Blocos","text":"<ul> <li>Bloco 0: Dados da empresa, contabilista, regimes de apura\u00e7\u00e3o</li> <li>Bloco A: Notas fiscais de servi\u00e7o</li> <li>Bloco C: Notas fiscais de mercadorias</li> <li>Bloco D: Documentos de transporte e comunica\u00e7\u00e3o</li> <li>Bloco F: Opera\u00e7\u00f5es geradoras de cr\u00e9ditos, bens do ativo, ajustes</li> <li>Bloco M: Apura\u00e7\u00e3o consolidada</li> <li>Bloco 1: Processos judiciais e administrativos</li> <li>Bloco 9: Encerramento e totais</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#3-processamento-por-empresa","title":"3. Processamento por Empresa","text":"<ul> <li>Consolida\u00e7\u00e3o por grupo centralizador (GC)</li> <li>Valida\u00e7\u00e3o de documentos fiscais</li> <li>C\u00e1lculo de bases e valores do PIS/COFINS</li> <li>Agrupamento por CST e atividade econ\u00f4mica</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#4-formatacao-e-saida","title":"4. Formata\u00e7\u00e3o e Sa\u00edda","text":"<ul> <li>Gera\u00e7\u00e3o do arquivo texto no formato delimitado por \"|\"</li> <li>Formata\u00e7\u00e3o de valores, datas e c\u00f3digos</li> <li>Controle de quantidade de linhas por registro</li> <li>Valida\u00e7\u00e3o final do arquivo</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#validacoes-de-documentos","title":"Valida\u00e7\u00f5es de Documentos","text":"<ul> <li>Apenas documentos com indicador EFD Contribuinte = 1</li> <li>Documentos n\u00e3o cancelados</li> <li>Per\u00edodo conforme datas informadas</li> <li>Situa\u00e7\u00e3o do documento obrigat\u00f3ria</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#classificacao-de-receitas","title":"Classifica\u00e7\u00e3o de Receitas","text":"<ul> <li>Tributada: CST 01-03, 05</li> <li>N\u00e3o-Tributada: CST 04, 06-09, 49</li> <li>Exporta\u00e7\u00e3o: CST espec\u00edficos</li> <li>Cumulativa: Regime cumulativo</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#calculos-financeiros","title":"C\u00e1lculos Financeiros","text":"<ul> <li>Base de C\u00e1lculo: Conforme CST e movimento</li> <li>Al\u00edquotas: Espec\u00edficas por atividade/documento</li> <li>Cr\u00e9ditos: Baseados em deprecia\u00e7\u00e3o ou aquisi\u00e7\u00e3o</li> <li>Ajustes: Conforme legisla\u00e7\u00e3o espec\u00edfica</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#formatacao-de-dados","title":"Formata\u00e7\u00e3o de Dados","text":"<ul> <li>Datas: Formato \"ddMMyyyy\"</li> <li>Valores: 2 casas decimais</li> <li>CNPJ/CPF: Apenas n\u00fameros (14/11 d\u00edgitos)</li> <li>C\u00f3digos: Preenchimento com zeros \u00e0 esquerda</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra toda a gera\u00e7\u00e3o da EFD.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#geracao-por-bloco","title":"Gera\u00e7\u00e3o por Bloco","text":"<ul> <li><code>gerarAberturaBloco0()</code> - Dados iniciais da empresa</li> <li><code>gerarBlocoA()</code> - Documentos de servi\u00e7os</li> <li><code>gerarBlocoC()</code> - Documentos de mercadorias</li> <li><code>gerarBlocoD()</code> - Documentos de transporte/comunica\u00e7\u00e3o</li> <li><code>gerarBlocoF()</code> - Opera\u00e7\u00f5es diversas e cr\u00e9ditos</li> <li><code>gerarBlocoM()</code> - Apura\u00e7\u00e3o do PIS/COFINS</li> <li><code>gerarBloco1()</code> - Processos extempor\u00e2neos</li> <li><code>gerarBloco9()</code> - Encerramento</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#metodos-auxiliares","title":"M\u00e9todos Auxiliares","text":"<ul> <li><code>buscarDocumentosXXX()</code> - Consultas espec\u00edficas por bloco</li> <li><code>comporRegistroXXX()</code> - Montagem de registros</li> <li><code>formatarValor()</code> - Formata\u00e7\u00e3o de valores monet\u00e1rios</li> <li><code>selecionarCSTPis/Cofins()</code> - Defini\u00e7\u00e3o de CST</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Arquivo Texto: - Formato delimitado por pipe (\"|\") - Codifica\u00e7\u00e3o UTF-8 - Registros conforme layout oficial - Blocos separados com totais</p> <p>Principais Registros: - 0000/0001: Abertura do arquivo e bloco - 0100: Dados do contabilista - 0140: Estabelecimentos - 0150: Participantes - 0200: Produtos/servi\u00e7os - A100/C100/D100: Documentos fiscais - F100/F120/F130: Opera\u00e7\u00f5es de cr\u00e9dito - F550: Consolida\u00e7\u00e3o para lucro presumido - 9999: Encerramento do arquivo</p>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multitec.utils</code> - Utilit\u00e1rios, datas e formata\u00e7\u00e3o - <code>multiorm</code> - Criteria e consultas ao banco - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.model</code> - Entidades do sistema - <code>java.time</code> - Manipula\u00e7\u00e3o de datas</p> <p>Configura\u00e7\u00f5es: - Alinhamento EFD (0051) - Vers\u00e3o do leiaute (6) - Modelos de documentos fiscais por bloco</p>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#otimizacoes","title":"Otimiza\u00e7\u00f5es","text":"<ul> <li>Consultas paginadas para grandes volumes</li> <li>Cache de entidades frequentemente acessadas</li> <li>Agrupamento por chaves para evitar duplicidades</li> <li>Processamento por lotes de documentos</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#tratamento-de-erros","title":"Tratamento de Erros","text":"<ul> <li>Valida\u00e7\u00e3o de dados obrigat\u00f3rios</li> <li>Tratamento de valores nulos</li> <li>Log de documentos com inconsist\u00eancias</li> <li>Interrup\u00e7\u00e3o por cancelamento do processo</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#performance","title":"Performance","text":"<ul> <li>Uso de TableMap para agrupamentos</li> <li>Consultas espec\u00edficas por bloco</li> <li>Processamento em mem\u00f3ria com limites</li> <li>Controle de quantidade de registros</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 22/10/2025 \u00e0s 17:15 Autor: Bruno Tipo: F\u00f3rmula EFD Contribui\u00e7\u00f5es Vers\u00e3o: 1.0 Leiaute: 15/2021</p>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/","title":"SGT_Leiaute19_2025_ICMS_IPI","text":""},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Gerador da Escritura\u00e7\u00e3o Fiscal Digital (EFD) para ICMS e IPI conforme Leiaute 19/2025. Implementa todos os blocos e registros necess\u00e1rios para atender \u00e0s obriga\u00e7\u00f5es acess\u00f3rias fiscais.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar arquivo texto no formato EFD-ICMS/IPI contendo todas as opera\u00e7\u00f5es fiscais do per\u00edodo, incluindo documentos fiscais, apura\u00e7\u00f5es, invent\u00e1rios e demais informa\u00e7\u00f5es exigidas pela legisla\u00e7\u00e3o.</p>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Auditoria Fiscal</li> <li>Consultores Tribut\u00e1rios</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#parametrosconfiguracoes","title":"\u2699\ufe0f Par\u00e2metros/Configura\u00e7\u00f5es","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis dtInicial LocalDate Sim Data inicial do per\u00edodo Data no formato dd/MM/yyyy dtFinal LocalDate Sim Data final do per\u00edodo Data no formato dd/MM/yyyy arqSubstituto Integer Sim Indicador de arquivo substituto 0=Original, 1=Substituto dtInventario LocalDate N\u00e3o Data do invent\u00e1rio Data no formato dd/MM/yyyy"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#estrutura-de-blocos","title":"\ud83d\udcca Estrutura de Blocos","text":""},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#bloco-0-abertura-identificacao-e-referencias","title":"Bloco 0 - Abertura, Identifica\u00e7\u00e3o e Refer\u00eancias","text":"<ul> <li>0000: Abertura do arquivo digital</li> <li>0001: Abertura do Bloco 0</li> <li>0002: Classifica\u00e7\u00e3o do Estabelecimento Industrial</li> <li>0005: Dados Complementares da Entidade</li> <li>0015: Dados do Contribuinte Substituto</li> <li>0100: Dados do Contabilista</li> <li>0150: Tabela de Cadastro do Participante</li> <li>0190: Unidades de Medida</li> <li>0200: Identifica\u00e7\u00e3o do Item</li> <li>0300: Cadastro de Bens do CIAP</li> <li>0400: Natureza da Opera\u00e7\u00e3o/Presta\u00e7\u00e3o</li> <li>0450: Informa\u00e7\u00e3o Complementar do Documento Fiscal</li> <li>0460: Observa\u00e7\u00f5es do Lan\u00e7amento Fiscal</li> <li>0500: Plano de Contas Cont\u00e1beis</li> <li>0600: Centros de Custo</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#bloco-b-escrituracao-e-apuracao-do-iss","title":"Bloco B - Escritura\u00e7\u00e3o e Apura\u00e7\u00e3o do ISS","text":"<ul> <li>B001: Abertura do Bloco B</li> <li>B990: Encerramento do Bloco B</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#bloco-c-documentos-fiscais-i-mercadorias-icmsipi","title":"Bloco C - Documentos Fiscais I - Mercadorias (ICMS/IPI)","text":"<ul> <li>C001: Abertura do Bloco C</li> <li>C100: Nota Fiscal, Nota Fiscal Avulsa, Nota Fiscal de Produtor e NF-e</li> <li>C300: Resumo Di\u00e1rio de NFC-e</li> <li>C500: NF de Energia El\u00e9trica, \u00c1gua e G\u00e1s</li> <li>C800: Cupom Fiscal Eletr\u00f4nico - SAT</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#bloco-d-documentos-fiscais-ii-servicos-icms","title":"Bloco D - Documentos Fiscais II - Servi\u00e7os (ICMS)","text":"<ul> <li>D001: Abertura do Bloco D</li> <li>D100: Nota Fiscal de Servi\u00e7o de Transporte e Conhecimentos de Transporte</li> <li>D500: Nota Fiscal de Servi\u00e7o de Comunica\u00e7\u00e3o e Telecomunica\u00e7\u00e3o</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#bloco-e-apuracao-do-icms-e-do-ipi","title":"Bloco E - Apura\u00e7\u00e3o do ICMS e do IPI","text":"<ul> <li>E001: Abertura do Bloco E</li> <li>E100: Per\u00edodo da Apura\u00e7\u00e3o do ICMS</li> <li>E110: Apura\u00e7\u00e3o do ICMS - Opera\u00e7\u00f5es Pr\u00f3prias</li> <li>E200: Apura\u00e7\u00e3o do ICMS - Substitui\u00e7\u00e3o Tribut\u00e1ria</li> <li>E300: Apura\u00e7\u00e3o do ICMS Diferencial de Al\u00edquota</li> <li>E500: Apura\u00e7\u00e3o do IPI</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#bloco-g-ciap-controle-de-credito-de-icms-do-ativo-permanente","title":"Bloco G - CIAP (Controle de Cr\u00e9dito de ICMS do Ativo Permanente)","text":"<ul> <li>G001: Abertura do Bloco G</li> <li>G110: ICMS - Ativo Permanente - CIAP</li> <li>G125: Movimenta\u00e7\u00e3o de Bem ou Componente do Ativo Imobilizado</li> <li>G130: Identifica\u00e7\u00e3o do Documento Fiscal</li> <li>G140: Identifica\u00e7\u00e3o do Item do Documento Fiscal</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#bloco-h-inventario-fisico","title":"Bloco H - Invent\u00e1rio F\u00edsico","text":"<ul> <li>H001: Abertura do Bloco H</li> <li>H005: Totais do Invent\u00e1rio</li> <li>H010: Invent\u00e1rio</li> <li>H020: Informa\u00e7\u00e3o Complementar do Invent\u00e1rio</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#bloco-k-controle-da-producao-e-estoque","title":"Bloco K - Controle da Produ\u00e7\u00e3o e Estoque","text":"<ul> <li>K001: Abertura do Bloco K</li> <li>K100: Per\u00edodo de Apura\u00e7\u00e3o</li> <li>K200: Estoque Escriturado</li> <li>K220: Outras Movimenta\u00e7\u00f5es Internas</li> <li>K230: Itens Produzidos</li> <li>K250: Industrializa\u00e7\u00e3o por Terceiros</li> <li>K270: Corre\u00e7\u00e3o de Apontamento</li> <li>K290: Produ\u00e7\u00e3o Conjunta</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#bloco-1-outras-informacoes","title":"Bloco 1 - Outras Informa\u00e7\u00f5es","text":"<ul> <li>1001: Abertura do Bloco 1</li> <li>1010: Obrigatoriedade de Registros</li> <li>1100: Informa\u00e7\u00f5es sobre Exporta\u00e7\u00e3o</li> <li>1400: Informa\u00e7\u00e3o sobre Valores Agregados</li> <li>1601: Opera\u00e7\u00f5es com Instrumentos de Pagamento Eletr\u00f4nico</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#bloco-9-controle-e-encerramento","title":"Bloco 9 - Controle e Encerramento","text":"<ul> <li>9001: Abertura do Bloco 9</li> <li>9900: Registros do Arquivo</li> <li>9990: Encerramento do Bloco 9</li> <li>9999: Encerramento do Arquivo Digital</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o de Par\u00e2metros</li> <li>Verifica datas do per\u00edodo</li> <li>Valida dados da empresa</li> <li> <p>Configura alinhamentos fiscais</p> </li> <li> <p>Inicializa\u00e7\u00e3o</p> </li> <li>Cria arquivos texto de sa\u00edda</li> <li>Inicializa contadores de registros</li> <li> <p>Prepara estruturas de dados</p> </li> <li> <p>Gera\u00e7\u00e3o dos Blocos</p> </li> <li>Bloco 0: Dados da empresa e cadastros</li> <li>Bloco B: ISS (quando aplic\u00e1vel)</li> <li>Bloco C: Documentos fiscais de mercadorias</li> <li>Bloco D: Documentos fiscais de servi\u00e7os</li> <li>Bloco E: Apura\u00e7\u00f5es de impostos</li> <li>Bloco G: CIAP</li> <li>Bloco H: Invent\u00e1rio</li> <li>Bloco K: Controle de produ\u00e7\u00e3o</li> <li> <p>Bloco 1: Informa\u00e7\u00f5es complementares</p> </li> <li> <p>Finaliza\u00e7\u00e3o</p> </li> <li>Gera totais e encerramentos</li> <li>Consolida arquivo final</li> <li>Atualiza controles de envio</li> </ol>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#validacoes-obrigatorias","title":"Valida\u00e7\u00f5es Obrigat\u00f3rias","text":"<ul> <li>Empresa deve ter munic\u00edpio cadastrado</li> <li>Informa\u00e7\u00f5es fiscais devem estar completas</li> <li>Perfil da empresa deve ser definido</li> <li>Apura\u00e7\u00f5es do per\u00edodo devem existir</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#tratamento-de-documentos","title":"Tratamento de Documentos","text":"<ul> <li>Considera documentos com data de entrada/sa\u00edda no per\u00edodo</li> <li>Aplica filtros por modelo de documento</li> <li>Trata documentos cancelados adequadamente</li> <li>Processa apenas documentos marcados para EFD</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#calculos-fiscais","title":"C\u00e1lculos Fiscais","text":"<ul> <li>Campos fiscais s\u00e3o obtidos do JSON do documento</li> <li>Valores s\u00e3o formatados com precis\u00e3o espec\u00edfica por registro</li> <li>CSTs e CFOPs s\u00e3o validados e formatados</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#perfis-de-apuracao","title":"Perfis de Apura\u00e7\u00e3o","text":"<ul> <li>Perfil A: Ind\u00fastria e equiparado</li> <li>Perfil B: Com\u00e9rcio</li> <li>Perfil C: Prestador de servi\u00e7os</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#saidasretornos","title":"\ud83c\udfa8 Sa\u00eddas/Retornos","text":"Tipo Descri\u00e7\u00e3o Formato Arquivo EFD Arquivo texto com todos os blocos Texto delimitado por pipe Log de Processamento Contadores e status Console/Interface"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multitec.utils</code> - Utilit\u00e1rios gerais - <code>java.time</code> - Manipula\u00e7\u00e3o de datas - <code>jasperreports</code> - Relat\u00f3rios (n\u00e3o utilizado neste c\u00f3digo)</p> <p>Entidades do Sistema: - <code>Eaa01</code> - Documentos fiscais - <code>Abb01</code> - Cabe\u00e7alho de documentos - <code>Abe01</code> - Entidades (clientes/fornecedores) - <code>Abm01</code> - Itens (produtos/servi\u00e7os) - <code>Edb01</code> - Apura\u00e7\u00f5es fiscais - <code>Ecc01</code> - Fichas CIAP</p>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#performance","title":"Performance","text":"<ul> <li>Utiliza pagina\u00e7\u00e3o na consulta de documentos</li> <li>Implementa cache de entidades para evitar consultas repetidas</li> <li>Otimiza processamento com estruturas Map e Set</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#tratamento-de-dados","title":"Tratamento de Dados","text":"<ul> <li>Campos JSON s\u00e3o acessados dinamicamente via <code>jGet()</code></li> <li>Formata\u00e7\u00e3o espec\u00edfica para cada tipo de campo</li> <li>Normaliza\u00e7\u00e3o de textos para remover acentos</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#controles","title":"Controles","text":"<ul> <li>Contadores individuais por tipo de registro</li> <li>Verifica\u00e7\u00e3o de cancelamento do processo</li> <li>Atualiza\u00e7\u00e3o de status durante execu\u00e7\u00e3o</li> </ul>"},{"location":"ELTECH/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#validacoes-especificas","title":"Valida\u00e7\u00f5es Espec\u00edficas","text":"<ul> <li>Regime especial de apura\u00e7\u00e3o</li> <li>Opera\u00e7\u00f5es com diferencial de al\u00edquota</li> <li>Documentos de exporta\u00e7\u00e3o</li> <li>Industrializa\u00e7\u00e3o por terceiros</li> </ul> <p>\u00daltima Atualiza\u00e7\u00e3o: 07/11/2025 Vers\u00e3o do Leiaute: 19</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/","title":"SRF - C\u00e1lculo da FCI (Equilibrio) - Vers\u00e3o Atualizada","text":""},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para c\u00e1lculo e gera\u00e7\u00e3o de Ficha de Conte\u00fado de Importa\u00e7\u00e3o (FCI), considerando composi\u00e7\u00f5es de produtos (BOM), entradas de itens importados, sa\u00eddas do produto final e regras de neg\u00f3cio espec\u00edficas do m\u00f3dulo Equilibrio.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente o conte\u00fado de importa\u00e7\u00e3o (CI) de produtos compostos, com base nas entradas de componentes importados e nas vendas do produto final, gerando registros de FCI para fins fiscais e de controle de origem da mercadoria.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Controle de Qualidade</li> <li>Compras</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Abp20</code> - Composi\u00e7\u00e3o de produtos (BOM) - <code>Abm01</code> - Cadastro de itens - <code>Abm0101</code> - Configura\u00e7\u00f5es fiscais do item - <code>Abm12</code> - CST de origem da mercadoria - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens do documento fiscal - <code>Eab01</code> - Cadastro de FCI - <code>Eab0101</code> - C\u00e1lculos da FCI - <code>Eab01011</code> - Itens importados da FCI - <code>Aba20</code> / <code>Aba2001</code> - Reposit\u00f3rio de dados (configura\u00e7\u00f5es da tarefa SRF2002) - <code>Aag0201</code> / <code>Aag02</code> - Munic\u00edpios e UFs</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o dataCalculo LocalDate Sim Data base para o c\u00e1lculo da FCI bom String Sim C\u00f3digo da composi\u00e7\u00e3o (BOM) whereItem ClientCriterion Sim Crit\u00e9rio para sele\u00e7\u00e3o de produtos dtIniEnt LocalDate Sim Data inicial para entradas dtFinEnt LocalDate Sim Data final para entradas dtIniSai LocalDate Sim Data inicial para sa\u00eddas dtFinSai LocalDate Sim Data final para sa\u00eddas"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Carregamento das configura\u00e7\u00f5es do reposit\u00f3rio SRF2002</li> <li>Valida\u00e7\u00e3o dos par\u00e2metros obrigat\u00f3rios</li> <li>Carregamento dos campos de alinhamento para valores e quantidades</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#2-inicializacao-de-servicos","title":"2. Inicializa\u00e7\u00e3o de Servi\u00e7os","text":"<ul> <li>Instancia\u00e7\u00e3o dos servi\u00e7os necess\u00e1rios (CGSService, ParametroService, etc.)</li> <li>Busca da especifica\u00e7\u00e3o da FCI e seus campos</li> <li>Obten\u00e7\u00e3o da UF da empresa ativa</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#3-selecao-de-produtos-e-componentes","title":"3. Sele\u00e7\u00e3o de Produtos e Componentes","text":"<ul> <li>Busca de produtos com base no BOM informado</li> <li>Identifica\u00e7\u00e3o de componentes importados (CST 1, 2, 6, 7, 8)</li> <li>Carregamento do \u00faltimo c\u00e1lculo de FCI existente para cada produto</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#4-calculo-das-entradas-importacoes","title":"4. C\u00e1lculo das Entradas (Importa\u00e7\u00f5es)","text":"<ul> <li>Inicializa\u00e7\u00e3o de mapas para itens importados</li> <li>Sele\u00e7\u00e3o de entradas no per\u00edodo configurado</li> <li>C\u00e1lculo do Valor M\u00e9dio Unit\u00e1rio (VMU) por componente</li> <li>Controle de m\u00e9dias a partir da \u00faltima FCI quando habilitado</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#5-calculo-das-saidas-vendas","title":"5. C\u00e1lculo das Sa\u00eddas (Vendas)","text":"<ul> <li>Sele\u00e7\u00e3o de sa\u00eddas no per\u00edodo configurado</li> <li>Filtro por UF (interestaduais ou todas) conforme tipoSaida</li> <li>C\u00e1lculo do unit\u00e1rio m\u00e9dio de sa\u00edda</li> <li>Controle de m\u00e9dias a partir da \u00faltima FCI</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#6-calculo-do-ci-e-geracao-da-fci","title":"6. C\u00e1lculo do CI e Gera\u00e7\u00e3o da FCI","text":"<ul> <li>C\u00e1lculo do Conte\u00fado de Importa\u00e7\u00e3o: <code>CI = (Total VMU Importa\u00e7\u00f5es / Unit\u00e1rio Sa\u00eddas) * 100</code></li> <li>Valida\u00e7\u00e3o de consist\u00eancia (unit\u00e1rio importa\u00e7\u00e3o \u2264 unit\u00e1rio sa\u00edda)</li> <li>Cria\u00e7\u00e3o/atualiza\u00e7\u00e3o dos registros de FCI (Eab01, Eab0101, Eab01011)</li> <li>Composi\u00e7\u00e3o do JSON da especifica\u00e7\u00e3o</li> <li>Atualiza\u00e7\u00e3o autom\u00e1tica da origem da mercadoria no item (CST-A)</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#7-validacoes-finais","title":"7. Valida\u00e7\u00f5es Finais","text":"<ul> <li>Verifica\u00e7\u00e3o de inclus\u00e3o de pelo menos um c\u00e1lculo</li> <li>Tratamento de exce\u00e7\u00f5es e mensagens de erro</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#configuracoes-do-repositorio-srf2002-json","title":"Configura\u00e7\u00f5es do Reposit\u00f3rio (SRF2002 - JSON)","text":"<ul> <li>srf2002_tpsaida: Tipo de sa\u00edda (1=Interestaduais, 2=Todas)</li> <li>srf2002_entretro: Considerar entradas retroativas</li> <li>srf2002_entretroultmes: Considerar apenas \u00faltimo m\u00eas para entradas retroativas</li> <li>srf2002_consisaidaretro: Considerar sa\u00eddas retroativas</li> <li>srf2002_saidaultmes: Considerar apenas \u00faltimo m\u00eas para sa\u00eddas retroativas</li> <li>srf2002_mediaunitultfci: Considerar m\u00e9dias da \u00faltima FCI</li> <li>srf2002_cizero: Gerar FCI mesmo com CI zero</li> <li>srf2002_attorigmerc: Atualizar origem da mercadoria automaticamente</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#calculo-do-ci-e-origem-da-mercadoria","title":"C\u00e1lculo do CI e Origem da Mercadoria","text":"<ul> <li>CI \u2264 40%: Origem 5 (Nacional - Conte\u00fado de Importa\u00e7\u00e3o \u2264 40%)</li> <li>CI 40,01% a 70%: Origem 3 (Nacional - Conte\u00fado de Importa\u00e7\u00e3o 40-70%)</li> <li>CI &gt; 70%: Origem 8 (Nacional - Conte\u00fado de Importa\u00e7\u00e3o &gt; 70%)</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#criterios-para-componentes-importados","title":"Crit\u00e9rios para Componentes Importados","text":"<ul> <li>CSTs considerados: 1, 2, 6, 7, 8</li> <li>Filtro por empresa ativa</li> <li>Considera\u00e7\u00e3o apenas de itens na composi\u00e7\u00e3o (BOM)</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#filtros-de-documentos","title":"Filtros de Documentos","text":"<ul> <li>Entradas: Documentos fiscais de classe 1, movimento 0, com indica\u00e7\u00e3o FCI</li> <li>Sa\u00eddas: Documentos fiscais de classe 1, movimento 1, com indica\u00e7\u00e3o FCI</li> <li>Status: N\u00e3o cancelados, aprovados, n\u00e3o bloqueados, status ativo</li> <li>Retorno: Sem indica\u00e7\u00e3o de retorno (retInd = 0)</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de c\u00e1lculo da FCI.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#buscarrepositorio","title":"<code>buscarRepositorio()</code>","text":"<p>Carrega as configura\u00e7\u00f5es da tarefa SRF2002 do reposit\u00f3rio de dados (Aba20/Aba2001).</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#validaralinhamentostring-codigoalinhamento","title":"<code>validarAlinhamento(String codigoAlinhamento)</code>","text":"<p>Valida os campos de alinhamento obrigat\u00f3rios para o c\u00e1lculo: - FCICAMPOQTDIMP (quantidade importa\u00e7\u00e3o) - FCICAMPOQTDSAI (quantidade sa\u00edda)</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#obterufempresa","title":"<code>obterUFEmpresa()</code>","text":"<p>Obt\u00e9m a UF da empresa ativa a partir do munic\u00edpio cadastrado.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#buscarprodutoscombomcriterion-crititem-string-bom","title":"<code>buscarProdutosComBOM(Criterion critItem, String bom)</code>","text":"<p>Busca produtos com base no BOM informado e crit\u00e9rio de sele\u00e7\u00e3o.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#buscaridsitensimportadossetlong-abm01ids","title":"<code>buscarIdsItensImportados(Set&lt;Long&gt; abm01ids)</code>","text":"<p>Identifica componentes importados pelo CST entre os itens da composi\u00e7\u00e3o.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#buscarultimocalculolong-abm01id","title":"<code>buscarUltimoCalculo(Long abm01id)</code>","text":"<p>Busca o \u00faltimo c\u00e1lculo de FCI para o item principal.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#buscarultimovmulong-abm01idfci-long-abm01idimp-localdate-datacalc","title":"<code>buscarUltimoVMU(Long abm01idFci, Long abm01idImp, LocalDate dataCalc)</code>","text":"<p>Busca o \u00faltimo VMU calculado para um componente espec\u00edfico.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#selecionarentradas","title":"<code>selecionarEntradas(...)</code>","text":"<p>Seleciona e calcula entradas de componentes importados com suporte a retroativos.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#buscarsomaentradasfciporitemqtde","title":"<code>buscarSomaEntradasFCIPorItemQtde(...)</code>","text":"<p>Busca a soma de quantidades e valores de entradas para um componente.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#selecionarsaidas","title":"<code>selecionarSaidas(...)</code>","text":"<p>Seleciona e calcula sa\u00eddas do produto principal com suporte a retroativos.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#selecionardocumentosdesaidas","title":"<code>selecionarDocumentosDeSaidas(...)</code>","text":"<p>Seleciona documentos de sa\u00edda conforme tipo configurado.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#buscarsomasaidasfciporitemqtde","title":"<code>buscarSomaSaidasFCIPorItemQtde(...)</code>","text":"<p>Busca a soma de quantidades e valores de sa\u00eddas para o produto principal.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#setarorigemmercadorianoitembyci","title":"<code>setarOrigemMercadoriaNoItemByCI(...)</code>","text":"<p>Atualiza a origem da mercadoria (CST-A) com base no CI calculado.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#buscarncmdoitemlong-abm01id","title":"<code>buscarNCMDoItem(Long abm01id)</code>","text":"<p>Busca o c\u00f3digo NCM do item.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#buscarumvdoitemlong-abm01id","title":"<code>buscarUMVDoItem(Long abm01id)</code>","text":"<p>Busca a unidade de medida de venda do item.</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Registros Criados/Atualizados: - <code>Eab01</code> - Cadastro da FCI do item - <code>Eab0101</code> - C\u00e1lculo da FCI com os campos:   - <code>eab0101unitImp</code> - Unit\u00e1rio total das importa\u00e7\u00f5es   - <code>eab0101unitSai</code> - Unit\u00e1rio m\u00e9dio das sa\u00eddas   - <code>eab0101ci</code> - Conte\u00fado de Importa\u00e7\u00e3o calculado   - <code>eab0101qtdSai</code> - Quantidade total de sa\u00eddas   - <code>eab0101vlrSai</code> - Valor total de sa\u00eddas   - <code>eab0101status</code> - Status da FCI (A_ENVIAR)   - <code>eab0101json</code> - JSON com campos da especifica\u00e7\u00e3o - <code>Eab01011</code> - Itens importados do c\u00e1lculo (VMU, quantidades, valores)</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios de data, valida\u00e7\u00e3o e cole\u00e7\u00f5es - <code>sam.dicdados</code> - Tipos de f\u00f3rmula e par\u00e2metros - <code>sam.dto.cgs</code> - DTOs do m\u00f3dulo CGS - <code>sam.model</code> - Entidades do sistema - <code>java.time</code> - Manipula\u00e7\u00e3o de datas</p> <p>Servi\u00e7os: - <code>CGSService</code> - Servi\u00e7o do m\u00f3dulo CGS (para composi\u00e7\u00f5es) - <code>ParametroService</code> - Servi\u00e7o de par\u00e2metros do sistema - <code>EspecificacaoService</code> - Servi\u00e7o de especifica\u00e7\u00f5es de campos - <code>CASService</code> - Servi\u00e7o de composi\u00e7\u00e3o de JSON</p> <p>M\u00f3dulo: Equilibrio</p>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#campos-de-alinhamento","title":"Campos de Alinhamento","text":"<ul> <li>FCICAMPOVLRIMP - Campo para valor de importa\u00e7\u00e3o (opcional)</li> <li>FCICAMPOQTDIMP - Campo para quantidade de importa\u00e7\u00e3o (obrigat\u00f3rio)</li> <li>FCICAMPOVLRSAI - Campo para valor de sa\u00edda (opcional)</li> <li>FCICAMPOQTDSAI - Campo para quantidade de sa\u00edda (obrigat\u00f3rio)</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#calculo-de-unitarios","title":"C\u00e1lculo de Unit\u00e1rios","text":"<ul> <li>Arredondamento para 6 casas decimais em quantidades e VMUs</li> <li>Arredondamento para 2 casas decimais em valores monet\u00e1rios</li> <li>Controle de divis\u00e3o por zero em c\u00e1lculos de unit\u00e1rios</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#suporte-a-retroativos","title":"Suporte a Retroativos","text":"<ul> <li>Busca inteligente do \u00faltimo m\u00eas com movimenta\u00e7\u00e3o</li> <li>Suporte a per\u00edodos desde sempre quando n\u00e3o h\u00e1 movimenta\u00e7\u00e3o recente</li> <li>Considera\u00e7\u00e3o de c\u00e1lculos anteriores da FCI como refer\u00eancia</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#validacoes-de-negocio","title":"Valida\u00e7\u00f5es de Neg\u00f3cio","text":"<ul> <li>Verifica\u00e7\u00e3o de consist\u00eancia: unit\u00e1rio importa\u00e7\u00e3o \u2264 unit\u00e1rio sa\u00edda</li> <li>Valida\u00e7\u00e3o de produtos selecionados a partir do BOM</li> <li>Verifica\u00e7\u00e3o de inclus\u00e3o de pelo menos um c\u00e1lculo</li> <li>Tratamento de casos sem componentes importados</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_CalculoFCI/#sql-personalizado-para-saidas","title":"SQL Personalizado para Sa\u00eddas","text":"<ul> <li>C\u00e1lculo de unit\u00e1rio de sa\u00edda: <code>(total - ICMS) / quantidade</code></li> <li>Filtro por UF para documentos interestaduais</li> <li>Considera\u00e7\u00e3o apenas de documentos principais (principal = 1)</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 01/12/2025 \u00e0s 17:50 Autor: Bruno Tipo: F\u00f3rmula de C\u00e1lculo de FCI Vers\u00e3o: 2.0 Observa\u00e7\u00e3o: O funcionamento dessa f\u00f3rmula depende 100% do script na tarefa SRF2002 e do reposit\u00f3rio de dados. Ver documenta\u00e7\u00e3o no Trello.</p>"},{"location":"ELTECH/formulas/srf/SRF_Documento/","title":"SRF - Documento","text":""},{"location":"ELTECH/formulas/srf/SRF_Documento/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para processamento e composi\u00e7\u00e3o de documentos fiscais, aplicando regras de tributa\u00e7\u00e3o, observa\u00e7\u00f5es fiscais, c\u00e1lculo de comiss\u00f5es, valida\u00e7\u00f5es de itens e tratamento de documentos referenciados.</p>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Processar documentos fiscais (notas fiscais) aplicando regras de neg\u00f3cio espec\u00edficas, como valida\u00e7\u00e3o de itens, c\u00e1lculo de taxas de comiss\u00e3o, composi\u00e7\u00e3o de observa\u00e7\u00f5es e tratamento de documentos referenciados.</p>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Faturamento</li> <li>Tesouraria</li> <li>Contabilidade</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Abe01</code> - Entidades (clientes/fornecedores) - <code>Abe02</code> - Dados comerciais da entidade - <code>Abe03</code> - Dados fiscais da entidade - <code>Abe05</code> - Representantes - <code>Abe40</code> - Tabelas de pre\u00e7o - <code>Abb01</code> - Documentos centrais - <code>Abb10</code> - Opera\u00e7\u00f5es comerciais - <code>Abd01</code> - Par\u00e2metros de c\u00e1lculo de documentos (PCD) - <code>Abd02</code> - Campos fiscais do PCD - <code>Abd05</code> - Campos industriais do PCD - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0101</code> - Endere\u00e7os do documento - <code>Eaa0103</code> - Itens do documento fiscal - <code>Eaa01033</code> - Itens de devolu\u00e7\u00e3o referenciados - <code>Abm01</code> - Produtos - <code>Abm0101</code> - Configura\u00e7\u00f5es do produto por empresa - <code>Abm10</code> - Valores do produto - <code>Abm1001</code> - Valores do produto por UF - <code>Aac10</code> - Empresas - <code>Aac13</code> - Dados fiscais da empresa - <code>Aag02</code> - Estados (UF) - <code>Aag0201</code> - Munic\u00edpios - <code>Aaj10</code> - C\u00f3digos de situa\u00e7\u00e3o tribut\u00e1ria (CST)</p>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01 Eaa01 Sim Documento fiscal a ser processado procInvoc String Sim Processo de invoca\u00e7\u00e3o da f\u00f3rmula"},{"location":"ELTECH/formulas/srf/SRF_Documento/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"ELTECH/formulas/srf/SRF_Documento/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o do documento fiscal (Eaa01)</li> <li>Carregamento da opera\u00e7\u00e3o comercial (Abb10)</li> <li>Obten\u00e7\u00e3o do PCD (Abd01)</li> <li>Carregamento da entidade (Abe01) e dados fiscais</li> <li>Carregamento da empresa (Aac10) e dados fiscais</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#2-processamento-por-item","title":"2. Processamento por Item","text":"<ul> <li>Valida\u00e7\u00e3o de itens sem c\u00f3digo de produto</li> <li>Carregamento de configura\u00e7\u00f5es do produto (Abm0101)</li> <li>Obten\u00e7\u00e3o de valores do produto por UF (Abm1001)</li> <li>Aplica\u00e7\u00e3o de observa\u00e7\u00f5es fiscais espec\u00edficas por item</li> <li>Tratamento de CST ICMS com redu\u00e7\u00e3o de base de c\u00e1lculo</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#3-calculo-de-taxas-de-comissao","title":"3. C\u00e1lculo de Taxas de Comiss\u00e3o","text":"<ul> <li>Obten\u00e7\u00e3o de taxas fixadas na entidade (Abe02)</li> <li>Obten\u00e7\u00e3o de taxas fixadas na tabela de pre\u00e7o (Abe40)</li> <li>Obten\u00e7\u00e3o de taxas de representantes (Abe05)</li> <li>Defini\u00e7\u00e3o final das taxas no documento</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#4-composicao-de-observacoes","title":"4. Composi\u00e7\u00e3o de Observa\u00e7\u00f5es","text":"<ul> <li>Composi\u00e7\u00e3o de observa\u00e7\u00f5es de uso interno</li> <li>Composi\u00e7\u00e3o de observa\u00e7\u00f5es fiscais</li> <li>Composi\u00e7\u00e3o de observa\u00e7\u00f5es ao contribuinte</li> <li>Composi\u00e7\u00e3o de observa\u00e7\u00f5es de reten\u00e7\u00e3o/indeniza\u00e7\u00e3o</li> <li>Composi\u00e7\u00e3o de observa\u00e7\u00f5es gerais</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#5-processamento-final","title":"5. Processamento Final","text":"<ul> <li>C\u00e1lculo de fidelidade (para PCD espec\u00edfico)</li> <li>C\u00e1lculo de cr\u00e9dito/cashback (para PCD espec\u00edfico)</li> <li>Composi\u00e7\u00e3o de observa\u00e7\u00f5es com documentos referenciados</li> <li>Atualiza\u00e7\u00e3o do documento fiscal</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/formulas/srf/SRF_Documento/#validacao-de-itens","title":"Valida\u00e7\u00e3o de Itens","text":"<ul> <li>Todos os itens devem ter c\u00f3digo de produto preenchido</li> <li>Configura\u00e7\u00f5es do produto s\u00e3o carregadas por empresa</li> <li>Valores do produto s\u00e3o aplicados conforme UF do endere\u00e7o principal</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#observacoes-fiscais","title":"Observa\u00e7\u00f5es Fiscais","text":"<ul> <li>Observa\u00e7\u00f5es do fisco podem ser definidas por produto/UF</li> <li>Tratamento especial para CST ICMS 20 (redu\u00e7\u00e3o de base de c\u00e1lculo)</li> <li>Regime especial Simples Nacional com aproveitamento de ICMS</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#taxas-de-comissao","title":"Taxas de Comiss\u00e3o","text":"<ul> <li>Hierarquia de fontes: Entidade \u2192 Tabela de Pre\u00e7o \u2192 Representante</li> <li>Taxas podem ser fixadas em m\u00faltiplos n\u00edveis</li> <li>Valores zerados s\u00e3o substitu\u00eddos pelas fontes dispon\u00edveis</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#documentos-referenciados","title":"Documentos Referenciados","text":"<ul> <li>Identifica\u00e7\u00e3o de itens devolvidos referenciados</li> <li>Composi\u00e7\u00e3o autom\u00e1tica de observa\u00e7\u00e3o com dados dos documentos</li> <li>Inclus\u00e3o de n\u00famero, data e chave de acesso da NFe</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"ELTECH/formulas/srf/SRF_Documento/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processamento do documento.</p>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#setarobtertaxascomissaodocumento","title":"<code>setarObterTaxasComissaoDocumento()</code>","text":"<p>Calcula e define as taxas de comiss\u00e3o do documento seguindo a hierarquia estabelecida.</p>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#obtertaxadorepresentanteabe01-abe01rep","title":"<code>obterTaxaDoRepresentante(Abe01 abe01rep)</code>","text":"<p>Obt\u00e9m a taxa de comiss\u00e3o de um representante espec\u00edfico.</p>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#comporobservacoesdocumento","title":"<code>comporObservacoesDocumento()</code>","text":"<p>Composi\u00e7\u00e3o das observa\u00e7\u00f5es do documento a partir das configura\u00e7\u00f5es da entidade e do PCD.</p>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#comporobscontribuintecomchavenfedocumentosreferenciados","title":"<code>comporObsContribuinteComChaveNFeDocumentosReferenciados()</code>","text":"<p>Adiciona \u00e0 observa\u00e7\u00e3o do contribuinte informa\u00e7\u00f5es sobre documentos referenciados.</p>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#estrutura-de-processamento","title":"\ud83d\udcca Estrutura de Processamento","text":"<p>Entradas: - Documento fiscal (Eaa01) com todos os relacionamentos - Processo de invoca\u00e7\u00e3o para contexto de execu\u00e7\u00e3o</p> <p>Processamentos: - Valida\u00e7\u00f5es de consist\u00eancia - C\u00e1lculos financeiros e fiscais - Composi\u00e7\u00e3o de textos e observa\u00e7\u00f5es</p> <p>Sa\u00eddas: - Documento fiscal atualizado com:   - Observa\u00e7\u00f5es preenchidas   - Taxas de comiss\u00e3o definidas   - Campos JSON calculados   - Valida\u00e7\u00f5es aplicadas</p>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios e exce\u00e7\u00f5es - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.model</code> - Entidades do sistema - <code>java.time</code> - Manipula\u00e7\u00e3o de datas e formata\u00e7\u00e3o - <code>java.util</code> - Cole\u00e7\u00f5es e utilit\u00e1rios</p> <p>M\u00f3dulo: SRF (Sistema de Faturamento)</p>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"ELTECH/formulas/srf/SRF_Documento/#tratamento-de-json","title":"Tratamento de JSON","text":"<ul> <li>Campos livres (JSON) s\u00e3o utilizados para dados flex\u00edveis</li> <li>Estruturas JSON s\u00e3o manipuladas via TableMap</li> <li>Dados espec\u00edficos podem ser armazenados e recuperados dinamicamente</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#consultas-ao-banco","title":"Consultas ao Banco","text":"<ul> <li>Uso de Criteria para consultas din\u00e2micas</li> <li>Consultas SQL com par\u00e2metros nomeados</li> <li>Aplica\u00e7\u00e3o autom\u00e1tica de filtros de seguran\u00e7a (getSamWhere)</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#hierarquia-de-configuracoes","title":"Hierarquia de Configura\u00e7\u00f5es","text":"<ul> <li>Configura\u00e7\u00f5es s\u00e3o herdadas em n\u00edveis: Empresa \u2192 Entidade \u2192 Documento</li> <li>Valores mais espec\u00edficos sobrep\u00f5em os mais gen\u00e9ricos</li> <li>Fallback autom\u00e1tico para valores padr\u00e3o</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_Documento/#validacoes-de-negocio","title":"Valida\u00e7\u00f5es de Neg\u00f3cio","text":"<ul> <li>Interrup\u00e7\u00e3o por exce\u00e7\u00e3o em caso de erros cr\u00edticos</li> <li>Valida\u00e7\u00f5es preventivas em itens e configura\u00e7\u00f5es</li> <li>Mensagens de erro claras para o usu\u00e1rio final</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 02/12/2025 \u00e0s 10:00 Autor: Bruno Tipo: F\u00f3rmula de Documento Fiscal Vers\u00e3o: 1.0</p>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/","title":"SRF_ImportarXMLNFeEntrada.md","text":""},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de importa\u00e7\u00e3o de XML de Nota Fiscal Eletr\u00f4nica (NF-e) para documentos de entrada, respons\u00e1vel por extrair e processar todos os dados fiscais, tribut\u00e1rios e comerciais do arquivo XML.</p>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar o processo de importa\u00e7\u00e3o de dados fiscais de NF-e de entrada, garantindo a correta extra\u00e7\u00e3o e mapeamento de informa\u00e7\u00f5es tribut\u00e1rias, valores, produtos e dados complementares para o sistema.</p>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Compras</li> <li>Almoxarifado/Estoque</li> <li>Contabilidade</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - F\u00f3rmula <code>SRF_ImportarXMLNFeEntrada</code> - Processamento de XML NF-e entrada</p> <p>Localiza\u00e7\u00e3o: <code>eltech/formulas/srf/</code></p>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos fiscais - <code>EAA0103</code> - Itens do documento - <code>EAA01038</code> - Controle de lotes/s\u00e9ries - <code>EAA0113</code> - Duplicatas - <code>EAA01033</code> - Itens referenciados</p> <p>Entidades Envolvidas: - <code>Eaa01</code> - Documento fiscal - <code>Eaa0103</code> - Item do documento - <code>ElementXml</code> - Parser de XML</p>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01 Eaa01 Sim Documento fiscal a ser processado elementXmlNfe ElementXml Sim Estrutura XML da NF-e a ser importada"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o Inicial</li> <li>Verifica estrutura do XML (nfeProc &gt; NFe &gt; infNFe)</li> <li> <p>Valida n\u00f3 principal do documento fiscal</p> </li> <li> <p>Processamento de Itens</p> </li> <li>Percorre todos os itens (det) do XML</li> <li>Busca item correspondente no documento por n\u00famero de sequ\u00eancia</li> <li> <p>Processa dados b\u00e1sicos do produto (NCM, unidade tribut\u00e1ria)</p> </li> <li> <p>Extra\u00e7\u00e3o de Dados Tribut\u00e1rios</p> </li> <li>ICMS: Todos os grupos (00, 10, 20, 30, 40, 51, 60, 70, 90, Part, ST, SN)</li> <li>IPI: Dados de impostos sobre produtos industrializados</li> <li>PIS/COFINS: Tributos federais normal e ST</li> <li>II: Imposto de importa\u00e7\u00e3o</li> <li> <p>ISSQN: Imposto sobre servi\u00e7os</p> </li> <li> <p>Controle de Lotes e S\u00e9ries</p> </li> <li>Processa informa\u00e7\u00f5es de rastreamento (rastro)</li> <li>Aplica fatores de convers\u00e3o de unidades</li> <li> <p>Define status e controles conforme configura\u00e7\u00e3o do PCD</p> </li> <li> <p>Dados Complementares</p> </li> <li>Totais da NF-e (valores, impostos consolidados)</li> <li>Informa\u00e7\u00f5es de transporte (volumes, pesos)</li> <li>Observa\u00e7\u00f5es fiscais e complementares</li> <li>Duplicatas (quando aplic\u00e1vel)</li> </ol>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#validacoes-de-estrutura","title":"Valida\u00e7\u00f5es de Estrutura","text":"<ul> <li>XML deve conter estrutura nfeProc &gt; NFe &gt; infNFe</li> <li>Itens devem corresponder sequencialmente aos itens do documento</li> <li>Campos num\u00e9ricos s\u00e3o convertidos com casas decimais espec\u00edficas</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#processamento-de-tributos","title":"Processamento de Tributos","text":"<ul> <li>ICMS: Suporte a todos os CSTs (00, 10, 20, 30, 40, 51, 60, 70, 90)</li> <li>IPI: Tratamento para c\u00e1lculos por al\u00edquota e por unidade</li> <li>PIS/COFINS: Diferencia\u00e7\u00e3o entre regime cumulativo e n\u00e3o-cumulativo</li> <li>Substitui\u00e7\u00e3o Tribut\u00e1ria: C\u00e1lculos de MVA, redu\u00e7\u00f5es e bases</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#controle-de-estoques","title":"Controle de Estoques","text":"<ul> <li>Aplica\u00e7\u00e3o autom\u00e1tica de fatores de convers\u00e3o</li> <li>Defini\u00e7\u00e3o de status conforme configura\u00e7\u00e3o do PCD</li> <li>Controles espec\u00edficos para opera\u00e7\u00f5es com estoque</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#referencias-e-relacionamentos","title":"Refer\u00eancias e Relacionamentos","text":"<ul> <li>Vincula\u00e7\u00e3o autom\u00e1tica de NF-e referenciadas</li> <li>Processamento de duplicatas para documentos financeiros</li> <li>Mapeamento de observa\u00e7\u00f5es fiscais e complementares</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#saidas-geradas","title":"\ud83c\udfa8 Sa\u00eddas Geradas","text":"Sa\u00edda Descri\u00e7\u00e3o Tipo eaa01 Documento fiscal com dados importados Eaa01"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Persist\u00eancia e consultas - <code>br.com.multitec.utils.xml</code> - Processamento de XML - <code>sam.model.entities</code> - Entidades do sistema</p> <p>Estruturas de Dados: - <code>ElementXml</code> - Parser e navega\u00e7\u00e3o de XML - <code>TableMap</code> - Armazenamento de dados JSON</p>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Processamento: S\u00edncrono, execu\u00e7\u00e3o completa do XML</li> <li>Performance: Processamento otimizado por lotes de itens</li> <li>Flexibilidade: Suporte a m\u00faltiplos regimes tribut\u00e1rios</li> <li>Precis\u00e3o: Arredondamentos espec\u00edficos por tipo de campo</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#mapeamento-de-campos-xml","title":"Mapeamento de Campos XML","text":"<ul> <li>Produtos: NCM, unidades, quantidades, valores</li> <li>Tributos: Bases de c\u00e1lculo, al\u00edquotas, valores</li> <li>Transporte: Volumes, pesos l\u00edquido e bruto</li> <li>Complementares: Observa\u00e7\u00f5es, protocolos, chaves de acesso</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#tratamento-de-dados","title":"Tratamento de Dados","text":"<ul> <li>Convers\u00e3o autom\u00e1tica de datas e valores</li> <li>Aplica\u00e7\u00e3o de fatores de convers\u00e3o de unidades</li> <li>Valida\u00e7\u00e3o de consist\u00eancia de dados</li> <li>Preserva\u00e7\u00e3o de dados originais do XML</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_EnviarEmailsNFe/#integracao-com-sistema","title":"Integra\u00e7\u00e3o com Sistema","text":"<ul> <li>Atualiza\u00e7\u00e3o em tempo real do documento fiscal</li> <li>Manuten\u00e7\u00e3o de relacionamentos entre entidades</li> <li>Suporte a opera\u00e7\u00f5es de entrada com estoque</li> <li>Compatibilidade com diferentes tipos de PCD</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/","title":"SRF - Gerar XML de NFe (Fiscal)","text":""},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para gera\u00e7\u00e3o do arquivo XML da Nota Fiscal Eletr\u00f4nica (NFe) conforme layout 4.00, incluindo dados do emitente, destinat\u00e1rio, produtos, impostos, transportes, pagamentos e informa\u00e7\u00f5es complementares.</p>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar automaticamente o XML da NFe a partir dos dados do documento fiscal, aplicando valida\u00e7\u00f5es, formata\u00e7\u00f5es e regras fiscais conforme a legisla\u00e7\u00e3o vigente.</p>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Faturamento</li> <li>Contabilidade</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0101</code> - Endere\u00e7os do documento - <code>Eaa0102</code> - Dados gerais do documento - <code>Eaa0103</code> - Itens do documento - <code>Eaa01033</code> - Itens vinculados (devolu\u00e7\u00e3o) - <code>Eaa01034</code> - Declara\u00e7\u00e3o de importa\u00e7\u00e3o - <code>Eaa010341</code> - Adi\u00e7\u00f5es da DI - <code>Eaa01038</code> - Rastreabilidade - <code>Eaa0104</code> - Declara\u00e7\u00e3o de exporta\u00e7\u00e3o - <code>Eaa0113</code> - Financeiro do documento - <code>Eaa01131</code> - Formas de pagamento - <code>Aac10</code> - Empresa emitente - <code>Aac1002</code> - Inscri\u00e7\u00f5es estaduais da empresa - <code>Abe01</code> - Entidades (clientes/fornecedores) - <code>Abe0101</code> - Endere\u00e7os das entidades - <code>Abb01</code> - Central de documentos - <code>Abm01</code> - Itens cadastrais - <code>Abm0101</code> - Configura\u00e7\u00e3o de itens por empresa - <code>Abg01</code> - NCM - <code>Abg0101</code> - NVE - <code>Aaj03</code> - Situa\u00e7\u00e3o do documento - <code>Aaj04</code> - C\u00f3digo ANP - <code>Aaj10</code> - CST ICMS - <code>Aaj11</code> - CST IPI - <code>Aaj12</code> - CST PIS - <code>Aaj13</code> - CST COFINS - <code>Aaj14</code> - CSOSN - <code>Aaj15</code> - CFOP - <code>Aam06</code> - Unidades de medida - <code>Aah20</code> - Ve\u00edculos/transportes - <code>Aag01</code> - Pa\u00edses - <code>Aag02</code> - Estados/UF</p>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01 Eaa01 Sim Documento fiscal a ser processado formaEmis Integer N\u00e3o Forma de emiss\u00e3o (1=Normal, 2=Conting\u00eancia) contDt LocalDate N\u00e3o Data da conting\u00eancia contHr LocalTime N\u00e3o Hora da conting\u00eancia contJust String N\u00e3o Justificativa da conting\u00eancia"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o dos par\u00e2metros obrigat\u00f3rios</li> <li>Carregamento da empresa emitente</li> <li>Sele\u00e7\u00e3o do alinhamento fiscal (Simples Nacional ou Outros)</li> <li>Composi\u00e7\u00e3o dos dados do documento (central, dados gerais, endere\u00e7os)</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#2-validacoes-de-dados","title":"2. Valida\u00e7\u00f5es de Dados","text":"<ul> <li>Valida\u00e7\u00e3o de dados obrigat\u00f3rios do emitente</li> <li>Valida\u00e7\u00e3o de dados do documento fiscal</li> <li>Valida\u00e7\u00e3o de itens, impostos e formas de pagamento</li> <li>Valida\u00e7\u00e3o de documentos referenciados e transportes</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#3-geracao-da-estrutura-xml","title":"3. Gera\u00e7\u00e3o da Estrutura XML","text":"<ul> <li>Cria\u00e7\u00e3o do elemento raiz <code>NFe</code></li> <li>Defini\u00e7\u00e3o das informa\u00e7\u00f5es b\u00e1sicas (<code>infNFe</code>)</li> <li>Montagem da identifica\u00e7\u00e3o (<code>ide</code>)</li> <li>Inclus\u00e3o de documentos referenciados (<code>NFref</code>)</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#4-montagem-das-secoes-da-nfe","title":"4. Montagem das Se\u00e7\u00f5es da NFe","text":"<ul> <li>Emitente (<code>emit</code>)</li> <li>Destinat\u00e1rio (<code>dest</code>)</li> <li>Itens (<code>det</code>) com produtos, impostos e informa\u00e7\u00f5es espec\u00edficas</li> <li>Totais (<code>total</code>) com valores de ICMS, ISS, reten\u00e7\u00f5es</li> <li>Transporte (<code>transp</code>) com ve\u00edculos e volumes</li> <li>Cobran\u00e7a (<code>cobr</code>) com faturas e duplicatas</li> <li>Pagamento (<code>pag</code>) com formas de pagamento</li> <li>Informa\u00e7\u00f5es adicionais (<code>infAdic</code>)</li> <li>Exporta\u00e7\u00e3o (<code>exporta</code>)</li> <li>Respons\u00e1vel t\u00e9cnico (<code>infRespTec</code>)</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#5-finalizacao","title":"5. Finaliza\u00e7\u00e3o","text":"<ul> <li>Gera\u00e7\u00e3o do XML final</li> <li>Retorno da chave de acesso e dados do XML</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#validacoes-obrigatorias","title":"Valida\u00e7\u00f5es Obrigat\u00f3rias","text":"<ul> <li>Empresa emitente deve ter munic\u00edpio, IE, endere\u00e7o e CNPJ/CPF v\u00e1lidos</li> <li>Documento deve ter tipo, modelo, situa\u00e7\u00e3o e dados gerais</li> <li>Itens devem ter unidade de medida, descri\u00e7\u00e3o, CFOP e CST/CSOSN conforme classifica\u00e7\u00e3o tribut\u00e1ria</li> <li>Para Simples Nacional: CSOSN obrigat\u00f3rio</li> <li>Para outras classifica\u00e7\u00f5es: CST ICMS obrigat\u00f3rio (exceto para itens com ISS)</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#regras-fiscais","title":"Regras Fiscais","text":"<ul> <li>Identifica\u00e7\u00e3o do destino (1=Interna, 2=Interestadual, 3=Exterior)</li> <li>Tratamento diferenciado para opera\u00e7\u00f5es com e sem ISS</li> <li>C\u00e1lculo de impostos (ICMS, IPI, PIS, COFINS, ISS) conforme CST/CSOSN</li> <li>Informa\u00e7\u00f5es de ST, FCP e reten\u00e7\u00f5es conforme configura\u00e7\u00e3o</li> <li>Tratamento especial para combust\u00edveis (ANP, CIDE)</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#formatacao-e-estrutura","title":"Formata\u00e7\u00e3o e Estrutura","text":"<ul> <li>Formata\u00e7\u00e3o de valores monet\u00e1rios com 2 decimais</li> <li>Formata\u00e7\u00e3o de quantidades com 4 decimais</li> <li>Ajuste de caracteres especiais no XML</li> <li>Gera\u00e7\u00e3o de chave de acesso com d\u00edgito verificador</li> <li>Vers\u00e3o do layout: 4.00</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de gera\u00e7\u00e3o do XML.</p>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#validardadosdanfe","title":"<code>validarDadosDaNFe()</code>","text":"<p>Realiza valida\u00e7\u00f5es abrangentes dos dados necess\u00e1rios para a gera\u00e7\u00e3o da NFe.</p>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#comporfilhosdocumento","title":"<code>comporFilhosDocumento()</code>","text":"<p>Carrega e associa os dados relacionados ao documento (central, dados gerais, endere\u00e7os).</p>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#emitente","title":"<code>emitente()</code>","text":"<p>Monta a se\u00e7\u00e3o do emitente com dados da empresa.</p>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#destinatario","title":"<code>destinatario()</code>","text":"<p>Monta a se\u00e7\u00e3o do destinat\u00e1rio com dados da entidade.</p>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#item","title":"<code>item()</code>","text":"<p>Processa todos os itens do documento, incluindo produtos, impostos e informa\u00e7\u00f5es espec\u00edficas.</p>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#metodos-de-busca","title":"M\u00e9todos de Busca","text":"<ul> <li><code>buscarInscricaoEstadualPorEstado()</code>: Busca IE da empresa por UF</li> <li><code>buscarDocumentosReferenciados()</code>: Busca notas referenciadas</li> <li><code>buscarItensDoDocumento()</code>: Busca itens do documento</li> <li><code>buscarNVEsPorNCM()</code>: Busca NVE relacionados ao NCM</li> <li><code>buscarDeclaracaoDeImportacaoPorItem()</code>: Busca DI dos itens</li> <li><code>buscarAdicoesPorDI()</code>: Busca adi\u00e7\u00f5es da DI</li> <li><code>buscarDeclaracoesDeExportacao()</code>: Busca declara\u00e7\u00f5es de exporta\u00e7\u00e3o</li> <li><code>buscarRastreabilidadeDoItem()</code>: Busca dados de rastreabilidade</li> <li><code>buscarLancamentosDoItem()</code>: Busca lan\u00e7amentos de estoque</li> <li><code>buscarFinanceiroPorDocumento()</code>: Busca parcelas financeiras</li> <li><code>buscarFormasDePagamentoPorDocumento()</code>: Busca formas de pagamento</li> <li><code>buscarFormasPgtp()</code>: Busca formas de pagamento alternativas</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>XML da NFe: String formatada conforme layout 4.00</p> <p>Par\u00e2metros de Retorno: - <code>chaveNfe</code>: Chave de acesso da NFe (44 d\u00edgitos) - <code>dados</code>: XML completo da NFe</p>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios (DateUtils, StringUtils, ValidacaoException) - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.model</code> - Entidades do sistema - <code>sam.server.samdev.utils</code> - Utilit\u00e1rios do SAM (NFeUtils, Parametro) - <code>java.time</code> - Manipula\u00e7\u00e3o de datas - <code>java.math</code> - C\u00e1lculos com BigDecimal</p> <p>M\u00f3dulo: Fiscal</p>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#versao-do-layout","title":"Vers\u00e3o do Layout","text":"<ul> <li>Layout 4.00 da NFe</li> <li>Suporte a NFC-e (modelo 65) e NFe normal (modelo 55)</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#ambiente","title":"Ambiente","text":"<ul> <li>Produ\u00e7\u00e3o: <code>tpAmb = 1</code></li> <li>Homologa\u00e7\u00e3o: <code>tpAmb = 2</code></li> <li>CNPJ de homologa\u00e7\u00e3o: 99999999000191</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#contingencia","title":"Conting\u00eancia","text":"<ul> <li>Forma de emiss\u00e3o normal: <code>tpEmis = 1</code></li> <li>Conting\u00eancia: <code>tpEmis = 2</code> com data/hora e justificativa</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#tratamento-de-dados","title":"Tratamento de Dados","text":"<ul> <li>Formata\u00e7\u00e3o de IE (remo\u00e7\u00e3o de caracteres n\u00e3o num\u00e9ricos)</li> <li>Ajuste de fone (DDD + n\u00famero)</li> <li>Substitui\u00e7\u00e3o de caracteres especiais no XML (&amp;, &lt;, &gt;, \", ')</li> <li>Formata\u00e7\u00e3o de datas no padr\u00e3o UTC</li> </ul>"},{"location":"ELTECH/formulas/srf/SRF_GerarXMLNfe/#campos-livres-json","title":"Campos Livres (JSON)","text":"<p>Os dados fiscais detalhados s\u00e3o armazenados em campos livres (JSON) nas tabelas: - <code>eaa01json</code> para totais do documento - <code>eaa0103json</code> para valores por item</p> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 16:28 Autor: NAGYLA Tipo: F\u00f3rmula de Gera\u00e7\u00e3o de Arquivos de NFe Vers\u00e3o: 1.0</p>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/","title":"SAP - Ficha Patrimonial (Eltech)","text":""},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio para gera\u00e7\u00e3o da ficha patrimonial de bens, contendo dados de imobilizado, deprecia\u00e7\u00e3o e reclassifica\u00e7\u00f5es, com agrupamento por c\u00f3digo de bem.</p>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar um documento PDF estruturado com informa\u00e7\u00f5es patrimoniais, organizadas por grupo de bens, para an\u00e1lise e controle cont\u00e1bil.</p>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Cont\u00e1bil</li> <li>Patrim\u00f4nio</li> <li>Auditoria Interna</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>abb20</code> - Cadastro de bens - <code>ecb01</code> - Dados de imobilizado - <code>abb01</code> - Centros de custo - <code>abe01</code> - Entidades (respons\u00e1veis) - <code>aah01</code> - Tipos de centro de custo - <code>ecb0102</code> - Deprecia\u00e7\u00f5es acumuladas - <code>ecb0101</code> - Reclassifica\u00e7\u00f5es - <code>eca01</code> - Classifica\u00e7\u00f5es cont\u00e1beis - <code>abb11</code> - Departamentos</p>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o clas List N\u00e3o IDs das classifica\u00e7\u00f5es de bens para filtro bens List N\u00e3o IDs dos bens para filtro"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o e captura dos par\u00e2metros de entrada</li> <li>Carregamento dos dados principais da ficha patrimonial</li> <li>Defini\u00e7\u00e3o dos grupos de bens baseado no c\u00f3digo</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#2-agrupamento-de-dados","title":"2. Agrupamento de Dados","text":"<ul> <li>Identifica\u00e7\u00e3o de grupos baseados no c\u00f3digo do bem (termina\u00e7\u00e3o \"000\")</li> <li>Cria\u00e7\u00e3o de estruturas de dados para:</li> <li>Dados principais do bem</li> <li>Subdados de imobilizado</li> <li>Subdados de deprecia\u00e7\u00e3o</li> <li>Subdados de reclassifica\u00e7\u00e3o</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#3-busca-de-dados-complementares","title":"3. Busca de Dados Complementares","text":"<ul> <li>Consulta de dados de deprecia\u00e7\u00e3o por grupo de bens</li> <li>Consulta de dados de reclassifica\u00e7\u00e3o por grupo de bens</li> <li>Associa\u00e7\u00e3o dos dados complementares aos grupos correspondentes</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#4-montagem-da-estrutura-do-relatorio","title":"4. Montagem da Estrutura do Relat\u00f3rio","text":"<ul> <li>Configura\u00e7\u00e3o de DataSources principais e subsidi\u00e1rios</li> <li>Associa\u00e7\u00e3o de sub-relat\u00f3rios para cada se\u00e7\u00e3o</li> <li>Adi\u00e7\u00e3o de par\u00e2metros comuns (ex: nome da empresa)</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#5-geracao-do-pdf","title":"5. Gera\u00e7\u00e3o do PDF","text":"<ul> <li>Montagem final do documento</li> <li>Aplica\u00e7\u00e3o de templates e formata\u00e7\u00e3o</li> <li>Retorno do arquivo para download</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#agrupamento-de-bens","title":"Agrupamento de Bens","text":"<ul> <li>Grupo: Definido pelo c\u00f3digo do bem terminado em \"000\"</li> <li>Hierarquia: Bens com mesmo prefixo pertencem ao mesmo grupo</li> <li>Controle: Sequ\u00eancia num\u00e9rica autom\u00e1tica por ordem de c\u00f3digo</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#dados-de-imobilizado","title":"Dados de Imobilizado","text":"<ul> <li>Informa\u00e7\u00f5es b\u00e1sicas: C\u00f3digo, nome, descri\u00e7\u00e3o, chapa, data de aquisi\u00e7\u00e3o</li> <li>Valores: Valor de aquisi\u00e7\u00e3o, valor atual, valor de baixa</li> <li>Localiza\u00e7\u00e3o: Centro de custo, respons\u00e1vel, tipo</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#depreciacao","title":"Deprecia\u00e7\u00e3o","text":"<ul> <li>Agrupamento: Por ano e m\u00eas</li> <li>C\u00e1lculo: Soma dos valores depreciados por per\u00edodo</li> <li>Ordena\u00e7\u00e3o: Cronol\u00f3gica (ano \u2192 m\u00eas)</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#reclassificacao","title":"Reclassifica\u00e7\u00e3o","text":"<ul> <li>Per\u00edodo: M\u00eas e ano da reclassifica\u00e7\u00e3o</li> <li>Classifica\u00e7\u00e3o: C\u00f3digo e nome da nova classifica\u00e7\u00e3o cont\u00e1bil</li> <li>Departamento: Departamento associado</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de gera\u00e7\u00e3o do relat\u00f3rio.</p>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#buscardadosfichalistlong-clas-listlong-bens","title":"<code>buscarDadosFicha(List&lt;Long&gt; clas, List&lt;Long&gt; bens)</code>","text":"<p>Busca os dados principais da ficha patrimonial, aplicando filtros por classifica\u00e7\u00e3o e bens.</p>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#buscardadosdepreclistlong-idsbensimob","title":"<code>buscarDadosDeprec(List&lt;Long&gt; idsBensImob)</code>","text":"<p>Busca dados de deprecia\u00e7\u00e3o acumulada para os bens informados.</p>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#buscardadosreclassiflistlong-idsbensimob","title":"<code>buscarDadosReclassif(List&lt;Long&gt; idsBensImob)</code>","text":"<p>Busca dados de reclassifica\u00e7\u00e3o para os bens informados.</p>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#agruparporgrupointeger-grupo-long-ecb01id-mapinteger-listlong-grupomap","title":"<code>agruparPorGrupo(Integer grupo, Long ecb01id, Map&lt;Integer, List&lt;Long&gt;&gt; grupoMap)</code>","text":"<p>Agrupa IDs de bens por grupo para consultas complementares.</p>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Relat\u00f3rio Principal (PDF): - Se\u00e7\u00e3o 1: Dados principais do bem (c\u00f3digo, nome, valores, localiza\u00e7\u00e3o) - Se\u00e7\u00e3o 2: Hist\u00f3rico de deprecia\u00e7\u00e3o (tabela por per\u00edodo) - Se\u00e7\u00e3o 3: Hist\u00f3rico de reclassifica\u00e7\u00f5es (tabela por per\u00edodo)</p> <p>Estrutura de Dados: - <code>grupo</code>: Identificador num\u00e9rico do grupo - <code>key</code>: Chave de relacionamento entre se\u00e7\u00f5es - <code>abb20codigo</code>: C\u00f3digo do bem - <code>abb20nome</code>: Nome do bem - <code>ecb01vlraquis</code>: Valor de aquisi\u00e7\u00e3o - <code>ecb0102deprec</code>: Valor depreciado no per\u00edodo - <code>eca01nome</code>: Nome da classifica\u00e7\u00e3o cont\u00e1bil</p>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Acesso ao banco de dados - <code>sam.server.samdev.relatorio</code> - Framework de relat\u00f3rios - <code>sam.server.samdev.utils</code> - Utilit\u00e1rios do sistema - <code>sam.model</code> - Entidades do sistema</p> <p>M\u00f3dulo: Relat\u00f3rios SAP</p>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#tratamento-de-grupos","title":"Tratamento de Grupos","text":"<ul> <li>Uso de window function para identifica\u00e7\u00e3o de grupos</li> <li>Mapa de agrupamento para otimizar consultas complementares</li> <li>Chave \u00fanica (<code>key</code>) para relacionar se\u00e7\u00f5es do relat\u00f3rio</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#sub-relatorios","title":"Sub-relat\u00f3rios","text":"<ul> <li>Tr\u00eas sub-relat\u00f3rios independentes:</li> <li><code>SAP_FichaPatrimonial_S1</code>: Dados de imobilizado</li> <li><code>SAP_FichaPatrimonial_S2</code>: Dados de deprecia\u00e7\u00e3o</li> <li><code>SAP_FichaPatrimonial_S3</code>: Dados de reclassifica\u00e7\u00e3o</li> <li>Vincula\u00e7\u00e3o por chave comum (<code>key</code>)</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#performance","title":"Performance","text":"<ul> <li>Consultas otimizadas com filtros din\u00e2micos</li> <li>Agrupamento em mem\u00f3ria para reduzir chamadas ao banco</li> <li>Uso de TableMap para estrutura\u00e7\u00e3o flex\u00edvel dos dados</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_FichaPatrimonial/#formatacao","title":"Formata\u00e7\u00e3o","text":"<ul> <li>Convers\u00e3o de meses para formato \"00\" (TO_CHAR)</li> <li>Ordena\u00e7\u00e3o cronol\u00f3gica em todas as se\u00e7\u00f5es temporais</li> <li>Nome da empresa como par\u00e2metro global</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 09:20 Autor: Bruno Tipo: Relat\u00f3rio SAP Vers\u00e3o: 1.0</p>"},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/","title":"SAP Resumo Deprecia\u00e7\u00e3o por Departamento","text":""},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio que apresenta o resumo da deprecia\u00e7\u00e3o patrimonial agrupado por departamentos/classifica\u00e7\u00f5es patrimoniais da empresa El Tech.</p>"},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Controlar e analisar a deprecia\u00e7\u00e3o de ativos imobilizados por centro de custo/departamento, permitindo acompanhar: - Saldo anterior de deprecia\u00e7\u00e3o - Deprecia\u00e7\u00e3o do per\u00edodo atual - Baixas de ativos - Transfer\u00eancias entre departamentos - Saldo atual acumulado</p>"},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Financeiro</li> <li>Contabilidade</li> <li>Gestores Patrimoniais</li> <li>Controladoria</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>ABB11</code> - Departamentos/Centro de Custos - <code>ECB01</code> - Imobilizados - <code>ECB0101</code> - Reclassifica\u00e7\u00f5es de Imobilizados - <code>ECB0102</code> - Deprecia\u00e7\u00e3o Mensal - <code>ABB20</code> - Bens Patrimoniais - <code>ABA01</code> - Par\u00e2metros do Sistema</p> <p>Entidades Envolvidas: - <code>Abb11</code> - Departamento - <code>Ecb01</code> - Imobilizado - <code>Ecb0101</code> - Reclassifica\u00e7\u00e3o - <code>Ecb0102</code> - Deprecia\u00e7\u00e3o - <code>Aba01</code> - Par\u00e2metro</p>"},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis dtReferencia String Sim M\u00eas/Ano de refer\u00eancia Formato MM/yyyy imprimir Integer Sim Tipo de sa\u00edda 0=PDF, 1=XLSX"},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/#campos-do-relatorio","title":"\ud83d\udccb Campos do Relat\u00f3rio","text":"Campo Descri\u00e7\u00e3o Tipo F\u00f3rmula C\u00f3digo C\u00f3digo do departamento String - Nome Nome do departamento String - Saldo Anterior Saldo depreciado acumulado anterior BigDecimal <code>buscaSaldo(dataRef-1)</code> Deprecia\u00e7\u00e3o Deprecia\u00e7\u00e3o do m\u00eas atual BigDecimal <code>buscaDepreciacao(dataRef)</code> Baixas Baixas de ativos no per\u00edodo BigDecimal <code>buscaBaixas(dataRef)</code> Saldo Atual Saldo depreciado acumulado atual BigDecimal <code>buscaSaldo(dataRef)</code> Transfer\u00eancias Varia\u00e7\u00e3o por transfer\u00eancias BigDecimal <code>saldoAtual - saldoAnterior - deprec + baixas</code>"},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o de Estrutura</li> <li>Busca par\u00e2metro <code>ABB11-ESTRCODDEPTO</code> para estrutura de c\u00f3digos</li> <li> <p>Valida exist\u00eancia de pelo menos 2 grupos na estrutura</p> </li> <li> <p>Processamento de Reclassifica\u00e7\u00f5es</p> </li> <li>Identifica \u00faltima reclassifica\u00e7\u00e3o por imobilizado at\u00e9 a data de refer\u00eancia</li> <li> <p>Mapeia imobilizados por departamento considerando reclassifica\u00e7\u00f5es</p> </li> <li> <p>C\u00e1lculo de Valores</p> </li> <li>Busca departamentos ativos</li> <li>Calcula saldos anteriores e atuais</li> <li>Calcula deprecia\u00e7\u00e3o do per\u00edodo</li> <li>Identifica baixas de ativos</li> <li> <p>Calcula transfer\u00eancias entre departamentos</p> </li> <li> <p>Consolida\u00e7\u00e3o Hier\u00e1rquica</p> </li> <li>Soma valores dos n\u00edveis inferiores para superiores baseado na estrutura de c\u00f3digos</li> <li>Filtra registros com valores zerados</li> </ol>"},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Estrutura de c\u00f3digos deve ter pelo menos 2 grupos</li> <li>Data de refer\u00eancia obrigat\u00f3ria</li> <li>Considera apenas imobilizados ativos (n\u00e3o baixados)</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/#calculos","title":"C\u00e1lculos","text":"<ul> <li>Saldo Anterior: Soma deprecia\u00e7\u00e3o acumulada at\u00e9 m\u00eas anterior</li> <li>Deprecia\u00e7\u00e3o: Valor depreciado no m\u00eas atual</li> <li>Baixas: Deprecia\u00e7\u00e3o de ativos baixados no per\u00edodo</li> <li>Transfer\u00eancias: Diferen\u00e7a entre varia\u00e7\u00e3o do saldo e movimenta\u00e7\u00f5es conhecidas</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/#filtros","title":"Filtros","text":"<ul> <li>Aplica <code>getSamWhere()</code> para filtros padr\u00e3o do sistema</li> <li>Considera apenas departamentos com movimenta\u00e7\u00e3o no per\u00edodo</li> </ul>"},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Formato Descri\u00e7\u00e3o M\u00e9todo PDF Relat\u00f3rio formatado para visualiza\u00e7\u00e3o <code>gerarPDF()</code> XLSX Planilha para an\u00e1lise e exporta\u00e7\u00e3o <code>gerarXLSX()</code>"},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Persist\u00eancia e queries - <code>multitec.utils</code> - Utilit\u00e1rios (DateUtils, StringUtils, Utils) - <code>sam.core</code> - Core do sistema SAM - <code>sam.model</code> - Entidades do sistema</p> <p>Par\u00e2metros do Sistema: - <code>ABB11-ESTRCODDEPTO</code> - Estrutura de codifica\u00e7\u00e3o de departamentos</p>"},{"location":"ELTECH/relatorios/sap/SAP_Resumo_Deprecia%C3%A7%C3%A3o_por_Departamento/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Utiliza recursividade para processar estrutura hier\u00e1rquica</li> <li>Considera reclassifica\u00e7\u00f5es hist\u00f3ricas de imobilizados</li> <li>Otimizado com consultas SQL nativas para performance</li> <li>Filtra automaticamente registros com todos valores zerados</li> </ul>"},{"location":"ELTECH/relatorios/sce/SCE_RegistroDeInventarioP7/","title":"SCE - Registro de Invent\u00e1rio Modelo P7","text":""},{"location":"ELTECH/relatorios/sce/SCE_RegistroDeInventarioP7/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio de registro de invent\u00e1rio (Modelo P7) que detalha itens por grupo e grau, incluindo totais, m\u00e9dias e unidades de medida. Permite gera\u00e7\u00e3o de termo de abertura e encerramento do livro.</p>"},{"location":"ELTECH/relatorios/sce/SCE_RegistroDeInventarioP7/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer vis\u00e3o detalhada do invent\u00e1rio, permitindo controle administrativo e fiscal, com consolida\u00e7\u00e3o por grupos, graus e totais.</p>"},{"location":"ELTECH/relatorios/sce/SCE_RegistroDeInventarioP7/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Controladoria</li> <li>Departamento Fiscal</li> <li>Auditoria Interna</li> <li>Gest\u00e3o de Estoque</li> <li>Diretoria Administrativa</li> </ul>"},{"location":"ELTECH/relatorios/sce/SCE_RegistroDeInventarioP7/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis grupos List N\u00e3o IDs de grupos de invent\u00e1rio Lista de IDs livroNum Integer Sim N\u00famero do livro Inteiro livroPag Integer Sim N\u00famero da p\u00e1gina inicial Inteiro impressao Integer Sim Tipo de impress\u00e3o 0=P\u00e1gina, 1=Folha imprimir Integer Sim Formato de impress\u00e3o 0=Livro, 1=Termo abertura, 2=Termo encerramento resumo Integer N\u00e3o Nivel de resumo dos grupos 0=Nenhum, 1=Grau1, 2=Grau2 totUniMed Boolean N\u00e3o Totalizar unidades de medida true/false totQtd Boolean N\u00e3o Totalizar quantidade true/false inventario Long Sim ID do invent\u00e1rio Inteiro rascunho Boolean N\u00e3o Indica rascunho true/false"},{"location":"ELTECH/relatorios/sce/SCE_RegistroDeInventarioP7/#campos-do-relatorio","title":"\ud83d\udccb Campos do Relat\u00f3rio","text":"Campo Descri\u00e7\u00e3o Tipo abm40codigo C\u00f3digo do grupo/registro String abm40descr Descri\u00e7\u00e3o do grupo String bcb11qtde Quantidade do item BigDecimal bcb11total Total do item BigDecimal descTotComp Total do grupo BigDecimal totGrau1 / totGrau2 Totais dos graus BigDecimal mediaGrau1 / mediaGrau2 M\u00e9dia por grau BigDecimal totComp Total geral do grupo BigDecimal descrUniMed Unidade de medida String qtdUniMed Quantidade por unidade BigDecimal totUniMed Total por unidade BigDecimal"},{"location":"ELTECH/relatorios/sce/SCE_RegistroDeInventarioP7/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Carrega par\u00e2metros e ano de refer\u00eancia.</li> <li>Inicializa totais e listas de dados.</li> <li>Busca os itens por grupo e invent\u00e1rio.</li> <li>Agrupa por grau1, grau2 e grupo, calculando totais e m\u00e9dias.</li> <li>Gera linhas de resumo, totais e unidades de medida.</li> <li>Se <code>imprimir != 0</code>, gera termo de abertura ou encerramento.</li> <li>Monta <code>TableMapDataSource</code> para JasperReports.</li> <li>Gera PDF com o relat\u00f3rio e informa\u00e7\u00f5es adicionais.</li> </ol>"},{"location":"ELTECH/relatorios/sce/SCE_RegistroDeInventarioP7/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":"<ul> <li>Agrupamento por c\u00f3digos de 2 e 4 caracteres (grau1 e grau2).</li> <li>Totaliza\u00e7\u00e3o condicional por unidade de medida.</li> <li>C\u00e1lculo de m\u00e9dias apenas se quantidade &gt; 0.</li> <li>Termos de abertura e encerramento seguem regras legais (Lei 6374/89, Conv\u00eanio 57/95).</li> <li>Inclus\u00e3o de resumo por grupos se par\u00e2metro <code>resumo</code> for diferente de 0.</li> </ul>"},{"location":"ELTECH/relatorios/sce/SCE_RegistroDeInventarioP7/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Formato Descri\u00e7\u00e3o PDF Relat\u00f3rio pronto para impress\u00e3o"},{"location":"ELTECH/relatorios/sce/SCE_RegistroDeInventarioP7/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<ul> <li><code>sam.server.samdev.relatorio.RelatorioBase</code> \u2014 Classe base para relat\u00f3rios</li> <li><code>sam.server.samdev.relatorio.TableMapDataSource</code> \u2014 Fonte de dados para JasperReports</li> <li><code>br.com.multitec.utils.collections.TableMap</code> \u2014 Estrutura de dados</li> <li>Entidades: <code>Abm40</code>, <code>Abm01</code>, <code>Bcb10</code>, <code>Bcb11</code>, <code>Aac10</code>, <code>Aag02</code>, <code>Aag0201</code></li> <li>JasperReports (<code>JasperReport</code>, <code>JasperPrint</code>)</li> <li>Utilit\u00e1rios para datas e manipula\u00e7\u00e3o de mapas (<code>MDate</code>, <code>Utils</code>)</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/","title":"SCF - Caixa Financeiro (El Tech)","text":""},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio de caixa financeiro que apresenta o fluxo de entradas e sa\u00eddas por conta corrente, com c\u00e1lculo de saldo acumulado e suporte a diferentes formas de agrupamento (por natureza ou por conta).</p>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Controlar e analisar o movimento financeiro por conta corrente, permitindo acompanhar saldos, entradas, sa\u00eddas e o fluxo de caixa em per\u00edodos espec\u00edficos.</p>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Financeiro</li> <li>Contabilidade</li> <li>Tesouraria</li> <li>Ger\u00eancia Financeira</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Dab10</code> - Lan\u00e7amentos financeiros - <code>Dab1002</code> - Vincula\u00e7\u00e3o de lan\u00e7amentos com contas correntes - <code>Dab01</code> - Contas correntes - <code>Dab0101</code> - Saldos mensais das contas correntes - <code>Dab1001</code> - Departamentos do lan\u00e7amento - <code>Dab10011</code> - Naturezas por departamento - <code>Abf10</code> - Naturezas financeiras - <code>Aac10</code> - Empresas - <code>Aac01</code> - Grupos de empresas - <code>Abb01</code> - Central de documentos</p>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o contaCorrente List N\u00e3o Filtro por IDs das contas correntes periodo LocalDate[] Sim Per\u00edodo do relat\u00f3rio [in\u00edcio, fim] imprimir Integer Sim Formato de sa\u00edda (0=XLSX, 1=PDF) isSaltarPagina Boolean Sim Controla quebra de p\u00e1gina por conta no PDF isNatureza Boolean Sim Agrupa por natureza (true) ou por conta (false)"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Carregamento dos filtros padr\u00e3o (m\u00eas atual)</li> <li>Configura\u00e7\u00e3o da empresa ativa</li> <li>Defini\u00e7\u00e3o dos par\u00e2metros do relat\u00f3rio</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#2-processamento-dos-filtros","title":"2. Processamento dos Filtros","text":"<ul> <li>Valida\u00e7\u00e3o do per\u00edodo informado</li> <li>Aplica\u00e7\u00e3o de filtros de contas correntes</li> <li>Configura\u00e7\u00e3o do tipo de agrupamento (natureza ou conta)</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#3-busca-e-processamento-de-dados","title":"3. Busca e Processamento de Dados","text":"<ul> <li>Busca dos lan\u00e7amentos financeiros no per\u00edodo</li> <li>C\u00e1lculo do saldo inicial para cada conta</li> <li>Processamento sequencial para c\u00e1lculo de saldo acumulado</li> <li>Agrupamento conforme op\u00e7\u00e3o selecionada</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#4-calculo-de-saldos","title":"4. C\u00e1lculo de Saldos","text":"<ul> <li>Saldo inicial: Busca saldo do m\u00eas anterior ou \u00faltimo dispon\u00edvel</li> <li>Saldo acumulado: Calculado linha a linha considerando entradas e sa\u00eddas</li> <li>Saldo final: Resultado ap\u00f3s processamento de todos os lan\u00e7amentos</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#5-geracao-do-relatorio","title":"5. Gera\u00e7\u00e3o do Relat\u00f3rio","text":"<ul> <li>Formato XLSX ou PDF conforme sele\u00e7\u00e3o</li> <li>Quebra de p\u00e1gina por conta (quando habilitado)</li> <li>Inclus\u00e3o de cabe\u00e7alho com empresa e per\u00edodo</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#calculo-de-saldo-inicial","title":"C\u00e1lculo de Saldo Inicial","text":"<ol> <li>Busca saldo do m\u00eas anterior na tabela <code>Dab0101</code></li> <li>Se n\u00e3o encontrado, retrocede meses/anos at\u00e9 encontrar saldo</li> <li>Adiciona entradas e subtrai sa\u00eddas ocorridas antes do per\u00edodo</li> <li>Resultado \u00e9 o saldo inicial para o per\u00edodo informado</li> </ol>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#processamento-de-lancamentos","title":"Processamento de Lan\u00e7amentos","text":"<ul> <li>Entradas (<code>dab10mov = 0</code>): Aumentam o saldo</li> <li>Sa\u00eddas (<code>dab10mov = 1</code>): Diminuem o saldo</li> <li>Ordena\u00e7\u00e3o: Por c\u00f3digo da conta e data do lan\u00e7amento</li> <li>Agrupamento: Controlado por <code>isNatureza</code> (true=natureza, false=conta)</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#formato-de-saida","title":"Formato de Sa\u00edda","text":"<ul> <li>PDF: Ideal para impress\u00e3o e visualiza\u00e7\u00e3o</li> <li>XLSX: Ideal para an\u00e1lise e manipula\u00e7\u00e3o dos dados</li> <li>Quebra de p\u00e1gina: Aplicada apenas no PDF quando habilitada</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra a gera\u00e7\u00e3o do relat\u00f3rio.</p>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#buscarsaldoinicial","title":"<code>buscarSaldoInicial()</code>","text":"<p>Calcula o saldo inicial para uma conta em uma data espec\u00edfica.</p>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#somarvalorentrada","title":"<code>somarValorEntrada()</code>","text":"<p>Soma as entradas de uma conta antes da data informada.</p>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#somarvalorsaida","title":"<code>somarValorSaida()</code>","text":"<p>Soma as sa\u00eddas de uma conta antes da data informada.</p>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#buscarvalorinicialdomes","title":"<code>buscarValorInicialDoMes()</code>","text":"<p>Busca o saldo inicial registrado em meses anteriores.</p>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#obterdadosrelatorio","title":"<code>obterDadosRelatorio()</code>","text":"<p>Busca dados agrupados por natureza.</p>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#obterdadosrelatoriopornatureza","title":"<code>obterDadosRelatorioPorNatureza()</code>","text":"<p>Busca dados agrupados por conta.</p>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Campos do Relat\u00f3rio: - <code>codigoConta</code> - C\u00f3digo da conta corrente - <code>dab01nome</code> - Nome da conta corrente - <code>dab10data</code> - Data do lan\u00e7amento - <code>dab10historico</code> - Hist\u00f3rico do lan\u00e7amento - <code>abf10nome</code> - Nome da natureza (quando agrupado por natureza) - <code>entrada</code> - Valor de entrada - <code>saida</code> - Valor de sa\u00edda - <code>SALDOINICIAL</code> - Saldo inicial da conta - <code>SALDO</code> - Saldo acumulado ap\u00f3s o lan\u00e7amento</p> <p>Par\u00e2metros do Relat\u00f3rio: - <code>TITULO_RELATORIO</code>: \"Caixa Financeiro\" - <code>EMPRESA</code>: Nome da empresa ativa - <code>PERIODO</code>: Per\u00edodo formatado do relat\u00f3rio - <code>NATUREZA</code>: Indica se agrupado por natureza</p>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios (DateUtils, Utils, TableMap) - <code>sam.server.samdev.relatorio</code> - Base para relat\u00f3rios - <code>sam.server.samdev.utils</code> - Utilit\u00e1rios do SAM (Parametro) - <code>java.time</code> - Manipula\u00e7\u00e3o de datas - <code>sam.core.variaveis</code> - Vari\u00e1veis do sistema (MDate)</p> <p>M\u00f3dulo: SCF (Sistema Cont\u00e1bil Financeiro)</p>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#performance","title":"Performance","text":"<ul> <li>Consultas otimizadas com filtros aplicados no banco</li> <li>C\u00e1lculo de saldo inicial com busca progressiva</li> <li>Processamento em lote para grandes volumes</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#tratamento-de-periodos","title":"Tratamento de Per\u00edodos","text":"<ul> <li>Per\u00edodo padr\u00e3o: m\u00eas atual</li> <li>Suporte a qualquer intervalo de datas</li> <li>Formata\u00e7\u00e3o espec\u00edfica para exibi\u00e7\u00e3o</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#calculo-de-saldo-inicial_1","title":"C\u00e1lculo de Saldo Inicial","text":"<ul> <li>Busca recursiva por saldos anteriores</li> <li>Tratamento de mudan\u00e7a de ano (janeiro busca dezembro do ano anterior)</li> <li>Soma de movimenta\u00e7\u00f5es parciais antes do per\u00edodo</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_CaixaFinanceiro/#seguranca","title":"Seguran\u00e7a","text":"<ul> <li>Aplica\u00e7\u00e3o de where padr\u00e3o do sistema para controle de acesso</li> <li>Valida\u00e7\u00e3o de par\u00e2metros de entrada</li> <li>Tratamento de valores nulos e vazios</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 04/12/2025 \u00e0s 08:30 Autor: Bruno Tipo: Relat\u00f3rio de Caixa Financeiro Vers\u00e3o: 1.0 (Customizado para El Tech)</p>"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/","title":"SCF Extrato Cont\u00e1bil","text":"<p>]# SCF - Extrato Cont\u00e1bil</p>"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio de extrato cont\u00e1bil para documentos a receber e a pagar, com op\u00e7\u00f5es de visualiza\u00e7\u00e3o por diferentes crit\u00e9rios, exporta\u00e7\u00e3o para m\u00faltiplos formatos e filtro por PLF (Parametro e Lan\u00e7amento Fiscal).</p>"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer uma vis\u00e3o consolidada da situa\u00e7\u00e3o financeira da empresa, permitindo an\u00e1lise de contas a receber/pagar por diversos filtros e per\u00edodos, com c\u00e1lculo autom\u00e1tico de juros, multas e encargos.</p>"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Financeiro</li> <li>Contabilidade</li> <li>Controladoria</li> <li>Gestores Financeiros</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>DAA01</code> - Documentos a receber/pagar - <code>ABB01</code> - Cabe\u00e7alho de documentos - <code>ABE01</code> - Entidades (clientes/fornecedores) - <code>ABC10</code> - Plano de contas cont\u00e1bil - <code>ABF15</code> - Portadores - <code>AAH01</code> - Tipos de documento - <code>AAC10</code> - Empresas - <code>DAB10</code> - Hist\u00f3ricos de documentos - <code>DAA0103</code> - Itens de documentos financeiros - <code>ABF20</code> - PLF (Parametro e Lan\u00e7amento Fiscal).</p> <p>Entidades Envolvidas: - <code>Daa01</code> - Documentos financeiros - <code>Abe01</code> - Clientes/Fornecedores - <code>Aac10</code> - Empresa - <code>Abf15</code> - Portador - <code>Abc10</code> - Conta cont\u00e1bil - <code>Abf20</code> - PLF</p>"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis classe Integer Sim Tipo de documento 0=A receber, 1=A pagar ordem Integer Sim Ordena\u00e7\u00e3o 0=C\u00f3digo entidade, 1=Nome entidade exportar Integer Sim Formato sa\u00edda 0=PDF, 1=XLSX tp Integer Sim Tipo de registro 0=Todos, 1=Reais numeroInicial Integer N\u00e3o N\u00famero documento inicial 000000000 numeroFinal Integer N\u00e3o N\u00famero documento final 999999999 port List N\u00e3o Portadores espec\u00edficos IDs portadores documento List N\u00e3o Tipos documento IDs tipos documento entInicial String N\u00e3o C\u00f3digo entidade inicial C\u00f3digo inicial entFinal String N\u00e3o C\u00f3digo entidade final C\u00f3digo final emps List N\u00e3o Empresas espec\u00edficas IDs empresas dataPer LocalDate[] Sim Per\u00edodo de an\u00e1lise Data inicial e final op Integer Sim Layout do relat\u00f3rio 0=Padr\u00e3o, 1=Alternativo opEnt Integer Sim Nome entidade 0=Nome reduzido, 1=Nome completo plf List N\u00e3o PLFs a desconsiderar IDs PLFs"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#campos-do-relatorio","title":"\ud83d\udccb Campos do Relat\u00f3rio","text":"Campo Descri\u00e7\u00e3o Tipo ent_cod C\u00f3digo da entidade String ent_nome Nome da entidade String contabil Conta cont\u00e1bil String dt_emis Data emiss\u00e3o Date tp Tipo documento String doc_num N\u00famero documento Integer dt_vcto Data vencimento Date dt_baixa Data baixa Date portador Nome portador String aRealizar Valor a realizar BigDecimal realizado Valor realizado BigDecimal jme Juros/Multas/Encargos BigDecimal"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o de Par\u00e2metros</li> <li>Define classe (receber/pagar)</li> <li>Configura ordena\u00e7\u00e3o e formata\u00e7\u00e3o</li> <li> <p>Processa filtros de empresas e entidades</p> </li> <li> <p>Constru\u00e7\u00e3o da Consulta</p> </li> <li>Monta SQL din\u00e2mico com filtros aplicados</li> <li>Define joins espec\u00edficos por classe</li> <li> <p>Aplica filtro de PLF quando informado</p> </li> <li> <p>Busca de Dados</p> </li> <li>Consulta documentos no per\u00edodo</li> <li>Considera apenas \u00faltimo item por documento</li> <li> <p>Calcula campos financeiros (JME)</p> </li> <li> <p>Ajuste de Per\u00edodo</p> </li> <li>Separa valores realizados e a realizar</li> <li>Filtra documentos fora do per\u00edodo</li> <li> <p>Calcula totais de juros, multas e encargos</p> </li> <li> <p>Gera\u00e7\u00e3o de Sa\u00edda</p> </li> <li>Seleciona template conforme layout</li> <li>Exporta para PDF ou XLSX</li> <li>Formata dados para visualiza\u00e7\u00e3o</li> </ol>"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#filtros-de-periodo","title":"Filtros de Per\u00edodo","text":"<ul> <li>Considera documentos com data de liquida\u00e7\u00e3o dentro do per\u00edodo</li> <li>Inclui documentos em aberto com vencimento no per\u00edodo</li> <li>Exclui documentos emitidos ap\u00f3s o per\u00edodo final</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#calculos-financeiros","title":"C\u00e1lculos Financeiros","text":"<ul> <li>JME: Soma de juros, multas e encargos</li> <li>A Realizar: Valores em aberto no per\u00edodo</li> <li>Realizado: Valores liquidados no per\u00edodo</li> <li>Descontos zerados para valores realizados</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#classificacao","title":"Classifica\u00e7\u00e3o","text":"<ul> <li>Classe 0 (Receber): Join com <code>Abe02</code> e <code>Abe0201</code></li> <li>Classe 1 (Pagar): Join com <code>Abe03</code> e <code>Abe0301</code></li> <li>Conta cont\u00e1bil da primeira sequ\u00eancia</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#filtro-plf","title":"Filtro PLF","text":"<ul> <li>Exclui documentos vinculados aos PLFs informados</li> <li>Considera apenas o \u00faltimo item por documento</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Formato Descri\u00e7\u00e3o Template M\u00e9todo PDF Layout padr\u00e3o <code>SCF_ExtratoContabil</code> <code>gerarPDF()</code> PDF Layout alternativo <code>SCF_ExtratoContabil_R1</code> <code>gerarPDF()</code> XLSX Planilha padr\u00e3o <code>SCF_ExtratoContabil</code> <code>gerarXLSX()</code> XLSX Planilha alternativo <code>SCF_ExtratoContabil_R1</code> <code>gerarXLSX()</code>"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multitec.utils</code> - Utilit\u00e1rios e datas - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios (PDF)</p> <p>Configura\u00e7\u00f5es: - Templates Jasper para diferentes layouts - Par\u00e2metros JSON para campos financeiros</p>"},{"location":"ELTECH/relatorios/scf/SCF_Extrato_Cont%C3%A1bil/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>SQL din\u00e2mico com m\u00faltiplos filtros opcionais</li> <li>Join espec\u00edfico por classe (receber/pagar)</li> <li>Processamento de campos JSON para valores financeiros</li> <li>Ajuste autom\u00e1tico de datas e per\u00edodos</li> <li>Suporte a m\u00faltiplas empresas no cabe\u00e7alho</li> <li>Filtro por PLF com subconsulta para \u00faltimo item</li> <li>Ordena\u00e7\u00e3o flex\u00edvel por c\u00f3digo ou nome de entidade</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/","title":"SCF - Lan\u00e7amentos (El Tech)","text":""},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio de lan\u00e7amentos financeiros por conta corrente, apresentando o fluxo completo com c\u00e1lculo de saldo acumulado, ideal para concilia\u00e7\u00e3o banc\u00e1ria e acompanhamento di\u00e1rio do caixa.</p>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Controlar e analisar todos os lan\u00e7amentos financeiros por conta corrente, permitindo concilia\u00e7\u00e3o, identifica\u00e7\u00e3o de movimenta\u00e7\u00f5es e acompanhamento do saldo em tempo real.</p>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Financeiro</li> <li>Contabilidade</li> <li>Tesouraria</li> <li>Auditoria Interna</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Dab10</code> - Lan\u00e7amentos financeiros - <code>Dab1002</code> - Vincula\u00e7\u00e3o de lan\u00e7amentos com contas correntes - <code>Dab01</code> - Contas correntes - <code>Dab0101</code> - Saldos mensais das contas correntes - <code>Aac10</code> - Empresas - <code>Aac01</code> - Grupos de empresas - <code>Abb01</code> - Central de documentos</p>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o contaCorrente List N\u00e3o Filtro por IDs das contas correntes periodo LocalDate[] Sim Per\u00edodo do relat\u00f3rio [in\u00edcio, fim] imprimir Integer Sim Formato de sa\u00edda (0=XLSX, 1=PDF) isSaltarPagina Boolean Sim Controla quebra de p\u00e1gina por conta no PDF"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Carregamento dos filtros padr\u00e3o (m\u00eas atual)</li> <li>Configura\u00e7\u00e3o da empresa ativa</li> <li>Defini\u00e7\u00e3o dos par\u00e2metros do relat\u00f3rio</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#2-processamento-dos-filtros","title":"2. Processamento dos Filtros","text":"<ul> <li>Valida\u00e7\u00e3o do per\u00edodo informado</li> <li>Aplica\u00e7\u00e3o de filtros de contas correntes</li> <li>Configura\u00e7\u00e3o da quebra de p\u00e1gina</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#3-busca-e-processamento-de-dados","title":"3. Busca e Processamento de Dados","text":"<ul> <li>Busca dos lan\u00e7amentos financeiros no per\u00edodo</li> <li>C\u00e1lculo do saldo inicial para cada conta</li> <li>Processamento sequencial para c\u00e1lculo de saldo acumulado</li> <li>Ordena\u00e7\u00e3o por conta e data</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#4-calculo-de-saldos","title":"4. C\u00e1lculo de Saldos","text":"<ul> <li>Saldo inicial: Busca saldo do m\u00eas anterior ou \u00faltimo dispon\u00edvel</li> <li>Saldo acumulado: Calculado linha a linha considerando entradas e sa\u00eddas</li> <li>Saldo final: Resultado ap\u00f3s processamento de todos os lan\u00e7amentos</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#5-geracao-do-relatorio","title":"5. Gera\u00e7\u00e3o do Relat\u00f3rio","text":"<ul> <li>Formato XLSX ou PDF conforme sele\u00e7\u00e3o</li> <li>Quebra de p\u00e1gina por conta (quando habilitado)</li> <li>Inclus\u00e3o de cabe\u00e7alho com empresa e per\u00edodo</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#calculo-de-saldo-inicial","title":"C\u00e1lculo de Saldo Inicial","text":"<ol> <li>Busca saldo do m\u00eas anterior na tabela <code>Dab0101</code></li> <li>Se n\u00e3o encontrado, retrocede meses/anos at\u00e9 encontrar saldo</li> <li>Adiciona entradas e subtrai sa\u00eddas ocorridas antes do per\u00edodo</li> <li>Resultado \u00e9 o saldo inicial para o per\u00edodo informado</li> </ol>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#processamento-de-lancamentos","title":"Processamento de Lan\u00e7amentos","text":"<ul> <li>Entradas (<code>dab10mov = 0</code>): Aumentam o saldo</li> <li>Sa\u00eddas (<code>dab10mov = 1</code>): Diminuem o saldo</li> <li>Ordena\u00e7\u00e3o: Por c\u00f3digo da conta e data do lan\u00e7amento</li> <li>Saldo inicial: Calculado apenas na primeira linha de cada conta</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#formato-de-saida","title":"Formato de Sa\u00edda","text":"<ul> <li>PDF: Ideal para impress\u00e3o e visualiza\u00e7\u00e3o, com op\u00e7\u00e3o de quebra por conta</li> <li>XLSX: Ideal para an\u00e1lise e manipula\u00e7\u00e3o dos dados</li> <li>Quebra de p\u00e1gina: Aplicada apenas no PDF quando habilitada</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra a gera\u00e7\u00e3o do relat\u00f3rio.</p>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#buscarsaldoinicial","title":"<code>buscarSaldoInicial()</code>","text":"<p>Calcula o saldo inicial para uma conta em uma data espec\u00edfica.</p>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#somarvalorentrada","title":"<code>somarValorEntrada()</code>","text":"<p>Soma as entradas de uma conta antes da data informada.</p>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#somarvalorsaida","title":"<code>somarValorSaida()</code>","text":"<p>Soma as sa\u00eddas de uma conta antes da data informada.</p>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#buscarvalorinicialdomes","title":"<code>buscarValorInicialDoMes()</code>","text":"<p>Busca o saldo inicial registrado em meses anteriores.</p>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#obterdadosrelatorio","title":"<code>obterDadosRelatorio()</code>","text":"<p>Busca dados de lan\u00e7amentos com filtros aplicados.</p>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Campos do Relat\u00f3rio: - <code>codigoConta</code> - C\u00f3digo da conta corrente - <code>dab01nome</code> - Nome da conta corrente - <code>dab10data</code> - Data do lan\u00e7amento - <code>dab10historico</code> - Hist\u00f3rico do lan\u00e7amento - <code>dab10mov</code> - Tipo de movimento (0=Entrada, 1=Sa\u00edda) - <code>dab10valor</code> - Valor do lan\u00e7amento - <code>SALDOINICIAL</code> - Saldo inicial da conta - <code>SALDO</code> - Saldo acumulado ap\u00f3s o lan\u00e7amento</p> <p>Par\u00e2metros do Relat\u00f3rio: - <code>TITULO_RELATORIO</code>: \"Lan\u00e7amentos\" - <code>EMPRESA</code>: Nome da empresa ativa - <code>PERIODO</code>: Per\u00edodo formatado do relat\u00f3rio</p>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios (DateUtils, Utils, TableMap) - <code>sam.server.samdev.relatorio</code> - Base para relat\u00f3rios - <code>sam.server.samdev.utils</code> - Utilit\u00e1rios do SAM (Parametro) - <code>java.time</code> - Manipula\u00e7\u00e3o de datas - <code>sam.core.variaveis</code> - Vari\u00e1veis do sistema (MDate)</p> <p>M\u00f3dulo: SCF (Sistema Cont\u00e1bil Financeiro)</p>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#performance","title":"Performance","text":"<ul> <li>Consultas otimizadas com filtros aplicados no banco</li> <li>C\u00e1lculo de saldo inicial com busca progressiva</li> <li>Processamento em lote para grandes volumes</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#tratamento-de-periodos","title":"Tratamento de Per\u00edodos","text":"<ul> <li>Per\u00edodo padr\u00e3o: m\u00eas atual</li> <li>Suporte a qualquer intervalo de datas</li> <li>Formata\u00e7\u00e3o espec\u00edfica para exibi\u00e7\u00e3o</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#calculo-de-saldo-inicial_1","title":"C\u00e1lculo de Saldo Inicial","text":"<ul> <li>Busca recursiva por saldos anteriores</li> <li>Tratamento de mudan\u00e7a de ano (janeiro busca dezembro do ano anterior)</li> <li>Soma de movimenta\u00e7\u00f5es parciais antes do per\u00edodo</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#seguranca","title":"Seguran\u00e7a","text":"<ul> <li>Aplica\u00e7\u00e3o de where padr\u00e3o do sistema para controle de acesso</li> <li>Valida\u00e7\u00e3o de par\u00e2metros de entrada</li> <li>Tratamento de valores nulos e vazios</li> </ul>"},{"location":"ELTECH/relatorios/scf/SCF_Lancamentos/#comparacao-com-caixa-financeiro","title":"Compara\u00e7\u00e3o com Caixa Financeiro","text":"<ul> <li>Este relat\u00f3rio: Foco em lan\u00e7amentos individuais com detalhes completos</li> <li>Caixa Financeiro: Op\u00e7\u00e3o de agrupamento por natureza</li> <li>Ambos: C\u00e1lculo de saldo acumulado e concilia\u00e7\u00e3o</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 04/12/2025 \u00e0s 08:30 Autor: Bruno Tipo: Relat\u00f3rio de Lan\u00e7amentos Financeiros Vers\u00e3o: 1.0 (Customizado para El Tech)</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/","title":"SCV_PedidoEstoqueProducao.md","text":""},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio \"SCV - Pedido Venda x Estoque x Produ\u00e7\u00e3o - Eltech\" que consolida informa\u00e7\u00f5es de pedidos de venda, estoque atual e produ\u00e7\u00e3o em andamento para an\u00e1lise de atendimento e planejamento.</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer uma vis\u00e3o integrada da situa\u00e7\u00e3o de itens entre pedidos em aberto, saldo em estoque e produ\u00e7\u00e3o programada, permitindo an\u00e1lise de capacidade de atendimento e planejamento de produ\u00e7\u00e3o.</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento de Vendas</li> <li>Planejamento de Produ\u00e7\u00e3o</li> <li>Controle de Estoque</li> <li>Gest\u00e3o Comercial</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#localizacao-do-codigo","title":"\ud83d\udcc1 Localiza\u00e7\u00e3o do C\u00f3digo","text":"<p>Caminho: <code>eltech/relatorios/scv/SCV_PedidoEstoqueProducao.groovy</code></p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#estrutura-do-projeto","title":"\ud83e\uddf1 Estrutura do Projeto","text":"<ul> <li>Classe: <code>SCV_PedidoEstoqueProducao</code></li> <li>Pacote: <code>eltech.relatorios.scv</code></li> <li>Heran\u00e7a: <code>RelatorioBase</code> (Framework SAMDev)</li> <li>Linguagem: Groovy</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - Framework SAMDev - M\u00f3dulo de relat\u00f3rios Streama - Conex\u00e3o com banco de dados corporativo - Bibliotecas: <code>DateUtils</code>, <code>Utils</code>, <code>TableMap</code></p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>eaa01</code> - Documentos SCV - <code>abb01</code> - Cabe\u00e7alho de documentos - <code>abe01</code> - Entidades - <code>abm01</code> - Itens/Cadastro de produtos - <code>eaa0103</code> - Itens de documentos SCV - <code>eaa01032</code> - Vincula\u00e7\u00e3o entre itens SCV e SRF - <code>bcc02</code> - Saldo de estoque - <code>bab01</code> - Ordens de produ\u00e7\u00e3o - <code>abp20</code> - Componentes de produ\u00e7\u00e3o</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o exportar Integer Sim 0=PDF, 1=XLSX tipo List N\u00e3o Tipo(s) de documento status List N\u00e3o Status de estoque emissao LocalDate[] Sim Per\u00edodo de emiss\u00e3o [in\u00edcio, fim] entrega LocalDate[] N\u00e3o Per\u00edodo de entrega [in\u00edcio, fim] itemIni String N\u00e3o Item inicial (c\u00f3digo) itemFim String N\u00e3o Item final (c\u00f3digo) atendimentoN Boolean Sim Incluir n\u00e3o atendidos atendimentoP Boolean Sim Incluir parcialmente atendidos atendimentoE Boolean Sim Incluir entregues mpms List N\u00e3o Tipos de MPM entIni String N\u00e3o Entidade inicial entFim String N\u00e3o Entidade final aprovado1 Boolean N\u00e3o Aprovados aprovado2 Boolean N\u00e3o N\u00e3o aprovados bloqueado1 Boolean N\u00e3o Bloqueados bloqueado2 Boolean N\u00e3o N\u00e3o bloqueados"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#saidas-do-relatorio","title":"\ud83d\udccb Sa\u00eddas do Relat\u00f3rio","text":"Campo Descri\u00e7\u00e3o Tipo abm01codigo C\u00f3digo do item String abm01na Descri\u00e7\u00e3o do item String aam06codigo Unidade de medida String abm01tipo Tipo do item Integer qtdePedido Quantidade pedida BigDecimal qtdeEntregue Quantidade entregue BigDecimal qtdeEntregar Quantidade a entregar BigDecimal qtdeEstoque Saldo em estoque BigDecimal qtdeProducao Quantidade em produ\u00e7\u00e3o BigDecimal saldo Saldo dispon\u00edvel (estoque + produ\u00e7\u00e3o - entregar) BigDecimal"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#fluxo-de-execucao","title":"\ud83d\udd04 Fluxo de Execu\u00e7\u00e3o","text":"<ol> <li>Valida\u00e7\u00e3o e Prepara\u00e7\u00e3o de Par\u00e2metros</li> <li>Coleta e converte par\u00e2metros de entrada</li> <li>Processa flags booleanas para listas (aprovado, bloqueado)</li> <li> <p>Define valores padr\u00e3o para filtros</p> </li> <li> <p>Busca de Itens Base</p> </li> <li>Executa <code>buscarItens()</code> para obter lista de itens filtrados</li> <li> <p>Aplica filtros: item, MPM, tipo, datas, entidade, aprova\u00e7\u00e3o, bloqueio</p> </li> <li> <p>Agrega\u00e7\u00e3o de Quantidades</p> </li> <li> <p>Para cada item encontrado, busca:</p> <ul> <li><code>buscarQtdPedidos()</code>: Total pedido</li> <li><code>buscarQtdEntregue()</code>: Total j\u00e1 entregue</li> <li><code>buscarQtdAEntregar()</code>: Total pendente de entrega</li> <li><code>buscarSaldoAtualItem()</code>: Estoque atual</li> <li><code>buscarQtdeProducao()</code>: Em produ\u00e7\u00e3o</li> </ul> </li> <li> <p>C\u00e1lculo de Saldo</p> </li> <li> <p>Para cada item: <code>saldo = (estoque - aEntregar) + produ\u00e7\u00e3o</code></p> </li> <li> <p>Gera\u00e7\u00e3o de Sa\u00edda</p> </li> <li>Se <code>exportar = 0</code>: Gera relat\u00f3rio PDF</li> <li>Se <code>exportar = 1</code>: Gera planilha XLSX</li> </ol>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#filtros-de-atendimento","title":"Filtros de Atendimento","text":"<ul> <li>N\u00e3o atendidos (N): <code>eaa01scvAtend = 0</code></li> <li>Parcialmente atendidos (P): <code>eaa01scvAtend = 1</code></li> <li>Entregues (E): Considera apenas itens com vincula\u00e7\u00e3o via <code>eaa01032</code></li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#criterios-de-inclusao","title":"Crit\u00e9rios de Inclus\u00e3o","text":"<ul> <li>Documentos n\u00e3o cancelados (<code>eaa01cancdata IS NULL</code>)</li> <li>Documentos SCV (<code>eaa01clasDoc = 0</code>)</li> <li>Movimenta\u00e7\u00e3o de entrada (<code>eaa01esMov = 1</code>)</li> <li>Status de produ\u00e7\u00e3o = 1 (em aberto)</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#calculo-de-pendencias","title":"C\u00e1lculo de Pend\u00eancias","text":"<p>Quantidade a entregar = Quantidade pedida - Quantidade j\u00e1 entregue Considera apenas pend\u00eancias onde <code>quantidade pedida &gt;= quantidade entregue</code></p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#metodos-principais","title":"\ud83d\udd0d M\u00e9todos Principais","text":""},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#buscaritens","title":"<code>buscarItens()</code>","text":"<p>Retorna lista de itens filtrados com base nos par\u00e2metros: - Filtros de item (c\u00f3digo) - Filtros de MPM (tipo de item) - Filtros de datas (emiss\u00e3o, entrega) - Filtros de entidade - Filtros de aprova\u00e7\u00e3o e bloqueio</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#buscarqtdpedidos","title":"<code>buscarQtdPedidos()</code>","text":"<p>Calcula quantidade total pedida por item, considerando: - Itens espec\u00edficos - Tipo de documento - Per\u00edodo de emiss\u00e3o - Per\u00edodo de entrega - Status de atendimento</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#buscarqtdentregue","title":"<code>buscarQtdEntregue()</code>","text":"<p>Calcula quantidade j\u00e1 entregue por item atrav\u00e9s da tabela de vincula\u00e7\u00e3o <code>eaa01032</code></p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidoEstoqueProducao/#buscarqtdaentregar","title":"<code>buscarQtdAEntregar()</code>","text":"<p>Calcula quantidade pendente de entrega usando CTE (Common Table Expression): ```sql WITH base AS (...) SELECT abm01id, SUM(eaa0103qtcoml) AS total FROM base GROUP BY abm01id</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/","title":"SCV - Pedidos por Item (Eltech)","text":""},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio que consolida informa\u00e7\u00f5es de pedidos agrupados por item, permitindo an\u00e1lise de quantidades solicitadas versus quantidades atendidas, com filtros flex\u00edveis para diferentes tipos de pedidos e situa\u00e7\u00f5es.</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer uma vis\u00e3o consolidada dos pedidos por item, facilitando o acompanhamento de atendimento, identifica\u00e7\u00e3o de saldos pendentes e an\u00e1lise de movimenta\u00e7\u00e3o de produtos.</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Comercial/Vendas</li> <li>Compras</li> <li>Planejamento</li> <li>Estoques</li> <li>Ger\u00eancia</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos fiscais - <code>Abb01</code> - Central de documento - <code>Eaa0103</code> - Itens do documento fiscal - <code>Eaa01032</code> - Itens atendidos do SCV - <code>Abm01</code> - Produtos - <code>Aam01</code> - Classes de produtos - <code>Abe01</code> - Entidades (clientes/fornecedores) - <code>Aam06</code> - Unidades de medida (comercial e uso)</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valor Padr\u00e3o tipos List N\u00e3o Tipos de documento a filtrar - numeroInicial Integer N\u00e3o N\u00famero inicial do documento 0 numeroFinal Integer N\u00e3o N\u00famero final do documento 0 entidades List N\u00e3o IDs das entidades (clientes/fornecedores) - emissao LocalDate[] N\u00e3o Per\u00edodo de emiss\u00e3o dos documentos - pedEntSai Integer Sim Tipo de movimento (0=Compra, 1=Venda) 1 impressao Integer Sim Formato de sa\u00edda (0=PDF, 1=XLSX) 0 entrega LocalDate[] N\u00e3o Per\u00edodo de entrega dos itens - numeroCliente String N\u00e3o N\u00famero do pedido do cliente - isDesconsiderarSaldoZerado Boolean Sim Desconsiderar itens com saldo zero true classes List N\u00e3o Classes de produtos - itens List N\u00e3o IDs dos itens espec\u00edficos - status1 Boolean Sim Incluir status 0 (pendente) true status2 Boolean Sim Incluir status 1 (parcial) true status3 Boolean Sim Incluir status 2 (atendido) false"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Defini\u00e7\u00e3o dos valores padr\u00e3o dos filtros</li> <li>Carregamento dos par\u00e2metros fornecidos pelo usu\u00e1rio</li> <li>Valida\u00e7\u00e3o e formata\u00e7\u00e3o dos dados de entrada</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#2-busca-de-documentos","title":"2. Busca de Documentos","text":"<ul> <li>Consulta ao banco de dados com m\u00faltiplos filtros aplic\u00e1veis</li> <li>Jun\u00e7\u00e3o de tabelas relacionadas (documentos, itens, entidades, produtos)</li> <li>Aplica\u00e7\u00e3o autom\u00e1tica de filtros de seguran\u00e7a (where padr\u00e3o)</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#3-processamento-de-dados","title":"3. Processamento de Dados","text":"<ul> <li>Agrupamento de itens por c\u00f3digo de produto</li> <li>Soma de quantidades comercializadas por item</li> <li>Remo\u00e7\u00e3o de duplicidades na consolida\u00e7\u00e3o</li> <li>C\u00e1lculo de saldos (quantidade solicitada vs. atendida)</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#4-filtragem-final","title":"4. Filtragem Final","text":"<ul> <li>Op\u00e7\u00e3o de desconsiderar itens com saldo zero</li> <li>Valida\u00e7\u00e3o de diferen\u00e7as entre quantidades</li> <li>Remo\u00e7\u00e3o de registros conforme crit\u00e9rios definidos</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#5-geracao-de-saida","title":"5. Gera\u00e7\u00e3o de Sa\u00edda","text":"<ul> <li>Formata\u00e7\u00e3o dos dados para o formato escolhido (PDF ou XLSX)</li> <li>Adi\u00e7\u00e3o de par\u00e2metros de cabe\u00e7alho (empresa, t\u00edtulo, datas)</li> <li>Cria\u00e7\u00e3o do arquivo para download</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#filtros-de-documentos","title":"Filtros de Documentos","text":"<ul> <li>Documentos cancelados s\u00e3o exclu\u00eddos automaticamente</li> <li>Apenas documentos com classifica\u00e7\u00e3o 0 s\u00e3o considerados</li> <li>Filtros de seguran\u00e7a s\u00e3o aplicados automaticamente</li> <li>Per\u00edodos de data s\u00e3o inclusivos (between)</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#tipos-de-movimento","title":"Tipos de Movimento","text":"<ul> <li>0 - Pedidos de Compra: Movimento de entrada (esmov = 0)</li> <li>1 - Pedidos de Venda: Movimento de sa\u00edda (esmov = 1)</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#status-de-atendimento","title":"Status de Atendimento","text":"<ul> <li>0 - Pendente: Nenhum item atendido</li> <li>1 - Parcial: Parte dos itens atendidos</li> <li>2 - Atendido: Todos os itens atendidos</li> <li>Filtro m\u00faltiplo permite combina\u00e7\u00e3o de status</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#consolidacao-por-item","title":"Consolida\u00e7\u00e3o por Item","text":"<ul> <li>Itens com mesmo c\u00f3digo s\u00e3o agrupados</li> <li>Quantidades comercializadas s\u00e3o somadas</li> <li>Primeira ocorr\u00eancia mant\u00e9m outros dados (entidade, datas)</li> <li>Ordena\u00e7\u00e3o por n\u00famero do documento, c\u00f3digo da entidade e c\u00f3digo do item</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#tratamento-de-saldos","title":"Tratamento de Saldos","text":"<ul> <li>Saldo = eaa0103qtcoml (solicitado) - eaa01032qtcoml (atendido)</li> <li>Op\u00e7\u00e3o de excluir itens com saldo zero</li> <li>Valida\u00e7\u00e3o de diferen\u00e7a exata (compareTo BigDecimal.ZERO)</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#getnometarefa","title":"<code>getNomeTarefa()</code>","text":"<p>Retorna o nome da tarefa para identifica\u00e7\u00e3o no sistema.</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#criarvaloresiniciais","title":"<code>criarValoresIniciais()</code>","text":"<p>Define os valores padr\u00e3o para os filtros do relat\u00f3rio.</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo do relat\u00f3rio.</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#buscardocumentos","title":"<code>buscarDocumentos(...)</code>","text":"<p>Executa a consulta SQL com todos os filtros aplicados e retorna os dados brutos.</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Colunas do Relat\u00f3rio: - <code>abb01num</code> - N\u00famero do documento - <code>abb01data</code> - Data de emiss\u00e3o - <code>abb01serie</code> - S\u00e9rie do documento - <code>abe01codigo</code> - C\u00f3digo da entidade - <code>abe01na</code> - Nome/Apelido da entidade - <code>abm01codigo</code> - C\u00f3digo do produto - <code>abm01na</code> - Nome/Apelido do produto - <code>eaa0103dtentrega</code> - Data de entrega do item - <code>eaa01032qtComl</code> - Quantidade atendida (consolidada) - <code>eaa0103qtcoml</code> - Quantidade solicitada - <code>aam06descr_uso</code> - Descri\u00e7\u00e3o da unidade de uso</p> <p>Formato de Sa\u00edda: - PDF: Relat\u00f3rio formatado para impress\u00e3o/visualiza\u00e7\u00e3o - XLSX: Planilha Excel para an\u00e1lise e manipula\u00e7\u00e3o</p> <p>Par\u00e2metros do Cabe\u00e7alho: - C\u00f3digo e raz\u00e3o social da empresa - T\u00edtulo do relat\u00f3rio (Pedidos de Compra/Venda) - Per\u00edodo de emiss\u00e3o filtrado</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>br.com.multitec.utils</code> - Utilit\u00e1rios gerais - <code>br.com.multitec.utils.collections.TableMap</code> - Estrutura de dados - <code>sam.server.samdev.relatorio</code> - Classes base para relat\u00f3rios - <code>java.time</code> - Manipula\u00e7\u00e3o de datas - <code>java.math</code> - Opera\u00e7\u00f5es com BigDecimal</p> <p>M\u00f3dulo: SCV (Sistema de Controle de Vendas)</p>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#performance-da-consulta","title":"Performance da Consulta","text":"<ul> <li>Uso de LEFT JOIN para garantir todos os dados necess\u00e1rios</li> <li>\u00cdndices sugeridos nas colunas de filtro frequente</li> <li>Filtragem aplicada diretamente no banco para efici\u00eancia</li> <li>Pagina\u00e7\u00e3o impl\u00edcita por limita\u00e7\u00e3o de per\u00edodo</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#tratamento-de-dados","title":"Tratamento de Dados","text":"<ul> <li>Convers\u00e3o segura de par\u00e2metros para evitar NullPointerException</li> <li>Uso de BigDecimal para precis\u00e3o em c\u00e1lculos monet\u00e1rios</li> <li>Formata\u00e7\u00e3o de datas no padr\u00e3o brasileiro (dd/MM/yyyy)</li> <li>Remo\u00e7\u00e3o de registros nulos das listas de status</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#seguranca","title":"Seguran\u00e7a","text":"<ul> <li>Aplica\u00e7\u00e3o autom\u00e1tica de where padr\u00e3o por empresa/usu\u00e1rio</li> <li>Valida\u00e7\u00e3o de permiss\u00f5es atrav\u00e9s da classe base</li> <li>Sanitiza\u00e7\u00e3o de par\u00e2metros de entrada</li> </ul>"},{"location":"ELTECH/relatorios/scv/SCV_PedidosPorItem/#algoritmo-de-consolidacao","title":"Algoritmo de Consolida\u00e7\u00e3o","text":"<ul> <li>Loop while com controle manual do \u00edndice para remo\u00e7\u00e3o segura</li> <li>Compara\u00e7\u00e3o de c\u00f3digo do produto para identifica\u00e7\u00e3o de duplicatas</li> <li>Acumula\u00e7\u00e3o progressiva de quantidades</li> <li>Atualiza\u00e7\u00e3o in-place dos registros consolidados</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 28/11/2025 \u00e0s 20:49 Autor: Bruno Tipo: Relat\u00f3rio de Pedidos por Item Vers\u00e3o: 1.0</p>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/","title":"SGC_BalancoPatrimonialDRE.md","text":""},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de gera\u00e7\u00e3o de relat\u00f3rios cont\u00e1beis para a Linhasita, incluindo Balan\u00e7o Patrimonial, Demonstra\u00e7\u00e3o do Resultado do Exerc\u00edcio (DRE) e Notas Explicativas.</p>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer relat\u00f3rios cont\u00e1beis completos e padronizados para atendimento \u00e0s obriga\u00e7\u00f5es legais e an\u00e1lise gerencial da situa\u00e7\u00e3o patrimonial e de resultados da empresa.</p>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Cont\u00e1bil</li> <li>Controladoria</li> <li>Diretoria Financeira</li> <li>Auditores externos</li> <li>Conselho de Administra\u00e7\u00e3o</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - Template Jasper <code>SGC_BalancoPatrimonialDRE</code> - Layout dos relat\u00f3rios - Par\u00e2metros cont\u00e1beis configurados</p> <p>Localiza\u00e7\u00e3o: <code>linhasita/relatorios/sgc/</code></p>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>ABC10</code> - Plano de contas - <code>EBB02</code> - Saldos cont\u00e1beis - <code>EBA10</code> - Agrupamentos de contas - <code>EBA30</code> - Notas explicativas - <code>EBA40</code> - Livros cont\u00e1beis - <code>AAC10</code> - Empresas/Filiais</p> <p>Entidades Envolvidas: - <code>Abc10</code> - Contas cont\u00e1beis - <code>Ebb02</code> - Saldos mensais - <code>Eba10</code> - Agrupamentos - <code>Eba30</code> - Notas - <code>Aac10</code> - Empresas</p>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis emitir Integer Sim Tipo de relat\u00f3rio 0-BP, 1-DRE, 2-DRE Mensal, 3-Notas data1 String Sim Data de refer\u00eancia 1 MM/aaaa data2 String N\u00e3o Data de refer\u00eancia 2 MM/aaaa data3 String N\u00e3o Data de refer\u00eancia 3 MM/aaaa anexarBalanceteAoDiario Boolean N\u00e3o Vincular ao livro di\u00e1rio true/false"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#tipos-de-relatorio","title":"\ud83d\udccb Tipos de Relat\u00f3rio","text":""},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#balanco-patrimonial-0","title":"Balan\u00e7o Patrimonial (0)","text":"<ul> <li>Ativo e Passivo circulante/n\u00e3o circulante</li> <li>Patrim\u00f4nio l\u00edquido</li> <li>Comparativo entre per\u00edodos (at\u00e9 3 datas)</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#dre-demonstracao-do-resultado-1","title":"DRE - Demonstra\u00e7\u00e3o do Resultado (1)","text":"<ul> <li>Receitas operacionais</li> <li>Custos e despesas</li> <li>Resultado l\u00edquido do exerc\u00edcio</li> <li>Agrupamentos espec\u00edficos por conta</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#dre-mensal-2","title":"DRE Mensal (2)","text":"<ul> <li>Vers\u00e3o mensal da DRE</li> <li>Foco em resultados do m\u00eas</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#notas-explicativas-3","title":"Notas Explicativas (3)","text":"<ul> <li>Informa\u00e7\u00f5es complementares</li> <li>Esclarecimentos sobre demonstra\u00e7\u00f5es</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o de Par\u00e2metros</li> <li>Verifica datas de refer\u00eancia</li> <li>Valida consist\u00eancia entre per\u00edodos</li> <li> <p>Confirma configura\u00e7\u00f5es cont\u00e1beis</p> </li> <li> <p>Configura\u00e7\u00e3o do Ambiente</p> </li> <li>Carrega dados da empresa</li> <li>Obt\u00e9m estrutura do plano de contas</li> <li> <p>Configura assinaturas e termos</p> </li> <li> <p>Processamento de Dados</p> </li> <li>Busca saldos cont\u00e1beis por per\u00edodo</li> <li>Aplica regras de classifica\u00e7\u00e3o</li> <li> <p>Calcula totais e subtotais</p> </li> <li> <p>Formata\u00e7\u00e3o do Relat\u00f3rio</p> </li> <li>Composi\u00e7\u00e3o hier\u00e1rquica das contas</li> <li>Aplica\u00e7\u00e3o de sinais (d\u00e9bito/cr\u00e9dito)</li> <li> <p>Formata\u00e7\u00e3o de valores e textos</p> </li> <li> <p>Gera\u00e7\u00e3o de Sa\u00edda</p> </li> <li>PDF com relat\u00f3rio formatado</li> <li>Numera\u00e7\u00e3o de p\u00e1ginas</li> <li>Assinaturas e termos</li> </ol>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Estrutura de plano de contas com 6 graus</li> <li>Grau da empresa deve ser o 5\u00ba</li> <li>Datas de refer\u00eancia n\u00e3o podem ser iguais</li> <li>Saldos devem estar atualizados</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#classificacao-de-contas","title":"Classifica\u00e7\u00e3o de Contas","text":"<ul> <li>Ativo: Contas classe 1</li> <li>Passivo: Contas classe 2  </li> <li>Resultado: Contas classe 3</li> <li>Sinais invertidos para passivo e resultado</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#agrupamentos-especificos","title":"Agrupamentos Espec\u00edficos","text":"<ul> <li>Contas 31, 32, 33, 36 possuem agrupamentos customizados</li> <li>Mapeamento para c\u00f3digos espec\u00edficos (990101xx)</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#termos-e-assinaturas","title":"Termos e Assinaturas","text":"<ul> <li>Termos em extenso para valores</li> <li>Assinaturas do respons\u00e1vel e contador</li> <li>Qualifica\u00e7\u00f5es profissionais</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Formato Descri\u00e7\u00e3o M\u00e9todo PDF Relat\u00f3rio cont\u00e1bil completo <code>gerarPDF()</code>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios - <code>multitec.utils</code> - Utilit\u00e1rios e c\u00e1lculos - <code>java.time</code> - Manipula\u00e7\u00e3o de datas</p> <p>Par\u00e2metros do Sistema: - <code>GRAUEMPRESA</code> - Grau da empresa no plano - <code>ESTRCODCONTA</code> - Estrutura do c\u00f3digo de conta - <code>EB_ATUALIZARCTAS</code> - Indicador de atualiza\u00e7\u00e3o</p>"},{"location":"ELTECH/relatorios/sgc/SGC_BalancoPatrimonialDRE/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Suporte a m\u00faltiplos per\u00edodos comparativos</li> <li>Hierarquia autom\u00e1tica baseada em graus</li> <li>Tratamento espec\u00edfico para DRE mensal</li> <li>Integra\u00e7\u00e3o com livro di\u00e1rio</li> <li>Formata\u00e7\u00e3o profissional para relat\u00f3rios cont\u00e1beis</li> <li>Valida\u00e7\u00f5es robustas de consist\u00eancia</li> <li>Suporte a notas explicativas periodizadas</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/","title":"SGC_LivroRazao.md","text":""},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de gera\u00e7\u00e3o do Livro Raz\u00e3o cont\u00e1bil para a Linhasita, respons\u00e1vel pela impress\u00e3o do registro cronol\u00f3gico de todos os lan\u00e7amentos cont\u00e1beis por conta.</p>"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer um relat\u00f3rio completo do Livro Raz\u00e3o para acompanhamento dos lan\u00e7amentos cont\u00e1beis, saldos e movimenta\u00e7\u00f5es por conta no per\u00edodo.</p>"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Cont\u00e1bil</li> <li>Controladoria</li> <li>Auditores internos e externos</li> <li>Diretoria Financeira</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - Template Jasper <code>SGC_LivroRazao_R2</code> - Layout retrato - Template Jasper <code>SGC_LivroRazao_R3</code> - Layout paisagem - Template Jasper <code>SGC_LivroRazao_R1</code> - Termos de abertura/encerramento</p> <p>Localiza\u00e7\u00e3o: <code>eltech/relatorios/sgc/</code></p>"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>ABC10</code> - Plano de contas - <code>EBB05</code> - Lan\u00e7amentos cont\u00e1beis - <code>EBB02</code> - Saldos cont\u00e1beis - <code>EBA40</code> - Livros cont\u00e1beis - <code>AAC10</code> - Empresas/Filiais</p> <p>Entidades Envolvidas: - <code>Abc10</code> - Contas cont\u00e1beis - <code>Ebb05</code> - Lan\u00e7amentos - <code>Ebb02</code> - Saldos mensais - <code>Eba40</code> - Controle de livros - <code>Aac10</code> - Empresas</p>"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis imprimir Integer Sim Tipo de impress\u00e3o 0-Livro Raz\u00e3o, 1-Termo Abertura, 2-Termo Encerramento dataInicial LocalDate Sim Data inicial do per\u00edodo dd/MM/yyyy dataFinal LocalDate Sim Data final do per\u00edodo dd/MM/yyyy contaContabilInicial String N\u00e3o Conta cont\u00e1bil inicial C\u00f3digo da conta contaContabilFinal String N\u00e3o Conta cont\u00e1bil final C\u00f3digo da conta rascunho Boolean Sim Modo rascunho true/false ctaComMovimento Boolean Sim Apenas contas com movimento true/false"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#tipos-de-impressao","title":"\ud83d\udccb Tipos de Impress\u00e3o","text":""},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#livro-razao-0","title":"Livro Raz\u00e3o (0)","text":"<ul> <li>Lan\u00e7amentos detalhados por conta</li> <li>Saldos anteriores e atuais</li> <li>Movimenta\u00e7\u00f5es a d\u00e9bito e cr\u00e9dito</li> <li>Hist\u00f3rico dos lan\u00e7amentos</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#termo-de-abertura-1","title":"Termo de Abertura (1)","text":"<ul> <li>Documento formal de abertura do livro</li> <li>Identifica\u00e7\u00e3o da empresa</li> <li>Per\u00edodo cont\u00e1bil</li> <li>Assinaturas respons\u00e1veis</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#termo-de-encerramento-2","title":"Termo de Encerramento (2)","text":"<ul> <li>Documento formal de encerramento</li> <li>Confirma\u00e7\u00e3o do per\u00edodo</li> <li>Encerramento para novo livro</li> <li>Assinaturas respons\u00e1veis</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o de Par\u00e2metros</li> <li>Verifica per\u00edodo informado</li> <li>Valida contas cont\u00e1beis selecionadas</li> <li> <p>Confirma configura\u00e7\u00f5es do plano de contas</p> </li> <li> <p>Busca de Dados Cont\u00e1beis</p> </li> <li>Obt\u00e9m saldos anteriores do per\u00edodo</li> <li>Busca lan\u00e7amentos a d\u00e9bito</li> <li>Busca lan\u00e7amentos a cr\u00e9dito</li> <li> <p>Calcula saldos atualizados</p> </li> <li> <p>Processamento do Raz\u00e3o</p> </li> <li>Agrupa lan\u00e7amentos por conta</li> <li>Calcula saldos em tempo real</li> <li> <p>Ordena por c\u00f3digo de conta e data</p> </li> <li> <p>Controle de Livros</p> </li> <li>Verifica exist\u00eancia de livro em aberto</li> <li>Calcula numera\u00e7\u00e3o de p\u00e1ginas</li> <li> <p>Gerencia termos de abertura/encerramento</p> </li> <li> <p>Gera\u00e7\u00e3o do Relat\u00f3rio</p> </li> <li>Aplica formata\u00e7\u00e3o espec\u00edfica</li> <li>Insere quebras de p\u00e1gina por conta</li> <li>Gera PDF final</li> </ol>"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Estrutura do plano de contas deve estar configurada</li> <li>Grau da empresa deve ser definido</li> <li>C\u00f3digos das empresas devem estar atualizados</li> <li>N\u00e3o permite livro em aberto com n\u00famero diferente</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#calculos-contabeis","title":"C\u00e1lculos Cont\u00e1beis","text":"<ul> <li>Saldo Anterior: Saldo do m\u00eas anterior + lan\u00e7amentos do in\u00edcio do m\u00eas</li> <li>D\u00e9bitos: Soma de todos os lan\u00e7amentos a d\u00e9bito</li> <li>Cr\u00e9ditos: Soma de todos os lan\u00e7amentos a cr\u00e9dito  </li> <li>Saldo Atual: Saldo anterior + d\u00e9bitos - cr\u00e9ditos</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#controle-de-livros","title":"Controle de Livros","text":"<ul> <li>Livro deve estar em aberto para novas impress\u00f5es</li> <li>Termo de encerramento gera novo n\u00famero de livro</li> <li>Numera\u00e7\u00e3o de p\u00e1ginas \u00e9 sequencial e controlada</li> </ul>"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#opcoes-de-formatacao","title":"\ud83c\udfa8 Op\u00e7\u00f5es de Formata\u00e7\u00e3o","text":"Configura\u00e7\u00e3o Descri\u00e7\u00e3o Valores Orienta\u00e7\u00e3o Layout da p\u00e1gina 0-Retrato, 1-Paisagem Salto Quebra por conta 0-Linhas, 1-P\u00e1gina Rascunho Modo n\u00e3o oficial true/false"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Par\u00e2metros do Sistema: - <code>GRAUEMPRESA</code> - Grau da empresa no plano - <code>ESTRCODCONTA</code> - Estrutura do c\u00f3digo de conta - <code>EMPRATUALIZADAS</code> - C\u00f3digos das empresas atualizadas - <code>EB_ATUALIZARCTAS</code> - Indicador de atualiza\u00e7\u00e3o</p> <p>Bibliotecas: - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios - <code>multiorm</code> - Acesso a dados - <code>java.time</code> - Manipula\u00e7\u00e3o de datas</p>"},{"location":"ELTECH/relatorios/sgc/SGC_LivroRazao/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Suporte a m\u00faltiplas empresas no mesmo plano</li> <li>C\u00e1lculo preciso de saldos considerando per\u00edodos parciais</li> <li>Controle rigoroso de numera\u00e7\u00e3o de livros e p\u00e1ginas</li> <li>Op\u00e7\u00e3o de emitir apenas contas com movimento</li> <li>Formata\u00e7\u00e3o profissional para documentos cont\u00e1beis</li> <li>Integra\u00e7\u00e3o com sistema de livros fiscais</li> <li>Valida\u00e7\u00f5es de consist\u00eancia dos dados cont\u00e1beis</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/","title":"SGT_ApuracaoICMSP9.md","text":""},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de gera\u00e7\u00e3o do Livro de Apura\u00e7\u00e3o do ICMS (P9) para a Linhasita, respons\u00e1vel pela apura\u00e7\u00e3o e registro dos valores de ICMS e ICMS-ST no per\u00edodo.</p>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer relat\u00f3rio completo de apura\u00e7\u00e3o do ICMS conforme exig\u00eancias fiscais, incluindo c\u00e1lculos de d\u00e9bitos, cr\u00e9ditos e saldos a recolher ou compensar.</p>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Controladoria</li> <li>Auditores fiscais</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - Template Jasper <code>SGT_ApuracaoICMSP9_R2</code> - Layout ICMS - Template Jasper <code>SGT_ApuracaoICMSP9_R3</code> - Layout ICMS-ST - Template Jasper <code>SGT_ApuracaoICMSP9_R1</code> - Termos de abertura/encerramento - M\u00faltiplos sub-relat\u00f3rios para se\u00e7\u00f5es espec\u00edficas</p> <p>Localiza\u00e7\u00e3o: <code>eltech/relatorios/sgt/</code></p>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos fiscais - <code>EAA0103</code> - Itens de documentos - <code>EDB01</code> - Apura\u00e7\u00f5es fiscais - <code>EDB0101</code> - Ocorr\u00eancias da apura\u00e7\u00e3o - <code>EDD10</code> - Livros fiscais - <code>AAJ15</code> - CFOPs - <code>AAG02</code> - Estados/UF</p> <p>Entidades Envolvidas: - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens fiscais - <code>Edb01</code> - Apura\u00e7\u00e3o principal - <code>Edb0101</code> - Detalhes da apura\u00e7\u00e3o - <code>Edd10</code> - Controle de livros</p>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis imprimir Integer Sim Tipo de impress\u00e3o 0-Livro, 1-Termo Abertura, 2-Termo Encerramento referencia String Sim Per\u00edodo de refer\u00eancia MM/aaaa modelo Integer Sim Tipo de apura\u00e7\u00e3o 0-ICMS, 1-ICMS-ST estados List N\u00e3o Estados para filtro IDs dos estados apuracao Long N\u00e3o Tipo de apura\u00e7\u00e3o espec\u00edfica ID do tipo rascunho Boolean Sim Modo rascunho true/false"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#tipos-de-apuracao","title":"\ud83d\udccb Tipos de Apura\u00e7\u00e3o","text":""},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#icms-0","title":"ICMS (0)","text":"<ul> <li>Apura\u00e7\u00e3o normal do ICMS</li> <li>Entradas e sa\u00eddas por CFOP</li> <li>C\u00e1lculo de d\u00e9bitos e cr\u00e9ditos</li> <li>Saldo a recolher ou compensar</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#icms-st-1","title":"ICMS-ST (1)","text":"<ul> <li>Apura\u00e7\u00e3o do ICMS Substitui\u00e7\u00e3o Tribut\u00e1ria</li> <li>Filtro por estados espec\u00edficos</li> <li>C\u00e1lculos espec\u00edficos para ST</li> <li>Diferencia\u00e7\u00e3o por UF</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o de Par\u00e2metros</li> <li>Verifica per\u00edodo de refer\u00eancia</li> <li>Valida tipo de apura\u00e7\u00e3o selecionado</li> <li> <p>Confirma exist\u00eancia de dados fiscais</p> </li> <li> <p>Busca de Dados Fiscais</p> </li> <li>Lan\u00e7amentos agrupados por CFOP</li> <li>C\u00e1lculos de bases e valores de ICMS</li> <li> <p>Dados de entradas e sa\u00eddas</p> </li> <li> <p>Processamento da Apura\u00e7\u00e3o</p> </li> <li>C\u00e1lculo de d\u00e9bitos e cr\u00e9ditos</li> <li>Aplica\u00e7\u00e3o de estornos e dedu\u00e7\u00f5es</li> <li> <p>C\u00e1lculo do saldo final</p> </li> <li> <p>Composi\u00e7\u00e3o do Relat\u00f3rio</p> </li> <li>M\u00faltiplos sub-relat\u00f3rios especializados</li> <li>Agrupamento por UF (ICMS-ST)</li> <li> <p>Formata\u00e7\u00e3o fiscal espec\u00edfica</p> </li> <li> <p>Controle de Livros</p> </li> <li>Numera\u00e7\u00e3o sequencial de livros</li> <li>Termos de abertura e encerramento</li> <li>Controle de p\u00e1ginas</li> </ol>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Per\u00edodo deve ser v\u00e1lido e consistente</li> <li>Dados fiscais devem estar integrados</li> <li>Livro n\u00e3o pode estar encerrado para novas apura\u00e7\u00f5es</li> <li>Estados devem estar cadastrados para ICMS-ST</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#calculos-fiscais","title":"C\u00e1lculos Fiscais","text":"<ul> <li>Base de C\u00e1lculo: Soma das bases de ICMS dos lan\u00e7amentos</li> <li>Valor do ICMS: Soma dos valores de ICMS</li> <li>D\u00e9bitos/Cr\u00e9ditos: C\u00e1lculo conforme regras fiscais</li> <li>Saldo Final: D\u00e9bitos - Cr\u00e9ditos - Dedu\u00e7\u00f5es</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#campos-de-alinhamento","title":"Campos de Alinhamento","text":"<ul> <li>Configura\u00e7\u00e3o espec\u00edfica para campos JSON</li> <li>Mapeamento de campos fiscais padronizados</li> <li>Suporte a m\u00faltiplos tipos de apura\u00e7\u00e3o</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#estrutura-do-relatorio","title":"\ud83c\udfa8 Estrutura do Relat\u00f3rio","text":""},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#secao-1-dados-da-empresa","title":"Se\u00e7\u00e3o 1 - Dados da Empresa","text":"<ul> <li>Raz\u00e3o social e CNPJ</li> <li>Inscri\u00e7\u00e3o Estadual</li> <li>Per\u00edodo de apura\u00e7\u00e3o</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#secao-2-lancamentos-por-cfop","title":"Se\u00e7\u00e3o 2 - Lan\u00e7amentos por CFOP","text":"<ul> <li>Agrupamento por grupo de CFOP (1.x, 2.x, 3.x, 5.x, 6.x, 7.x)</li> <li>Valores cont\u00e1beis e fiscais</li> <li>Bases e valores de ICMS</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#secao-3-apuracao-do-icms","title":"Se\u00e7\u00e3o 3 - Apura\u00e7\u00e3o do ICMS","text":"<ul> <li>D\u00e9bitos e cr\u00e9ditos do per\u00edodo</li> <li>Estornos e compensa\u00e7\u00f5es</li> <li>Saldo a recolher</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#secao-4-ocorrencias","title":"Se\u00e7\u00e3o 4 - Ocorr\u00eancias","text":"<ul> <li>Detalhamento por tipo de ocorr\u00eancia</li> <li>Valores espec\u00edficos por subitem</li> <li>Observa\u00e7\u00f5es fiscais</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Par\u00e2metros de Alinhamento: - <code>0040</code> - Apura\u00e7\u00e3o LF ICMS - <code>0082</code> - Resumo de Apura\u00e7\u00e3o ICMS P9</p> <p>Bibliotecas: - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios - <code>multiorm</code> - Acesso a dados - <code>java.time</code> - Manipula\u00e7\u00e3o de datas</p>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoICMSP9/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Suporte a m\u00faltiplos sub-relat\u00f3rios especializados</li> <li>C\u00e1lculos fiscais precisos baseados em JSON fields</li> <li>Controle rigoroso de livros fiscais</li> <li>Formata\u00e7\u00e3o espec\u00edfica para cada tipo de apura\u00e7\u00e3o</li> <li>Integra\u00e7\u00e3o com sistema de alinhamento de campos</li> <li>Valida\u00e7\u00f5es de consist\u00eancia dos dados fiscais</li> <li>Suporte a filtros por UF para ICMS-ST</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/","title":"SGT_ApuracaoIPIP8.md","text":""},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de gera\u00e7\u00e3o do Livro de Apura\u00e7\u00e3o do IPI (P8) para a Linhasita, respons\u00e1vel pela apura\u00e7\u00e3o e registro dos valores de IPI no per\u00edodo.</p>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer relat\u00f3rio completo de apura\u00e7\u00e3o do IPI conforme exig\u00eancias fiscais, incluindo c\u00e1lculos de d\u00e9bitos, cr\u00e9ditos e saldos a recolher ou compensar.</p>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Controladoria</li> <li>Auditores fiscais</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - Template Jasper <code>SGT_ApuracaoIPIP8_R2</code> - Layout principal do IPI - Template Jasper <code>SGT_ApuracaoIPIP8_R1</code> - Termos de abertura/encerramento - M\u00faltiplos sub-relat\u00f3rios para se\u00e7\u00f5es espec\u00edficas</p> <p>Localiza\u00e7\u00e3o: <code>eltech/relatorios/sgt/</code></p>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos fiscais - <code>EAA0103</code> - Itens de documentos - <code>EDB01</code> - Apura\u00e7\u00f5es fiscais - <code>EDB0101</code> - Ocorr\u00eancias da apura\u00e7\u00e3o - <code>EDD10</code> - Livros fiscais - <code>AAJ15</code> - CFOPs</p> <p>Entidades Envolvidas: - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens fiscais - <code>Edb01</code> - Apura\u00e7\u00e3o principal - <code>Edb0101</code> - Detalhes da apura\u00e7\u00e3o - <code>Edd10</code> - Controle de livros</p>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis imprimir Integer Sim Tipo de impress\u00e3o 0-Livro, 1-Termo Abertura, 2-Termo Encerramento referencia String Sim Per\u00edodo de refer\u00eancia MM/aaaa apuracao Long N\u00e3o Tipo de apura\u00e7\u00e3o espec\u00edfica ID do tipo rascunho Boolean Sim Modo rascunho true/false"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#estrutura-do-relatorio","title":"\ud83d\udccb Estrutura do Relat\u00f3rio","text":""},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#secao-1-dados-da-empresa","title":"Se\u00e7\u00e3o 1 - Dados da Empresa","text":"<ul> <li>Raz\u00e3o social e CNPJ</li> <li>Inscri\u00e7\u00e3o Estadual</li> <li>Per\u00edodo de apura\u00e7\u00e3o</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#secao-2-lancamentos-por-cfop-entradas","title":"Se\u00e7\u00e3o 2 - Lan\u00e7amentos por CFOP (Entradas)","text":"<ul> <li>Agrupamento por grupo de CFOP (1.x, 2.x, 3.x)</li> <li>Valores cont\u00e1beis e fiscais</li> <li>Bases e valores de IPI</li> <li>Isen\u00e7\u00f5es e outras situa\u00e7\u00f5es</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#secao-3-lancamentos-por-cfop-saidas","title":"Se\u00e7\u00e3o 3 - Lan\u00e7amentos por CFOP (Sa\u00eddas)","text":"<ul> <li>Agrupamento por grupo de CFOP (5.x, 6.x, 7.x)</li> <li>Valores cont\u00e1beis e fiscais</li> <li>Bases e valores de IPI</li> <li>Isen\u00e7\u00f5es e outras situa\u00e7\u00f5es</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#secao-4-apuracao-do-ipi","title":"Se\u00e7\u00e3o 4 - Apura\u00e7\u00e3o do IPI","text":"<ul> <li>D\u00e9bitos e cr\u00e9ditos do per\u00edodo</li> <li>Estornos e compensa\u00e7\u00f5es</li> <li>Cr\u00e9ditos anteriores</li> <li>Dedu\u00e7\u00f5es aplic\u00e1veis</li> <li>Saldo a recolher</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#secao-5-ocorrencias","title":"Se\u00e7\u00e3o 5 - Ocorr\u00eancias","text":"<ul> <li>Detalhamento por tipo de ocorr\u00eancia</li> <li>Valores espec\u00edficos por subitem</li> <li>Observa\u00e7\u00f5es fiscais</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o de Par\u00e2metros</li> <li>Verifica per\u00edodo de refer\u00eancia</li> <li>Valida tipo de apura\u00e7\u00e3o selecionado</li> <li> <p>Confirma exist\u00eancia de dados fiscais</p> </li> <li> <p>Busca de Dados Fiscais</p> </li> <li>Lan\u00e7amentos agrupados por CFOP</li> <li>C\u00e1lculos de bases e valores de IPI</li> <li> <p>Dados de entradas e sa\u00eddas</p> </li> <li> <p>Processamento da Apura\u00e7\u00e3o</p> </li> <li>C\u00e1lculo de d\u00e9bitos e cr\u00e9ditos</li> <li>Aplica\u00e7\u00e3o de estornos e dedu\u00e7\u00f5es</li> <li> <p>C\u00e1lculo do saldo final</p> </li> <li> <p>Composi\u00e7\u00e3o do Relat\u00f3rio</p> </li> <li>M\u00faltiplos sub-relat\u00f3rios especializados</li> <li> <p>Formata\u00e7\u00e3o fiscal espec\u00edfica para IPI</p> </li> <li> <p>Controle de Livros</p> </li> <li>Numera\u00e7\u00e3o sequencial de livros</li> <li>Termos de abertura e encerramento</li> <li>Controle de p\u00e1ginas</li> </ol>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Per\u00edodo deve ser v\u00e1lido e consistente</li> <li>Dados fiscais devem estar integrados</li> <li>Livro n\u00e3o pode estar encerrado para novas apura\u00e7\u00f5es</li> <li>Documentos cancelados s\u00e3o exclu\u00eddos</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#calculos-fiscais","title":"C\u00e1lculos Fiscais","text":"<ul> <li>Base de C\u00e1lculo: Soma das bases de IPI dos lan\u00e7amentos</li> <li>Valor do IPI: Soma dos valores de IPI</li> <li>D\u00e9bitos/Cr\u00e9ditos: C\u00e1lculo conforme regras fiscais</li> <li>Saldo Final: D\u00e9bitos - Cr\u00e9ditos - Dedu\u00e7\u00f5es</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#campos-de-alinhamento","title":"Campos de Alinhamento","text":"<ul> <li>0040 - Apura\u00e7\u00e3o LF ICMS/IPI (campos gerais)</li> <li>0083 - Resumo de Apura\u00e7\u00e3o IPI P8 (campos espec\u00edficos)</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#sub-relatorios-especializados","title":"\ud83c\udfa8 Sub-relat\u00f3rios Especializados","text":"Sub-relat\u00f3rio Descri\u00e7\u00e3o R2S1 Lan\u00e7amentos de entrada por CFOP R2S2 Lan\u00e7amentos de sa\u00edda por CFOP R2S3 Apura\u00e7\u00e3o principal do IPI R2S3S1-R2S3S5 Ocorr\u00eancias detalhadas por tipo R2S4 Resumo final da apura\u00e7\u00e3o"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Par\u00e2metros de Alinhamento: - <code>0040</code> - Apura\u00e7\u00e3o LF ICMS/IPI - <code>0083</code> - Resumo de Apura\u00e7\u00e3o IPI P8</p> <p>Bibliotecas: - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios - <code>multiorm</code> - Acesso a dados - <code>java.time</code> - Manipula\u00e7\u00e3o de datas</p>"},{"location":"ELTECH/relatorios/sgt/SGT_ApuracaoIPIP8/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Suporte a m\u00faltiplos sub-relat\u00f3rios especializados</li> <li>C\u00e1lculos fiscais precisos baseados em JSON fields</li> <li>Controle rigoroso de livros fiscais (P8)</li> <li>Formata\u00e7\u00e3o espec\u00edfica para apura\u00e7\u00e3o de IPI</li> <li>Integra\u00e7\u00e3o com sistema de alinhamento de campos</li> <li>Valida\u00e7\u00f5es de consist\u00eancia dos dados fiscais</li> <li>Suporte a termos de abertura e encerramento</li> <li>Modo rascunho para testes e verifica\u00e7\u00f5es</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/","title":"SGT_LivroSaidasP2P2A.md","text":""},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de gera\u00e7\u00e3o do Livro de Sa\u00eddas (P2/P2A) para a Linhasita, respons\u00e1vel pelo registro fiscal de todas as opera\u00e7\u00f5es de sa\u00edda no per\u00edodo.</p>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer relat\u00f3rio completo de sa\u00eddas fiscais conforme exig\u00eancias legais, incluindo dados de ICMS, IPI e demais tributos incidentes nas opera\u00e7\u00f5es.</p>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Controladoria</li> <li>Auditores fiscais</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - Template Jasper <code>SGT_LivroSaidasP2P2A_R2</code> - Layout P2 (sem IPI) - Template Jasper <code>SGT_LivroSaidasP2P2A_R3</code> - Layout P2A (com IPI) - Template Jasper <code>SGT_LivroSaidasP2P2A_R1</code> - Termos de abertura/encerramento - M\u00faltiplos sub-relat\u00f3rios para demonstra\u00e7\u00f5es e resumos</p> <p>Localiza\u00e7\u00e3o: <code>eltech/relatorios/sgt/</code></p>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos fiscais - <code>EAA0103</code> - Itens de documentos - <code>ABB01</code> - Cabe\u00e7alho de documentos - <code>AAJ15</code> - CFOPs - <code>EAA0102</code> - Dados gerais do documento - <code>EAA0101</code> - Endere\u00e7os - <code>AAG02</code> - Estados/UF - <code>EDD10</code> - Livros fiscais</p> <p>Entidades Envolvidas: - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens fiscais - <code>Abb01</code> - Cabe\u00e7alho documentos - <code>Eaa0102</code> - Dados do destinat\u00e1rio - <code>Edd10</code> - Controle de livros</p>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis imprimir Integer Sim Tipo de impress\u00e3o 0-Livro, 1-Termo Abertura, 2-Termo Encerramento dataInicial LocalDate Sim Data inicial do per\u00edodo dd/MM/yyyy dataFinal LocalDate Sim Data final do per\u00edodo dd/MM/yyyy modelo Integer Sim Modelo do livro 0-P2, 1-P2A consEntNosDocDeSaida Boolean Sim Considerar entradas em docs de sa\u00edda true/false rascunho Boolean Sim Modo rascunho true/false resumo Boolean Sim Exibir resumo por CFOP e al\u00edquota true/false"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#modelos-do-livro","title":"\ud83d\udccb Modelos do Livro","text":""},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#p2-0","title":"P2 (0)","text":"<ul> <li>Livro de Sa\u00eddas sem IPI</li> <li>Foco nas opera\u00e7\u00f5es de ICMS</li> <li>Demonstra\u00e7\u00f5es por estado e CFOP</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#p2a-1","title":"P2A (1)","text":"<ul> <li>Livro de Sa\u00eddas com IPI</li> <li>Inclui dados de IPI al\u00e9m do ICMS</li> <li>Formata\u00e7\u00e3o espec\u00edfica para ind\u00fastria</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o de Par\u00e2metros</li> <li>Verifica per\u00edodo informado</li> <li>Valida modelo selecionado</li> <li> <p>Confirma configura\u00e7\u00f5es fiscais</p> </li> <li> <p>Busca de Dados Fiscais</p> </li> <li>Documentos de sa\u00edda no per\u00edodo</li> <li>Itens fiscais com tributos</li> <li> <p>Dados de destinat\u00e1rios e CFOPs</p> </li> <li> <p>Processamento dos Dados</p> </li> <li>Agrupamento por diversos crit\u00e9rios</li> <li>C\u00e1lculos de bases e valores tribut\u00e1rios</li> <li> <p>Formata\u00e7\u00e3o espec\u00edfica por modelo</p> </li> <li> <p>Composi\u00e7\u00e3o do Relat\u00f3rio</p> </li> <li>Dados principais dos documentos</li> <li>Demonstra\u00e7\u00f5es por estado (contribuintes/n\u00e3o contribuintes)</li> <li>Resumos por CFOP e al\u00edquotas</li> <li> <p>Sub-relat\u00f3rios especializados</p> </li> <li> <p>Controle de Livros</p> </li> <li>Numera\u00e7\u00e3o sequencial</li> <li>Termos de abertura e encerramento</li> <li>Controle de p\u00e1ginas</li> </ol>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Per\u00edodo deve ser v\u00e1lido e consistente</li> <li>Documentos cancelados t\u00eam valores zerados</li> <li>Apenas documentos fiscais integrados</li> <li>Livro n\u00e3o pode estar encerrado</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#calculos-fiscais","title":"C\u00e1lculos Fiscais","text":"<ul> <li>Valor Cont\u00e1bil: Soma dos totais dos itens</li> <li>Base ICMS: Soma das bases de c\u00e1lculo</li> <li>Valor ICMS: Soma dos valores do imposto</li> <li>Base IPI: Soma das bases de IPI (P2A)</li> <li>Valor IPI: Soma dos valores de IPI (P2A)</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#campos-de-alinhamento","title":"Campos de Alinhamento","text":"<ul> <li>Configura\u00e7\u00e3o espec\u00edfica para campos JSON</li> <li>Mapeamento de campos fiscais padronizados (0080)</li> <li>Suporte a m\u00faltiplos tipos de dados tribut\u00e1rios</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#estrutura-do-relatorio","title":"\ud83c\udfa8 Estrutura do Relat\u00f3rio","text":""},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#secao-principal-documentos-de-saida","title":"Se\u00e7\u00e3o Principal - Documentos de Sa\u00edda","text":"<ul> <li>Data e n\u00famero do documento</li> <li>CFOP e descri\u00e7\u00e3o</li> <li>Destinat\u00e1rio (c\u00f3digo, nome, IE)</li> <li>Valores cont\u00e1beis e fiscais</li> <li>Tributos incidentes</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#sub-relatorios-especializados","title":"Sub-relat\u00f3rios Especializados","text":"<p>R2S1: Demonstrativo por estado - Opera\u00e7\u00f5es com contribuinte R2S4: Demonstrativo por estado - Opera\u00e7\u00f5es com n\u00e3o contribuinte R2S2: Resumo por CFOP R2S3: Resumo por CFOP e al\u00edquota de ICMS</p>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Par\u00e2metros de Alinhamento: - <code>0080</code> - Livro de Sa\u00eddas P2/P2A</p> <p>Bibliotecas: - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios - <code>multiorm</code> - Acesso a dados - <code>java.time</code> - Manipula\u00e7\u00e3o de datas</p>"},{"location":"ELTECH/relatorios/sgt/SGT_LivroSaidasP2P2A/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Suporte a m\u00faltiplos sub-relat\u00f3rios especializados</li> <li>Zeramento autom\u00e1tico de valores para documentos cancelados</li> <li>Controle rigoroso de livros fiscais (P2/P2A)</li> <li>Formata\u00e7\u00e3o espec\u00edfica para cada modelo</li> <li>Integra\u00e7\u00e3o com sistema de alinhamento de campos</li> <li>Valida\u00e7\u00f5es de consist\u00eancia dos dados fiscais</li> <li>Suporte a entradas em documentos de sa\u00edda (opcional)</li> <li>Resumos agrupados por diversos crit\u00e9rios</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_Livro_Entradas_P1-P1A/","title":"SGT - Livro de Entradas P1/P1A","text":""},{"location":"ELTECH/relatorios/sgt/SGT_Livro_Entradas_P1-P1A/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio do livro de entradas fiscais (Modelos P1 e P1A), detalhando notas fiscais de entrada, demonstrativos por estado, resumo por CFOP e al\u00edquota de ICMS. Permite gera\u00e7\u00e3o de termo de abertura e encerramento do livro e suporta rascunho para pr\u00e9-visualiza\u00e7\u00e3o.</p>"},{"location":"ELTECH/relatorios/sgt/SGT_Livro_Entradas_P1-P1A/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer vis\u00e3o detalhada das entradas fiscais da empresa, permitindo controle administrativo e fiscal, com consolida\u00e7\u00e3o por estado, CFOP e al\u00edquota de ICMS.</p>"},{"location":"ELTECH/relatorios/sgt/SGT_Livro_Entradas_P1-P1A/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Controladoria</li> <li>Departamento Fiscal</li> <li>Auditoria Interna</li> <li>Gest\u00e3o Financeira</li> <li>Diretoria Administrativa</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_Livro_Entradas_P1-P1A/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis empresaId Long Sim ID da empresa Inteiro dataIni LocalDate Sim Data inicial do per\u00edodo yyyy-MM-dd dataFim LocalDate Sim Data final do per\u00edodo yyyy-MM-dd livroNum Integer N\u00e3o N\u00famero do livro Inteiro livroPag Integer N\u00e3o N\u00famero da p\u00e1gina inicial Inteiro modelo Integer Sim Modelo do livro 0=P1, 1=P1A imprimir Integer Sim Tipo de impress\u00e3o 0=Livro, 1=Termo abertura, 2=Termo encerramento rascunho Boolean N\u00e3o Indica rascunho true/false comIPI Boolean N\u00e3o Inclui valores de IPI true/false"},{"location":"ELTECH/relatorios/sgt/SGT_Livro_Entradas_P1-P1A/#campos-do-relatorio","title":"\ud83d\udccb Campos do Relat\u00f3rio","text":"Campo Descri\u00e7\u00e3o Tipo obs Observa\u00e7\u00f5es da nota fiscal String aliqIcms Al\u00edquota de ICMS BigDecimal bcIcms Base de c\u00e1lculo do ICMS BigDecimal icms Valor do ICMS BigDecimal isentasIcms Valor de ICMS isento BigDecimal outrasIcms Outras situa\u00e7\u00f5es de ICMS BigDecimal bcIpi Base de c\u00e1lculo do IPI BigDecimal ipi Valor do IPI BigDecimal isentasIpi Valor de IPI isento BigDecimal outrasIpi Outras situa\u00e7\u00f5es de IPI BigDecimal vlrGia Valor GIA BigDecimal icmsST ICMS Substitui\u00e7\u00e3o Tribut\u00e1ria BigDecimal estado UF da nota fiscal String cfop C\u00f3digo Fiscal de Opera\u00e7\u00f5es e Presta\u00e7\u00f5es String"},{"location":"ELTECH/relatorios/sgt/SGT_Livro_Entradas_P1-P1A/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Carrega par\u00e2metros do relat\u00f3rio e define per\u00edodo e modelo.</li> <li>Inicializa listas e totais.</li> <li>Busca notas fiscais de entrada conforme filtros.</li> <li>Agrupa dados por estado, CFOP e al\u00edquota de ICMS.</li> <li>Calcula totais, subtotais e valores de IPI se aplic\u00e1vel.</li> <li>Se <code>imprimir != 0</code>, gera termo de abertura ou encerramento.</li> <li>Monta <code>TableMapDataSource</code> para JasperReports.</li> <li>Gera PDF final do relat\u00f3rio.</li> <li>Atualiza dados do livro no sistema caso n\u00e3o seja rascunho.</li> </ol>"},{"location":"ELTECH/relatorios/sgt/SGT_Livro_Entradas_P1-P1A/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":"<ul> <li>Agrupamento por estado, CFOP e al\u00edquota de ICMS.</li> <li>Inclus\u00e3o de IPI \u00e9 opcional (<code>comIPI</code>).</li> <li>Termos de abertura e encerramento seguem regras legais fiscais.</li> <li>Rascunho n\u00e3o grava dados do livro no sistema.</li> <li>Campos de notas canceladas t\u00eam valores zerados.</li> <li>N\u00famero do livro \u00e9 sequencial, evitando duplicidade.</li> </ul>"},{"location":"ELTECH/relatorios/sgt/SGT_Livro_Entradas_P1-P1A/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Formato Descri\u00e7\u00e3o PDF Relat\u00f3rio pronto para impress\u00e3o"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/","title":"SRF \u2013 Resumo Anual Faturamento por Entidade","text":""},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio anual consolidado de faturamento por entidade (cliente), trazendo valores brutos e l\u00edquidos por m\u00eas, com tratamento de devolu\u00e7\u00f5es, agrupamento de entidades por c\u00f3digo e filtros corporativos para an\u00e1lise gerencial.</p>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer vis\u00e3o anual do faturamento bruto e l\u00edquido de cada entidade, m\u00eas a m\u00eas, permitindo \u00e0 gest\u00e3o analisar evolu\u00e7\u00e3o, sazonalidade e impacto de devolu\u00e7\u00f5es por cliente.</p>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Controladoria</li> <li>Departamento Fiscal</li> <li>Gest\u00e3o Comercial</li> <li>Diretoria / Ger\u00eancia Administrativa</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":""},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#tabelas-principais","title":"Tabelas Principais","text":"<ul> <li><code>EAA01</code> \u2014 Documentos fiscais</li> <li><code>EAA0103</code> \u2014 Itens de documentos</li> <li><code>EAA01033</code> \u2014 Relacionamento de devolu\u00e7\u00f5es</li> <li><code>ABB01</code> \u2014 Cabe\u00e7alho do documento</li> <li><code>ABB10</code> \u2014 Opera\u00e7\u00f5es comerciais</li> <li><code>ABE01</code> \u2014 Entidades (clientes, representantes)</li> <li><code>AAC10</code> \u2014 Empresas</li> <li><code>AAJ15</code> \u2014 CFOP</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#entidades-envolvidas","title":"Entidades Envolvidas","text":"<ul> <li><code>Abe01</code> \u2014 Clientes e representantes</li> <li><code>Aac10</code> \u2014 Empresa</li> <li><code>Eaa01 / Eaa0103</code> \u2014 Documentos e itens de faturamento</li> <li><code>Eaa01033</code> \u2014 Itens de devolu\u00e7\u00e3o vinculados</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis faturamento Integer N\u00e3o Tipo de opera\u00e7\u00e3o (n\u00e3o utilizado diretamente) 0 / 1 valorRelatorio Integer Sim Define se relat\u00f3rio soma quantidade ou valor 0=Quantidade, 1=Total documento anoRef String Sim Ano de refer\u00eancia do relat\u00f3rio AAAA dtIni String Autom\u00e1tico M\u00eas/ano inicial \"MM/yyyy\" dtFim String Autom\u00e1tico M\u00eas/ano final \"MM/yyyy\" impressao Integer Sim Formato de sa\u00edda 0=PDF, 1=XLSX entidade List N\u00e3o IDs de entidades (clientes) Lista de IDs tipoDoc List N\u00e3o Tipos de documento Lista de IDs numero Integer N\u00e3o N\u00famero de documento Inteiro pcd List N\u00e3o Crit\u00e9rios PCD Lista representantes List N\u00e3o Representantes vinculados Lista empresas List N\u00e3o Empresas Lista liquido Boolean N\u00e3o Define se mostra apenas o valor l\u00edquido true/false"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#campos-do-relatorio","title":"\ud83d\udccb Campos do Relat\u00f3rio","text":"Campo Descri\u00e7\u00e3o Tipo codcli C\u00f3digo da entidade (cliente) String nomecli Nome da entidade String Janeiro\u2026Dezembro Valor bruto e l\u00edquido do m\u00eas BigDecimal totalbruto Soma anual do valor bruto BigDecimal totalliquido Soma anual do valor l\u00edquido BigDecimal"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#1-carregamento-de-parametros-e-ano-de-referencia","title":"1. Carregamento de Par\u00e2metros e Ano de Refer\u00eancia","text":"<ul> <li>Prepara datas de in\u00edcio e fim do ano.</li> <li>Obt\u00e9m nome(s) das empresas para exibi\u00e7\u00e3o.</li> <li>Define se relat\u00f3rio usa quantidade ou valor.</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#2-processamento-de-agrupamentos-de-entidades","title":"2. Processamento de Agrupamentos de Entidades","text":"<ul> <li>Identifica c\u00f3digos com 2 d\u00edgitos (agrupadores).</li> <li>Expande para incluir entidades com in\u00edcio igual ao grupo.</li> <li>Retorna IDs finais para inclus\u00e3o no filtro do SQL.</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#3-busca-de-faturamento","title":"3. Busca de Faturamento","text":"<ul> <li>Aplica filtros de per\u00edodo, empresas, clientes e representantes.</li> <li>Somente documentos de sa\u00edda v\u00e1lidos entram no c\u00e1lculo:<ul> <li>SRF (<code>eaa01clasDoc = 1</code>)</li> <li>Sa\u00edda (<code>eaa01esMov = 1</code>)</li> <li>Emiss\u00e3o pr\u00f3pria</li> <li>N\u00e3o cancelados</li> <li><code>abb10tipoCod IN (1,6)</code></li> </ul> </li> <li>CFOP terminando em 124 recebe tratamento especial.</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#4-tratamento-de-devolucoes","title":"4. Tratamento de Devolu\u00e7\u00f5es","text":"<ul> <li>Identifica devolu\u00e7\u00f5es atrav\u00e9s de <code>EAA01033</code>.</li> <li>Soma valores devolvidos por m\u00eas.</li> <li>Subtrai do faturamento bruto para obter o l\u00edquido.</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#5-consolidacao-mensal-por-entidade","title":"5. Consolida\u00e7\u00e3o Mensal por Entidade","text":"<ul> <li>Cria acumuladores <code>TableMap</code> por cliente.</li> <li>Preenche os meses: Janeiro, Fevereiro, ..., Dezembro.</li> <li>Calcula totais anuais bruto e l\u00edquido.</li> <li>Mant\u00e9m ordena\u00e7\u00e3o por c\u00f3digo da entidade.</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#6-geracao-da-saida","title":"6. Gera\u00e7\u00e3o da Sa\u00edda","text":"<ul> <li>Se <code>impressao = 1</code>: gera XLSX.</li> <li>Caso contr\u00e1rio: gera PDF.</li> <li>Envia dataset consolidado ao Jasper.</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#agrupamento-de-entidades","title":"Agrupamento de Entidades","text":"<ul> <li>C\u00f3digos com 2 caracteres s\u00e3o agrupadores.</li> <li>Entidades com c\u00f3digo iniciando nesses 2 caracteres s\u00e3o inclu\u00eddas.</li> <li>Usuario n\u00e3o precisa informar todas as entidades individualmente.</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#selecao-de-valores-valorrelatorio","title":"Sele\u00e7\u00e3o de Valores (valorRelatorio)","text":"<ul> <li>0 \u2192 Soma quantidade comercial (<code>eaa0103qtComl</code>)</li> <li>1 \u2192 Soma total do item (<code>eaa0103total</code>)</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#filtros-de-faturamento","title":"Filtros de Faturamento","text":"<p>Aceita apenas documentos com: - <code>eaa01clasDoc = 1</code> - <code>eaa01esMov = 1</code> - <code>eaa01emissao = 1</code> - <code>abb10tipoCod IN (1,6)</code> - N\u00e3o cancelados - Itens CFOP <code>%124</code> sempre inclu\u00eddos</p>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#devolucoes","title":"Devolu\u00e7\u00f5es","text":"<ul> <li><code>aaj03codigo = '09'</code></li> <li><code>abb10tipocod = 4</code></li> <li>Somente devolu\u00e7\u00f5es dentro do per\u00edodo</li> <li>Vincula\u00e7\u00e3o item a item via <code>EAA01033</code></li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#consolidacao","title":"Consolida\u00e7\u00e3o","text":"<ul> <li>Agrupamento final por cliente.</li> <li>Soma de valores mensais e totais.</li> <li>Mant\u00e9m meses como chave textual via <code>verificaMes()</code>.</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Formato Descri\u00e7\u00e3o M\u00e9todo PDF Relat\u00f3rio para impress\u00e3o <code>gerarPDF()</code> XLSX Planilha anal\u00edtica com meses <code>gerarXLSX()</code>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":""},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#bibliotecas","title":"Bibliotecas","text":"<ul> <li><code>multitec.utils</code> \u2014 Datas e utilit\u00e1rios</li> <li><code>TableMap</code> \u2014 Estrutura de dados</li> <li><code>jasperreports</code> \u2014 Engine de relat\u00f3rios</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#configuracoes","title":"Configura\u00e7\u00f5es","text":"<ul> <li>Template Jasper dedicado</li> <li>Par\u00e2metros de header (ano, empresa, per\u00edodo)</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoEntidade/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Relat\u00f3rio sempre cobre janeiro a dezembro do ano informado.</li> <li>Preenchimento de m\u00eas feito por <code>verificaMes()</code>.</li> <li>C\u00e1lculo e agrupamento feitos em mem\u00f3ria (Java/Groovy).</li> <li>SQL separado para faturamento e devolu\u00e7\u00f5es.</li> <li>Usa fun\u00e7\u00f5es SQL como <code>string_agg</code>, <code>extract(month)</code>, <code>like any</code>.</li> <li>CFOP <code>%124</code> possui l\u00f3gica especial no somat\u00f3rio.</li> <li>Exporta\u00e7\u00e3o depende de <code>impressao</code>:<ul> <li><code>0</code> \u2192 PDF</li> <li><code>1</code> \u2192 XLSX</li> </ul> </li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoItem/","title":"SRF \u2013 Resumo Anual Faturamento por Item","text":""},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoItem/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio anual consolidado de faturamento por item, mostrando valores brutos e l\u00edquidos por m\u00eas, com tratamento de devolu\u00e7\u00f5es, agrupamento de itens por c\u00f3digo e filtros corporativos.</p>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoItem/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer vis\u00e3o anual do faturamento bruto e l\u00edquido por item, m\u00eas a m\u00eas, permitindo \u00e0 gest\u00e3o analisar evolu\u00e7\u00e3o, sazonalidade e impacto de devolu\u00e7\u00f5es.</p>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoItem/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Controladoria</li> <li>Departamento Fiscal</li> <li>Gest\u00e3o Comercial</li> <li>Diretoria / Ger\u00eancia Administrativa</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoItem/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis faturamento Integer N\u00e3o Tipo de opera\u00e7\u00e3o 0 / 1 valorRelatorio Integer Sim Soma quantidade ou valor 0=Quantidade, 1=Total documento anoRef String Sim Ano de refer\u00eancia AAAA dtIni String Autom\u00e1tico M\u00eas/ano inicial MM/yyyy dtFim String Autom\u00e1tico M\u00eas/ano final MM/yyyy impressao Integer Sim Formato de sa\u00edda 0=PDF, 1=XLSX itens List N\u00e3o IDs de itens Lista de IDs tipoDoc List N\u00e3o Tipos de documento Lista de IDs numero Integer N\u00e3o N\u00famero de documento Inteiro pcd List N\u00e3o Crit\u00e9rios PCD Lista representantes List N\u00e3o Representantes vinculados Lista empresas List N\u00e3o Empresas Lista liquido Boolean N\u00e3o Apenas valor l\u00edquido true/false"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoItem/#campos-do-relatorio","title":"\ud83d\udccb Campos do Relat\u00f3rio","text":"Campo Descri\u00e7\u00e3o Tipo abm01codigo C\u00f3digo do item String abm01na Nome do item String Janeiro\u2026Dezembro Valor bruto e l\u00edquido do m\u00eas BigDecimal total Soma anual BigDecimal"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoItem/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Carrega par\u00e2metros e ano de refer\u00eancia.</li> <li>Processa agrupamentos de itens.</li> <li>Busca faturamento bruto ou l\u00edquido conforme par\u00e2metro.</li> <li>Aplica tratamento de devolu\u00e7\u00f5es.</li> <li>Consolida valores por m\u00eas e item.</li> <li>Gera sa\u00edda em PDF ou XLSX.</li> </ol>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoItem/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":"<ul> <li>Agrupamento por c\u00f3digos de 2 caracteres.</li> <li>CFOPs especiais tratados nas somas.</li> <li>Devolu\u00e7\u00f5es subtra\u00eddas do total bruto.</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoItem/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Formato Descri\u00e7\u00e3o PDF Relat\u00f3rio para impress\u00e3o XLSX Planilha anal\u00edtica"},{"location":"ELTECH/relatorios/srf/SRF_ResumoAnualFaturamentoItem/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<ul> <li><code>multitec.utils</code> \u2014 Datas e utilit\u00e1rios</li> <li><code>TableMap</code> \u2014 Estrutura de dados</li> <li><code>jasperreports</code> \u2014 Engine de relat\u00f3rios</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/","title":"SRF - Resumo Por Item","text":""},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio resumido de documentos fiscais consolidados por item, com flexibilidade para sele\u00e7\u00e3o de campos personalizados e tratamento de devolu\u00e7\u00f5es.</p>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer vis\u00e3o consolidada das opera\u00e7\u00f5es fiscais por item, permitindo an\u00e1lise personalizada com campos flex\u00edveis e ajustes autom\u00e1ticos para devolu\u00e7\u00f5es.</p>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Controladoria</li> <li>Gest\u00e3o de Estoque</li> <li>Comercial</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA0103</code> - Itens de documentos fiscais - <code>EAA01</code> - Documentos fiscais - <code>ABB01</code> - Cabe\u00e7alho de documentos - <code>ABM01</code> - Itens/Cadastro de produtos - <code>AAC10</code> - Empresas - <code>AAM06</code> - Unidades de medida - <code>ABE01</code> - Entidades - <code>ABM0102</code> - Crit\u00e9rios de itens</p> <p>Entidades Envolvidas: - <code>Eaa0103</code> - Itens de documentos - <code>Abm01</code> - Itens/produtos - <code>Eaa01</code> - Documentos fiscais - <code>Aac10</code> - Empresa</p>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis resumoOperacao Integer Sim Tipo de opera\u00e7\u00e3o 0=Entrada, 1=Sa\u00edda impressao Integer Sim Formato sa\u00edda 0=PDF, 1=XLSX numeroInicial Integer Sim N\u00famero documento inicial 000000001 numeroFinal Integer Sim N\u00famero documento final 999999999 entidade List N\u00e3o Entidades espec\u00edficas IDs entidades tipo List N\u00e3o Tipos documento IDs tipos documento itens List N\u00e3o Itens espec\u00edficos IDs itens empresas List N\u00e3o Empresas espec\u00edficas IDs empresas dataEmissao LocalDate[] N\u00e3o Per\u00edodo emiss\u00e3o Data inicial e final dataEntSai LocalDate[] N\u00e3o Per\u00edodo entrada/sa\u00edda Data inicial e final criterios List N\u00e3o Crit\u00e9rios de item IDs crit\u00e9rios cfop List N\u00e3o CFOPs espec\u00edficos IDs CFOPs pcd List N\u00e3o Crit\u00e9rios PCD IDs crit\u00e9rios PCD"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Campos Personaliz\u00e1veis: - 6 campos configur\u00e1veis (fixos ou livres) - Campos fixos: Qtde Uso, Qtde Comercial, Pre\u00e7o Unit\u00e1rio, Total Item, Total Documento, Total Financeiro - Campos livres: Qualquer campo do JSON do item - Valida\u00e7\u00e3o contra duplica\u00e7\u00e3o de campos</p>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#campos-do-relatorio","title":"\ud83d\udccb Campos do Relat\u00f3rio","text":"Campo Descri\u00e7\u00e3o Tipo abm01codigo C\u00f3digo do item String abm01descr Descri\u00e7\u00e3o do item String aam06codigo Unidade de medida String eaa0103qtComl Quantidade comercial BigDecimal eaa0103unit Pre\u00e7o unit\u00e1rio BigDecimal eaa0103total Total item BigDecimal nomeCampo[1-6] Nome campo personalizado String valor[1-6] Valor campo personalizado BigDecimal"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o de Par\u00e2metros</li> <li>Valida campos personalizados (sem duplicatas)</li> <li>Define opera\u00e7\u00e3o (entrada/sa\u00edda)</li> <li> <p>Processa agrupamentos de entidades e itens</p> </li> <li> <p>Busca de Agrupamentos</p> </li> <li>Identifica c\u00f3digos com 2 caracteres como agrupadores</li> <li>Expande para incluir entidades e itens filhas</li> <li> <p>Prepara listas completas de IDs</p> </li> <li> <p>Consulta de Dados Principais</p> </li> <li>Busca itens consolidados com filtros aplicados</li> <li>Agrupa por item com totais</li> <li> <p>Aplica crit\u00e9rios de opera\u00e7\u00e3o</p> </li> <li> <p>Processamento de Campos Personalizados</p> </li> <li>Busca campos JSON para cada item</li> <li>Calcula totais dos campos livres</li> <li> <p>Aplica ajustes de devolu\u00e7\u00f5es</p> </li> <li> <p>Tratamento de Devolu\u00e7\u00f5es</p> </li> <li>Identifica itens com devolu\u00e7\u00f5es</li> <li>Subtrai valores devolvidos dos totais</li> <li> <p>Ajusta campos personalizados</p> </li> <li> <p>Gera\u00e7\u00e3o de Sa\u00edda</p> </li> <li>Formata dados com campos personalizados</li> <li>Exporta para PDF ou XLSX</li> <li>Configura totais por campo</li> </ol>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#agrupamento","title":"Agrupamento","text":"<ul> <li>C\u00f3digos com 2 caracteres considerados como agrupadores</li> <li>Expans\u00e3o autom\u00e1tica para entidades e itens filhas</li> <li>Agrupamento por tipo e c\u00f3digo de item</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#campos-personalizados","title":"Campos Personalizados","text":"<ul> <li>M\u00e1ximo 6 campos por relat\u00f3rio</li> <li>Combina\u00e7\u00e3o de campos fixos e livres</li> <li>Valida\u00e7\u00e3o contra duplica\u00e7\u00e3o</li> <li>Campos livres somados do JSON dos itens</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#devolucoes","title":"Devolu\u00e7\u00f5es","text":"<ul> <li>Subtrai quantidades e valores devolvidos</li> <li>Ajusta campos personalizados quando aplic\u00e1vel</li> <li>Considera apenas devolu\u00e7\u00f5es com quantidades &gt; 0</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#filtros","title":"Filtros","text":"<ul> <li>Apenas documentos fiscais (<code>CLASDOC_SRF</code>)</li> <li>Exclui documentos cancelados</li> <li>Filtros por per\u00edodo de emiss\u00e3o ou entrada/sa\u00edda</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Formato Descri\u00e7\u00e3o M\u00e9todo PDF Relat\u00f3rio formatado <code>gerarPDF()</code> XLSX Planilha para an\u00e1lise <code>gerarXLSX()</code>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multitec.utils</code> - Utilit\u00e1rios e datas - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios</p> <p>Configura\u00e7\u00f5es: - Templates Jasper para formata\u00e7\u00e3o - Par\u00e2metros JSON para campos personalizados - Tabela <code>AAH02</code> para descri\u00e7\u00e3o de campos</p>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_Por_Item/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Flexibilidade total na sele\u00e7\u00e3o de campos</li> <li>Processamento complexo de agrupamentos</li> <li>Duas consultas SQL: dados principais + campos personalizados</li> <li>Algoritmo de valida\u00e7\u00e3o de campos contra duplica\u00e7\u00e3o</li> <li>Suporte a m\u00faltiplos crit\u00e9rios de filtragem</li> <li>Tratamento autom\u00e1tico de devolu\u00e7\u00f5es</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/","title":"SRF - Resumo Por Estado","text":""},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio resumido de documentos fiscais consolidados por estado/UF, com tratamento de devolu\u00e7\u00f5es e agrupamento autom\u00e1tico para an\u00e1lise geogr\u00e1fica.</p>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer vis\u00e3o consolidada das opera\u00e7\u00f5es fiscais por estado, permitindo an\u00e1lise r\u00e1pida de faturamento ou recebimento com totais agrupados por UF e ajustes para devolu\u00e7\u00f5es.</p>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Controladoria</li> <li>Gest\u00e3o Comercial</li> <li>Diretoria</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos fiscais - <code>EAA0103</code> - Itens de documentos - <code>ABB01</code> - Cabe\u00e7alho de documentos - <code>ABE01</code> - Entidades - <code>AAG02</code> - Estados/UF - <code>AAG0201</code> - Munic\u00edpios - <code>AAH01</code> - Tipos de documento - <code>AAC10</code> - Empresas</p> <p>Entidades Envolvidas: - <code>Eaa01</code> - Documentos fiscais - <code>Abe01</code> - Clientes/Fornecedores - <code>Aag02</code> - Estado - <code>Aac10</code> - Empresa</p>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis resumoOperacao Integer Sim Tipo de opera\u00e7\u00e3o 0=Recebimento, 1=Faturamento impressao Integer Sim Formato sa\u00edda 0=PDF, 1=XLSX numeroInicial Integer Sim N\u00famero documento inicial 000000001 numeroFinal Integer Sim N\u00famero documento final 999999999 entidade List N\u00e3o Entidades espec\u00edficas IDs entidades tipo List N\u00e3o Tipos documento IDs tipos documento empresas List N\u00e3o Empresas espec\u00edficas IDs empresas dataEmissao LocalDate[] N\u00e3o Per\u00edodo emiss\u00e3o Data inicial e final dataEntSai LocalDate[] N\u00e3o Per\u00edodo entrada/sa\u00edda Data inicial e final estados List N\u00e3o Estados espec\u00edficos IDs estados pcd List N\u00e3o Crit\u00e9rios PCD IDs crit\u00e9rios"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#campos-do-relatorio","title":"\ud83d\udccb Campos do Relat\u00f3rio","text":"Campo Descri\u00e7\u00e3o Tipo aag02uf Estado/UF String aag02nome Nome do estado String eaa0103qtComl Soma quantidade comercial BigDecimal eaa0103unit Soma pre\u00e7o unit\u00e1rio BigDecimal eaa0103total Soma total item BigDecimal eaa0103totDoc Soma total documento BigDecimal"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o de Par\u00e2metros</li> <li>Define opera\u00e7\u00e3o (faturamento/recebimento)</li> <li>Configura per\u00edodo no cabe\u00e7alho</li> <li> <p>Processa agrupamentos de entidades</p> </li> <li> <p>Busca de Agrupamentos</p> </li> <li>Identifica c\u00f3digos de entidade com 2 caracteres</li> <li>Expande para incluir entidades filhas</li> <li> <p>Prepara lista completa de IDs</p> </li> <li> <p>Consulta de Dados Detalhados</p> </li> <li>Busca documentos com filtros aplicados</li> <li>Processa devolu\u00e7\u00f5es para cada item</li> <li> <p>Ajusta valores com base nas devolu\u00e7\u00f5es</p> </li> <li> <p>Consolida\u00e7\u00e3o por Estado</p> </li> <li>Agrupa dados por UF</li> <li>Soma valores para cada estado</li> <li> <p>Cria estrutura resumida final</p> </li> <li> <p>Gera\u00e7\u00e3o de Sa\u00edda</p> </li> <li>Formata dados consolidados</li> <li>Exporta para PDF ou XLSX</li> <li>Configura cabe\u00e7alho com per\u00edodo</li> </ol>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#agrupamento-de-entidades","title":"Agrupamento de Entidades","text":"<ul> <li>C\u00f3digos com 2 caracteres considerados como agrupadores</li> <li>Inclui automaticamente entidades com c\u00f3digo iniciando pelo agrupador</li> <li>Expande lista de IDs para entidades filhas</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#filtros-de-operacao","title":"Filtros de Opera\u00e7\u00e3o","text":"<ul> <li>Recebimento: <code>eaa01esMov = Eaa01.ESMOV_ENTRADA</code></li> <li>Faturamento: <code>eaa01esMov = Eaa01.ESMOV_SAIDA</code></li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#tratamento-de-devolucoes","title":"Tratamento de Devolu\u00e7\u00f5es","text":"<ul> <li>Busca itens com relacionamento <code>EAA01033</code></li> <li>Subtrai quantidades e valores devolvidos</li> <li>Mant\u00e9m apenas valores l\u00edquidos no relat\u00f3rio</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#consolidacao","title":"Consolida\u00e7\u00e3o","text":"<ul> <li>Agrupamento autom\u00e1tico por estado</li> <li>Soma de todos os valores por UF</li> <li>Manuten\u00e7\u00e3o da ordena\u00e7\u00e3o por estado</li> </ul>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Formato Descri\u00e7\u00e3o M\u00e9todo PDF Relat\u00f3rio formatado <code>gerarPDF()</code> XLSX Planilha para an\u00e1lise <code>gerarXLSX()</code>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multitec.utils</code> - Utilit\u00e1rios e datas - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios</p> <p>Configura\u00e7\u00f5es: - Templates Jasper para formata\u00e7\u00e3o - Par\u00e2metros JSON para campos adicionais</p>"},{"location":"ELTECH/relatorios/srf/SRF_Resumo_por_Estado/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Processamento em duas etapas: detalhado \u2192 consolidado</li> <li>Expans\u00e3o autom\u00e1tica de agrupamentos de entidades</li> <li>Tratamento complexo de devolu\u00e7\u00f5es antes da consolida\u00e7\u00e3o</li> <li>Algoritmo de agrupamento manual por estado na mem\u00f3ria</li> <li>Manuten\u00e7\u00e3o da ordena\u00e7\u00e3o original durante a consolida\u00e7\u00e3o</li> <li>SQL com m\u00faltiplos joins para dados geogr\u00e1ficos</li> </ul>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/","title":"CGS - Parcelamento (Equilibrio)","text":""},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para c\u00e1lculo e gera\u00e7\u00e3o de parcelas de condi\u00e7\u00f5es de pagamento, considerando datas de vencimento, ajustes por dias da semana, feriados, valores m\u00ednimos por parcela e configura\u00e7\u00f5es espec\u00edficas do m\u00f3dulo Equilibrio.</p>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente as parcelas de uma condi\u00e7\u00e3o de pagamento, aplicando regras de vencimento, descontos, juros, multas e valida\u00e7\u00f5es de valores m\u00ednimos por parcela.</p>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Financeiro</li> <li>Faturamento</li> <li>Cr\u00e9dito e Cobran\u00e7a</li> </ul>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Abe30</code> - Condi\u00e7\u00f5es de pagamento - <code>Abe3001</code> - Parcelas da condi\u00e7\u00e3o de pagamento - <code>Abe3002</code> - Dias complementares (ajustes de vencimento) - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens do documento fiscal</p>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o dtBase LocalDate Sim Data base para c\u00e1lculo das parcelas abe30id Long Sim ID da condi\u00e7\u00e3o de pagamento valor BigDecimal Sim Valor total a ser parcelado abe01id Long N\u00e3o ID da entidade (cliente) eaa01 Eaa01 N\u00e3o Documento fiscal relacionado"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o dos par\u00e2metros obrigat\u00f3rios</li> <li>Carregamento da condi\u00e7\u00e3o de pagamento (Abe30)</li> <li>Defini\u00e7\u00e3o da data de emiss\u00e3o (do documento ou atual)</li> </ul>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#2-calculo-dos-ajustes-de-data","title":"2. C\u00e1lculo dos Ajustes de Data","text":"<ul> <li>Aplica\u00e7\u00e3o de dias adicionais conforme dia da semana da data base</li> <li>C\u00e1lculo de vencimentos nominais para cada parcela</li> <li>Ajustes por vencimentos fixos e dias espec\u00edficos</li> <li>Tratamento de meses com menos dias (ex: fevereiro)</li> </ul>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#3-calculo-dos-valores-das-parcelas","title":"3. C\u00e1lculo dos Valores das Parcelas","text":"<ul> <li>Distribui\u00e7\u00e3o percentual do valor total</li> <li>C\u00e1lculo do saldo para \u00faltima parcela</li> <li>Aplica\u00e7\u00e3o de juros, multas e encargos</li> <li>C\u00e1lculo de descontos por antecipa\u00e7\u00e3o</li> </ul>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#4-validacoes-e-regras-especiais","title":"4. Valida\u00e7\u00f5es e Regras Especiais","text":"<ul> <li>Verifica\u00e7\u00e3o de valor m\u00ednimo por parcela</li> <li>Op\u00e7\u00e3o de agrupamento em parcela \u00fanica</li> <li>C\u00e1lculo de comiss\u00f5es na \u00faltima parcela</li> <li>Valida\u00e7\u00e3o de documentos financeiros</li> </ul>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#configuracao-de-vencimentos","title":"Configura\u00e7\u00e3o de Vencimentos","text":"<ul> <li>Dias base: Ajustes por dia da semana na data base</li> <li>Vencimentos fixos: Datas espec\u00edficas por parcela</li> <li>Dias do m\u00eas: Vencimento em dia espec\u00edfico do m\u00eas</li> <li>Ajustes complementares: Regras por faixa de dias</li> </ul>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#calculo-financeiro","title":"C\u00e1lculo Financeiro","text":"<ul> <li>Juros: Percentual aplicado sobre o valor da parcela</li> <li>Multa: Percentual ou valor fixo</li> <li>Desconto: Percentual com limite temporal</li> <li>Encargos: Valores adicionais fixos</li> </ul>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#validacoes-de-parcelas","title":"Valida\u00e7\u00f5es de Parcelas","text":"<ul> <li>Valor m\u00ednimo: Configur\u00e1vel por condi\u00e7\u00e3o de pagamento</li> <li>Op\u00e7\u00f5es: 0 - Agrupar em uma parcela, 1 - Validar valor m\u00ednimo</li> <li>Comiss\u00f5es: Calculadas apenas na \u00faltima parcela</li> </ul>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#documentos-financeiros","title":"Documentos Financeiros","text":"<ul> <li>Tipo 1: Gera documento na data de vencimento</li> <li>Tipo 2: Gera documento na data de emiss\u00e3o</li> </ul>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de parcelamento.</p>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#obterdiasadicionaisadatalocaldate-data-abe30-abe30-int-qualdata","title":"<code>obterDiasAdicionaisAData(LocalDate data, Abe30 abe30, int qualData)</code>","text":"<p>Calcula dias adicionais baseado no dia da semana: - 0: Dias para data base - 1: Dias para vencimento nominal</p>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#buscarcondicaopagamentoporidlong-abe30id","title":"<code>buscarCondicaoPagamentoPorId(Long abe30id)</code>","text":"<p>Busca a condi\u00e7\u00e3o de pagamento pelo ID.</p>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#buscarparcelaspeloidcondicaopagamentolong-abe30id","title":"<code>buscarParcelasPeloIdCondicaoPagamento(Long abe30id)</code>","text":"<p>Busca as parcelas configuradas para a condi\u00e7\u00e3o de pagamento.</p>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#buscardiacomplementarpeloidcondicaopagamentolong-abe30id","title":"<code>buscarDiaComplementarPeloIdCondicaoPagamento(Long abe30id)</code>","text":"<p>Busca ajustes complementares de dias.</p>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#montarparceladtolocaldate-data-bigdecimal-valor-integer-docfinanc-abe3001-abe3001-tablemap-cposlivres","title":"<code>montarParcelaDto(LocalDate data, BigDecimal valor, Integer docFinanc, Abe3001 abe3001, TableMap cposLivres)</code>","text":"<p>Monta o DTO da parcela com todos os dados calculados.</p>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>ParcelaDto: - <code>vctoN</code> - Data de vencimento nominal - <code>valor</code> - Valor da parcela - <code>criaDoc</code> - Tipo de documento financeiro (1 ou 2) - <code>abf15id</code> - ID do portador - <code>abf16id</code> - ID da opera\u00e7\u00e3o - <code>abf40id</code> - ID da forma de pagamento - <code>cposLivres</code> - Campos livres (juros, multa, desconto, etc.)</p> <p>Lista de Parcelas: - Retornada no par\u00e2metro <code>listaParcelas</code></p>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios de data - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.dto.cgs</code> - DTOs do m\u00f3dulo CGS - <code>sam.model</code> - Entidades do sistema - <code>java.time</code> - Manipula\u00e7\u00e3o de datas</p> <p>M\u00f3dulo: Equilibrio</p>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#tratamento-de-datas","title":"Tratamento de Datas","text":"<ul> <li>Ajustes autom\u00e1ticos para finais de semana</li> <li>Tratamento especial para fevereiro (meses com menos dias)</li> <li>Suporte a vencimentos fixos e vari\u00e1veis</li> </ul>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#campos-livres-json","title":"Campos Livres (JSON)","text":"<ul> <li><code>juros</code> - Valor calculado de juros</li> <li><code>multa</code> - Valor calculado de multa</li> <li><code>encargos</code> - Encargos adicionais</li> <li><code>desconto</code> - Valor de desconto por antecipa\u00e7\u00e3o</li> <li><code>dtLimiteDesc</code> - Data limite para desconto</li> <li><code>nomevcto</code> - Nome personalizado do vencimento</li> <li><code>comissao_parcela</code> - Comiss\u00e3o na \u00faltima parcela</li> </ul>"},{"location":"EQUILIBRIO/formulas/cgs/CGS_Parcelamento/#validacoes-de-negocio","title":"Valida\u00e7\u00f5es de Neg\u00f3cio","text":"<ul> <li>Interrup\u00e7\u00e3o se valor m\u00ednimo n\u00e3o for atingido</li> <li>C\u00e1lculo preciso de saldos para evitar diferen\u00e7as</li> <li>Suporte a condi\u00e7\u00f5es complexas de pagamento</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 27/10/2025 \u00e0s 10:00 Autor: Bruno Tipo: F\u00f3rmula de Condi\u00e7\u00e3o de Pagamento Vers\u00e3o: 1.0</p>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/","title":"SRF - Enviar Emails NFe (Equilibrio)","text":""},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula especializada para envio automatizado de e-mails relacionados a Notas Fiscais Eletr\u00f4nicas no m\u00f3dulo Equilibrio, com tratamento de caracteres especiais e c\u00f3pia obrigat\u00f3ria para e-mail interno.</p>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar o envio de e-mails para clientes com documentos fiscais eletr\u00f4nicos (XML, DANFE, boletos) incluindo c\u00f3pia para contato@equilibrioind.com.br e tratamento de normaliza\u00e7\u00e3o de caracteres.</p>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Faturamento</li> <li>Cobran\u00e7a</li> <li>Administra\u00e7\u00e3o</li> </ul>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos fiscais NF-e - <code>Abb01</code> - Cabe\u00e7alho de documentos - <code>Abe01</code> - Entidades (clientes) - <code>Eaa0102</code> - Dados complementares do documento - <code>Aaa16</code> - Processamento da mensageria - <code>Eaa0114</code> - Cartas de corre\u00e7\u00e3o - <code>Eaa0101</code> - E-mails espec\u00edficos por documento - <code>Abe0101</code> - Endere\u00e7os de e-mail das entidades</p>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01id Long Sim ID do documento fiscal (Eaa01) aaa16id Long Sim ID do processamento da mensageria eaa0114id Long N\u00e3o ID da carta de corre\u00e7\u00e3o (se aplic\u00e1vel)"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Obten\u00e7\u00e3o dos par\u00e2metros de entrada</li> <li>Carregamento das entidades principais (Eaa01, Aaa16, Abb01, Abe01)</li> <li>Verifica\u00e7\u00e3o da exist\u00eancia de e-mail principal no documento</li> <li>Composi\u00e7\u00e3o do assunto com nome da empresa e n\u00famero da nota</li> </ul>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#2-composicao-do-corpo-da-mensagem","title":"2. Composi\u00e7\u00e3o do Corpo da Mensagem","text":"<ul> <li>Cancelamento: Inclui motivo do cancelamento (Aae11)</li> <li>Carta de Corre\u00e7\u00e3o: Inclui texto da corre\u00e7\u00e3o (Eaa0114)</li> <li>Faturamento Normal: Mensagem padr\u00e3o de envio de NF-e</li> <li>Formata\u00e7\u00e3o HTML com dados do cliente e chave de acesso</li> <li>Normaliza\u00e7\u00e3o de caracteres para remover acentos</li> </ul>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#3-definicao-dos-destinatarios-por-tipo","title":"3. Defini\u00e7\u00e3o dos Destinat\u00e1rios por Tipo","text":"<ul> <li>Cancelamento/CC-e: Apenas e-mail principal do cliente com XML</li> <li>Faturamento: E-mail principal com XML + DANFE + c\u00f3pia interna</li> <li>Cobran\u00e7a: E-mail espec\u00edfico de cobran\u00e7a com boleto</li> <li>C\u00f3pia Interna: contato@equilibrioind.com.br (apenas faturamento)</li> </ul>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#4-configuracao-dos-anexos","title":"4. Configura\u00e7\u00e3o dos Anexos","text":"<ul> <li>Cancelamento/CC-e: Apenas XML</li> <li>Faturamento: XML + DANFE (boleto opcional)</li> <li>Cobran\u00e7a: Apenas boleto</li> <li>C\u00f3pia Interna: XML + DANFE</li> </ul>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#tipos-de-operacao","title":"Tipos de Opera\u00e7\u00e3o","text":"<ul> <li>Cancelamento: Aaa16.TIPO_CANCELAMENTO_NFE</li> <li>Carta de Corre\u00e7\u00e3o: Aaa16.TIPO_CCEEVENTO  </li> <li>Faturamento: Demais tipos</li> </ul>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#hierarquia-de-e-mails-de-cobranca","title":"Hierarquia de E-mails de Cobran\u00e7a","text":"<ol> <li>E-mail espec\u00edfico no documento (Eaa0101) marcado como cobran\u00e7a</li> <li>E-mail principal da entidade (Abe0101) marcado como cobran\u00e7a</li> <li>E-mail principal do documento (Eaa0102)</li> </ol>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#configuracao-de-remetentes","title":"Configura\u00e7\u00e3o de Remetentes","text":"<ul> <li>Faturamento/C\u00f3pia Interna: Remetente 2 (Faturamento)</li> <li>Cobran\u00e7a: Remetente 1 (Cobran\u00e7a)</li> </ul>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#funcionalidades-especificas","title":"Funcionalidades Espec\u00edficas","text":"<ul> <li>Normaliza\u00e7\u00e3o de Caracteres: Remove acentos do nome do cliente</li> <li>C\u00f3pia Obrigat\u00f3ria: contato@equilibrioind.com.br para todos os faturamentos</li> <li>Transportadora: C\u00f3digo comentado - n\u00e3o envia e-mails para transportadora</li> </ul>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>N\u00e3o processa se n\u00e3o houver e-mail principal no documento</li> <li>Verifica diferen\u00e7a entre e-mails de faturamento e cobran\u00e7a</li> <li>Envia boleto junto com faturamento se mesmo e-mail</li> </ul>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de envio de e-mails.</p>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#comporcorpomsgaaa16-aaa16-eaa01-eaa01-abe01-abe01-abb01-abb01-long-eaa0114id","title":"<code>comporCorpoMsg(Aaa16 aaa16, Eaa01 eaa01, Abe01 abe01, Abb01 abb01, Long eaa0114id)</code>","text":"<p>Compoi o corpo do e-mail conforme o tipo de opera\u00e7\u00e3o com formata\u00e7\u00e3o HTML e normaliza\u00e7\u00e3o de caracteres.</p>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#obteremailcobrancalong-eaa01id-long-abe01id-eaa0102-eaa0102","title":"<code>obterEmailCobranca(Long eaa01id, Long abe01id, Eaa0102 eaa0102)</code>","text":"<p>Busca o e-mail de cobran\u00e7a seguindo a hierarquia definida.</p>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>EmailNFeDto: - <code>assunto</code> - Assunto do e-mail formatado - <code>corpo</code> - Corpo em HTML da mensagem (caracteres normalizados) - <code>emailsDestinoPara</code> - Lista de destinat\u00e1rios - <code>enviarXML</code> - Indica se envia arquivo XML - <code>enviarDanfe</code> - Indica se envia DANFE - <code>enviarBoleto</code> - Indica se envia boleto - <code>emailRemetente</code> - Tipo de remetente (1: Cobran\u00e7a, 2: Faturamento)</p> <p>Lista de E-mails Gerados: - Retornada no par\u00e2metro <code>emails</code> para processamento pela mensageria</p>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e joins para consultas - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.dto.srf</code> - DTOs espec\u00edficos do m\u00f3dulo SRF - <code>sam.model</code> - Entidades do sistema - <code>java.text.Normalizer</code> - Normaliza\u00e7\u00e3o de caracteres</p> <p>M\u00f3dulo: Equilibrio</p>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#normalizacao-de-caracteres","title":"Normaliza\u00e7\u00e3o de Caracteres","text":"<ul> <li>Uso de <code>Normalizer.normalize(corpo, Normalizer.Form.NFD).replaceAll(\"[^\\\\p{ASCII}]\", \"\")</code></li> <li>Remove acentos e caracteres especiais do nome do cliente</li> <li>Aplica tanto no corpo da mensagem quanto no nome do cliente</li> </ul>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#copia-interna-obrigatoria","title":"C\u00f3pia Interna Obrigat\u00f3ria","text":"<ul> <li>E-mail: contato@equilibrioind.com.br</li> <li>Apenas para opera\u00e7\u00f5es de faturamento (n\u00e3o cancelamento/CC-e)</li> <li>Recebe XML e DANFE para controle interno</li> </ul>"},{"location":"EQUILIBRIO/formulas/srf/SRF_EnviarEmailsNFe/#funcionalidades-comentadas","title":"Funcionalidades Comentadas","text":"<ul> <li>M\u00e9todo <code>obterEmailTransportadoraDespacho()</code> dispon\u00edvel mas n\u00e3o utilizado</li> <li>Bloco de c\u00f3digo para transportadora comentado</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 27/10/2025 \u00e0s 10:48 Autor: Bruno Tipo: F\u00f3rmula de Envio de E-mails NF-e (Equilibrio) Vers\u00e3o: 1.0</p>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/","title":"SCV - Separa\u00e7\u00e3o de Pedido (Equilibrio)","text":""},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Classe Groovy especializada na gera\u00e7\u00e3o de relat\u00f3rios de separa\u00e7\u00e3o de pedidos e envio automatizado de e-mails para o sistema SCV da Equilibrio.</p>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar relat\u00f3rios de separa\u00e7\u00e3o de pedidos em formato PDF/XLSX e enviar por e-mail para clientes, com controle de filtros avan\u00e7ados e composi\u00e7\u00e3o completa de dados do pedido.</p>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento de Vendas</li> <li>Log\u00edstica e Separa\u00e7\u00e3o</li> <li>Faturamento</li> </ul>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos de pedidos - <code>Abb01</code> - Cabe\u00e7alho de documentos - <code>Abe01</code> - Entidades (clientes) - <code>Eaa0103</code> - Itens do pedido - <code>Aac10</code> - Empresas - <code>Abe0104</code> - E-mails das entidades - <code>Aab1008</code> - Configura\u00e7\u00f5es de usu\u00e1rio</p>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#parametros-da-classe","title":"\u2699\ufe0f Par\u00e2metros da Classe","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o tipos List N\u00e3o Tipos de documento entidades List N\u00e3o Entidades (clientes) numeroInicial Integer Sim N\u00famero inicial do pedido numeroFinal Integer Sim N\u00famero final do pedido impressao Integer Sim 0=PDF, 1=XLSX atendimento Boolean Sim Filtro de atendimento eaa01id Long N\u00e3o Filtro por separador espec\u00edfico enviaEmail Boolean N\u00e3o Habilitar envio por e-mail"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Obten\u00e7\u00e3o dos par\u00e2metros de filtro</li> <li>Defini\u00e7\u00e3o do caminho do logo para relat\u00f3rios</li> <li>Carregamento de IDs de documentos com base nos crit\u00e9rios</li> </ul>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#2-composicao-de-dados-do-pedido","title":"2. Composi\u00e7\u00e3o de Dados do Pedido","text":"<ul> <li>Dados do Documento: N\u00famero, data, valores, observa\u00e7\u00f5es</li> <li>Dados da Empresa: Raz\u00e3o social, CNPJ, endere\u00e7o, contato</li> <li>Dados do Cliente: Nome, CNPJ/CPF, endere\u00e7o, e-mail</li> <li>Dados Financeiros: Condi\u00e7\u00e3o de pagamento, forma de pagamento</li> <li>Dados de Entrega: Endere\u00e7o, transportadora, tipo de frete</li> </ul>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#3-processamento-de-itens","title":"3. Processamento de Itens","text":"<ul> <li>Busca de itens do pedido com sequ\u00eancia</li> <li>C\u00e1lculo de volumes e pesos l\u00edquidos</li> <li>Agrupamento de n\u00fameros de pedido de compra</li> <li>Formata\u00e7\u00e3o de descontos e valores</li> </ul>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#4-geracao-de-saida","title":"4. Gera\u00e7\u00e3o de Sa\u00edda","text":"<ul> <li>PDF: Relat\u00f3rio formatado para impress\u00e3o</li> <li>XLSX: Planilha para an\u00e1lise de dados</li> <li>E-mail: Envio autom\u00e1tico com anexo PDF</li> </ul>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#filtros-de-documentos","title":"Filtros de Documentos","text":"<ul> <li>Apenas documentos n\u00e3o cancelados (<code>eaa01cancData is null</code>)</li> <li>Apenas documentos classificados como venda (<code>eaa01clasdoc = 0</code>)</li> <li>Apenas documentos com aceite confirmado (<code>eaa01aceite = 1</code>)</li> <li>Filtro por per\u00edodo de emiss\u00e3o e entrega</li> <li>Filtro por status de atendimento (0, 1, 2)</li> </ul>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#composicao-de-valores","title":"Composi\u00e7\u00e3o de Valores","text":"<ul> <li>Frete: Soma de valores do emitente e destinat\u00e1rio</li> <li>Desconto: Extra\u00eddo do JSON do documento</li> <li>Impostos: IPI, ICMS-ST, despesas acess\u00f3rias</li> <li>Valores: Unit\u00e1rio, total e total do documento</li> </ul>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#envio-de-e-mail","title":"Envio de E-mail","text":"<ul> <li>Requer e-mail cadastrado para o usu\u00e1rio logado</li> <li>Busca e-mails de destino na entidade (c\u00f3digo 9001)</li> <li>Inclui assinatura digital se configurada</li> <li>Anexa PDF do pedido com nome personalizado</li> </ul>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de gera\u00e7\u00e3o do relat\u00f3rio.</p>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#enviaremailinteger-numeroinicial-listtablemap-dadospedido","title":"<code>enviarEmail(Integer numeroInicial, List&lt;TableMap&gt; dadosPedido)</code>","text":"<p>Envia relat\u00f3rio por e-mail com PDF anexo para os destinat\u00e1rios configurados.</p>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#buscardocidslistlong-tipos-listlong-entidades","title":"<code>buscarDocIds(List&lt;Long&gt; tipos, List&lt;Long&gt; entidades, ...)</code>","text":"<p>Busca IDs de documentos com base nos crit\u00e9rios de filtro aplicados.</p>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#metodos-de-composicao","title":"M\u00e9todos de Composi\u00e7\u00e3o","text":"<ul> <li><code>comporDocumento()</code>: Dados b\u00e1sicos do documento</li> <li><code>comporDadosEmpresa()</code>: Informa\u00e7\u00f5es da empresa</li> <li><code>comporDadosEntidade()</code>: Dados do cliente</li> <li><code>comporDadosEntidadeEndereco()</code>: Endere\u00e7o completo</li> <li><code>comporDadosFinanceiro()</code>: Condi\u00e7\u00f5es financeiras</li> <li><code>comporDadosEntrega()</code>: Dados de entrega e frete</li> </ul>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>TableMap Principal: - Dados do documento (n\u00famero, data, valores totais) - Dados da empresa (raz\u00e3o social, endere\u00e7o, contato) - Dados do cliente (nome, endere\u00e7o, e-mail) - Dados financeiros (condi\u00e7\u00e3o pagamento) - Dados de entrega (endere\u00e7o, transportadora, frete)</p> <p>Lista de Itens: - Sequ\u00eancia, c\u00f3digo, descri\u00e7\u00e3o do produto - Quantidade, valor unit\u00e1rio, valor total - Volume, peso l\u00edquido, pedido de compra - Controle de qualidade (abm15nome)</p>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>JasperReports</code> - Gera\u00e7\u00e3o de relat\u00f3rios - <code>Java Mail</code> - Envio de e-mails - <code>MultiORM</code> - Persist\u00eancia e consultas - <code>Utils Multitec</code> - Utilit\u00e1rios corporativos - <code>Java Time</code> - Manipula\u00e7\u00e3o de datas</p> <p>M\u00f3dulo: SCV - Sistema de Controle de Vendas</p>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#normalizacao-de-caracteres","title":"Normaliza\u00e7\u00e3o de Caracteres","text":"<ul> <li>Uso de <code>Normalizer</code> para remover acentos do nome da empresa no e-mail</li> <li>Garante compatibilidade com sistemas de e-mail</li> </ul>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#tratamento-de-json","title":"Tratamento de JSON","text":"<ul> <li>Extra\u00e7\u00e3o de valores customizados do campo JSON dos documentos</li> <li>Flexibilidade para campos din\u00e2micos sem altera\u00e7\u00e3o de estrutura</li> </ul>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#configuracao-de-logotipo","title":"Configura\u00e7\u00e3o de Logotipo","text":"<ul> <li>Caminho din\u00e2mico baseado no package da classe</li> <li>Suporte a diferentes ambientes de deployment</li> </ul>"},{"location":"EQUILIBRIO/relatorios/scv/SCV_SeparacaoPedido/#controle-de-acesso","title":"Controle de Acesso","text":"<ul> <li>Verifica\u00e7\u00e3o de permiss\u00f5es atrav\u00e9s do m\u00e9todo <code>obterWherePadrao()</code></li> <li>Filtragem por empresa ativa do usu\u00e1rio logado</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 23/10/2025 \u00e0s 17:25 Autor: Bruno Tipo: Relat\u00f3rio de Separa\u00e7\u00e3o de Pedidos Vers\u00e3o: 1.0</p>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/","title":"SRF - Enviar Emails NFe (Foco)","text":""},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula especializada para envio automatizado de e-mails relacionados a Notas Fiscais Eletr\u00f4nicas no m\u00f3dulo Foco, com tratamento de caracteres especiais e configura\u00e7\u00e3o simplificada de envio.</p>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar o envio de e-mails para clientes com documentos fiscais eletr\u00f4nicos (XML, DANFE, boletos) com foco em simplicidade e tratamento de normaliza\u00e7\u00e3o de caracteres, adaptado para as necessidades do m\u00f3dulo Foco.</p>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Faturamento</li> <li>Cobran\u00e7a</li> </ul>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos fiscais NF-e - <code>Abb01</code> - Cabe\u00e7alho de documentos - <code>Abe01</code> - Entidades (clientes) - <code>Eaa0102</code> - Dados complementares do documento - <code>Aaa16</code> - Processamento da mensageria - <code>Eaa0114</code> - Cartas de corre\u00e7\u00e3o - <code>Eaa0101</code> - E-mails espec\u00edficos por documento - <code>Abe0101</code> - Endere\u00e7os de e-mail das entidades</p>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01id Long Sim ID do documento fiscal (Eaa01) aaa16id Long Sim ID do processamento da mensageria eaa0114id Long N\u00e3o ID da carta de corre\u00e7\u00e3o (se aplic\u00e1vel)"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Obten\u00e7\u00e3o dos par\u00e2metros de entrada</li> <li>Carregamento das entidades principais (Eaa01, Aaa16, Abb01, Abe01)</li> <li>Verifica\u00e7\u00e3o da exist\u00eancia de e-mail principal no documento</li> <li>Composi\u00e7\u00e3o do assunto com nome da empresa e n\u00famero da nota</li> </ul>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#2-composicao-do-corpo-da-mensagem","title":"2. Composi\u00e7\u00e3o do Corpo da Mensagem","text":"<ul> <li>Cancelamento: Inclui motivo do cancelamento (Aae11)</li> <li>Carta de Corre\u00e7\u00e3o: Inclui texto da corre\u00e7\u00e3o (Eaa0114)</li> <li>Faturamento Normal: Mensagem padr\u00e3o de envio de NF-e</li> <li>Formata\u00e7\u00e3o HTML com dados do cliente e chave de acesso</li> <li>Normaliza\u00e7\u00e3o de caracteres para remover acentos</li> </ul>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#3-definicao-dos-destinatarios-por-tipo","title":"3. Defini\u00e7\u00e3o dos Destinat\u00e1rios por Tipo","text":"<ul> <li>Cancelamento/CC-e: Apenas e-mail principal do cliente com XML</li> <li>Faturamento: E-mail principal com XML + DANFE + boleto</li> <li>Cobran\u00e7a: E-mail espec\u00edfico de cobran\u00e7a com boleto (se diferente)</li> </ul>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#4-configuracao-dos-anexos","title":"4. Configura\u00e7\u00e3o dos Anexos","text":"<ul> <li>Cancelamento/CC-e: Apenas XML</li> <li>Faturamento: XML + DANFE + boleto</li> <li>Cobran\u00e7a: Apenas boleto</li> </ul>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#tipos-de-operacao","title":"Tipos de Opera\u00e7\u00e3o","text":"<ul> <li>Cancelamento: Aaa16.TIPO_CANCELAMENTO_NFE</li> <li>Carta de Corre\u00e7\u00e3o: Aaa16.TIPO_CCEEVENTO  </li> <li>Faturamento: Demais tipos</li> </ul>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#hierarquia-de-e-mails-de-cobranca","title":"Hierarquia de E-mails de Cobran\u00e7a","text":"<ol> <li>E-mail espec\u00edfico no documento (Eaa0101) marcado como cobran\u00e7a</li> <li>E-mail principal da entidade (Abe0101) marcado como cobran\u00e7a</li> <li>E-mail principal do documento (Eaa0102)</li> </ol>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#configuracao-de-remetentes","title":"Configura\u00e7\u00e3o de Remetentes","text":"<ul> <li>Todos os e-mails: Remetente 2 (Faturamento)</li> <li>Cobran\u00e7a: Tamb\u00e9m usa remetente 2</li> </ul>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#funcionalidades-especificas","title":"Funcionalidades Espec\u00edficas","text":"<ul> <li>Normaliza\u00e7\u00e3o de Caracteres: Remove acentos do nome do cliente</li> <li>Boleto no Faturamento: Sempre enviado junto com XML e DANFE</li> <li>Configura\u00e7\u00e3o Simplificada: Sem c\u00f3pias internas ou representantes</li> </ul>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>N\u00e3o processa se n\u00e3o houver e-mail principal no documento</li> <li>Verifica diferen\u00e7a entre e-mails de faturamento e cobran\u00e7a</li> <li>Sempre envia boleto no e-mail de faturamento</li> </ul>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de envio de e-mails.</p>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#comporcorpomsgaaa16-aaa16-eaa01-eaa01-abe01-abe01-abb01-abb01-long-eaa0114id","title":"<code>comporCorpoMsg(Aaa16 aaa16, Eaa01 eaa01, Abe01 abe01, Abb01 abb01, Long eaa0114id)</code>","text":"<p>Compoi o corpo do e-mail conforme o tipo de opera\u00e7\u00e3o com formata\u00e7\u00e3o HTML e normaliza\u00e7\u00e3o de caracteres.</p>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#obteremailcobrancalong-eaa01id-long-abe01id-eaa0102-eaa0102","title":"<code>obterEmailCobranca(Long eaa01id, Long abe01id, Eaa0102 eaa0102)</code>","text":"<p>Busca o e-mail de cobran\u00e7a seguindo a hierarquia definida.</p>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>EmailNFeDto: - <code>assunto</code> - Assunto do e-mail formatado - <code>corpo</code> - Corpo em HTML da mensagem (caracteres normalizados) - <code>emailsDestinoPara</code> - Lista de destinat\u00e1rios - <code>enviarXML</code> - Indica se envia arquivo XML - <code>enviarDanfe</code> - Indica se envia DANFE - <code>enviarBoleto</code> - Indica se envia boleto - <code>emailRemetente</code> - Tipo de remetente (2: Faturamento para todos)</p> <p>Lista de E-mails Gerados: - Retornada no par\u00e2metro <code>emails</code> para processamento pela mensageria</p>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e joins para consultas - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.dto.srf</code> - DTOs espec\u00edficos do m\u00f3dulo SRF - <code>sam.model</code> - Entidades do sistema - <code>java.text.Normalizer</code> - Normaliza\u00e7\u00e3o de caracteres</p> <p>M\u00f3dulo: Foco</p>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#normalizacao-de-caracteres","title":"Normaliza\u00e7\u00e3o de Caracteres","text":"<ul> <li>Uso de <code>Normalizer.normalize(corpo, Normalizer.Form.NFD).replaceAll(\"[^\\\\p{ASCII}]\", \"\")</code></li> <li>Remove acentos e caracteres especiais do nome do cliente</li> <li>Aplica tanto no corpo da mensagem quanto no nome do cliente</li> </ul>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#configuracao-simplificada","title":"Configura\u00e7\u00e3o Simplificada","text":"<ul> <li>Sem c\u00f3pias internas para administra\u00e7\u00e3o</li> <li>Sem e-mails para representantes</li> <li>Sem e-mails para transportadora</li> <li>Foco apenas no cliente final</li> </ul>"},{"location":"FOCO/fromulas/srf/SRF_EnviarEmailsNFe/#configuracao-de-cobranca","title":"Configura\u00e7\u00e3o de Cobran\u00e7a","text":"<ul> <li>Remetente 2 para todos os e-mails (inclusive cobran\u00e7a)</li> <li>Boleto sempre enviado no faturamento</li> <li>E-mail de cobran\u00e7a separado apenas se diferente do faturamento</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 27/10/2025 \u00e0s 10:47 Autor: Bruno Tipo: F\u00f3rmula de Envio de E-mails NF-e (Foco) Vers\u00e3o: 1.0</p>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/","title":"SRF - Enviar Emails NFe (LCB)","text":""},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula especializada para envio automatizado de e-mails relacionados a Notas Fiscais Eletr\u00f4nicas no m\u00f3dulo LCB, com tratamento de caracteres especiais, c\u00f3pia obrigat\u00f3ria para e-mail da empresa e configura\u00e7\u00e3o espec\u00edfica de cobran\u00e7a.</p>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar o envio de e-mails para clientes com documentos fiscais eletr\u00f4nicos (XML, DANFE, boletos) incluindo c\u00f3pia para e-mail configurado na empresa e tratamento de normaliza\u00e7\u00e3o de caracteres, adaptado para as necessidades do m\u00f3dulo LCB.</p>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Faturamento</li> <li>Cobran\u00e7a</li> <li>Administra\u00e7\u00e3o</li> </ul>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos fiscais NF-e - <code>Abb01</code> - Cabe\u00e7alho de documentos - <code>Abe01</code> - Entidades (clientes) - <code>Eaa0102</code> - Dados complementares do documento - <code>Aaa16</code> - Processamento da mensageria - <code>Eaa0114</code> - Cartas de corre\u00e7\u00e3o - <code>Eaa0101</code> - E-mails espec\u00edficos por documento - <code>Abe0101</code> - Endere\u00e7os de e-mail das entidades - <code>Aac10</code> - Empresa (para e-mail de c\u00f3pia)</p>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01id Long Sim ID do documento fiscal (Eaa01) aaa16id Long Sim ID do processamento da mensageria eaa0114id Long N\u00e3o ID da carta de corre\u00e7\u00e3o (se aplic\u00e1vel)"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Obten\u00e7\u00e3o dos par\u00e2metros de entrada</li> <li>Carregamento das entidades principais (Eaa01, Aaa16, Abb01, Abe01)</li> <li>Verifica\u00e7\u00e3o da exist\u00eancia de e-mail principal no documento</li> <li>Composi\u00e7\u00e3o do assunto com nome da empresa e n\u00famero da nota</li> </ul>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#2-composicao-do-corpo-da-mensagem","title":"2. Composi\u00e7\u00e3o do Corpo da Mensagem","text":"<ul> <li>Cancelamento: Inclui motivo do cancelamento (Aae11)</li> <li>Carta de Corre\u00e7\u00e3o: Inclui texto da corre\u00e7\u00e3o (Eaa0114)</li> <li>Faturamento Normal: Mensagem padr\u00e3o de envio de NF-e</li> <li>Formata\u00e7\u00e3o HTML com dados do cliente e chave de acesso</li> <li>Normaliza\u00e7\u00e3o de caracteres para remover acentos</li> </ul>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#3-definicao-dos-destinatarios-por-tipo","title":"3. Defini\u00e7\u00e3o dos Destinat\u00e1rios por Tipo","text":"<ul> <li>Cancelamento/CC-e: Apenas e-mail principal do cliente com XML</li> <li>Faturamento: E-mail principal com XML + DANFE + boleto + c\u00f3pia interna</li> <li>Cobran\u00e7a: E-mail espec\u00edfico de cobran\u00e7a com boleto</li> <li>C\u00f3pia Interna: E-mail configurado na empresa (Aac10.json)</li> </ul>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#4-configuracao-dos-anexos","title":"4. Configura\u00e7\u00e3o dos Anexos","text":"<ul> <li>Cancelamento/CC-e: Apenas XML</li> <li>Faturamento: XML + DANFE + boleto</li> <li>Cobran\u00e7a: Apenas boleto</li> <li>C\u00f3pia Interna: XML + DANFE</li> </ul>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#tipos-de-operacao","title":"Tipos de Opera\u00e7\u00e3o","text":"<ul> <li>Cancelamento: Aaa16.TIPO_CANCELAMENTO_NFE</li> <li>Carta de Corre\u00e7\u00e3o: Aaa16.TIPO_CCEEVENTO  </li> <li>Faturamento: Demais tipos</li> </ul>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#hierarquia-de-e-mails-de-cobranca","title":"Hierarquia de E-mails de Cobran\u00e7a","text":"<ol> <li>E-mail espec\u00edfico no documento (Eaa0101) marcado como cobran\u00e7a</li> <li>E-mail principal da entidade (Abe0101) marcado como cobran\u00e7a</li> <li>E-mail principal do documento (Eaa0102)</li> </ol>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#configuracao-de-remetentes","title":"Configura\u00e7\u00e3o de Remetentes","text":"<ul> <li>Todos os e-mails: Remetente 2 (Faturamento)</li> <li>Cobran\u00e7a: Tamb\u00e9m usa remetente 2 (diferente de outros m\u00f3dulos)</li> </ul>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#funcionalidades-especificas","title":"Funcionalidades Espec\u00edficas","text":"<ul> <li>Normaliza\u00e7\u00e3o de Caracteres: Remove acentos do nome do cliente</li> <li>C\u00f3pia Obrigat\u00f3ria: E-mail configurado em <code>obterEmpresaAtiva().aac10json.getString(\"email\")</code></li> <li>Boleto no Faturamento: Sempre enviado junto com XML e DANFE</li> </ul>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>N\u00e3o processa se n\u00e3o houver e-mail principal no documento</li> <li>Verifica diferen\u00e7a entre e-mails de faturamento e cobran\u00e7a</li> <li>Sempre envia boleto no e-mail de faturamento</li> </ul>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de envio de e-mails.</p>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#comporcorpomsgaaa16-aaa16-eaa01-eaa01-abe01-abe01-abb01-abb01-long-eaa0114id","title":"<code>comporCorpoMsg(Aaa16 aaa16, Eaa01 eaa01, Abe01 abe01, Abb01 abb01, Long eaa0114id)</code>","text":"<p>Compoi o corpo do e-mail conforme o tipo de opera\u00e7\u00e3o com formata\u00e7\u00e3o HTML e normaliza\u00e7\u00e3o de caracteres.</p>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#obteremailcobrancalong-eaa01id-long-abe01id-eaa0102-eaa0102","title":"<code>obterEmailCobranca(Long eaa01id, Long abe01id, Eaa0102 eaa0102)</code>","text":"<p>Busca o e-mail de cobran\u00e7a seguindo a hierarquia definida.</p>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>EmailNFeDto: - <code>assunto</code> - Assunto do e-mail formatado - <code>corpo</code> - Corpo em HTML da mensagem (caracteres normalizados) - <code>emailsDestinoPara</code> - Lista de destinat\u00e1rios - <code>enviarXML</code> - Indica se envia arquivo XML - <code>enviarDanfe</code> - Indica se envia DANFE - <code>enviarBoleto</code> - Indica se envia boleto - <code>emailRemetente</code> - Tipo de remetente (2: Faturamento para todos)</p> <p>Lista de E-mails Gerados: - Retornada no par\u00e2metro <code>emails</code> para processamento pela mensageria</p>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e joins para consultas - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.dto.srf</code> - DTOs espec\u00edficos do m\u00f3dulo SRF - <code>sam.model</code> - Entidades do sistema - <code>java.text.Normalizer</code> - Normaliza\u00e7\u00e3o de caracteres</p> <p>M\u00f3dulo: LCB</p>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#normalizacao-de-caracteres","title":"Normaliza\u00e7\u00e3o de Caracteres","text":"<ul> <li>Uso de <code>Normalizer.normalize(corpo, Normalizer.Form.NFD).replaceAll(\"[^\\\\p{ASCII}]\", \"\")</code></li> <li>Remove acentos e caracteres especiais do nome do cliente</li> <li>Aplica tanto no corpo da mensagem quanto no nome do cliente</li> </ul>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#copia-interna-dinamica","title":"C\u00f3pia Interna Din\u00e2mica","text":"<ul> <li>E-mail obtido de <code>obterEmpresaAtiva().aac10json.getString(\"email\")</code></li> <li>Configur\u00e1vel por empresa via campo JSON</li> <li>Apenas para opera\u00e7\u00f5es de faturamento (n\u00e3o cancelamento/CC-e)</li> </ul>"},{"location":"LCB/formulas/srf/SRF_EnviarEmailsNFe/#configuracao-de-cobranca","title":"Configura\u00e7\u00e3o de Cobran\u00e7a","text":"<ul> <li>Remetente 2 para todos os e-mails (inclusive cobran\u00e7a)</li> <li>Boleto sempre enviado no faturamento</li> <li>E-mail de cobran\u00e7a separado apenas se diferente do faturamento</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 27/10/2025 \u00e0s 10:37 Autor: Bruno Tipo: F\u00f3rmula de Envio de E-mails NF-e (LCB) Vers\u00e3o: 1.0</p>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/","title":"SCE - Saldo por Local (LCB)","text":""},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio de saldo de estoque agrupado por localiza\u00e7\u00e3o, desenvolvido especificamente para a LCB, permitindo visualizar a quantidade de itens em cada local com filtros por itens, classes, status, lotes, s\u00e9ries e validade.</p>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar relat\u00f3rio de saldo de estoque por local para controle de invent\u00e1rio, identifica\u00e7\u00e3o de locais sem saldo e an\u00e1lise da distribui\u00e7\u00e3o de produtos no armaz\u00e9m.</p>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento de Estoque</li> <li>Almoxarifado</li> <li>Log\u00edstica</li> <li>Controle de Invent\u00e1rio</li> <li>Ger\u00eancia de Opera\u00e7\u00f5es</li> </ul>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Abm15</code> - Locais de estoque - <code>Bcc02</code> - Saldos de estoque - <code>Bcc0201</code> - Detalhes de saldos (lotes/s\u00e9ries) - <code>Abm01</code> - Itens cadastrais - <code>Aam01</code> - Classes de itens - <code>Aam04</code> - Status de estoque - <code>Aam06</code> - Unidades de medida - <code>Abm0101</code> - Configura\u00e7\u00e3o de itens</p>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o itens List N\u00e3o Filtro por IDs dos itens classes List N\u00e3o Filtro por IDs das classes status List N\u00e3o Filtro por IDs dos status local List N\u00e3o Filtro por nome do local (in\u00edcio do nome) lote String N\u00e3o Filtro por n\u00famero de lote (separado por \";\") serie String N\u00e3o Filtro por n\u00famero de s\u00e9rie (separado por \";\") validade LocalDate[] N\u00e3o Intervalo de validade [in\u00edcio, fim] saldoItem Boolean N\u00e3o Op\u00e7\u00e3o de exibir saldo por item exibirSaldo Boolean N\u00e3o Op\u00e7\u00e3o de exibir saldo localSemSaldo Boolean N\u00e3o Op\u00e7\u00e3o de exibir apenas locais sem saldo imprimir Integer Sim Formato de sa\u00edda (0=PDF, 1=XLSX)"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Carregamento dos filtros padr\u00e3o</li> <li>Busca da lista de locais dispon\u00edveis</li> <li>Configura\u00e7\u00e3o da empresa ativa</li> </ul>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#2-processamento-dos-filtros","title":"2. Processamento dos Filtros","text":"<ul> <li>Convers\u00e3o de par\u00e2metros de entrada</li> <li>Tratamento de listas de lotes e s\u00e9ries (separados por \";\")</li> <li>Valida\u00e7\u00e3o de intervalos de datas</li> </ul>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#3-busca-de-dados","title":"3. Busca de Dados","text":"<ul> <li>Op\u00e7\u00e3o normal: Busca de saldos por local com filtros aplicados</li> <li>Op\u00e7\u00e3o locais sem saldo: Busca de locais que n\u00e3o possuem nenhum item em estoque</li> </ul>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#4-geracao-do-relatorio","title":"4. Gera\u00e7\u00e3o do Relat\u00f3rio","text":"<ul> <li>Formato PDF ou XLSX conforme sele\u00e7\u00e3o</li> <li>Adi\u00e7\u00e3o de par\u00e2metros da empresa</li> <li>Formata\u00e7\u00e3o dos dados conforme op\u00e7\u00f5es selecionadas</li> </ul>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#filtros-de-busca","title":"Filtros de Busca","text":"<ul> <li>Local: Filtro por in\u00edcio do nome do local (LIKE 'local%')</li> <li>Lotes/S\u00e9ries: M\u00faltiplos valores separados por ponto e v\u00edrgula</li> <li>Validade: Intervalo inclusivo (BETWEEN)</li> <li>Locais sem saldo: Exibe apenas locais que n\u00e3o possuem itens em estoque</li> </ul>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#formatacao-de-dados","title":"Formata\u00e7\u00e3o de Dados","text":"<ul> <li>Quantidade em UA: C\u00e1lculo de quantidade em unidade auxiliar (bcc0201qt / abm0101fcua)</li> <li>Nome do local: Truncado em 6 caracteres para agrupamento</li> <li>Ordena\u00e7\u00e3o: Por nome do local, c\u00f3digo do item e lote</li> </ul>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#parametros-do-relatorio_1","title":"Par\u00e2metros do Relat\u00f3rio","text":"<ul> <li>SALDOITEM: Controla exibi\u00e7\u00e3o de saldo por item</li> <li>EXIBIRSALDO: Controla exibi\u00e7\u00e3o de coluna de saldo</li> <li>EMPRESA: Nome da empresa ativa no cabe\u00e7alho</li> </ul>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra a gera\u00e7\u00e3o do relat\u00f3rio.</p>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#buscardados","title":"<code>buscarDados()</code>","text":"<p>Busca os saldos de estoque por local com aplica\u00e7\u00e3o de filtros.</p>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#buscaridslocais","title":"<code>buscarIdsLocais()</code>","text":"<p>Busca IDs dos locais que possuem saldo em estoque.</p>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#buscarlocaissemsaldo","title":"<code>buscarLocaisSemSaldo()</code>","text":"<p>Busca locais que n\u00e3o possuem nenhum item em estoque.</p>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#buscarlocais","title":"<code>buscarLocais()</code>","text":"<p>Busca lista de locais dispon\u00edveis para preenchimento do filtro.</p>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Campos do Relat\u00f3rio: - <code>abm15nome</code> - Nome do local (truncado em 6 caracteres) - <code>abm01codigo</code> - C\u00f3digo do item - <code>abm01descr</code> - Descri\u00e7\u00e3o do item - <code>bcc0201lote</code> - N\u00famero do lote - <code>bcc0201serie</code> - N\u00famero de s\u00e9rie - <code>bcc0201qt</code> - Quantidade em estoque - <code>bcc0201validade</code> - Data de validade - <code>aam06codigo</code> - Unidade de medida de uso - <code>fcua</code> - Quantidade em unidade auxiliar (quando aplic\u00e1vel)</p> <p>Formato de Sa\u00edda: - PDF: Relat\u00f3rio formatado para impress\u00e3o/visualiza\u00e7\u00e3o - XLSX: Planilha Excel para an\u00e1lise e manipula\u00e7\u00e3o</p>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multitec.utils</code> - Utilit\u00e1rios (Utils, TableMap) - <code>sam.server.samdev.relatorio</code> - Base para relat\u00f3rios - <code>sam.server.samdev.utils</code> - Utilit\u00e1rios do SAM (Parametro) - <code>java.time</code> - Manipula\u00e7\u00e3o de datas - <code>java.util.stream</code> - Processamento de collections</p> <p>M\u00f3dulo: SCE (Sistema de Controle de Estoque)</p>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#performance","title":"Performance","text":"<ul> <li>Consultas otimizadas com \u00edndices apropriados</li> <li>Filtros aplicados no banco de dados para reduzir transfer\u00eancia</li> <li>Agrupamento por local otimizado para grandes volumes</li> </ul>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#formato-de-locais","title":"Formato de Locais","text":"<ul> <li>Nomes de locais truncados em 6 caracteres para agrupamento</li> <li>Suporte a m\u00faltiplos locais em filtro</li> <li>Locais inativos (com data de inativa\u00e7\u00e3o) s\u00e3o exclu\u00eddos</li> </ul>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#filtros-especiais","title":"Filtros Especiais","text":"<ul> <li>Lotes/S\u00e9ries: Suporte a m\u00faltiplos valores com separador \";\"</li> <li>Local: Busca por in\u00edcio do nome (otimizado com \u00edndice)</li> <li>Validade: Intervalo flex\u00edvel com tratamento de nulos</li> </ul>"},{"location":"LCB/relatorios/sce/SCE_SaldoPorLocal/#seguranca","title":"Seguran\u00e7a","text":"<ul> <li>Aplica\u00e7\u00e3o de where padr\u00e3o do sistema para controle de acesso</li> <li>Valida\u00e7\u00e3o de par\u00e2metros de entrada</li> <li>Tratamento de valores nulos e vazios</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 10/12/2025 \u00e0s 14:44 Autor: NAGYLA Tipo: Relat\u00f3rio de Saldo por Local Vers\u00e3o: 1.0 (Customizado para LCB)</p>"},{"location":"LCB/relatorios/scf/SCF_DRE/","title":"SCF - Demonstrativo de Resultados do Exerc\u00edcio (DRE) - LCB","text":""},{"location":"LCB/relatorios/scf/SCF_DRE/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio financeiro que gera o Demonstrativo de Resultados do Exerc\u00edcio (DRE) para a empresa LCB, com duas modalidades: sint\u00e9tico (resumido por grupos) e anal\u00edtico (detalhado por documento). O relat\u00f3rio consolida receitas, custos, despesas e resultados do per\u00edodo.</p>"},{"location":"LCB/relatorios/scf/SCF_DRE/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer uma vis\u00e3o completa do desempenho financeiro da empresa, permitindo an\u00e1lise de margens, rentabilidade e composi\u00e7\u00e3o de resultados. Atende tanto a necessidades gerenciais (vis\u00e3o sint\u00e9tica) quanto cont\u00e1beis (vis\u00e3o anal\u00edtica).</p>"},{"location":"LCB/relatorios/scf/SCF_DRE/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Diretoria/Administra\u00e7\u00e3o</li> <li>Controladoria</li> <li>Contabilidade</li> <li>Ger\u00eancia Financeira</li> <li>Analistas de Custos</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Daa01</code> - Documentos financeiros - <code>Daa0101</code> - Departamentos do documento - <code>Daa01011</code> - Naturezas financeiras do departamento - <code>Abf10</code> - Naturezas financeiras - <code>Abf11</code> - Agrupamentos de natureza financeira - <code>Abf1101</code> - Relacionamento natureza-agrupamento - <code>Dab10</code> - Lan\u00e7amentos cont\u00e1beis - <code>Dab1001</code> - Departamentos do lan\u00e7amento - <code>Dab10011</code> - Naturezas do lan\u00e7amento - <code>Abb01</code> - Central de documento - <code>Abe01</code> - Entidades (clientes/fornecedores) - <code>Aac10</code> - Empresa - <code>Bcc01</code> - Movimenta\u00e7\u00f5es de estoque (informa\u00e7\u00f5es adicionais) - <code>Abm01</code> - Produtos - <code>Aam01</code> - Classes de produtos</p>"},{"location":"LCB/relatorios/scf/SCF_DRE/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valor Padr\u00e3o emissao LocalDate[] Sim Per\u00edodo de emiss\u00e3o/lan\u00e7amento M\u00eas atual detalhamento Integer Sim Tipo de detalhamento (0=Sint\u00e9tico, 1=Anal\u00edtico) 0 impressao Integer Sim Formato de sa\u00edda (0=PDF, 1=XLSX) 0"},{"location":"LCB/relatorios/scf/SCF_DRE/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LCB/relatorios/scf/SCF_DRE/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Defini\u00e7\u00e3o dos valores padr\u00e3o dos filtros (m\u00eas atual)</li> <li>Carregamento dos par\u00e2metros fornecidos pelo usu\u00e1rio</li> <li>Obten\u00e7\u00e3o dos dados da empresa ativa</li> <li>Formata\u00e7\u00e3o do per\u00edodo para exibi\u00e7\u00e3o no relat\u00f3rio</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#2-processamento-sintetico-detalhamento-0","title":"2. Processamento Sint\u00e9tico (detalhamento = 0)","text":""},{"location":"LCB/relatorios/scf/SCF_DRE/#coleta-de-dados","title":"Coleta de Dados","text":"<ul> <li>Vendas: Busca receitas por linha de produto (IDs espec\u00edficos)</li> <li>Custos: Busca custos diretos por linha de produto (IDs correspondentes)</li> <li>Margem: Obt\u00e9m estrutura para c\u00e1lculo de margem bruta</li> <li>Outras Entradas: Receitas n\u00e3o operacionais</li> <li>Despesas Operacionais: Divididas em:</li> <li>Custo Fixo (infraestrutura, manuten\u00e7\u00e3o)</li> <li>Departamento Pessoal (sal\u00e1rios, encargos)</li> <li>Despesas Banc\u00e1rias (tarifas, juros)</li> <li>Impostos (tributos diretos)</li> <li>ARS Itatiba (despesas espec\u00edficas)</li> <li>Informa\u00e7\u00f5es Adicionais: Dados de estoque por classe de produto</li> <li>Ativo Imobilizado: Deprecia\u00e7\u00f5es e amortiza\u00e7\u00f5es</li> <li>Distribui\u00e7\u00e3o de Lucros: Provis\u00f5es e distribui\u00e7\u00f5es</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#calculos-e-consolidacao","title":"C\u00e1lculos e Consolida\u00e7\u00e3o","text":"<ul> <li>Totais por Grupo: Soma de valores por agrupamento</li> <li>Percentuais: C\u00e1lculo de participa\u00e7\u00e3o sobre vendas ou margem</li> <li>Margem Bruta: Vendas - Custos Diretos</li> <li>Resultados Intermedi\u00e1rios:</li> <li>Lucro L\u00edquido Operacional: Margem Bruta - Despesas Operacionais</li> <li>Lucro L\u00edquido: Lucro Operacional + Outras Entradas + Ativo Imobilizado</li> <li>Consolida\u00e7\u00e3o de Fontes: Unifica\u00e7\u00e3o de dados de <code>Dab10</code> (lan\u00e7ados) e <code>Daa01</code> (n\u00e3o pagos)</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#estrutura-de-sub-relatorios","title":"Estrutura de Sub-relat\u00f3rios","text":"<ul> <li>13 sub-relat\u00f3rios interligados via TableMapDataSource</li> <li>Cada se\u00e7\u00e3o do DRE como sub-relat\u00f3rio independente</li> <li>Chave de relacionamento (<code>key</code>) para v\u00ednculo principal</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#3-processamento-analitico-detalhamento-1","title":"3. Processamento Anal\u00edtico (detalhamento = 1)","text":""},{"location":"LCB/relatorios/scf/SCF_DRE/#dados-detalhados","title":"Dados Detalhados","text":"<ul> <li>Mesmas categorias do sint\u00e9tico, mas com detalhamento por documento</li> <li>Inclus\u00e3o de: n\u00famero documento, data, situa\u00e7\u00e3o (quitado), entidade</li> <li>Consolida\u00e7\u00e3o de m\u00faltiplas fontes em listas \u00fanicas</li> <li>Ordena\u00e7\u00e3o por agrupamento \u2192 n\u00famero documento \u2192 entidade</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#estrutura-de-sub-relatorios_1","title":"Estrutura de Sub-relat\u00f3rios","text":"<ul> <li>7 sub-relat\u00f3rios anal\u00edticos</li> <li>Layout otimizado para visualiza\u00e7\u00e3o detalhada</li> <li>Manuten\u00e7\u00e3o da estrutura hier\u00e1rquica</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#4-geracao-de-saida","title":"4. Gera\u00e7\u00e3o de Sa\u00edda","text":"<ul> <li>PDF: Relat\u00f3rio formatado para impress\u00e3o/visualiza\u00e7\u00e3o</li> <li>XLSX: Planilha Excel para an\u00e1lise e manipula\u00e7\u00e3o</li> <li>Mesma estrutura de dados para ambos os formatos</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LCB/relatorios/scf/SCF_DRE/#categorias-financeiras-ids-fixos","title":"Categorias Financeiras (IDs Fixos)","text":""},{"location":"LCB/relatorios/scf/SCF_DRE/#vendas-abf10-ids","title":"Vendas (Abf10 IDs)","text":"<ul> <li>45118536, 45118558, 48621447, 45118556, 45118571, 45118538,</li> <li>45118540, 48312987, 45118567, 45118565, 45118575, 45118560,</li> <li>45118569, 45118542, 45118550, 45118563, 50242950, 56159621,</li> <li>63491575, 67170852, 73575997</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#custos-abf10-ids-correspondentes","title":"Custos (Abf10 IDs Correspondentes)","text":"<ul> <li>45118606, 45118631, 48621476, 45118629, 45118643,</li> <li>45118611, 45118613, 48313032, 45118639, 45118637, 45118647,</li> <li>45118633, 45118641, 45118616, 45118623, 45118636, 50242996, 56159623,</li> <li>63491577, 67170690, 73575999</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#agrupamentos-de-despesas-abf11-ids","title":"Agrupamentos de Despesas (Abf11 IDs)","text":"<ul> <li>Outras Entradas: 45724656</li> <li>Custo Fixo: 45671519, 45671525, 45671528, 45714999, 45671530, 45671542, 45671532, 45671534, 45671536, 45671538, 45671540, 53634052, 53633915, 79473971</li> <li>Depto Pessoal: 45671546, 45671548, 45671550, 45671552, 45671554, 68684602, 73779171, 75611157</li> <li>Despesas Banc\u00e1rias: 45671560, 45671558</li> <li>Impostos: 45671571</li> <li>ARS Itatiba: 47514382</li> <li>Ativo Imobilizado: 45671568</li> <li>Distribui\u00e7\u00e3o Lucros: 45805292</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#informacoes-adicionais-bcc01-ple","title":"Informa\u00e7\u00f5es Adicionais (Bcc01 PLE)","text":"<ul> <li>44322655, 44322656, 44514002</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#tratamento-de-valores","title":"Tratamento de Valores","text":"<ul> <li>Movimenta\u00e7\u00e3o de Entrada (dab10mov = 1): Valores multiplicados por -1</li> <li>Documentos RP (daa01rp = 1): Valores multiplicados por -1</li> <li>Arredondamentos: 2 casas decimais para valores monet\u00e1rios</li> <li>Percentuais: Calculados sobre total de vendas ou margem, conforme categoria</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#consolidacao-de-fontes","title":"Consolida\u00e7\u00e3o de Fontes","text":"<ul> <li>Dab10: Documentos j\u00e1 lan\u00e7ados contabilmente</li> <li>Daa01: Documentos financeiros n\u00e3o pagos (em aberto)</li> <li>L\u00f3gica de Jun\u00e7\u00e3o: Quando existe <code>daa01dtLcto</code>, usa essa data; sen\u00e3o, usa <code>abb01data</code></li> <li>Valida\u00e7\u00e3o de IDs: Garantia de que todos os registros da segunda fonte sejam inclu\u00eddos</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#ordenacao","title":"Ordena\u00e7\u00e3o","text":"<ul> <li>Sint\u00e9tico: Por nome do agrupamento/natureza</li> <li>Anal\u00edtico: Por nome do agrupamento \u2192 n\u00famero do documento \u2192 nome da entidade</li> <li>Custom Comparators: Implementa\u00e7\u00e3o espec\u00edfica para ordena\u00e7\u00e3o m\u00faltipla</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LCB/relatorios/scf/SCF_DRE/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que direciona para processamento sint\u00e9tico ou anal\u00edtico.</p>"},{"location":"LCB/relatorios/scf/SCF_DRE/#metodos-de-busca-sintetica","title":"M\u00e9todos de Busca Sint\u00e9tica","text":"<ul> <li><code>buscarDadosVendas()</code>, <code>buscarDadosCustos()</code>, <code>buscarDadosMargem()</code></li> <li><code>buscarDadosOutrasEntradas()</code>, <code>buscarDadosCustoFixo()</code>, <code>buscarDadosDeptoPessoal()</code></li> <li><code>buscarDadosDespeBancarias()</code>, <code>buscarDadosImpostos()</code>, <code>buscarDadosArsItatiba()</code></li> <li><code>buscarDadosInfoAdd()</code>, <code>buscarDadosAtivoImob()</code>, <code>buscarDistribLucro()</code></li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#metodos-de-busca-analitica","title":"M\u00e9todos de Busca Anal\u00edtica","text":"<ul> <li><code>buscarDados...Analitico()</code>: Vers\u00f5es detalhadas de cada categoria</li> <li>Incluem dados documentais: n\u00famero, data, situa\u00e7\u00e3o, entidade</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#metodos-de-calculo-de-totais","title":"M\u00e9todos de C\u00e1lculo de Totais","text":"<ul> <li><code>buscarTotalVendas()</code>, <code>buscarTotalCustos()</code>, <code>buscarTotalInfoAdd()</code></li> <li>Retornam somat\u00f3rios para c\u00e1lculo de percentuais</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#estrutura-do-dre","title":"\ud83d\udcca Estrutura do DRE","text":""},{"location":"LCB/relatorios/scf/SCF_DRE/#secao-1-receitas-operacionais","title":"Se\u00e7\u00e3o 1: Receitas Operacionais","text":"<ul> <li>Vendas por linha de produto (com % sobre total)</li> <li>Subtotal: Total de Vendas</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#secao-2-custos-operacionais","title":"Se\u00e7\u00e3o 2: Custos Operacionais","text":"<ul> <li>Custos diretos por linha de produto (com % sobre total)</li> <li>Subtotal: Total de Custos</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#secao-3-margem-bruta","title":"Se\u00e7\u00e3o 3: Margem Bruta","text":"<ul> <li>Margem por linha de produto (Vendas - Custos)</li> <li>Percentual sobre margem total</li> <li>Subtotal: Margem Bruta Total</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#secao-4-outras-receitas","title":"Se\u00e7\u00e3o 4: Outras Receitas","text":"<ul> <li>Receitas n\u00e3o operacionais</li> <li>Subtotal: Total Outras Entradas</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#secao-5-despesas-operacionais","title":"Se\u00e7\u00e3o 5: Despesas Operacionais","text":""},{"location":"LCB/relatorios/scf/SCF_DRE/#51-custo-fixo","title":"5.1 Custo Fixo","text":""},{"location":"LCB/relatorios/scf/SCF_DRE/#52-departamento-pessoal","title":"5.2 Departamento Pessoal","text":""},{"location":"LCB/relatorios/scf/SCF_DRE/#53-despesas-bancarias","title":"5.3 Despesas Banc\u00e1rias","text":""},{"location":"LCB/relatorios/scf/SCF_DRE/#54-impostos","title":"5.4 Impostos","text":""},{"location":"LCB/relatorios/scf/SCF_DRE/#55-ars-itatiba","title":"5.5 ARS Itatiba","text":"<ul> <li>Subtotal: Total Despesas Operacionais</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#secao-6-ativo-imobilizado","title":"Se\u00e7\u00e3o 6: Ativo Imobilizado","text":"<ul> <li>Deprecia\u00e7\u00f5es e amortiza\u00e7\u00f5es</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#secao-7-resultados","title":"Se\u00e7\u00e3o 7: Resultados","text":"<ul> <li>Lucro L\u00edquido Operacional (Margem - Despesas)</li> <li>Distribui\u00e7\u00e3o de Lucros</li> <li>Lucro L\u00edquido do Exerc\u00edcio</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#secao-8-informacoes-adicionais","title":"Se\u00e7\u00e3o 8: Informa\u00e7\u00f5es Adicionais","text":"<ul> <li>Movimenta\u00e7\u00f5es de estoque por classe de produto</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>br.com.multitec.utils</code> - Utilit\u00e1rios de data e cole\u00e7\u00f5es - <code>br.com.multitec.utils.collections.TableMap</code> - Estrutura de dados - <code>sam.server.samdev.relatorio</code> - Classes base para relat\u00f3rios - <code>sam.core.variaveis.MDate</code> - Manipula\u00e7\u00e3o de datas - <code>java.time</code> - API de datas moderna - <code>java.util</code> - Cole\u00e7\u00f5es e comparators</p> <p>M\u00f3dulo: SCF (Sistema Cont\u00e1bil Financeiro)</p>"},{"location":"LCB/relatorios/scf/SCF_DRE/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LCB/relatorios/scf/SCF_DRE/#performance-de-consultas","title":"Performance de Consultas","text":"<ul> <li>Consultas otimizadas com filtros por per\u00edodo</li> <li>Uso de subqueries para consolida\u00e7\u00e3o</li> <li>Agrupamentos (GROUP BY) no banco para reduzir processamento</li> <li>\u00cdndices sugeridos em: <code>daa01dtLcto</code>, <code>abb01data</code>, <code>abf10id</code>, <code>abf11id</code></li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#tratamento-de-dados","title":"Tratamento de Dados","text":"<ul> <li>Convers\u00e3o segura de tipos (getBigDecimal_Zero)</li> <li>Valida\u00e7\u00e3o de nulls antes de c\u00e1lculos</li> <li>Arredondamento consistente em 2 casas decimais</li> <li>Formata\u00e7\u00e3o de datas no padr\u00e3o brasileiro (dd/MM/yyyy)</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#arquitetura-de-sub-relatorios","title":"Arquitetura de Sub-relat\u00f3rios","text":"<ul> <li>TableMapDataSource: Estrutura hier\u00e1rquica de dados</li> <li>Chaves de Relacionamento: Campo <code>key</code> para v\u00ednculo entre n\u00edveis</li> <li>SubDataSources M\u00faltiplos: At\u00e9 13 sub-relat\u00f3rios no modo sint\u00e9tico</li> <li>Templates Independentes: Cada se\u00e7\u00e3o com layout espec\u00edfico</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#flexibilidade-do-relatorio","title":"Flexibilidade do Relat\u00f3rio","text":"<ul> <li>Duas Modalidades: Sint\u00e9tico (gerencial) e Anal\u00edtico (cont\u00e1bil)</li> <li>Dois Formatos: PDF (visualiza\u00e7\u00e3o) e XLSX (an\u00e1lise)</li> <li>Per\u00edodo Customiz\u00e1vel: Qualquer intervalo de datas</li> <li>Empresa Ativa: Dados espec\u00edficos da empresa do usu\u00e1rio logado</li> </ul>"},{"location":"LCB/relatorios/scf/SCF_DRE/#validacoes-e-tratamento-de-erros","title":"Valida\u00e7\u00f5es e Tratamento de Erros","text":"<ul> <li>Verifica\u00e7\u00e3o de dados vazios/nulos</li> <li>C\u00e1lculos de percentuais com prote\u00e7\u00e3o contra divis\u00e3o por zero</li> <li>Consolida\u00e7\u00e3o segura de m\u00faltiplas fontes de dados</li> <li>Ordena\u00e7\u00e3o robusta com comparators customizados</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 28/11/2025 \u00e0s 08:50 Autor: Bruno Tipo: Relat\u00f3rio Financeiro (DRE) Vers\u00e3o: 1.0</p>"},{"location":"LINHASITA/formulas/sce/SCE_InventarioFiscal/","title":"SCE_InventarioFiscal","text":""},{"location":"LINHASITA/formulas/sce/SCE_InventarioFiscal/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula respons\u00e1vel pelo c\u00e1lculo e atualiza\u00e7\u00e3o de pre\u00e7os unit\u00e1rios e totais de itens em invent\u00e1rio fiscal, considerando regras de custo, hist\u00f3rico de lan\u00e7amentos e configura\u00e7\u00e3o fiscal do item. Atualiza campos JSON e saldo cont\u00e1bil para correta escritura\u00e7\u00e3o e acompanhamento de invent\u00e1rio.</p>"},{"location":"LINHASITA/formulas/sce/SCE_InventarioFiscal/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<ul> <li>Calcular pre\u00e7o unit\u00e1rio e total de itens no invent\u00e1rio fiscal.</li> <li>Atualizar campos JSON de controle interno e fiscal do item.</li> <li>Validar configura\u00e7\u00e3o fiscal e grupo de invent\u00e1rio.</li> <li>Obter saldo de contas e invent\u00e1rios anteriores.</li> </ul>"},{"location":"LINHASITA/formulas/sce/SCE_InventarioFiscal/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Auditoria Fiscal</li> <li>Desenvolvedores de sistemas de gest\u00e3o de invent\u00e1rio</li> </ul>"},{"location":"LINHASITA/formulas/sce/SCE_InventarioFiscal/#parametrosconfiguracoes","title":"\u2699\ufe0f Par\u00e2metros/Configura\u00e7\u00f5es","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o bcb11 Bcb11 Sim Item do invent\u00e1rio a ser processado dtIni LocalDate N\u00e3o Data inicial do per\u00edodo de consulta dtFin LocalDate N\u00e3o Data final do per\u00edodo de consulta"},{"location":"LINHASITA/formulas/sce/SCE_InventarioFiscal/#estrutura-de-processamento","title":"\ud83d\udcca Estrutura de Processamento","text":""},{"location":"LINHASITA/formulas/sce/SCE_InventarioFiscal/#inicializacao","title":"Inicializa\u00e7\u00e3o","text":"<ul> <li>Recupera empresa ativa (<code>Aac10</code>) e item (<code>Abm01</code>).</li> <li>Carrega configura\u00e7\u00f5es do item (<code>Abm0101</code>) e campos JSON (<code>jsonAbm0101</code>).</li> <li>Define per\u00edodo do invent\u00e1rio baseado na data do lan\u00e7amento (<code>bcb10data</code>).</li> </ul>"},{"location":"LINHASITA/formulas/sce/SCE_InventarioFiscal/#processamento-de-itens","title":"Processamento de Itens","text":"<ul> <li>Recupera configura\u00e7\u00e3o fiscal (<code>Abm12</code>) e valida presen\u00e7a.</li> <li>Calcula taxa do grupo de invent\u00e1rio do item.</li> <li>Obt\u00e9m pre\u00e7o unit\u00e1rio via regras de custo ou invent\u00e1rios anteriores.</li> <li>Atualiza <code>bcb11unit</code> e <code>bcb11total</code>.</li> <li>Atualiza JSON do item (<code>vlr_inventario</code>) e saldo da conta (<code>inv_est_sdo_cta</code>).</li> </ul>"},{"location":"LINHASITA/formulas/sce/SCE_InventarioFiscal/#calculo-de-preco-unitario","title":"C\u00e1lculo de Pre\u00e7o Unit\u00e1rio","text":"<ul> <li>Baseado em <code>campoGI</code> do item:<ul> <li>Pre\u00e7o m\u00e9dio, custo de aquisi\u00e7\u00e3o, maior/menor custo, \u00faltimo pre\u00e7o, \u00faltimo unit\u00e1rio de sa\u00edda.</li> <li>Busca hist\u00f3rico em invent\u00e1rios anteriores se necess\u00e1rio.</li> </ul> </li> <li>Ajusta pelo percentual do grupo de invent\u00e1rio (<code>taxa</code>).</li> </ul>"},{"location":"LINHASITA/formulas/sce/SCE_InventarioFiscal/#saldo-contabil","title":"Saldo Cont\u00e1bil","text":"<ul> <li>Obt\u00e9m saldo do grupo de invent\u00e1rio (<code>buscarSaldoDoGrupo</code>).</li> <li>Caso saldo zero, busca saldo da conta (<code>buscarSaldoConta</code>).</li> </ul>"},{"location":"LINHASITA/formulas/sce/SCE_InventarioFiscal/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":"<ul> <li>Itens sem configura\u00e7\u00e3o fiscal interrompem o processamento.</li> <li>Tipos fiscais 7, 8, 9 e 99 ignoram valida\u00e7\u00e3o de grupo de invent\u00e1rio.</li> <li>Pre\u00e7os unit\u00e1rios nulos s\u00e3o substitu\u00eddos por zero.</li> <li>Saldo de grupo e contas \u00e9 agregado via JSON.</li> <li>Taxa de invent\u00e1rio aplica-se apenas se <code>taxa &gt; 0</code>.</li> </ul>"},{"location":"LINHASITA/formulas/sce/SCE_InventarioFiscal/#saidasretornos","title":"\ud83c\udfa8 Sa\u00eddas/Retornos","text":"Tipo Descri\u00e7\u00e3o Formato Item atualizado Objeto <code>Bcb11</code> com pre\u00e7o unit\u00e1rio, total e JSON ajustado Objeto Java (JSON interno)"},{"location":"LINHASITA/formulas/sce/SCE_InventarioFiscal/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>sam.server.samdev.formula.FormulaBase</code> - Base da f\u00f3rmula - <code>sam.dicdados.FormulaTipo</code> - Tipo da f\u00f3rmula - <code>br.com.multitec.utils.collections.TableMap</code> - Estrutura para campos JSON - <code>java.time.LocalDate</code> e <code>DateTimeFormatter</code> - Manipula\u00e7\u00e3o de datas</p> <p>Entidades do Sistema: - <code>Bcb11</code>, <code>Bcb10</code>, <code>Abm01</code>, <code>Abm0101</code>, <code>Abm12</code>, <code>Abm11</code>, <code>Abm40</code> - <code>Bcc01</code>, <code>Bcc02</code>, <code>Ebb02</code>, <code>Aac10</code>, <code>Aag02</code></p>"},{"location":"LINHASITA/formulas/sce/SCE_InventarioFiscal/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Campos JSON acessados dinamicamente via <code>TableMap</code>.</li> <li>Consulta de hist\u00f3rico via crit\u00e9rios e SQL direto.</li> <li>C\u00e1lculo de pre\u00e7o unit\u00e1rio considera diversas regras de custo.</li> <li>Saldo de contas e invent\u00e1rio anterior \u00e9 usado como fallback.</li> <li>Atualiza\u00e7\u00e3o do item persiste altera\u00e7\u00f5es e garante commit da sess\u00e3o.</li> </ul>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/","title":"Apura\u00e7\u00e3o EFD ICMS ST - SGT","text":""},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para c\u00e1lculo e apura\u00e7\u00e3o do ICMS-ST (Substitui\u00e7\u00e3o Tribut\u00e1ria) para a Escritura\u00e7\u00e3o Fiscal Digital (EFD), considerando opera\u00e7\u00f5es de devolu\u00e7\u00e3o, ressarcimento, reten\u00e7\u00e3o, ajustes, dedu\u00e7\u00f5es e valores extra-apura\u00e7\u00e3o. A f\u00f3rmula gera registros na tabela <code>Edb01</code> por estado (UF) para um determinado per\u00edodo (m\u00eas/ano).</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente os valores de ICMS-ST a recolher, saldos credores, dedu\u00e7\u00f5es e extra-apura\u00e7\u00f5es, conforme as regras da EFD, para cada estado envolvido nas opera\u00e7\u00f5es da empresa.</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Faturamento</li> <li>Auditoria Fiscal</li> </ul>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Edb01</code> - Apura\u00e7\u00f5es fiscais - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens do documento fiscal - <code>Eaa01031</code> - Ajustes por item - <code>Eaa01035</code> - Outros ajustes - <code>Aag02</code> - Estados (UF) - <code>Aac10</code> - Empresas - <code>Abb01</code> - Centrais de neg\u00f3cio - <code>Aah01</code> - Tipos de documento - <code>Aaj15</code> - CFOP - <code>Aaj03</code> - Situa\u00e7\u00e3o do documento - <code>Aaj16</code> - C\u00f3digos de ajuste (Eaa01031) - <code>Aaj17</code> - C\u00f3digos de ajuste (Eaa01035) - <code>Aaj28</code> - Tipos de apura\u00e7\u00e3o</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o edb01 Edb01 Sim Registro de apura\u00e7\u00e3o base (cont\u00e9m m\u00eas, ano, tipo) icmsST_efd String N\u00e3o Campo JSON que armazena o valor de ICMS-ST nos itens (Eaa0103)"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o do registro de apura\u00e7\u00e3o (<code>edb01</code>)</li> <li>Defini\u00e7\u00e3o do per\u00edodo (data inicial e final do m\u00eas)</li> <li>Obten\u00e7\u00e3o da UF da empresa</li> <li>Determina\u00e7\u00e3o dos estados a processar (um espec\u00edfico ou todos)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#2-exclusao-de-apuracoes-anteriores","title":"2. Exclus\u00e3o de Apura\u00e7\u00f5es Anteriores","text":"<ul> <li>Remo\u00e7\u00e3o de registros <code>Edb01</code> existentes para o mesmo per\u00edodo e tipo, evitando duplicidade.</li> </ul>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#3-calculo-dos-valores-por-estado","title":"3. C\u00e1lculo dos Valores por Estado","text":"<p>Para cada estado (exceto \"EX\" - Exterior): - Busca saldo credor anterior (<code>credAnt</code>) - Calcula devolu\u00e7\u00f5es (<code>devolucao</code>) e ressarcimentos (<code>ressarcimento</code>) de ICMS-ST - Soma outros cr\u00e9ditos (<code>outrosCred</code>) e ajustes a cr\u00e9dito (<code>ajustesCred</code>) - Calcula reten\u00e7\u00e3o por ST (<code>retencao</code>) - Soma outros d\u00e9bitos (<code>outrosDeb</code>) e ajustes a d\u00e9bito (<code>ajustesDeb</code>) - Determina saldo devedor antes das dedu\u00e7\u00f5es (<code>saldo</code>) - Calcula dedu\u00e7\u00f5es (<code>deducoes</code>) - Calcula total de ICMS-ST a recolher (<code>saldoDevedor</code>) - Calcula saldo credor a transportar (<code>saldoCredor</code>) - Soma valores extra-apura\u00e7\u00e3o (<code>extra</code>)</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#4-persistencia-dos-resultados","title":"4. Persist\u00eancia dos Resultados","text":"<ul> <li>Cria ou atualiza registro <code>Edb01</code> para o estado, armazenando todos os campos calculados no JSON.</li> <li>Persiste apenas se houver valores relevantes ou se for a UF da empresa.</li> </ul>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#escopo-da-apuracao","title":"Escopo da Apura\u00e7\u00e3o","text":"<ul> <li>Processa por estado (UF) individual ou todos de uma vez.</li> <li>Ignora opera\u00e7\u00f5es com UF \"EX\" (Exterior).</li> <li>Considera apenas documentos com <code>eaa01iEfdIcms = 1</code> (inclu\u00eddo na EFD ICMS).</li> </ul>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#calculo-de-campos","title":"C\u00e1lculo de Campos","text":"<ol> <li>Saldo credor anterior: Buscado da apura\u00e7\u00e3o do m\u00eas anterior para a mesma UF.</li> <li>Devolu\u00e7\u00e3o e Ressarcimento: CFOPs espec\u00edficos para cada opera\u00e7\u00e3o.</li> <li>Outros cr\u00e9ditos/d\u00e9bitos: Ajustes das tabelas <code>Eaa01031</code> e <code>Eaa01035</code> com c\u00f3digos espec\u00edficos.</li> <li>Reten\u00e7\u00e3o por ST: CFOPs iniciados com \"5\" ou \"6\".</li> <li>Dedu\u00e7\u00f5es: Ajustes com c\u00f3digo iniciado em \"61\".</li> <li>Extra-apura\u00e7\u00e3o: Valores de documentos com situa\u00e7\u00e3o diferente de \"01\" ou \"07\".</li> </ol>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Apenas documentos com situa\u00e7\u00e3o EFD diferente de \"02\", \"03\", \"04\", \"05\" s\u00e3o considerados.</li> <li>Campos JSON s\u00e3o utilizados para armazenar valores de ICMS-ST (<code>icmsST_efd</code>).</li> </ul>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de apura\u00e7\u00e3o.</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#buscarestados","title":"<code>buscarEstados()</code>","text":"<p>Retorna lista de todos os estados (UF) cadastrados.</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#buscarapuracaoanteriorlong-aag02id-edb01-edb01","title":"<code>buscarApuracaoAnterior(Long aag02id, Edb01 edb01)</code>","text":"<p>Busca a apura\u00e7\u00e3o do m\u00eas anterior para a UF especificada.</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#buscardevolucoesressarcimentosicmsstboolean-isdevolucao-long-aag02id-string-cpovlr1-localdate-dtinicial-localdate-dtfinal","title":"<code>buscarDevolucoesRessarcimentosIcmsST(boolean isDevolucao, Long aag02id, String cpoVlr1, LocalDate dtInicial, LocalDate dtFinal)</code>","text":"<p>Calcula devolu\u00e7\u00f5es ou ressarcimentos de ICMS-ST conforme CFOPs espec\u00edficos.</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#buscaroutroscredeaa01035icmsst-buscaroutroscredicmsst-buscarajustescredeaa01031icmsst","title":"<code>buscarOutrosCredEaa01035IcmsSt(...)</code>, <code>buscarOutrosCredIcmsST(...)</code>, <code>buscarAjustesCredEaa01031IcmsSt(...)</code>","text":"<p>M\u00e9todos para calcular outros cr\u00e9ditos e ajustes a cr\u00e9dito.</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#buscarretencaoicmsst","title":"<code>buscarRetencaoIcmsSt(...)</code>","text":"<p>Calcula o valor de ICMS-ST retido nas opera\u00e7\u00f5es com CFOP iniciado em \"5\" ou \"6\".</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#buscaroutrosdebeaa01035icmsst-buscarajustesdebeaa01031icmsst","title":"<code>buscarOutrosDebEaa01035IcmsSt(...)</code>, <code>buscarAjustesDebEaa01031IcmsSt(...)</code>","text":"<p>M\u00e9todos para calcular outros d\u00e9bitos e ajustes a d\u00e9bito.</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#buscardeducoeseaa01031icmsst-buscardeducoeseaa01035icmsst","title":"<code>buscarDeducoesEaa01031IcmsSt(...)</code>, <code>buscarDeducoesEaa01035IcmsSt(...)</code>","text":"<p>Calculam as dedu\u00e7\u00f5es de ICMS-ST.</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#buscarextraapurc100icmsst-buscarextraapureaa01031icmsst-buscarextraapureaa01035icmsst","title":"<code>buscarExtraApurC100IcmsSt(...)</code>, <code>buscarExtraApurEaa01031IcmsSt(...)</code>, <code>buscarExtraApurEaa01035IcmsSt(...)</code>","text":"<p>Calculam valores extra-apura\u00e7\u00e3o.</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#excluirapuracoesinteger-mes-integer-ano-long-aaj28id-long-aag02id","title":"<code>excluirApuracoes(Integer mes, Integer ano, Long aaj28id, Long aag02id)</code>","text":"<p>Remove apura\u00e7\u00f5es anteriores para o mesmo per\u00edodo, tipo e UF (se especificada).</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Registro Edb01 (JSON): - <code>credAnt</code> - Saldo credor do per\u00edodo anterior - <code>devolucao</code> - ICMS-ST de devolu\u00e7\u00f5es - <code>ressarcimento</code> - ICMS-ST de ressarcimentos - <code>outrosCred</code> - Outros cr\u00e9ditos e estornos - <code>ajustesCred</code> - Ajustes a cr\u00e9dito - <code>retencao</code> - ICMS retido por ST - <code>outrosDeb</code> - Outros d\u00e9bitos e estornos - <code>ajustesDeb</code> - Ajustes a d\u00e9bito - <code>saldo</code> - Saldo devedor antes das dedu\u00e7\u00f5es - <code>deducoes</code> - Dedu\u00e7\u00f5es - <code>saldoDevedor</code> - Total do ICMS-ST a recolher - <code>saldoCredor</code> - Saldo credor a transportar - <code>extra</code> - Valores extra-apura\u00e7\u00e3o</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios de data e cole\u00e7\u00f5es - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.model</code> - Entidades do sistema - <code>java.time</code> - Manipula\u00e7\u00e3o de datas</p> <p>M\u00f3dulo: SGT (Sistema de Gest\u00e3o Tribut\u00e1ria)</p>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#filtros-de-periodo","title":"Filtros de Per\u00edodo","text":"<ul> <li>Utiliza <code>eaa01esData</code> ou <code>abb01data</code> conforme o tipo de movimento (<code>eaa01esMov</code>).</li> <li>Considera o m\u00eas completo (do dia 1 ao \u00faltimo dia).</li> </ul>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#campos-dinamicos","title":"Campos Din\u00e2micos","text":"<ul> <li>O campo <code>icmsST_efd</code> \u00e9 configur\u00e1vel e deve conter o nome do campo JSON que armazena o ICMS-ST nos itens.</li> </ul>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#tratamento-de-estados","title":"Tratamento de Estados","text":"<ul> <li>Processa apenas estados com opera\u00e7\u00f5es relevantes ou a UF da empresa.</li> <li>Ignora \"EX\" (Exterior).</li> </ul>"},{"location":"LINHASITA/formulas/sgt/Apuracao_EFD_ICMS_ST/#performance","title":"Performance","text":"<ul> <li>Utiliza exclus\u00e3o pr\u00e9via para evitar registros duplicados.</li> <li>Consultas SQL otimizadas com somat\u00f3rios diretos no banco.</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 08:20 Autor: Bruno Tipo: F\u00f3rmula de Apura\u00e7\u00e3o (SGT) Vers\u00e3o: 1.0</p>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/","title":"EFD ICMS IPI - Simplificado v3.10","text":""},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para gera\u00e7\u00e3o da Escritura\u00e7\u00e3o Fiscal Digital (EFD ICMS/IPI) no formato simplificado, conforme vers\u00e3o 3.10 do leiaute. O processo consolida todos os dados fiscais do per\u00edodo (m\u00eas/ano) e gera os registros dos blocos 0, B, C, D, E, G, H, K, 1 e 9 conforme as regras da Receita Federal.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar o arquivo digital da EFD ICMS/IPI contendo: - Identifica\u00e7\u00e3o da empresa e per\u00edodos - Documentos fiscais de entrada e sa\u00edda - Apura\u00e7\u00f5es de ICMS, IPI, ICMS-ST e DIFAL - Controle de produ\u00e7\u00e3o e estoque (CIAP) - Invent\u00e1rio f\u00edsico - Outras informa\u00e7\u00f5es complementares</p>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Auditoria Fiscal</li> <li>Faturamento</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens dos documentos fiscais - <code>Eaa0102</code> - Informa\u00e7\u00f5es complementares dos documentos - <code>Eaa01031</code> - Lan\u00e7amentos fiscais - <code>Edb01</code> - Apura\u00e7\u00f5es fiscais (ICMS, IPI, ST, DIFAL) - <code>Edb0101</code> - Ajustes das apura\u00e7\u00f5es - <code>Edb0102</code> - Obriga\u00e7\u00f5es a recolher - <code>Ecc01</code> - Controle de CIAP (Cr\u00e9dito de ICMS do Ativo Permanente) - <code>Bcb11</code> - Itens de invent\u00e1rio - <code>Bcc01</code> - Movimenta\u00e7\u00f5es de estoque - <code>Aac10</code> - Empresa - <code>Abe01</code> - Entidades (clientes/fornecedores) - <code>Abm01</code> - Itens (produtos/servi\u00e7os) - <code>Abb20</code> - Bens do ativo imobilizado - Entre outras 50+ tabelas relacionadas</p>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o dtInicial LocalDate Sim Data inicial do per\u00edodo (geralmente primeiro dia do m\u00eas) dtFinal LocalDate Sim Data final do per\u00edodo (geralmente \u00faltimo dia do m\u00eas) arqSubstituto Integer N\u00e3o Indicador de arquivo substituto (0 ou 1) dtInventario LocalDate N\u00e3o Data do invent\u00e1rio f\u00edsico (\u00faltimo dia do m\u00eas)"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o dos dados da empresa (Aac10)</li> <li>Verifica\u00e7\u00e3o das informa\u00e7\u00f5es fiscais (Aac13)</li> <li>Defini\u00e7\u00e3o do perfil (A, B ou C)</li> <li>Configura\u00e7\u00e3o dos alinhamentos (0050, 0030, 0033, 0032, 0031)</li> <li>Inicializa\u00e7\u00e3o dos contadores de registros</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#2-geracao-do-bloco-0-abertura-e-identificacao","title":"2. Gera\u00e7\u00e3o do Bloco 0 - Abertura e Identifica\u00e7\u00e3o","text":"<ul> <li>Registro 0000: Abertura do arquivo e identifica\u00e7\u00e3o da empresa</li> <li>Registro 0001: Abertura do bloco 0</li> <li>Registro 0002: Classifica\u00e7\u00e3o industrial (se aplic\u00e1vel)</li> <li>Registro 0005: Dados complementares da empresa</li> <li>Registro 0015: Dados do contribuinte substituto</li> <li>Registro 0100: Dados do contabilista</li> <li>Inicializa\u00e7\u00e3o das estruturas para registros 0150, 0190, 0200, etc.</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#3-geracao-do-bloco-b-escrituracao-do-iss","title":"3. Gera\u00e7\u00e3o do Bloco B - Escritura\u00e7\u00e3o do ISS","text":"<ul> <li>Registro B001: Abertura do bloco B</li> <li>Registro B990: Encerramento do bloco B</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#4-geracao-do-bloco-c-documentos-fiscais-i-icmsipi","title":"4. Gera\u00e7\u00e3o do Bloco C - Documentos Fiscais I (ICMS/IPI)","text":"<ul> <li>Registro C001: Abertura do bloco C</li> <li>Se\u00e7\u00e3o C100: Notas fiscais (modelos 01, 1B, 04, 55)</li> <li>Registros C101, C110-C115, C120, C130, C140-C141, C160</li> <li>Registros C170-C179: Itens dos documentos</li> <li>Registros C190, C195, C197: An\u00e1lises e observa\u00e7\u00f5es</li> <li>Se\u00e7\u00e3o C300: Notas fiscais de venda a consumidor (modelo 02)</li> <li>Registros C310, C320-C321</li> <li>Se\u00e7\u00e3o C350: Notas fiscais de venda a consumidor (modelo 02 - individual)</li> <li>Registros C370, C390</li> <li>Se\u00e7\u00e3o C500: Notas de energia, g\u00e1s, \u00e1gua (modelos 06, 66, 28, 29)</li> <li>Registro C590</li> <li>Se\u00e7\u00e3o C800: Cupons fiscais eletr\u00f4nicos SAT (modelo 59)</li> <li>Registros C850, C860, C890</li> <li>Registro C990: Encerramento do bloco C</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#5-geracao-do-bloco-d-documentos-fiscais-ii-servicos-icms","title":"5. Gera\u00e7\u00e3o do Bloco D - Documentos Fiscais II (Servi\u00e7os - ICMS)","text":"<ul> <li>Registro D001: Abertura do bloco D</li> <li>Se\u00e7\u00e3o D100: Notas de servi\u00e7o de transporte (modelos 07, 08, 09, etc.)</li> <li>Registros D101, D190, D195, D197</li> <li>Se\u00e7\u00e3o D500: Notas de comunica\u00e7\u00e3o/telecomunica\u00e7\u00e3o (modelos 21, 22)</li> <li>Registro D590</li> <li>Registro D990: Encerramento do bloco D</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#6-geracao-do-bloco-e-apuracao-do-icms-e-ipi","title":"6. Gera\u00e7\u00e3o do Bloco E - Apura\u00e7\u00e3o do ICMS e IPI","text":"<ul> <li>Registro E001: Abertura do bloco E</li> <li>Se\u00e7\u00e3o E100: Per\u00edodo da apura\u00e7\u00e3o do ICMS</li> <li>Registros E110-E116: Apura\u00e7\u00e3o, ajustes e obriga\u00e7\u00f5es</li> <li>Se\u00e7\u00e3o E200: Apura\u00e7\u00e3o do ICMS-ST</li> <li>Registros E210, E220-E230, E250</li> <li>Se\u00e7\u00e3o E300: Apura\u00e7\u00e3o do DIFAL</li> <li>Registros E310-E316</li> <li>Se\u00e7\u00e3o E500: Apura\u00e7\u00e3o do IPI (se industrial)</li> <li>Registros E510, E520, E530</li> <li>Registro E990: Encerramento do bloco E</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#7-geracao-do-bloco-g-ciap-credito-de-icms-do-ativo-permanente","title":"7. Gera\u00e7\u00e3o do Bloco G - CIAP (Cr\u00e9dito de ICMS do Ativo Permanente)","text":"<ul> <li>Registro G001: Abertura do bloco G</li> <li>Registro G110: Totais do CIAP</li> <li>Registro G125: Movimenta\u00e7\u00e3o de bens</li> <li>Registro G126: Outros cr\u00e9ditos</li> <li>Registro G130: Identifica\u00e7\u00e3o dos documentos</li> <li>Registro G140: Itens dos documentos</li> <li>Registro G990: Encerramento do bloco G</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#8-geracao-do-bloco-h-inventario-fisico","title":"8. Gera\u00e7\u00e3o do Bloco H - Invent\u00e1rio F\u00edsico","text":"<ul> <li>Registro H001: Abertura do bloco H</li> <li>Registro H005: Totais do invent\u00e1rio</li> <li>Registro H010: Itens do invent\u00e1rio</li> <li>Registro H020: Informa\u00e7\u00f5es complementares</li> <li>Registro H990: Encerramento do bloco H</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#9-geracao-do-bloco-k-controle-de-producao-e-estoque","title":"9. Gera\u00e7\u00e3o do Bloco K - Controle de Produ\u00e7\u00e3o e Estoque","text":"<ul> <li>Registro K001: Abertura do bloco K</li> <li>Registro K100: Per\u00edodo de apura\u00e7\u00e3o</li> <li>Registros K200-K302: Estoque, produ\u00e7\u00f5es, corre\u00e7\u00f5es</li> <li>Registro K990: Encerramento do bloco K</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#10-geracao-do-bloco-1-outras-informacoes","title":"10. Gera\u00e7\u00e3o do Bloco 1 - Outras Informa\u00e7\u00f5es","text":"<ul> <li>Registro 1001: Abertura do bloco 1</li> <li>Registro 1010: Obrigatoriedade de registros</li> <li>Registro 1100: Informa\u00e7\u00f5es sobre exporta\u00e7\u00e3o</li> <li>Registro 1400: Informa\u00e7\u00f5es sobre valores agregados</li> <li>Registro 1990: Encerramento do bloco 1</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#11-completamento-do-bloco-0","title":"11. Completamento do Bloco 0","text":"<ul> <li>Registros 0150-0175: Cadastro de participantes</li> <li>Registro 0190: Unidades de medida</li> <li>Registros 0200-0220: Identifica\u00e7\u00e3o de itens</li> <li>Registros 0300-0305: Bens do CIAP</li> <li>Registros 0400, 0450, 0460: Tabelas auxiliares</li> <li>Registros 0500, 0600: Plano de contas e centros de custo</li> <li>Registro 0990: Encerramento do bloco 0</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#12-geracao-do-bloco-9-controle-e-encerramento","title":"12. Gera\u00e7\u00e3o do Bloco 9 - Controle e Encerramento","text":"<ul> <li>Registro 9001: Abertura do bloco 9</li> <li>Registro 9900: Quantifica\u00e7\u00e3o de registros por tipo</li> <li>Registro 9990: Encerramento do bloco 9</li> <li>Registro 9999: Encerramento do arquivo</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#perfis-de-apuracao","title":"Perfis de Apura\u00e7\u00e3o","text":"<ul> <li>Perfil A: Completo (todas as opera\u00e7\u00f5es)</li> <li>Perfil B: Simplificado (algumas exclus\u00f5es)</li> <li>Perfil C: Super simplificado (apenas essenciais)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#filtros-de-documentos","title":"Filtros de Documentos","text":"<ul> <li>Considera apenas documentos com <code>eaa01iEfdIcms = 1</code></li> <li>Ignora documentos cancelados (situa\u00e7\u00e3o 02, 03)</li> <li>Processa por data de entrada/sa\u00edda conforme configura\u00e7\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#validacoes-obrigatorias","title":"Valida\u00e7\u00f5es Obrigat\u00f3rias","text":"<ul> <li>Empresa deve ter munic\u00edpio e endere\u00e7o cadastrados</li> <li>Informa\u00e7\u00f5es fiscais (Aac13) devem estar completas</li> <li>Apura\u00e7\u00f5es (Edb01) devem existir para o per\u00edodo</li> <li>Itens devem ter configura\u00e7\u00f5es fiscais (Abm0101)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#tratamento-de-campos","title":"Tratamento de Campos","text":"<ul> <li>Formata\u00e7\u00e3o de CNPJ/CPF (somente n\u00fameros)</li> <li>Inscri\u00e7\u00f5es estaduais \"ISENTO\" s\u00e3o convertidas para null</li> <li>Valores monet\u00e1rios com 2 casas decimais</li> <li>Datas no formato DDMMYYYY</li> <li>S\u00e9rie da nota limitada a 3 caracteres</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra toda a gera\u00e7\u00e3o da EFD.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#geraraberturabloco0","title":"<code>gerarAberturaBloco0()</code>","text":"<p>Configura os registros iniciais do bloco 0.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#gerarblococ-gerarblocod-gerarblocoe-etc","title":"<code>gerarBlocoC()</code>, <code>gerarBlocoD()</code>, <code>gerarBlocoE()</code>, etc.","text":"<p>M\u00e9todos espec\u00edficos para cada bloco da EFD.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#buscardocumentospormodelo-buscardocumentospormovimentomodelo","title":"<code>buscarDocumentosPorModelo()</code>, <code>buscarDocumentosPorMovimentoModelo()</code>","text":"<p>Consultas para recuperar documentos por modelo e movimento.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#comporregistro0200-comporregistro0220","title":"<code>comporRegistro0200()</code>, <code>comporRegistro0220()</code>","text":"<p>Montam os registros de identifica\u00e7\u00e3o de itens.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#gerarcodigoentidade","title":"<code>gerarCodigoEntidade()</code>","text":"<p>Gera c\u00f3digo \u00fanico para entidades (considera m\u00faltiplas IEs).</p>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#gerarregbyperfil","title":"<code>gerarRegByPerfil()</code>","text":"<p>Define se um registro deve ser gerado conforme o perfil.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Arquivo de Texto: - Dois arquivos concatenados (txt1 e txt2) - Formato delimitado por pipe (<code>|</code>) - Codifica\u00e7\u00e3o UTF-8 - Linhas no formato: <code>REG|CAMPO1|CAMPO2|...|CAMPOn</code></p> <p>Conte\u00fado Principal: - Bloco 0: Identifica\u00e7\u00e3o e cadastros - Bloco C: Documentos de mercadorias - Bloco D: Documentos de servi\u00e7os - Bloco E: Apura\u00e7\u00f5es - Bloco G: CIAP - Bloco H: Invent\u00e1rio - Bloco K: Produ\u00e7\u00e3o/estoque - Bloco 1: Informa\u00e7\u00f5es complementares - Bloco 9: Controle</p>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios de data, strings, cole\u00e7\u00f5es - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.model</code> - Entidades do sistema (100+ classes) - <code>java.time</code> - Manipula\u00e7\u00e3o de datas - <code>java.math</code> - Precis\u00e3o decimal</p> <p>M\u00f3dulo: SGT (Sistema de Gest\u00e3o Tribut\u00e1ria)</p>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#performance","title":"Performance","text":"<ul> <li>Processamento paginado para grandes volumes</li> <li>Cache de entidades em mem\u00f3ria</li> <li>Agrupamento de registros similares</li> <li>Uso de TableMap para estruturas din\u00e2micas</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#contadores","title":"Contadores","text":"<ul> <li>Contagem precisa de cada tipo de registro</li> <li>Utilizado no registro 9900 para valida\u00e7\u00e3o</li> <li>Atualizado incrementalmente durante o processamento</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#campos-dinamicos-json","title":"Campos Din\u00e2micos (JSON)","text":"<ul> <li>Valores fiscais armazenados em campos JSON (eaa01json, eaa0103json, etc.)</li> <li>Chaves configur\u00e1veis via alinhamentos</li> <li>Flexibilidade para diferentes configura\u00e7\u00f5es por empresa</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_ICMS_IPI_Simplificado_v310/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Verifica\u00e7\u00e3o de cancelamento do processo</li> <li>Atualiza\u00e7\u00e3o de status durante execu\u00e7\u00e3o</li> <li>Valida\u00e7\u00f5es de integridade dos dados</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 08:20 Autor: Bruno Tipo: F\u00f3rmula de EFD ICMS/IPI Vers\u00e3o: 3.10 Leiaute: Vers\u00e3o 16 (PVA 3.1.0)</p>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/","title":"EFD_Leiaute15_2021 - Gera\u00e7\u00e3o de EFD Contribui\u00e7\u00f5es (PIS/COFINS)","text":""},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para gera\u00e7\u00e3o do arquivo digital da EFD Contribui\u00e7\u00f5es (PIS/COFINS) conforme Leiaute 15 vers\u00e3o 2021, contemplando m\u00faltiplos blocos e registros exigidos pela legisla\u00e7\u00e3o fiscal.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar automaticamente o arquivo da Escritura\u00e7\u00e3o Fiscal Digital de Contribui\u00e7\u00f5es (EFD-Contribui\u00e7\u00f5es), processando documentos fiscais, opera\u00e7\u00f5es diversas, apura\u00e7\u00f5es e registros complementares para entrega \u00e0 Receita Federal.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Faturamento</li> <li>Departamento Pessoal (para folha de pagamento)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Aac10</code> - Empresas - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens dos documentos fiscais - <code>Edb10</code> - Apura\u00e7\u00e3o da receita bruta - <code>Edb11</code> - Opera\u00e7\u00f5es geradoras de cr\u00e9dito - <code>Edb12</code> - Reten\u00e7\u00f5es na fonte - <code>Edb13</code> - Dedu\u00e7\u00f5es diversas - <code>Edb14</code> - Cr\u00e9ditos por incorpora\u00e7\u00e3o/fus\u00e3o/cis\u00e3o - <code>Abe01</code> - Entidades (clientes/fornecedores) - <code>Abm01</code> - Itens (produtos/servi\u00e7os) - <code>Abb40</code> - Processos referencia dos</p>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o dtInicial LocalDate Sim Data inicial do per\u00edodo de apura\u00e7\u00e3o dtFinal LocalDate Sim Data final do per\u00edodo de apura\u00e7\u00e3o situacao Integer Sim Situa\u00e7\u00e3o da EFD (0=Original, 1=Substituta, 9=Retificadora) numRecibo String N\u00e3o N\u00famero do recibo (para retifica\u00e7\u00f5es) aliqPisF150 BigDecimal N\u00e3o Al\u00edquota de PIS para estoque de abertura aliqCofinsF150 BigDecimal N\u00e3o Al\u00edquota de COFINS para estoque de abertura"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o dos par\u00e2metros obrigat\u00f3rios</li> <li>Busca da empresa matriz e filiais</li> <li>Verifica\u00e7\u00e3o da apura\u00e7\u00e3o da receita bruta do per\u00edodo</li> <li>Inicializa\u00e7\u00e3o de contadores e estruturas de dados</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#2-geracao-do-bloco-0-abertura-e-identificacao","title":"2. Gera\u00e7\u00e3o do Bloco 0 - Abertura e Identifica\u00e7\u00e3o","text":"<ul> <li>Registro 0000: Abertura do arquivo e identifica\u00e7\u00e3o da entidade</li> <li>Registro 0001: Abertura do Bloco 0</li> <li>Registro 0100: Dados do contabilista</li> <li>Registro 0110: Regimes de apura\u00e7\u00e3o</li> <li>Registro 0111: Receita bruta para rateio de cr\u00e9ditos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#3-geracao-do-bloco-a-documentos-fiscais-de-servicos","title":"3. Gera\u00e7\u00e3o do Bloco A - Documentos Fiscais de Servi\u00e7os","text":"<ul> <li>Registro A001: Abertura do Bloco A</li> <li>Registro A010: Identifica\u00e7\u00e3o do estabelecimento</li> <li>Registro A100: Nota Fiscal de Servi\u00e7o</li> <li>Registros filhos: A110, A111, A120, A170</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#4-geracao-do-bloco-c-documentos-fiscais-de-mercadorias-icmsipi","title":"4. Gera\u00e7\u00e3o do Bloco C - Documentos Fiscais de Mercadorias (ICMS/IPI)","text":"<ul> <li>Registro C001: Abertura do Bloco C</li> <li>Registro C010: Identifica\u00e7\u00e3o do estabelecimento</li> <li>Registro C100: Nota Fiscal/NF-e/NFC-e</li> <li>Registros filhos: C110, C111, C120, C170, C175</li> <li>Registro C395: Nota Fiscal de Venda a Consumidor</li> <li>Registro C396: Itens do documento</li> <li>Registro C500: Nota Fiscal de Energia/\u00c1gua/G\u00e1s</li> <li>Registros filhos: C501, C505, C509</li> <li>Registro C860: Cupom Fiscal Eletr\u00f4nico SAT</li> <li>Registro C870: Resumo di\u00e1rio do CF-e</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#5-geracao-do-bloco-d-documentos-fiscais-de-servicos-icms","title":"5. Gera\u00e7\u00e3o do Bloco D - Documentos Fiscais de Servi\u00e7os (ICMS)","text":"<ul> <li>Registro D001: Abertura do Bloco D</li> <li>Registro D010: Identifica\u00e7\u00e3o do estabelecimento</li> <li>Registro D100: Nota Fiscal/Conhecimento de Transporte</li> <li>Registros filhos: D101, D105, D111</li> <li>Registro D500: Nota Fiscal de Servi\u00e7o de Comunica\u00e7\u00e3o</li> <li>Registros filhos: D501, D505, D509</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#6-geracao-do-bloco-f-demais-documentos-e-operacoes","title":"6. Gera\u00e7\u00e3o do Bloco F - Demais Documentos e Opera\u00e7\u00f5es","text":"<ul> <li>Registro F001: Abertura do Bloco F</li> <li>Registro F010: Identifica\u00e7\u00e3o do estabelecimento</li> <li>Registro F100: Opera\u00e7\u00f5es geradoras de contribui\u00e7\u00e3o e cr\u00e9ditos</li> <li>Registro F120: Bens que geram cr\u00e9ditos por deprecia\u00e7\u00e3o</li> <li>Registro F130: Bens que geram cr\u00e9ditos por valor de aquisi\u00e7\u00e3o</li> <li>Registro F150: Cr\u00e9dito presumido sobre estoque de abertura</li> <li>Registro F550: Consolida\u00e7\u00e3o das opera\u00e7\u00f5es (lucro presumido)</li> <li>Registro F600: Contribui\u00e7\u00e3o retida na fonte</li> <li>Registro F700: Dedu\u00e7\u00f5es diversas</li> <li>Registro F800: Cr\u00e9ditos por incorpora\u00e7\u00e3o/fus\u00e3o/cis\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#7-geracao-do-bloco-p-contribuicao-previdenciaria-sobre-receita-bruta","title":"7. Gera\u00e7\u00e3o do Bloco P - Contribui\u00e7\u00e3o Previdenci\u00e1ria sobre Receita Bruta","text":"<ul> <li>Registro P001: Abertura do Bloco P</li> <li>Registro P010: Identifica\u00e7\u00e3o do estabelecimento</li> <li>Registro P100: Contribui\u00e7\u00e3o previdenci\u00e1ria sobre receita bruta</li> <li>Registro P200: Consolida\u00e7\u00e3o</li> <li>Registro P210: Ajustes</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#8-geracao-do-bloco-1-operacoes-extemporaneas","title":"8. Gera\u00e7\u00e3o do Bloco 1 - Opera\u00e7\u00f5es Extempor\u00e2neas","text":"<ul> <li>Registro 1001: Abertura do Bloco 1</li> <li>Registro 1010: Processo referenciado - A\u00e7\u00e3o judicial</li> <li>Registro 1020: Processo referenciado - Processo administrativo</li> <li>Registro 1900: Consolida\u00e7\u00e3o de documentos PJ lucro presumido</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#9-finalizacao","title":"9. Finaliza\u00e7\u00e3o","text":"<ul> <li>Registros 0140-0600: Tabelas auxiliares (participantes, itens, etc.)</li> <li>Registro 0990: Encerramento do Bloco 0</li> <li>Registro 9990/9999: Encerramento do arquivo</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Verifica\u00e7\u00e3o de apura\u00e7\u00e3o da receita bruta obrigat\u00f3ria</li> <li>Valida\u00e7\u00e3o de situa\u00e7\u00e3o dos documentos fiscais</li> <li>Controle de empresas j\u00e1 processadas por grupo centralizador</li> <li>Verifica\u00e7\u00e3o de dados obrigat\u00f3rios para cada registro</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#tratamento-de-documentos","title":"Tratamento de Documentos","text":"<ul> <li>Documentos com situa\u00e7\u00e3o especial (02, 03, 04, 05) geram registros parciais</li> <li>Suporte a m\u00faltiplos modelos de documentos fiscais</li> <li>Tratamento diferenciado para entrada/sa\u00edda</li> <li>Agrupamento por estabelecimento/empresa</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#calculos-financeiros","title":"C\u00e1lculos Financeiros","text":"<ul> <li>C\u00e1lculo de bases de PIS/COFINS</li> <li>Aplica\u00e7\u00e3o de al\u00edquotas espec\u00edficas</li> <li>Rateio de cr\u00e9ditos comuns</li> <li>Consolida\u00e7\u00e3o de valores por agrupamento</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra toda a gera\u00e7\u00e3o da EFD Contribui\u00e7\u00f5es.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#geraraberturabloco0","title":"<code>gerarAberturaBloco0()</code>","text":"<p>Gera os registros iniciais do Bloco 0.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#gerarblocoa-gerarblococ-gerarblocod-gerarblocof-gerarblocop-gerarbloco1","title":"<code>gerarBlocoA()</code>, <code>gerarBlocoC()</code>, <code>gerarBlocoD()</code>, <code>gerarBlocoF()</code>, <code>gerarBlocoP()</code>, <code>gerarBloco1()</code>","text":"<p>M\u00e9todos espec\u00edficos para gera\u00e7\u00e3o de cada bloco da EFD.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#gerarc100-gerarc300-gerarc500-gerarc800","title":"<code>gerarC100()</code>, <code>gerarC300()</code>, <code>gerarC500()</code>, <code>gerarC800()</code>","text":"<p>M\u00e9todos auxiliares para tipos espec\u00edficos de documentos do Bloco C.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#gerarfechamentobloco0","title":"<code>gerarFechamentoBloco0()</code>","text":"<p>Gera as tabelas auxiliares e finaliza o Bloco 0.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#gerarbloco9","title":"<code>gerarBloco9()</code>","text":"<p>Gera o Bloco 9 de controle e encerramento.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#formatarvalor-formatarserie-retirarmascara","title":"<code>formatarValor()</code>, <code>formatarSerie()</code>, <code>retirarMascara()</code>","text":"<p>M\u00e9todos utilit\u00e1rios para formata\u00e7\u00e3o de dados.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#selecionarcstpis-selecionarcstcofins","title":"<code>selecionarCSTPis()</code>, <code>selecionarCSTCofins()</code>","text":"<p>M\u00e9todos para defini\u00e7\u00e3o correta do CST conforme movimento e base de c\u00e1lculo.</p>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Arquivo Texto: - Dois arquivos concatenados (txt1 e txt2) - Formato delimitado por pipe (\"|\") - Codifica\u00e7\u00e3o espec\u00edfica para EFD - Registros organizados por blocos</p> <p>Conte\u00fado: - Bloco 0: Identifica\u00e7\u00e3o e tabelas auxiliares - Bloco A: Documentos de servi\u00e7os - Bloco C: Documentos de mercadorias - Bloco D: Documentos de servi\u00e7os (ICMS) - Bloco F: Opera\u00e7\u00f5es diversas - Bloco M: Apura\u00e7\u00e3o (reservado) - Bloco P: Contribui\u00e7\u00e3o previdenci\u00e1ria - Bloco 1: Opera\u00e7\u00f5es extempor\u00e2neas - Bloco 9: Controle e encerramento</p>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios diversos - <code>java.time</code> - Manipula\u00e7\u00e3o de datas - <code>java.math</code> - C\u00e1lculos com BigDecimal</p> <p>M\u00f3dulos: - M\u00f3dulo Fiscal - M\u00f3dulo Cont\u00e1bil - M\u00f3dulo de Estoques - M\u00f3dulo de Servi\u00e7os</p>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#performance","title":"Performance","text":"<ul> <li>Processamento paginado para grandes volumes</li> <li>Uso de caching para dados frequentes</li> <li>Agrupamento em mem\u00f3ria para consolida\u00e7\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#tratamento-de-erros","title":"Tratamento de Erros","text":"<ul> <li>Valida\u00e7\u00f5es preventivas</li> <li>Mensagens de erro espec\u00edficas</li> <li>Continuidade ap\u00f3s erros n\u00e3o-cr\u00edticos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#configurabilidade","title":"Configurabilidade","text":"<ul> <li>Suporte a m\u00faltiplas empresas/filiais</li> <li>Configura\u00e7\u00e3o por grupo centralizador</li> <li>Par\u00e2metros flex\u00edveis por per\u00edodo</li> </ul>"},{"location":"LINHASITA/formulas/sgt/EFD_Leiaute15_2021/#campos-json","title":"Campos JSON","text":"<ul> <li>Extens\u00e3o de campos via JSON em v\u00e1rias tabelas</li> <li>Mapeamento din\u00e2mico de campos da EFD</li> <li>Suporte a vers\u00f5es diferentes do leiaute</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 08:20 Autor: Bruno Tipo: F\u00f3rmula de EFD Contribui\u00e7\u00f5es Vers\u00e3o: 1.0 Leiaute: 015 (vers\u00e3o 2021) M\u00f3dulo: Fiscal/Cont\u00e1bil</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/","title":"SGT_Apuracao_EFD_ICMS - Apura\u00e7\u00e3o de ICMS para EFD","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para c\u00e1lculo e apura\u00e7\u00e3o do Imposto sobre Circula\u00e7\u00e3o de Mercadorias e Servi\u00e7os (ICMS) para gera\u00e7\u00e3o da Escritura\u00e7\u00e3o Fiscal Digital (EFD), realizando a consolida\u00e7\u00e3o de d\u00e9bitos, cr\u00e9ditos, ajustes e saldos do per\u00edodo.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente os valores de ICMS a pagar ou compensar em um per\u00edodo fiscal, consolidando opera\u00e7\u00f5es de entrada e sa\u00edda, ajustes fiscais, dedu\u00e7\u00f5es e saldos anteriores para gera\u00e7\u00e3o da EFD-ICMS.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Faturamento</li> <li>Departamento de Tributos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Edb01</code> - Apura\u00e7\u00e3o fiscal principal - <code>Edb0101</code> - Ajustes da apura\u00e7\u00e3o - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens dos documentos fiscais - <code>Eaa01035</code> - Ajustes fiscais dos itens - <code>Aaj17</code> - Tipos de ajustes fiscais - <code>Aaj15</code> - CFOP (C\u00f3digo Fiscal de Opera\u00e7\u00f5es e Presta\u00e7\u00f5es) - <code>Aah01</code> - Modelos de documentos fiscais - <code>Aaj03</code> - Situa\u00e7\u00f5es dos documentos</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o edb01 Edb01 Sim Objeto de apura\u00e7\u00e3o fiscal contendo m\u00eas, ano e tipo"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Obten\u00e7\u00e3o do objeto de apura\u00e7\u00e3o (Edb01)</li> <li>Inicializa\u00e7\u00e3o da estrutura JSON para armazenamento dos c\u00e1lculos</li> <li>Defini\u00e7\u00e3o do per\u00edodo fiscal (m\u00eas/ano)</li> <li>Sele\u00e7\u00e3o do alinhamento para campos din\u00e2micos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#2-calculo-de-debitos-do-icms","title":"2. C\u00e1lculo de D\u00e9bitos do ICMS","text":"<ul> <li>01 - Sa\u00eddas com d\u00e9bito do imposto: Consolida valores de ICMS nas sa\u00eddas</li> <li>Processa 8 grupos de documentos (C190, C320, C390, C490, C590, D190, D590, C850/C890)</li> <li>Considera entradas e sa\u00eddas conforme CFOP espec\u00edfico</li> <li> <p>Filtra por modelos de documentos v\u00e1lidos</p> </li> <li> <p>02 - Ajustes de d\u00e9bito 1: Ajustes fiscais nos documentos</p> </li> <li> <p>Soma ajustes com c\u00f3digos espec\u00edficos (terceira posi\u00e7\u00e3o: 3,4,5; quarta: 0,3,4,5,6,7,8)</p> </li> <li> <p>03 - Ajustes de d\u00e9bito 2: Ajustes na apura\u00e7\u00e3o</p> </li> <li> <p>Inclui ajustes da pr\u00f3pria apura\u00e7\u00e3o (Edb0101) com c\u00f3digos terminados em \"00\"</p> </li> <li> <p>04 - Estorno de cr\u00e9ditos: Revers\u00e3o de cr\u00e9ditos utilizados</p> </li> <li>Inclui ajustes da apura\u00e7\u00e3o com c\u00f3digos terminados em \"01\"</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#3-calculo-de-creditos-do-icms","title":"3. C\u00e1lculo de Cr\u00e9ditos do ICMS","text":"<ul> <li>05 - Entradas com cr\u00e9dito do imposto: Consolida valores de ICMS nas entradas</li> <li>Processa 4 grupos de documentos (C190, C590, D190, D590)</li> <li> <p>Considera entradas e sa\u00eddas conforme CFOP espec\u00edfico</p> </li> <li> <p>06 - Ajustes \u00e0 cr\u00e9dito 1: Ajustes fiscais favor\u00e1veis nos documentos</p> </li> <li> <p>Soma ajustes com c\u00f3digos espec\u00edficos (terceira posi\u00e7\u00e3o: 0,1,2; quarta: 0,3,4,5)</p> </li> <li> <p>07 - Ajustes \u00e0 cr\u00e9dito 2: Ajustes favor\u00e1veis na apura\u00e7\u00e3o</p> </li> <li> <p>Inclui ajustes da apura\u00e7\u00e3o com c\u00f3digos terminados em \"02\"</p> </li> <li> <p>08 - Estorno de d\u00e9bitos: Revers\u00e3o de d\u00e9bitos registrados</p> </li> <li>Inclui ajustes da apura\u00e7\u00e3o com c\u00f3digos terminados em \"03\"</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#4-calculo-de-saldos-e-compensacoes","title":"4. C\u00e1lculo de Saldos e Compensa\u00e7\u00f5es","text":"<ul> <li>09 - Saldo credor anterior: Busca saldo credor do per\u00edodo anterior</li> <li>10 - Saldo devedor antes das dedu\u00e7\u00f5es: Calcula saldo bruto (d\u00e9bitos - cr\u00e9ditos)</li> <li>11 - Dedu\u00e7\u00f5es: Aplica dedu\u00e7\u00f5es autorizadas</li> <li>Ajustes fiscais com c\u00f3digo espec\u00edfico (terceira posi\u00e7\u00e3o: 6)</li> <li>Ajustes na apura\u00e7\u00e3o com c\u00f3digo \"04\"</li> <li> <p>Ajustes da pr\u00f3pria apura\u00e7\u00e3o com c\u00f3digos terminados em \"04\"</p> </li> <li> <p>12 - Saldo devedor depois das dedu\u00e7\u00f5es: Saldo l\u00edquido a pagar</p> </li> <li>13 - Saldo credor a transportar: Saldo favor\u00e1vel para per\u00edodo seguinte</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#5-valores-extra-apuracao","title":"5. Valores Extra-Apura\u00e7\u00e3o","text":"<ul> <li>14 - Valores extra-apura\u00e7\u00e3o: Opera\u00e7\u00f5es n\u00e3o inclu\u00eddas na apura\u00e7\u00e3o normal</li> <li>Processa 7 grupos de documentos (C100, C300, C400, C500, D100, D500, D590)</li> <li>Inclui ajustes com c\u00f3digos espec\u00edficos</li> <li>Considera situa\u00e7\u00f5es especiais de documentos (01, 07)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#filtros-de-documentos","title":"Filtros de Documentos","text":"<ul> <li>Situa\u00e7\u00f5es exclu\u00eddas: 01, 02, 03, 04, 05, 07 (conforme aaj03efd)</li> <li>Indicador EFD-ICMS: Apenas documentos com <code>eaa01iEfdIcms = 1</code></li> <li>CFOP para d\u00e9bitos: 5605 (sa\u00eddas) e 1605 (entradas)</li> <li>CFOP para cr\u00e9ditos: 1605 (entradas) e 5605 (sa\u00eddas)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#classificacao-de-ajustes","title":"Classifica\u00e7\u00e3o de Ajustes","text":"<ul> <li>Posi\u00e7\u00e3o 3 do c\u00f3digo: Tipo do ajuste</li> <li>0,1,2: Cr\u00e9ditos</li> <li>3,4,5: D\u00e9bitos</li> <li>6: Dedu\u00e7\u00f5es</li> <li> <p>7: Extra-apura\u00e7\u00e3o</p> </li> <li> <p>Posi\u00e7\u00e3o 4 do c\u00f3digo: Sub-tipo do ajuste</p> </li> <li>Varia conforme o tipo principal</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#modelos-de-documentos-por-grupo","title":"Modelos de Documentos por Grupo","text":"<ul> <li>D\u00e9bitos: 8 grupos com modelos espec\u00edficos</li> <li>Cr\u00e9ditos: 4 grupos com modelos espec\u00edficos</li> <li>Extra-apura\u00e7\u00e3o: 7 grupos com modelos espec\u00edficos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#tratamento-de-periodos","title":"Tratamento de Per\u00edodos","text":"<ul> <li>Entradas: Considera data de entrada (esData)</li> <li>Sa\u00eddas: Considera data do documento (abb01data)</li> <li>Per\u00edodo anterior: Busca \u00faltimo registro do mesmo tipo</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de apura\u00e7\u00e3o do ICMS.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#buscardebitosicms","title":"<code>buscarDebitosICMS()</code>","text":"<p>Busca valores de ICMS a d\u00e9bito nos documentos fiscais. - Par\u00e2metros: nome do campo, per\u00edodo, tipo (entrada/sa\u00edda), grupo de registros - Retorna: Soma dos valores de d\u00e9bito</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#buscarcreditosicms","title":"<code>buscarCreditosICMS()</code>","text":"<p>Busca valores de ICMS a cr\u00e9dito nos documentos fiscais. - Par\u00e2metros: nome do campo, per\u00edodo, tipo (entrada/sa\u00edda), grupo de registros - Retorna: Soma dos valores de cr\u00e9dito</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#buscarajustesdebdoctsicms-buscarajustescreddoctsicms","title":"<code>buscarAjustesDebDoctsICMS()</code>, <code>buscarAjustesCredDoctsICMS()</code>","text":"<p>Buscam ajustes de d\u00e9bito/cr\u00e9dito nos documentos. - Filtram por c\u00f3digo de ajuste espec\u00edfico - Consideram diferentes modelos de documentos</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#buscarajustesdebapuricms-buscarajustescredapuricms","title":"<code>buscarAjustesDebApurICMS()</code>, <code>buscarAjustesCredApurICMS()</code>","text":"<p>Buscam ajustes de d\u00e9bito/cr\u00e9dito na apura\u00e7\u00e3o. - Incluem mais modelos de documentos - Filtram situa\u00e7\u00f5es de documentos diferentes</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#buscarestornocredicms-buscarestornodebicms","title":"<code>buscarEstornoCredICMS()</code>, <code>buscarEstornoDebICMS()</code>","text":"<p>Buscam estornos de cr\u00e9ditos e d\u00e9bitos. - C\u00f3digos espec\u00edficos para estornos</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#buscarsaldocredoranterior","title":"<code>buscarSaldoCredorAnterior()</code>","text":"<p>Busca saldo credor do per\u00edodo anterior. - Consulta apura\u00e7\u00f5es do mesmo tipo em meses anteriores</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#buscardeducoesajustesfiscais-buscardeducoesajustesapuracao","title":"<code>buscarDeducoesAjustesFiscais()</code>, <code>buscarDeducoesAjustesApuracao()</code>","text":"<p>Buscam valores de dedu\u00e7\u00f5es autorizadas. - Ajustes fiscais e de apura\u00e7\u00e3o espec\u00edficos</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#buscarvalorextraapur-buscarvalorextraapuricms-buscarvalorextraapuricmsestorno","title":"<code>buscarValorExtraApur()</code>, <code>buscarValorExtraApurICMS()</code>, <code>buscarValorExtraApurICMSEstorno()</code>","text":"<p>Buscam valores fora da apura\u00e7\u00e3o normal. - Documentos com situa\u00e7\u00f5es especiais - Ajustes de extra-apura\u00e7\u00e3o</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#buscarmodelosdeb-buscarmodeloscred-buscarmodelosextraapur","title":"<code>buscarModelosDeb()</code>, <code>buscarModelosCred()</code>, <code>buscarModelosExtraApur()</code>","text":"<p>Definem listas de modelos de documentos por grupo. - Retornam lista espec\u00edfica para cada tipo de consulta</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>JSON da Apura\u00e7\u00e3o (edb01json): - <code>debSaidas</code> - Sa\u00eddas com d\u00e9bito do imposto - <code>debAjustes</code> - Ajustes de d\u00e9bito nos documentos - <code>debAjustesApur</code> - Ajustes de d\u00e9bito na apura\u00e7\u00e3o - <code>estornoCred</code> - Estorno de cr\u00e9ditos - <code>credEntradas</code> - Entradas com cr\u00e9dito do imposto - <code>credAjustes</code> - Ajustes \u00e0 cr\u00e9dito nos documentos - <code>credAjustesApur</code> - Ajustes \u00e0 cr\u00e9dito na apura\u00e7\u00e3o - <code>estornoDeb</code> - Estorno de d\u00e9bitos - <code>saldoCredorAnt</code> - Saldo credor do per\u00edodo anterior - <code>saldo</code> - Saldo devedor antes das dedu\u00e7\u00f5es - <code>deducoes</code> - Dedu\u00e7\u00f5es aplic\u00e1veis - <code>saldoDevedor</code> - Saldo devedor l\u00edquido - <code>saldoCredor</code> - Saldo credor a transportar - <code>valoresExtra</code> - Valores extra-apura\u00e7\u00e3o</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios diversos - <code>java.time</code> - Manipula\u00e7\u00e3o de datas</p> <p>M\u00f3dulos: - M\u00f3dulo Fiscal - M\u00f3dulo de Documentos Fiscais - M\u00f3dulo de Apura\u00e7\u00f5es Fiscais</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#consultas-dinamicas","title":"Consultas Din\u00e2micas","text":"<ul> <li>Uso de campos JSON din\u00e2micos (<code>jGet()</code>)</li> <li>Filtros por posi\u00e7\u00e3o de caracteres em c\u00f3digos</li> <li>Consultas parametrizadas por grupo de modelos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#performance","title":"Performance","text":"<ul> <li>Consultas otimizadas com filtros espec\u00edficos</li> <li>Somas diretas no banco de dados</li> <li>Uso de \u00edndices por per\u00edodo e situa\u00e7\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#flexibilidade","title":"Flexibilidade","text":"<ul> <li>Suporte a m\u00faltiplos modelos de documentos</li> <li>Configura\u00e7\u00e3o por tipo de apura\u00e7\u00e3o</li> <li>Campos din\u00e2micos via alinhamento</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMS/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Exclus\u00e3o de situa\u00e7\u00f5es de documento inv\u00e1lidas</li> <li>Verifica\u00e7\u00e3o do indicador EFD-ICMS</li> <li>Filtros por CFOP adequados</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 08:20 Autor: Bruno Tipo: F\u00f3rmula de Apura\u00e7\u00e3o Fiscal Vers\u00e3o: 1.0 Tributo: ICMS Destino: EFD (Escritura\u00e7\u00e3o Fiscal Digital)</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/","title":"SGT_Apuracao_EFD_ICMSDifAliq - Apura\u00e7\u00e3o de Diferencial de Al\u00edquota do ICMS e FCP","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para c\u00e1lculo e apura\u00e7\u00e3o do Diferencial de Al\u00edquota do ICMS (DIFAL) e do Fundo de Combate \u00e0 Pobreza (FCP) para gera\u00e7\u00e3o da Escritura\u00e7\u00e3o Fiscal Digital (EFD), contemplando opera\u00e7\u00f5es interestaduais com diferentes al\u00edquotas entre estados.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente os valores de DIFAL e FCP devidos em opera\u00e7\u00f5es interestaduais, considerando a diferen\u00e7a entre al\u00edquotas interna e interestadual, al\u00e9m de gerar apura\u00e7\u00f5es espec\u00edficas por estado da federa\u00e7\u00e3o.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Faturamento</li> <li>Departamento de Tributos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Edb01</code> - Apura\u00e7\u00e3o fiscal principal - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens dos documentos fiscais - <code>Eaa01035</code> - Ajustes fiscais dos itens - <code>Eaa0101</code> - Informa\u00e7\u00f5es complementares dos documentos - <code>Aag02</code> - Estados da federa\u00e7\u00e3o - <code>Aag0201</code> - Munic\u00edpios - <code>Aaj17</code> - Tipos de ajustes fiscais - <code>Aah01</code> - Modelos de documentos fiscais - <code>Aac10</code> - Empresa</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o edb01 Edb01 Sim Objeto de apura\u00e7\u00e3o fiscal contendo m\u00eas, ano e tipo"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Obten\u00e7\u00e3o do objeto de apura\u00e7\u00e3o (Edb01)</li> <li>Identifica\u00e7\u00e3o da empresa ativa</li> <li>Defini\u00e7\u00e3o do per\u00edodo fiscal (m\u00eas/ano)</li> <li>Sele\u00e7\u00e3o do alinhamento para campos din\u00e2micos</li> <li>Identifica\u00e7\u00e3o dos campos JSON para DIFAL e FCP</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#2-identificacao-dos-estados","title":"2. Identifica\u00e7\u00e3o dos Estados","text":"<ul> <li>Verifica se h\u00e1 estado espec\u00edfico na apura\u00e7\u00e3o</li> <li>Se n\u00e3o houver, busca todos os estados da federa\u00e7\u00e3o</li> <li>Exclui estado \"EX\" (Exterior)</li> <li>Identifica se o estado \u00e9 o mesmo da empresa</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#3-processamento-por-estado","title":"3. Processamento por Estado","text":"<p>Para cada estado identificado:</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#verificacao-inicial","title":"Verifica\u00e7\u00e3o Inicial","text":"<ul> <li>Verifica se \u00e9 a primeira apura\u00e7\u00e3o para o estado</li> <li>Identifica se o estado \u00e9 o mesmo da empresa (UF de origem)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#calculo-do-difal-diferencial-de-aliquota","title":"C\u00e1lculo do DIFAL (Diferencial de Al\u00edquota)","text":"<p>3.1 Saldo Credor Anterior - DIFAL - Busca saldo credor do per\u00edodo anterior para o estado</p> <p>3.2 Sa\u00eddas com D\u00e9bito do Imposto - DIFAL - Processa 2 grupos de documentos (C101 e D101) - Diferencia campos conforme UF da empresa:   - Se UF da empresa: usa campo ICMS UF Remetente   - Se outra UF: usa campo ICMS UF Destinat\u00e1rio - Considera entradas e sa\u00eddas - Calcula valores do primeiro per\u00edodo (situa\u00e7\u00f5es especiais)</p> <p>3.3 Ajustes de D\u00e9bito - DIFAL - Busca ajustes fiscais de d\u00e9bito espec\u00edficos para DIFAL</p> <p>3.4 Cr\u00e9ditos do ICMS referente a DIFAL - Processa 2 grupos de documentos (C101 e D101) - Diferencia campos conforme UF da empresa:   - Se UF da empresa: usa campo ICMS UF Destinat\u00e1rio   - Se outra UF: usa campo ICMS UF Remetente</p> <p>3.5 Ajustes de Cr\u00e9dito - DIFAL - Busca ajustes fiscais de cr\u00e9dito espec\u00edficos para DIFAL</p> <p>3.6 C\u00e1lculo de Saldos - DIFAL - Saldo devedor antes das dedu\u00e7\u00f5es - Dedu\u00e7\u00f5es espec\u00edficas para DIFAL - Valor a recolher (saldo l\u00edquido) - Saldo credor a transportar - Valores extra-apura\u00e7\u00e3o</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#calculo-do-fcp-fundo-de-combate-a-pobreza","title":"C\u00e1lculo do FCP (Fundo de Combate \u00e0 Pobreza)","text":"<p>3.7 Saldo Credor Anterior - FCP - Busca saldo credor do per\u00edodo anterior para o estado</p> <p>3.8 Sa\u00eddas com D\u00e9bito do Imposto - FCP - Processa 2 grupos de documentos (C101 e D101) - Usa campo FCP UF Destinat\u00e1rio - Considera entradas e sa\u00eddas - Calcula valores do primeiro per\u00edodo</p> <p>3.9 Ajustes de D\u00e9bito - FCP - Busca ajustes fiscais de d\u00e9bito espec\u00edficos para FCP</p> <p>3.10 Entradas com Cr\u00e9dito do Imposto - FCP - Processa 2 grupos de documentos (C101 e D101) - Usa campo FCP UF Destinat\u00e1rio</p> <p>3.11 Ajustes de Cr\u00e9dito - FCP - Busca ajustes fiscais de cr\u00e9dito espec\u00edficos para FCP</p> <p>3.12 C\u00e1lculo de Saldos - FCP - Saldo devedor antes das dedu\u00e7\u00f5es - Dedu\u00e7\u00f5es espec\u00edficas para FCP - Valor a recolher (saldo l\u00edquido) - Saldo credor a transportar - Valores extra-apura\u00e7\u00e3o</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#4-criacao-das-apuracoes-por-estado","title":"4. Cria\u00e7\u00e3o das Apura\u00e7\u00f5es por Estado","text":"<ul> <li>Cria objeto Edb01 espec\u00edfico para cada estado</li> <li>Preenche JSON com todos os valores calculados</li> <li>Valida se h\u00e1 valores significativos para criar a apura\u00e7\u00e3o</li> <li>Persiste apura\u00e7\u00e3o no banco de dados</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#logica-de-campos-por-uf","title":"L\u00f3gica de Campos por UF","text":"<ul> <li>UF da Empresa (Remetente):</li> <li>DIFAL D\u00e9bito: <code>vl_icms_uf_rem</code></li> <li>DIFAL Cr\u00e9dito: <code>vl_icms_uf_dest</code></li> <li>Outras UFs (Destinat\u00e1rio):</li> <li>DIFAL D\u00e9bito: <code>vl_icms_uf_dest</code></li> <li>DIFAL Cr\u00e9dito: <code>vl_icms_uf_rem</code></li> <li>FCP (sempre): <code>vl_fcp_uf_dest</code></li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#filtros-de-documentos","title":"Filtros de Documentos","text":"<ul> <li>Situa\u00e7\u00f5es exclu\u00eddas: 01, 07 (para valores normais)</li> <li>Situa\u00e7\u00f5es inclu\u00eddas: 01, 07 (para primeiro per\u00edodo)</li> <li>Indicador EFD-ICMS: Apenas documentos com <code>eaa01iEfdIcms = 1</code></li> <li>Documentos n\u00e3o cancelados: <code>eaa01cancData IS NULL</code></li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#classificacao-de-ajustes","title":"Classifica\u00e7\u00e3o de Ajustes","text":"<ul> <li>Posi\u00e7\u00e3o 3 do c\u00f3digo Aaj17:</li> <li>\"2\": Ajustes de DIFAL</li> <li>\"3\": Ajustes de FCP</li> <li>Posi\u00e7\u00e3o 4 do c\u00f3digo Aaj17:</li> <li>\"0\", \"1\": D\u00e9bitos</li> <li>\"2\", \"3\": Cr\u00e9ditos/Dedu\u00e7\u00f5es</li> <li>\"5\": Extra-apura\u00e7\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#modelos-de-documentos","title":"Modelos de Documentos","text":"<ul> <li>Grupo C101: Modelos 01, 1B, 04, 55, 65</li> <li>Grupo D101: Modelos 07, 08, 8B, 09, 10, 11, 26, 27, 57, 67, 63</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#primeira-apuracao","title":"Primeira Apura\u00e7\u00e3o","text":"<ul> <li>Considera valores com situa\u00e7\u00f5es 01 e 07 como \"primeiro per\u00edodo\"</li> <li>Aplica l\u00f3gica diferente para c\u00e1lculo de extra-apura\u00e7\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de apura\u00e7\u00e3o de DIFAL e FCP.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#buscarestados","title":"<code>buscarEstados()</code>","text":"<p>Busca todos os estados da federa\u00e7\u00e3o para processamento.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#isprimeiraapuracao","title":"<code>isPrimeiraApuracao()</code>","text":"<p>Verifica se \u00e9 a primeira apura\u00e7\u00e3o para um determinado estado.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#buscarsaldocredoranterior","title":"<code>buscarSaldoCredorAnterior()</code>","text":"<p>Busca saldo credor do per\u00edodo anterior para um estado espec\u00edfico.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#buscartotalimpostodifalfcp","title":"<code>buscarTotalImpostoDifalFcp()</code>","text":"<p>Busca valores totais de DIFAL ou FCP nos documentos fiscais. - Par\u00e2metros: estado, \u00e9 UF da empresa, campo JSON, per\u00edodo, tipo (sa\u00edda/entrada), grupo - Retorna: Soma dos valores do imposto</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#buscartotalimpostoprimeiroperiododifalfcp","title":"<code>buscarTotalImpostoPrimeiroPeriodoDifalFcp()</code>","text":"<p>Busca valores do primeiro per\u00edodo (situa\u00e7\u00f5es especiais).</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#buscarajustesdebitosicmsdifalfcp-buscarajustescreditosicmsdifalfcp","title":"<code>buscarAjustesDebitosICMSDifalFcp()</code>, <code>buscarAjustesCreditosICMSDifalFcp()</code>","text":"<p>Buscam ajustes de d\u00e9bito/cr\u00e9dito para DIFAL ou FCP. - Diferenciam por tipo de imposto (0=DIFAL, 1=FCP)</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#buscardeducoesicmsdifalfcp","title":"<code>buscarDeducoesICMSDifalFcp()</code>","text":"<p>Busca valores de dedu\u00e7\u00f5es para DIFAL ou FCP.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#buscarextraapuricms","title":"<code>buscarExtraApurICMS()</code>","text":"<p>Busca valores de extra-apura\u00e7\u00e3o para DIFAL ou FCP.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#buscarmodelostotalimposto","title":"<code>buscarModelosTotalImposto()</code>","text":"<p>Define listas de modelos de documentos por grupo de registro.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#validacontemapuracao","title":"<code>validaContemApuracao()</code>","text":"<p>Valida se h\u00e1 valores significativos para criar a apura\u00e7\u00e3o.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>JSON da Apura\u00e7\u00e3o por Estado (edb01json):</p> <p>Campos DIFAL: - <code>sdoCredAntDifal</code> - Saldo credor anterior DIFAL - <code>debDifal</code> - D\u00e9bitos de DIFAL - <code>ajuDebDifal</code> - Ajustes de d\u00e9bito DIFAL - <code>credDifal</code> - Cr\u00e9ditos de DIFAL - <code>ajuCredDifal</code> - Ajustes de cr\u00e9dito DIFAL - <code>sdoDevDifal</code> - Saldo devedor DIFAL - <code>deducoesDifal</code> - Dedu\u00e7\u00f5es DIFAL - <code>vlrRecolDifal</code> - Valor a recolher DIFAL - <code>sdoCredDifal</code> - Saldo credor a transportar DIFAL - <code>extraDifal</code> - Valores extra-apura\u00e7\u00e3o DIFAL</p> <p>Campos FCP: - <code>sdoCredAntFcp</code> - Saldo credor anterior FCP - <code>debFcp</code> - D\u00e9bitos de FCP - <code>ajuDebFcp</code> - Ajustes de d\u00e9bito FCP - <code>credFcp</code> - Cr\u00e9ditos de FCP - <code>ajuCredFcp</code> - Ajustes de cr\u00e9dito FCP - <code>sdoDevFcp</code> - Saldo devedor FCP - <code>deducoesFcp</code> - Dedu\u00e7\u00f5es FCP - <code>vlrRecolFcp</code> - Valor a recolher FCP - <code>sdoCredFcp</code> - Saldo credor a transportar FCP - <code>extraFcp</code> - Valores extra-apura\u00e7\u00e3o FCP</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios diversos - <code>java.time</code> - Manipula\u00e7\u00e3o de datas - <code>sam.server.samdev.utils</code> - Utilit\u00e1rios de par\u00e2metros</p> <p>M\u00f3dulos: - M\u00f3dulo Fiscal - M\u00f3dulo de Documentos Fiscais - M\u00f3dulo de Apura\u00e7\u00f5es Fiscais - M\u00f3dulo de Cadastros (Estados/Munic\u00edpios)</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#processamento-por-estado","title":"Processamento por Estado","text":"<ul> <li>Gera apura\u00e7\u00f5es independentes para cada estado</li> <li>Otimiza consultas filtrando por estado</li> <li>Permite compensa\u00e7\u00f5es espec\u00edficas por jurisdi\u00e7\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#consultas-json-dinamicas","title":"Consultas JSON Din\u00e2micas","text":"<ul> <li>Uso de operador <code>-&gt;&gt;</code> para extrair valores JSON</li> <li>Campos din\u00e2micos configur\u00e1veis via alinhamento</li> <li>Consultas otimizadas com filtros espec\u00edficos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#performance","title":"Performance","text":"<ul> <li>Consultas parametrizadas por estado e per\u00edodo</li> <li>Somas diretas no banco de dados</li> <li>Valida\u00e7\u00e3o para evitar apura\u00e7\u00f5es vazias</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#situacoes-especiais","title":"Situa\u00e7\u00f5es Especiais","text":"<ul> <li>Tratamento diferenciado para primeiro per\u00edodo</li> <li>L\u00f3gica espec\u00edfica para extra-apura\u00e7\u00e3o</li> <li>Considera\u00e7\u00e3o de situa\u00e7\u00f5es de documentos (01, 07)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_ICMSDifAliq/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Exclus\u00e3o de estados do exterior (EX)</li> <li>Verifica\u00e7\u00e3o de cancelamento de documentos</li> <li>Valida\u00e7\u00e3o do indicador EFD-ICMS</li> <li>Filtro por endere\u00e7o principal do documento</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 08:20 Autor: Bruno Tipo: F\u00f3rmula de Apura\u00e7\u00e3o Fiscal Vers\u00e3o: 1.0 Tributo: DIFAL (ICMS) e FCP Destino: EFD (Escritura\u00e7\u00e3o Fiscal Digital) Alcance: Opera\u00e7\u00f5es Interestaduais</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/","title":"SGT Apuracao EFD IPI","text":"<p>SGT_Apuracao_EFD_IPI# SGT_Apuracao_EFD_IPI - Apura\u00e7\u00e3o de IPI para EFD</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para c\u00e1lculo e apura\u00e7\u00e3o do Imposto sobre Produtos Industrializados (IPI) para gera\u00e7\u00e3o da Escritura\u00e7\u00e3o Fiscal Digital (EFD), realizando a consolida\u00e7\u00e3o de d\u00e9bitos, cr\u00e9ditos e saldos do per\u00edodo fiscal.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente os valores de IPI a pagar ou compensar em um per\u00edodo fiscal, consolidando opera\u00e7\u00f5es de entrada e sa\u00edda, ajustes manuais e saldos anteriores para gera\u00e7\u00e3o da EFD-IPI.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Faturamento</li> <li>Departamento de Tributos</li> <li>Ind\u00fastrias e empresas sujeitas ao IPI</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Edb01</code> - Apura\u00e7\u00e3o fiscal principal - <code>Edb0105</code> - Ajustes manuais do IPI - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens dos documentos fiscais - <code>Aaj19</code> - Tipos de ajustes do IPI - <code>Aaj15</code> - CFOP (C\u00f3digo Fiscal de Opera\u00e7\u00f5es e Presta\u00e7\u00f5es) - <code>Aah01</code> - Modelos de documentos fiscais - <code>Aaj03</code> - Situa\u00e7\u00f5es dos documentos - <code>Aaj28</code> - Tipos de apura\u00e7\u00e3o</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o edb01 Edb01 Sim Objeto de apura\u00e7\u00e3o fiscal contendo m\u00eas, ano e tipo"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Obten\u00e7\u00e3o do objeto de apura\u00e7\u00e3o (Edb01)</li> <li>Defini\u00e7\u00e3o do per\u00edodo fiscal (m\u00eas/ano)</li> <li>Inicializa\u00e7\u00e3o da estrutura JSON para armazenamento dos c\u00e1lculos</li> <li>Sele\u00e7\u00e3o do alinhamento para campos din\u00e2micos</li> <li>Identifica\u00e7\u00e3o do campo JSON para valores de IPI</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#2-calculo-de-saldo-anterior","title":"2. C\u00e1lculo de Saldo Anterior","text":"<ul> <li>01 - Saldo credor anterior: Busca apura\u00e7\u00e3o do per\u00edodo anterior</li> <li>Consulta apura\u00e7\u00f5es do mesmo tipo em meses anteriores</li> <li>Extrai saldo credor do JSON da apura\u00e7\u00e3o anterior</li> <li>Se n\u00e3o houver apura\u00e7\u00e3o anterior, considera zero</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#3-calculo-de-debitos-do-ipi","title":"3. C\u00e1lculo de D\u00e9bitos do IPI","text":"<ul> <li>02 - Sa\u00eddas com d\u00e9bito do imposto: Consolida valores de IPI nas sa\u00eddas</li> <li>Processa documentos fiscais com CFOP iniciados em 5 ou 6</li> <li>Considera modelos de documentos: 01, 1B, 04, 55</li> <li>Filtra por situa\u00e7\u00f5es v\u00e1lidas (exclui 02, 03, 04, 05)</li> <li>Considera ambos: entradas (esData) e sa\u00eddas (abb01data)</li> <li>Soma valores do campo IPI no JSON dos itens</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#4-calculo-de-creditos-do-ipi","title":"4. C\u00e1lculo de Cr\u00e9ditos do IPI","text":"<ul> <li>03 - Entradas com cr\u00e9dito do imposto: Consolida valores de IPI nas entradas</li> <li>Processa documentos fiscais com CFOP iniciados em 1, 2 ou 3</li> <li>Considera os mesmos modelos de documentos que os d\u00e9bitos</li> <li>Aplica os mesmos filtros de situa\u00e7\u00f5es</li> <li>Soma valores do campo IPI no JSON dos itens</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#5-ajustes-manuais","title":"5. Ajustes Manuais","text":"<ul> <li>04 - Outros d\u00e9bitos e estorno de cr\u00e9ditos: Ajustes manuais de d\u00e9bito</li> <li>Processa ajustes manuais registrados em Edb0105</li> <li>Filtra por natureza do ajuste = 0 (d\u00e9bito)</li> <li> <p>Inclui estornos de cr\u00e9ditos anteriores</p> </li> <li> <p>05 - Outros cr\u00e9ditos e estorno de d\u00e9bitos: Ajustes manuais de cr\u00e9dito</p> </li> <li>Processa ajustes manuais registrados em Edb0105</li> <li>Filtra por natureza do ajuste = 1 (cr\u00e9dito)</li> <li>Inclui estornos de d\u00e9bitos anteriores</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#6-calculo-de-saldos-finais","title":"6. C\u00e1lculo de Saldos Finais","text":"<ul> <li>Saldo l\u00edquido: Calcula saldo consolidado</li> <li> <p>F\u00f3rmula: Saldo = credAnt + credEntradas - deboutros + credoutros - debSaidas</p> </li> <li> <p>Saldo devedor: Valor a pagar</p> </li> <li>Se saldo l\u00edquido for negativo, transforma em positivo</li> <li> <p>Representa o valor devido ao fisco</p> </li> <li> <p>Saldo credor: Valor a compensar</p> </li> <li>Se saldo l\u00edquido for positivo ou zero</li> <li>Representa cr\u00e9dito para per\u00edodos futuros</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#filtros-de-documentos","title":"Filtros de Documentos","text":"<ul> <li>Situa\u00e7\u00f5es exclu\u00eddas: 02, 03, 04, 05 (conforme aaj03efd)</li> <li>Indicador EFD-ICMS: Apenas documentos com <code>eaa01iEfdIcms = 1</code></li> <li>Modelos v\u00e1lidos: 01, 1B, 04, 55 (documentos de produtos industriais)</li> <li>Per\u00edodo considerado: </li> <li>Entradas: data de entrada (esData)</li> <li>Sa\u00eddas: data do documento (abb01data)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#classificacao-por-cfop","title":"Classifica\u00e7\u00e3o por CFOP","text":"<ul> <li>D\u00e9bitos (CFOP 5xxx, 6xxx):</li> <li>5xxx: Sa\u00eddas ou presta\u00e7\u00f5es</li> <li> <p>6xxx: Outras sa\u00eddas ou presta\u00e7\u00f5es</p> </li> <li> <p>Cr\u00e9ditos (CFOP 1xxx, 2xxx, 3xxx):</p> </li> <li>1xxx: Entradas ou aquisi\u00e7\u00f5es</li> <li>2xxx: Devolu\u00e7\u00f5es</li> <li>3xxx: Servi\u00e7os</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#ajustes-manuais-edb0105","title":"Ajustes Manuais (Edb0105)","text":"<ul> <li>Natureza 0: D\u00e9bitos e estornos de cr\u00e9ditos</li> <li>Natureza 1: Cr\u00e9ditos e estornos de d\u00e9bitos</li> <li>Vinculados \u00e0 apura\u00e7\u00e3o espec\u00edfica</li> <li>Permitem corre\u00e7\u00f5es manuais dos c\u00e1lculos autom\u00e1ticos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#busca-de-apuracao-anterior","title":"Busca de Apura\u00e7\u00e3o Anterior","text":"<ul> <li>Considera mesmo tipo de apura\u00e7\u00e3o (aaj28id)</li> <li>Busca pelo grupo centralizador da empresa</li> <li>Ordena por ano e m\u00eas decrescente</li> <li>Pega apenas o registro mais recente anterior ao per\u00edodo atual</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de apura\u00e7\u00e3o do IPI.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#buscarapuracaoanterior","title":"<code>buscarApuracaoAnterior()</code>","text":"<p>Busca a apura\u00e7\u00e3o do per\u00edodo anterior para c\u00e1lculo de saldo credor. - Par\u00e2metros: m\u00eas, ano, tipo de apura\u00e7\u00e3o - Retorna: Objeto Edb01 da apura\u00e7\u00e3o anterior ou null</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#buscardebitosipi","title":"<code>buscarDebitosIPI()</code>","text":"<p>Busca valores de IPI a d\u00e9bito nos documentos fiscais. - Par\u00e2metros: nome do campo JSON, per\u00edodo (data inicial/final) - Filtros: CFOP 5xxx/6xxx, modelos espec\u00edficos, situa\u00e7\u00f5es v\u00e1lidas - Retorna: Soma dos valores de d\u00e9bito</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#buscarcreditosipi","title":"<code>buscarCreditosIPI()</code>","text":"<p>Busca valores de IPI a cr\u00e9dito nos documentos fiscais. - Par\u00e2metros: nome do campo JSON, per\u00edodo (data inicial/final) - Filtros: CFOP 1xxx/2xxx/3xxx, modelos espec\u00edficos, situa\u00e7\u00f5es v\u00e1lidas - Retorna: Soma dos valores de cr\u00e9dito</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>JSON da Apura\u00e7\u00e3o (edb01json): - <code>credAnt</code> - Saldo credor do per\u00edodo anterior - <code>debSaidas</code> - Sa\u00eddas com d\u00e9bito do imposto - <code>credEntradas</code> - Entradas com cr\u00e9dito do imposto - <code>deboutros</code> - Outros d\u00e9bitos e estorno de cr\u00e9ditos - <code>credoutros</code> - Outros cr\u00e9ditos e estorno de d\u00e9bitos - <code>saldoDevedor</code> - Saldo devedor (valor a pagar) - <code>saldoCredor</code> - Saldo credor (cr\u00e9dito para per\u00edodo seguinte)</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/","title":"SGT_Apuracao_EFD_IPI_G5 - Apura\u00e7\u00e3o de IPI (Grupo 5) para EFD","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula alternativa para c\u00e1lculo e apura\u00e7\u00e3o do Imposto sobre Produtos Industrializados (IPI) conforme Grupo 5 da EFD, realizando a consolida\u00e7\u00e3o de d\u00e9bitos, cr\u00e9ditos e saldos com l\u00f3gica espec\u00edfica para empresas do Grupo 5.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente os valores de IPI a pagar ou compensar em um per\u00edodo fiscal para empresas classificadas no Grupo 5, utilizando regras espec\u00edficas de c\u00e1lculo e classifica\u00e7\u00e3o conforme exig\u00eancias fiscais para este grupo.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Faturamento</li> <li>Departamento de Tributos</li> <li>Empresas industriais do Grupo 5</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Edb01</code> - Apura\u00e7\u00e3o fiscal principal - <code>Edb0105</code> - Ajustes manuais do IPI - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens dos documentos fiscais - <code>Aaj15</code> - CFOP (C\u00f3digo Fiscal de Opera\u00e7\u00f5es e Presta\u00e7\u00f5es) - <code>Aah01</code> - Modelos de documentos fiscais - <code>Aaj03</code> - Situa\u00e7\u00f5es dos documentos - <code>Aaj28</code> - Tipos de apura\u00e7\u00e3o</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o edb01 Edb01 Sim Objeto de apura\u00e7\u00e3o fiscal contendo m\u00eas, ano e tipo"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Obten\u00e7\u00e3o do objeto de apura\u00e7\u00e3o (Edb01)</li> <li>Defini\u00e7\u00e3o do per\u00edodo fiscal (m\u00eas/ano)</li> <li>Inicializa\u00e7\u00e3o da estrutura JSON para armazenamento dos c\u00e1lculos</li> <li>Sele\u00e7\u00e3o do alinhamento espec\u00edfico (0032) para campos din\u00e2micos</li> <li>Identifica\u00e7\u00e3o do campo JSON para valores de IPI</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#2-calculo-de-saldo-anterior","title":"2. C\u00e1lculo de Saldo Anterior","text":"<ul> <li>01 - Saldo credor anterior: Busca apura\u00e7\u00e3o do per\u00edodo anterior</li> <li>Consulta apura\u00e7\u00f5es do mesmo tipo em meses anteriores</li> <li>Extrai saldo credor do JSON da apura\u00e7\u00e3o anterior</li> <li>Verifica se h\u00e1 JSON na apura\u00e7\u00e3o anterior</li> <li>Se n\u00e3o houver apura\u00e7\u00e3o anterior ou JSON, considera zero</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#3-calculo-de-debitos-do-ipi","title":"3. C\u00e1lculo de D\u00e9bitos do IPI","text":"<ul> <li>02 - Sa\u00eddas com d\u00e9bito do imposto: Consolida valores de IPI nas sa\u00eddas</li> <li>Processa documentos fiscais com CFOP iniciados em 5 ou 6</li> <li>Considera modelos de documentos: 01, 1B, 04, 55</li> <li>Filtra por situa\u00e7\u00f5es v\u00e1lidas (exclui 02, 03, 04, 05)</li> <li>Considera ambos: entradas (esData) e sa\u00eddas (abb01data)</li> <li>Soma valores do campo IPI no JSON dos itens usando campos din\u00e2micos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#4-calculo-de-creditos-do-ipi","title":"4. C\u00e1lculo de Cr\u00e9ditos do IPI","text":"<ul> <li>03 - Entradas com cr\u00e9dito do imposto: Consolida valores de IPI nas entradas</li> <li>Processa documentos fiscais com CFOP iniciados em 1, 2 ou 3</li> <li>Considera os mesmos modelos de documentos que os d\u00e9bitos</li> <li>Aplica os mesmos filtros de situa\u00e7\u00f5es</li> <li>Soma valores do campo IPI no JSON dos itens usando campos din\u00e2micos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#5-ajustes-manuais","title":"5. Ajustes Manuais","text":"<ul> <li>04 - Outros d\u00e9bitos e estorno de cr\u00e9ditos: Ajustes manuais de d\u00e9bito</li> <li>Processa todos os ajustes manuais registrados em Edb0105</li> <li>Soma todos os valores sem filtro por natureza</li> <li> <p>Representa ajustes diversos de d\u00e9bito</p> </li> <li> <p>05 - Outros cr\u00e9ditos e estorno de d\u00e9bitos: Ajustes manuais de cr\u00e9dito</p> </li> <li>Processa todos os ajustes manuais registrados em Edb0105</li> <li>Soma todos os valores sem filtro por natureza</li> <li>Representa ajustes diversos de cr\u00e9dito</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#6-calculo-de-saldos-finais","title":"6. C\u00e1lculo de Saldos Finais","text":"<ul> <li>06 - Total de IPI a recuperar: Calcula saldo credor</li> <li>F\u00f3rmula: Saldo1 = debSaidas + outrosDeb</li> <li>F\u00f3rmula: Saldo2 = credAnt + outrosCred</li> <li>F\u00f3rmula: Saldo = Saldo1 - Saldo2</li> <li>Se saldo for negativo: saldoCredor = saldo * (-1)</li> <li> <p>Representa cr\u00e9ditos a recuperar</p> </li> <li> <p>07 - Total de IPI a recolher: Calcula saldo devedor</p> </li> <li>Se saldo for positivo ou zero: saldoDevedor = saldo</li> <li>Representa d\u00e9bitos a recolher</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#especificidades-do-grupo-5","title":"Especificidades do Grupo 5","text":"<ul> <li>L\u00f3gica diferente de c\u00e1lculo: Invers\u00e3o na f\u00f3rmula de saldo</li> <li>Tratamento de ajustes: Sem distin\u00e7\u00e3o por natureza nos ajustes manuais</li> <li>Campos din\u00e2micos: Uso intensivo de campos via alinhamento</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#filtros-de-documentos","title":"Filtros de Documentos","text":"<ul> <li>Situa\u00e7\u00f5es exclu\u00eddas: 02, 03, 04, 05 (conforme aaj03efd)</li> <li>Indicador EFD-ICMS: Apenas documentos com <code>eaa01iEfdIcms = 1</code></li> <li>Modelos v\u00e1lidos: 01, 1B, 04, 55 (documentos de produtos industriais)</li> <li>Per\u00edodo considerado: </li> <li>Entradas: data de entrada (esData)</li> <li>Sa\u00eddas: data do documento (abb01data)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#classificacao-por-cfop","title":"Classifica\u00e7\u00e3o por CFOP","text":"<ul> <li>D\u00e9bitos (CFOP 5xxx, 6xxx):</li> <li>5xxx: Sa\u00eddas ou presta\u00e7\u00f5es</li> <li> <p>6xxx: Outras sa\u00eddas ou presta\u00e7\u00f5es</p> </li> <li> <p>Cr\u00e9ditos (CFOP 1xxx, 2xxx, 3xxx):</p> </li> <li>1xxx: Entradas ou aquisi\u00e7\u00f5es</li> <li>2xxx: Devolu\u00e7\u00f5es</li> <li>3xxx: Servi\u00e7os</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#ajustes-manuais-edb0105","title":"Ajustes Manuais (Edb0105)","text":"<ul> <li>Sem filtro por natureza: Soma todos os ajustes</li> <li>Dupla contagem: Mesmos ajustes considerados em d\u00e9bitos e cr\u00e9ditos</li> <li>Vinculados \u00e0 apura\u00e7\u00e3o espec\u00edfica</li> <li>Permitem corre\u00e7\u00f5es manuais dos c\u00e1lculos autom\u00e1ticos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#formula-especifica-do-grupo-5","title":"F\u00f3rmula Espec\u00edfica do Grupo 5","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de apura\u00e7\u00e3o do IPI para Grupo 5.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#buscarapuracaoanterior","title":"<code>buscarApuracaoAnterior()</code>","text":"<p>Busca a apura\u00e7\u00e3o do per\u00edodo anterior para c\u00e1lculo de saldo credor. - Par\u00e2metros: m\u00eas, ano, tipo de apura\u00e7\u00e3o - Verifica exist\u00eancia do JSON na apura\u00e7\u00e3o anterior - Retorna: Objeto Edb01 da apura\u00e7\u00e3o anterior ou null</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#buscardebitosipi","title":"<code>buscarDebitosIPI()</code>","text":"<p>Busca valores de IPI a d\u00e9bito nos documentos fiscais. - Par\u00e2metros: nome do campo JSON, per\u00edodo (data inicial/final) - Filtros: CFOP 5xxx/6xxx, modelos espec\u00edficos, situa\u00e7\u00f5es v\u00e1lidas - Usa campos din\u00e2micos via <code>getCampo()</code> - Retorna: Soma dos valores de d\u00e9bito</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#buscarcreditosipi","title":"<code>buscarCreditosIPI()</code>","text":"<p>Busca valores de IPI a cr\u00e9dito nos documentos fiscais. - Par\u00e2metros: nome do campo JSON, per\u00edodo (data inicial/final) - Filtros: CFOP 1xxx/2xxx/3xxx, modelos espec\u00edficos, situa\u00e7\u00f5es v\u00e1lidas - Usa campos din\u00e2micos via <code>getCampo()</code> - Retorna: Soma dos valores de cr\u00e9dito</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>JSON da Apura\u00e7\u00e3o (edb01json) com campos din\u00e2micos: - <code>credAnt</code> - Saldo credor do per\u00edodo anterior - <code>debSaidas</code> - Sa\u00eddas com d\u00e9bito do imposto - <code>credEntradas</code> - Entradas com cr\u00e9dito do imposto - <code>outrosDeb</code> - Outros d\u00e9bitos e estorno de cr\u00e9ditos - <code>outrosCred</code> - Outros cr\u00e9ditos e estorno de d\u00e9bitos - <code>saldoCredor</code> - Total de IPI a recuperar (cr\u00e9dito) - <code>saldoDevedor</code> - Total de IPI a recolher (d\u00e9bito)</p> <p>C\u00e1lculo do Saldo (Grupo 5):</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios diversos (DateUtils, Utils) - <code>java.time</code> - Manipula\u00e7\u00e3o de datas - <code>sam.server.samdev.utils</code> - Utilit\u00e1rios de par\u00e2metros</p> <p>M\u00f3dulos: - M\u00f3dulo Fiscal - M\u00f3dulo de Documentos Fiscais - M\u00f3dulo de Apura\u00e7\u00f5es Fiscais - M\u00f3dulo de Cadastros Fiscais</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#diferencas-em-relacao-a-versao-padrao","title":"Diferen\u00e7as em Rela\u00e7\u00e3o \u00e0 Vers\u00e3o Padr\u00e3o","text":"<ol> <li>L\u00f3gica invertida no c\u00e1lculo do saldo</li> <li>Ajustes manuais sem filtro por natureza</li> <li>Campos totalmente din\u00e2micos via alinhamento</li> <li>Nomenclatura diferente dos campos no JSON</li> <li>F\u00f3rmula espec\u00edfica para Grupo 5</li> </ol>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#consultas-com-campos-dinamicos","title":"Consultas com Campos Din\u00e2micos","text":"<ul> <li>Uso de <code>getCampo()</code> para obter nomes de campos do alinhamento</li> <li>Consultas parametrizadas com campos vari\u00e1veis</li> <li>Flexibilidade para diferentes configura\u00e7\u00f5es</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#tratamento-de-periodos","title":"Tratamento de Per\u00edodos","text":"<ul> <li>Considera o m\u00eas completo (do dia 1 ao \u00faltimo dia do m\u00eas)</li> <li>Usa <code>lengthOfMonth()</code> para determinar o \u00faltimo dia corretamente</li> <li>Diferenciamento entre data de entrada e data de documento</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Verifica\u00e7\u00e3o de null no JSON da apura\u00e7\u00e3o anterior</li> <li>Uso de <code>getBigDecimal_Zero()</code> para evitar null pointer</li> <li>Filtro por grupo centralizador nas consultas</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_EFD_IPI_G5/#performance","title":"Performance","text":"<ul> <li>Consultas otimizadas com filtros compostos</li> <li>Somas diretas no banco de dados</li> <li>Uso de \u00edndices por per\u00edodo e situa\u00e7\u00e3o</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 08:20 Autor: Bruno Tipo: F\u00f3rmula de Apura\u00e7\u00e3o Fiscal Vers\u00e3o: 1.0 Tributo: IPI (Imposto sobre Produtos Industrializados) Destino: EFD (Escritura\u00e7\u00e3o Fiscal Digital) Grupo: 5 (Regime Espec\u00edfico) Aplica\u00e7\u00e3o: Empresas industriais do Grupo 5</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/","title":"SGT_Apuracao_LF_ICMS - Apura\u00e7\u00e3o de ICMS para Livro Fiscal (LF)","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para c\u00e1lculo e apura\u00e7\u00e3o do Imposto sobre Circula\u00e7\u00e3o de Mercadorias e Servi\u00e7os (ICMS) para gera\u00e7\u00e3o do Livro Fiscal (LF), realizando a consolida\u00e7\u00e3o de d\u00e9bitos, cr\u00e9ditos, ajustes e saldos do per\u00edodo com foco nas obriga\u00e7\u00f5es do Livro Fiscal.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente os valores de ICMS para emiss\u00e3o do Livro Fiscal, consolidando opera\u00e7\u00f5es de entrada e sa\u00edda, ajustes fiscais, estornos e saldos anteriores, com tratamento espec\u00edfico para os registros exigidos pela legisla\u00e7\u00e3o do Livro Fiscal.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Faturamento</li> <li>Departamento de Tributos</li> <li>Setor de Livros Fiscais</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Edb01</code> - Apura\u00e7\u00e3o fiscal principal - <code>Edb0101</code> - Ajustes da apura\u00e7\u00e3o (ocorr\u00eancias) - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens dos documentos fiscais - <code>Eaa01035</code> - Ajustes fiscais dos itens - <code>Eaa01031</code> - Informa\u00e7\u00f5es adicionais de ICMS - <code>Aaj17</code> - Tipos de ajustes fiscais - <code>Aaj15</code> - CFOP (C\u00f3digo Fiscal de Opera\u00e7\u00f5es e Presta\u00e7\u00f5es) - <code>Aah01</code> - Modelos de documentos fiscais - <code>Aaj03</code> - Situa\u00e7\u00f5es dos documentos</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o edb01 Edb01 Sim Objeto de apura\u00e7\u00e3o fiscal contendo m\u00eas, ano e tipo"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Obten\u00e7\u00e3o do objeto de apura\u00e7\u00e3o (Edb01)</li> <li>Inicializa\u00e7\u00e3o/valida\u00e7\u00e3o da estrutura JSON</li> <li>Corre\u00e7\u00e3o de valores negativos no saldo devedor</li> <li>Sele\u00e7\u00e3o do alinhamento espec\u00edfico (0040) para campos din\u00e2micos</li> <li>Defini\u00e7\u00e3o do per\u00edodo fiscal (m\u00eas/ano)</li> <li>Inicializa\u00e7\u00e3o de conjuntos para classifica\u00e7\u00e3o de ajustes</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#2-processamento-de-ocorrenciasajustes","title":"2. Processamento de Ocorr\u00eancias/Ajustes","text":"<ul> <li>Verifica se h\u00e1 ajustes j\u00e1 registrados na apura\u00e7\u00e3o</li> <li>Se n\u00e3o houver, busca ajustes autom\u00e1ticos do per\u00edodo:</li> <li>Consulta ajustes fiscais (Eaa01035) do per\u00edodo</li> <li>Agrupa por tipo de ajuste (Aaj17)</li> <li>Ordena por c\u00f3digo do ajuste</li> <li>Cria registros de ocorr\u00eancia (Edb0101) na apura\u00e7\u00e3o</li> <li>Se j\u00e1 houver ajustes, consolida valores por subitem do c\u00f3digo</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#3-calculo-de-debitos-do-icms","title":"3. C\u00e1lculo de D\u00e9bitos do ICMS","text":"<ul> <li>Valor com d\u00e9bito do imposto: Sa\u00eddas tributadas</li> <li>Processa documentos de sa\u00edda (esMov = 1)</li> <li>CFOP diferente de 5605 (para sa\u00eddas)</li> <li>Modelos: 01, 1B, 04, 55, 65</li> <li>Filtra situa\u00e7\u00f5es inv\u00e1lidas (01, 02, 03, 04, 05, 07)</li> <li>Soma valores do campo ICMS no JSON dos itens</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#4-calculo-de-creditos-do-icms","title":"4. C\u00e1lculo de Cr\u00e9ditos do ICMS","text":"<ul> <li>Valor com cr\u00e9dito do imposto: Entradas com cr\u00e9dito</li> <li>Processa documentos de entrada (esMov = 0)</li> <li>CFOP iniciados em 1, 2 ou 3</li> <li>Documentos n\u00e3o cancelados</li> <li>Soma valores do campo ICMS no JSON dos itens</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#5-ajustes-e-estornos","title":"5. Ajustes e Estornos","text":"<ul> <li>Estorno de d\u00e9bitos: Revers\u00e3o de d\u00e9bitos registrados</li> <li>Busca ajustes com c\u00f3digo terminado em \"03\"</li> <li>Inclui ajustes manuais da apura\u00e7\u00e3o</li> <li> <p>Modelos diversos de documentos</p> </li> <li> <p>Estorno de cr\u00e9ditos: Revers\u00e3o de cr\u00e9ditos utilizados</p> </li> <li>Busca ajustes com c\u00f3digo terminado em \"01\"</li> <li>Inclui ajustes manuais da apura\u00e7\u00e3o</li> <li> <p>Modelos diversos de documentos</p> </li> <li> <p>Outros d\u00e9bitos: Ajustes diversos de d\u00e9bito</p> </li> <li>Busca ajustes com c\u00f3digo espec\u00edfico (terceira posi\u00e7\u00e3o: 0, quarta: 2)</li> <li>Inclui ajustes manuais com c\u00f3digo terminado em \"00\"</li> <li> <p>Modelos diversos de documentos</p> </li> <li> <p>Outros cr\u00e9ditos: Ajustes diversos de cr\u00e9dito</p> </li> <li>Busca valores da tabela Eaa01031 (ICMS adicional)</li> <li>Inclui ajustes manuais com c\u00f3digo terminado em \"02\"</li> <li>Modelos diversos de documentos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#6-saldo-anterior","title":"6. Saldo Anterior","text":"<ul> <li>Saldo credor anterior: Busca saldo do per\u00edodo anterior</li> <li>Consulta apura\u00e7\u00f5es do mesmo tipo em meses anteriores</li> <li>Extrai saldo credor do JSON</li> <li>Considera apenas o registro mais recente</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#processamento-de-ocorrencias","title":"Processamento de Ocorr\u00eancias","text":"<ul> <li>Agrupamento autom\u00e1tico: Ajustes do per\u00edodo s\u00e3o agrupados por tipo</li> <li>Ordena\u00e7\u00e3o: Ajustes ordenados por c\u00f3digo para organiza\u00e7\u00e3o do Livro Fiscal</li> <li>Limite de observa\u00e7\u00e3o: Texto da ocorr\u00eancia limitado a 100 caracteres</li> <li>Mapeamento de campos: Copia informa\u00e7\u00f5es GIA do tipo de ajuste</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#filtros-de-documentos","title":"Filtros de Documentos","text":"<ul> <li>Situa\u00e7\u00f5es exclu\u00eddas: 01, 02, 03, 04, 05, 07 (para d\u00e9bitos)</li> <li>Indicador EFD-ICMS: Apenas documentos com <code>eaa01iEfdIcms = 1</code></li> <li>Modelos para d\u00e9bitos: 01, 1B, 04, 55, 65</li> <li>Modelos para ajustes: Lista mais ampla incluindo servi\u00e7os, energia, etc.</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#classificacao-por-cfop","title":"Classifica\u00e7\u00e3o por CFOP","text":"<ul> <li>D\u00e9bitos: CFOP diferente de 5605 (para sa\u00eddas)</li> <li>Cr\u00e9ditos: CFOP iniciados em 1, 2 ou 3</li> <li>L\u00f3gica simplificada: Uso de <code>LIKE</code> para verifica\u00e7\u00e3o de padr\u00f5es</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#classificacao-de-ajustes","title":"Classifica\u00e7\u00e3o de Ajustes","text":"<ul> <li>C\u00f3digo Aaj17 (posi\u00e7\u00f5es 3-4):</li> <li>\"00\": Outros d\u00e9bitos</li> <li>\"01\": Estorno de cr\u00e9ditos</li> <li>\"02\": Outros cr\u00e9ditos</li> <li> <p>\"03\": Estorno de d\u00e9bitos</p> </li> <li> <p>Posi\u00e7\u00e3o 3:</p> </li> <li>\"0\": Ajustes diversos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#tratamento-de-periodos","title":"Tratamento de Per\u00edodos","text":"<ul> <li>D\u00e9bitos: Data do documento (abb01data)</li> <li>Cr\u00e9ditos: Data de entrada (esData)</li> <li>Ajustes: Data de entrada (esData)</li> <li>Busca anterior: Considera meses anteriores ao atual</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de apura\u00e7\u00e3o do ICMS para Livro Fiscal.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#buscarajustesdaapuricms","title":"<code>buscarAjustesDaApurICMS()</code>","text":"<p>Busca ajustes fiscais do per\u00edodo para cria\u00e7\u00e3o autom\u00e1tica de ocorr\u00eancias. - Par\u00e2metros: per\u00edodo (data inicial/final) - Retorna: Lista de ajustes agrup\u00e1veis</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#buscarsaidas_debitoimposto","title":"<code>buscarSaidas_DebitoImposto()</code>","text":"<p>Busca valores de ICMS a d\u00e9bito nas sa\u00eddas. - Par\u00e2metros: nome do campo JSON, per\u00edodo - Filtros: sa\u00eddas, CFOP espec\u00edfico, modelos, situa\u00e7\u00f5es - Retorna: Soma dos valores de d\u00e9bito</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#buscarentradas_creditoimposto","title":"<code>buscarEntradas_CreditoImposto()</code>","text":"<p>Busca valores de ICMS a cr\u00e9dito nas entradas. - Par\u00e2metros: nome do campo JSON, per\u00edodo - Filtros: entradas, CFOP 1xxx/2xxx/3xxx, n\u00e3o cancelados - Retorna: Soma dos valores de cr\u00e9dito</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#buscaroutrosdedicms-buscaroutroscredicms","title":"<code>buscarOutrosDedICMS()</code>, <code>buscarOutrosCredICMS()</code>","text":"<p>Buscam ajustes diversos de d\u00e9bito e cr\u00e9dito. - Filtram por c\u00f3digos espec\u00edficos de ajuste - Incluem m\u00faltiplos modelos de documentos</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#buscarestornodebicms-buscarestornocredicms","title":"<code>buscarEstornoDebICMS()</code>, <code>buscarEstornoCredICMS()</code>","text":"<p>Buscam estornos de d\u00e9bitos e cr\u00e9ditos. - Filtram por c\u00f3digos espec\u00edficos de estorno - Modelos diversos de documentos</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#buscarapuracaoanterior","title":"<code>buscarApuracaoAnterior()</code>","text":"<p>Busca apura\u00e7\u00e3o do per\u00edodo anterior. - Par\u00e2metros: m\u00eas, ano, tipo de apura\u00e7\u00e3o - Considera grupo centralizador - Retorna: Apura\u00e7\u00e3o anterior ou null</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#buscarsaldocredoranterior","title":"<code>buscarSaldoCredorAnterior()</code>","text":"<p>Busca saldo credor do per\u00edodo anterior. - Par\u00e2metros: nome do campo, ano, m\u00eas, tipo de apura\u00e7\u00e3o - Extrai valor do JSON da apura\u00e7\u00e3o anterior - Retorna: Valor do saldo credor ou 0</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>JSON da Apura\u00e7\u00e3o (edb01json) com campos din\u00e2micos: - <code>debImp</code> - Valor com d\u00e9bito do imposto (sa\u00eddas) - <code>outrosDeb</code> - Outros d\u00e9bitos - <code>estCred</code> - Estorno de cr\u00e9ditos - <code>credImp</code> - Valor com cr\u00e9dito do imposto (entradas) - <code>outrosCred</code> - Outros cr\u00e9ditos - <code>estDeb</code> - Estorno de d\u00e9bitos - <code>credAnt</code> - Saldo credor anterior - <code>deducoes</code> - Dedu\u00e7\u00f5es (inicializado como 0) - <code>subTotSai</code> - Subtotal sa\u00eddas (inicializado como 0) - <code>subTotEnt</code> - Subtotal entradas (inicializado como 0) - <code>total</code> - Total (inicializado como 0) - <code>saldoDevedor</code> - Saldo devedor (corrigido se negativo) - <code>saldoCredor</code> - Saldo credor (inicializado como 0) - <code>impRecolher</code> - Imposto a recolher (inicializado como 0)</p> <p>Ocorr\u00eancias (Edb0101): - Ajustes agrupados por tipo (Aaj17) - Com informa\u00e7\u00f5es GIA (SI, Fun\u00e7\u00e3o Legal, Ocorr\u00eancia) - Observa\u00e7\u00e3o limitada a 100 caracteres</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios diversos (DateUtils, Utils) - <code>java.time</code> - Manipula\u00e7\u00e3o de datas - <code>sam.server.samdev.utils</code> - Utilit\u00e1rios de par\u00e2metros</p> <p>Estruturas de Dados: - <code>Set&lt;String&gt;</code> para classifica\u00e7\u00e3o de d\u00e9bitos, cr\u00e9ditos e estornos - <code>Map&lt;String, BigDecimal&gt;</code> para consolida\u00e7\u00e3o de valores por subitem - <code>TreeSet&lt;Aaj17&gt;</code> para ordena\u00e7\u00e3o de ajustes</p> <p>M\u00f3dulos: - M\u00f3dulo Fiscal - M\u00f3dulo de Documentos Fiscais - M\u00f3dulo de Apura\u00e7\u00f5es Fiscais - M\u00f3dulo de Livros Fiscais</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#diferenciais-do-livro-fiscal","title":"Diferenciais do Livro Fiscal","text":"<ul> <li>Foco em ocorr\u00eancias: Agrupamento autom\u00e1tico de ajustes</li> <li>Campos GIA: Informa\u00e7\u00f5es espec\u00edficas para Guia de Informa\u00e7\u00e3o e Apura\u00e7\u00e3o</li> <li>Organiza\u00e7\u00e3o por c\u00f3digo: Ordena\u00e7\u00e3o dos ajustes para apresenta\u00e7\u00e3o</li> <li>Valida\u00e7\u00e3o de saldo: Corre\u00e7\u00e3o de valores negativos no saldo devedor</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#consultas-hibridas","title":"Consultas H\u00edbridas","text":"<ul> <li>JSON para valores principais: Uso de <code>jGet()</code> para campos din\u00e2micos</li> <li>Tabelas espec\u00edficas para ajustes: Eaa01035 para ajustes, Eaa01031 para cr\u00e9ditos adicionais</li> <li>Consultas parametrizadas: Com filtros complexos por c\u00f3digo de ajuste</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#inicializacao-completa","title":"Inicializa\u00e7\u00e3o Completa","text":"<ul> <li>Todos os campos do JSON s\u00e3o inicializados com 0</li> <li>Preven\u00e7\u00e3o de null pointer exceptions</li> <li>Estrutura consistente mesmo sem valores</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#performance","title":"Performance","text":"<ul> <li>Agrupamento no banco quando poss\u00edvel</li> <li>Consultas otimizadas com filtros espec\u00edficos</li> <li>Uso de conjuntos para classifica\u00e7\u00e3o eficiente</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ICMS/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Verifica\u00e7\u00e3o de cole\u00e7\u00f5es vazias com <code>Utils.isEmpty()</code></li> <li>Corre\u00e7\u00e3o de valores negativos no saldo devedor</li> <li>Limita\u00e7\u00e3o de texto para observa\u00e7\u00f5es</li> <li>Filtro por grupo centralizador</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 08:20 Autor: Bruno Tipo: F\u00f3rmula de Apura\u00e7\u00e3o Fiscal Vers\u00e3o: 1.0 Tributo: ICMS Destino: Livro Fiscal (LF) Finalidade: Apura\u00e7\u00e3o e escritura\u00e7\u00e3o fiscal</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/","title":"SGT_Apuracao_LF_IPI - Apura\u00e7\u00e3o de IPI para Livro Fiscal (LF)","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para c\u00e1lculo e apura\u00e7\u00e3o do Imposto sobre Produtos Industrializados (IPI) para gera\u00e7\u00e3o do Livro Fiscal (LF), realizando a consolida\u00e7\u00e3o de d\u00e9bitos, cr\u00e9ditos e saldos do per\u00edodo com foco nas obriga\u00e7\u00f5es do Livro Fiscal para ind\u00fastrias.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente os valores de IPI para emiss\u00e3o do Livro Fiscal, consolidando opera\u00e7\u00f5es de entrada e sa\u00edda industriais, e calculando saldos compens\u00e1veis entre per\u00edodos, com tratamento espec\u00edfico para os registros exigidos pela legisla\u00e7\u00e3o do Livro Fiscal para produtos industrializados.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade Industrial</li> <li>Faturamento</li> <li>Departamento de Tributos</li> <li>Setor de Livros Fiscais de ind\u00fastrias</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Edb01</code> - Apura\u00e7\u00e3o fiscal principal - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens dos documentos fiscais - <code>Aaj15</code> - CFOP (C\u00f3digo Fiscal de Opera\u00e7\u00f5es e Presta\u00e7\u00f5es) - <code>Aaj28</code> - Tipos de apura\u00e7\u00e3o</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o edb01 Edb01 Sim Objeto de apura\u00e7\u00e3o fiscal contendo m\u00eas, ano e tipo"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Obten\u00e7\u00e3o do objeto de apura\u00e7\u00e3o (Edb01)</li> <li>Inicializa\u00e7\u00e3o da estrutura JSON para armazenamento dos c\u00e1lculos</li> <li>Sele\u00e7\u00e3o do alinhamento espec\u00edfico (0040) para campos din\u00e2micos</li> <li>Defini\u00e7\u00e3o do per\u00edodo fiscal (m\u00eas/ano)</li> <li>Inicializa\u00e7\u00e3o de todos os campos do JSON com valor zero</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#2-inicializacao-de-campos","title":"2. Inicializa\u00e7\u00e3o de Campos","text":"<p>Todos os campos do JSON s\u00e3o inicializados com valor 0 para garantir estrutura consistente: - <code>debImp</code> - D\u00e9bitos do imposto - <code>outrosDeb</code> - Outros d\u00e9bitos - <code>estCred</code> - Estorno de cr\u00e9ditos - <code>credImp</code> - Cr\u00e9ditos do imposto - <code>outrosCred</code> - Outros cr\u00e9ditos - <code>estDeb</code> - Estorno de d\u00e9bitos - <code>credAnt</code> - Saldo credor anterior - <code>deducoes</code> - Dedu\u00e7\u00f5es - <code>subTotSai</code> - Subtotal sa\u00eddas - <code>subTotEnt</code> - Subtotal entradas - <code>total</code> - Total - <code>sdoDevedor</code> - Saldo devedor - <code>sdoCredor</code> - Saldo credor - <code>impRecolher</code> - Imposto a recolher</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#3-calculo-de-debitos-do-ipi","title":"3. C\u00e1lculo de D\u00e9bitos do IPI","text":"<ul> <li>Valor com d\u00e9bito do imposto: Sa\u00eddas industriais tributadas</li> <li>Processa documentos de sa\u00edda (esMov = 1)</li> <li>CFOP iniciados em 5, 6 ou 7 (sa\u00eddas industriais)</li> <li>Documentos n\u00e3o cancelados</li> <li>Per\u00edodo: data de entrada (esData) entre data inicial e final</li> <li>Soma valores do campo IPI no JSON dos itens usando campos din\u00e2micos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#4-calculo-de-creditos-do-ipi","title":"4. C\u00e1lculo de Cr\u00e9ditos do IPI","text":"<ul> <li>Valor com cr\u00e9dito do imposto: Entradas industriais com cr\u00e9dito</li> <li>Processa documentos de entrada (esMov = 0)</li> <li>CFOP iniciados em 1, 2 ou 3 (entradas industriais)</li> <li>Documentos n\u00e3o cancelados</li> <li>Per\u00edodo: data de entrada (esData) entre data inicial e final</li> <li>Soma valores do campo IPI no JSON dos itens usando campos din\u00e2micos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#5-calculo-de-saldo-anterior","title":"5. C\u00e1lculo de Saldo Anterior","text":"<ul> <li>Saldo credor anterior: Calcula saldo compens\u00e1vel do per\u00edodo anterior</li> <li>Busca apura\u00e7\u00e3o do per\u00edodo anterior do mesmo tipo</li> <li>Se existir apura\u00e7\u00e3o anterior:<ul> <li>Calcula cr\u00e9ditos totais do per\u00edodo anterior:   <pre><code>Cr\u00e9ditos = credImp + outrosCred + estDeb + credAnt\n</code></pre></li> <li>Calcula d\u00e9bitos totais do per\u00edodo anterior:   <pre><code>D\u00e9bitos = debImp + outrosDeb + estCred\n</code></pre></li> <li>Calcula saldo credor l\u00edquido:   <pre><code>SaldoCredor = Cr\u00e9ditos - D\u00e9bitos\n</code></pre></li> <li>Se saldo credor for positivo, armazena no campo <code>CredAnt</code></li> <li>Se negativo ou zero, mant\u00e9m 0</li> </ul> </li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#classificacao-por-cfop","title":"Classifica\u00e7\u00e3o por CFOP","text":"<ul> <li>D\u00e9bitos (CFOP 5xxx, 6xxx, 7xxx):</li> <li>5xxx: Sa\u00eddas ou presta\u00e7\u00f5es</li> <li>6xxx: Outras sa\u00eddas ou presta\u00e7\u00f5es</li> <li> <p>7xxx: Sa\u00eddas industriais espec\u00edficas</p> </li> <li> <p>Cr\u00e9ditos (CFOP 1xxx, 2xxx, 3xxx):</p> </li> <li>1xxx: Entradas ou aquisi\u00e7\u00f5es</li> <li>2xxx: Devolu\u00e7\u00f5es</li> <li>3xxx: Servi\u00e7os</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#filtros-de-documentos","title":"Filtros de Documentos","text":"<ul> <li>Cancelados exclu\u00eddos: Apenas documentos com <code>eaa01cancData IS NULL</code></li> <li>Data de refer\u00eancia: Usa data de entrada (esData) para ambos d\u00e9bitos e cr\u00e9ditos</li> <li>Movimento: </li> <li>D\u00e9bitos: <code>esMov = 1</code> (sa\u00eddas)</li> <li>Cr\u00e9ditos: <code>esMov = 0</code> (entradas)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#calculo-do-saldo-anterior","title":"C\u00e1lculo do Saldo Anterior","text":"<ul> <li>L\u00f3gica de compensa\u00e7\u00e3o: Saldo \u00e9 a diferen\u00e7a entre cr\u00e9ditos e d\u00e9bitos do per\u00edodo anterior</li> <li>Apenas saldo positivo: Armazena apenas se resultado for maior que zero</li> <li>Acumula\u00e7\u00e3o: Considera todos os tipos de cr\u00e9ditos e d\u00e9bitos do per\u00edodo anterior</li> <li>C\u00e1lculo completo: Inclui cr\u00e9ditos, outros cr\u00e9ditos, estornos de d\u00e9bito e saldo anterior anterior</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#inicializacao-rigorosa","title":"Inicializa\u00e7\u00e3o Rigorosa","text":"<ul> <li>Todos os campos s\u00e3o inicializados com 0</li> <li>Preven\u00e7\u00e3o de null pointer exceptions</li> <li>Estrutura consistente mesmo sem valores calculados</li> <li>Uso de <code>getBigDecimal_Zero()</code> para seguran\u00e7a</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de apura\u00e7\u00e3o do IPI para Livro Fiscal.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#buscarsaidas_debitoimposto","title":"<code>buscarSaidas_DebitoImposto()</code>","text":"<p>Busca valores de IPI a d\u00e9bito nas sa\u00eddas industriais. - Par\u00e2metros: nome do campo JSON, per\u00edodo (data inicial/final) - Filtros: sa\u00eddas (esMov=1), CFOP 5xxx/6xxx/7xxx, n\u00e3o cancelados - Consulta: Soma valores do campo IPI no JSON usando <code>jGet()</code> - Retorna: Soma dos valores de d\u00e9bito ou 0</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#buscarentradas_creditoimposto","title":"<code>buscarEntradas_CreditoImposto()</code>","text":"<p>Busca valores de IPI a cr\u00e9dito nas entradas industriais. - Par\u00e2metros: nome do campo JSON, per\u00edodo (data inicial/final) - Filtros: entradas (esMov=0), CFOP 1xxx/2xxx/3xxx, n\u00e3o cancelados - Consulta: Soma valores do campo IPI no JSON usando <code>jGet()</code> - Retorna: Soma dos valores de cr\u00e9dito ou 0</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#buscarapuracaoanterior","title":"<code>buscarApuracaoAnterior()</code>","text":"<p>Busca apura\u00e7\u00e3o do per\u00edodo anterior. - Par\u00e2metros: m\u00eas, ano, tipo de apura\u00e7\u00e3o - Filtro: mesmo tipo de apura\u00e7\u00e3o, meses anteriores - Considera grupo centralizador (<code>getSamWhere().getWhereGc()</code>) - Ordena por ano e m\u00eas decrescente - Retorna: Apura\u00e7\u00e3o anterior ou null</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>JSON da Apura\u00e7\u00e3o (edb01json) com campos din\u00e2micos: - <code>debImp</code> - Valor com d\u00e9bito do imposto (sa\u00eddas industriais) - <code>credImp</code> - Valor com cr\u00e9dito do imposto (entradas industriais) - <code>CredAnt</code> - Saldo credor anterior (calculado do per\u00edodo anterior) - <code>outrosDeb</code> - Outros d\u00e9bitos (inicializado como 0) - <code>estCred</code> - Estorno de cr\u00e9ditos (inicializado como 0) - <code>outrosCred</code> - Outros cr\u00e9ditos (inicializado como 0) - <code>estDeb</code> - Estorno de d\u00e9bitos (inicializado como 0) - <code>deducoes</code> - Dedu\u00e7\u00f5es (inicializado como 0) - <code>subTotSai</code> - Subtotal sa\u00eddas (inicializado como 0) - <code>subTotEnt</code> - Subtotal entradas (inicializado como 0) - <code>total</code> - Total (inicializado como 0) - <code>sdoDevedor</code> - Saldo devedor (inicializado como 0) - <code>sdoCredor</code> - Saldo credor (inicializado como 0) - <code>impRecolher</code> - Imposto a recolher (inicializado como 0)</p> <p>C\u00e1lculo do Saldo Anterior: Cr\u00e9ditosAnterior = credImp_anterior + outrosCred_anterior + estDeb_anterior + credAnt_anterior D\u00e9bitosAnterior = debImp_anterior + outrosDeb_anterior + estCred_anterior SaldoCredor = Cr\u00e9ditosAnterior - D\u00e9bitosAnterior</p> <p>Se SaldoCredor &gt; 0: credAnt_atual = SaldoCredor Sen\u00e3o: credAnt_atual = 0</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios diversos (DateUtils) - <code>java.time</code> - Manipula\u00e7\u00e3o de datas - <code>sam.server.samdev.utils</code> - Utilit\u00e1rios de par\u00e2metros</p> <p>M\u00f3dulos: - M\u00f3dulo Fiscal - M\u00f3dulo de Documentos Fiscais - M\u00f3dulo de Apura\u00e7\u00f5es Fiscais - M\u00f3dulo de Livros Fiscais - M\u00f3dulo Industrial</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#especificidades-do-ipi-industrial","title":"Especificidades do IPI Industrial","text":"<ul> <li>CFOP industriais: Inclui s\u00e9rie 7xxx para opera\u00e7\u00f5es industriais espec\u00edficas</li> <li>Data de entrada: Usa <code>esData</code> como refer\u00eancia para ambos d\u00e9bitos e cr\u00e9ditos</li> <li>Foco industrial: F\u00f3rmula especializada para empresas do ramo industrial</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#consultas-com-json","title":"Consultas com JSON","text":"<ul> <li>Uso de <code>jGet()</code> para extrair valores de campos JSON din\u00e2micos</li> <li>Consultas parametrizadas com filtros por padr\u00e3o de CFOP</li> <li>Somas diretas no banco de dados para performance</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#inicializacao-completa","title":"Inicializa\u00e7\u00e3o Completa","text":"<ul> <li>Todos os 15 campos do JSON s\u00e3o inicializados com 0</li> <li>Garantia de estrutura consistente para o Livro Fiscal</li> <li>Preven\u00e7\u00e3o de erros em c\u00e1lculos subsequentes</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#calculo-de-saldo-anterior","title":"C\u00e1lculo de Saldo Anterior","text":"<ul> <li>C\u00e1lculo em tempo de execu\u00e7\u00e3o: N\u00e3o armazena saldo bruto, recalcula</li> <li>Compensa\u00e7\u00e3o completa: Considera todos os componentes do per\u00edodo anterior</li> <li>Apenas positivo: Saldo negativo do per\u00edodo anterior \u00e9 descartado</li> <li>Cumulatividade: Saldo anterior considera saldo anterior do anterior</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#seguranca-e-validacao","title":"Seguran\u00e7a e Valida\u00e7\u00e3o","text":"<ul> <li>Verifica\u00e7\u00e3o de null no JSON da apura\u00e7\u00e3o anterior</li> <li>Uso de <code>getBigDecimal_Zero()</code> para evitar null pointer</li> <li>Filtro por grupo centralizador nas consultas</li> <li>Valida\u00e7\u00e3o de documentos n\u00e3o cancelados</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_IPI/#performance","title":"Performance","text":"<ul> <li>Consultas otimizadas com filtros simples</li> <li>Uso de <code>LIKE</code> para padr\u00f5es de CFOP (5%, 6%, 7%, etc.)</li> <li>Busca \u00fanica para apura\u00e7\u00e3o anterior</li> <li>C\u00e1lculos m\u00ednimos em tempo de execu\u00e7\u00e3o</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 08:20 Autor: Bruno Tipo: F\u00f3rmula de Apura\u00e7\u00e3o Fiscal Vers\u00e3o: 1.0 Tributo: IPI (Imposto sobre Produtos Industrializados) Destino: Livro Fiscal (LF) Setor: Industrial Especificidade: Opera\u00e7\u00f5es industriais com CFOP 7xxx</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/","title":"SGT_Apuracao_LF_ManipulacaoCampos - Manipula\u00e7\u00e3o de Campos da Apura\u00e7\u00e3o do Livro Fiscal","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula complementar para c\u00e1lculo e manipula\u00e7\u00e3o dos campos derivados da apura\u00e7\u00e3o fiscal do Livro Fiscal (LF), realizando os c\u00e1lculos finais de subtotais, totais, saldos e impostos a recolher com base nos valores j\u00e1 apurados.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Processar os valores j\u00e1 calculados da apura\u00e7\u00e3o fiscal para gerar os campos derivados necess\u00e1rios para o Livro Fiscal, incluindo subtotais, totais, saldos devedor/credor e c\u00e1lculo final do imposto a recolher ap\u00f3s dedu\u00e7\u00f5es.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Sistema de Livros Fiscais</li> <li>M\u00f3dulo de Apura\u00e7\u00f5es Fiscais</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Edb01</code> - Apura\u00e7\u00e3o fiscal principal - <code>edb01json</code> - Estrutura JSON com os valores apurados</p> <p>Campos de Entrada (j\u00e1 calculados): - <code>debImp</code> - D\u00e9bitos do imposto - <code>outrosDeb</code> - Outros d\u00e9bitos - <code>estCred</code> - Estorno de cr\u00e9ditos - <code>credImp</code> - Cr\u00e9ditos do imposto - <code>outrosCred</code> - Outros cr\u00e9ditos - <code>estDeb</code> - Estorno de d\u00e9bitos - <code>credAnt</code> - Saldo credor anterior - <code>deducoes</code> - Dedu\u00e7\u00f5es aplic\u00e1veis</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o edb01 Edb01 Sim Objeto de apura\u00e7\u00e3o fiscal com JSON j\u00e1 preenchido"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#1-validacao-inicial","title":"1. Valida\u00e7\u00e3o Inicial","text":"<ul> <li>Verifica se o objeto Edb01 existe</li> <li>Verifica se o JSON da apura\u00e7\u00e3o existe</li> <li>Retorna silenciosamente se faltarem dados essenciais</li> <li>Seleciona alinhamento espec\u00edfico (0040) para campos din\u00e2micos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#2-calculo-de-subtotal-de-saidas","title":"2. C\u00e1lculo de Subtotal de Sa\u00eddas","text":"<ul> <li>F\u00f3rmula: <code>subTotSai = debImp + outrosDeb + estCred</code></li> <li>Componentes:</li> <li><code>debImp</code>: D\u00e9bitos principais do imposto</li> <li><code>outrosDeb</code>: Outros d\u00e9bitos diversos</li> <li><code>estCred</code>: Estornos de cr\u00e9ditos (aumentam o d\u00e9bito)</li> <li>Prop\u00f3sito: Consolidar todas as obriga\u00e7\u00f5es de d\u00e9bito do per\u00edodo</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#3-calculo-de-subtotal-de-entradas","title":"3. C\u00e1lculo de Subtotal de Entradas","text":"<ul> <li>F\u00f3rmula: <code>subTotEnt = credImp + outrosCred + estDeb</code></li> <li>Componentes:</li> <li><code>credImp</code>: Cr\u00e9ditos principais do imposto</li> <li><code>outrosCred</code>: Outros cr\u00e9ditos diversos</li> <li><code>estDeb</code>: Estornos de d\u00e9bitos (aumentam o cr\u00e9dito)</li> <li>Prop\u00f3sito: Consolidar todos os direitos de cr\u00e9dito do per\u00edodo</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#4-calculo-do-total","title":"4. C\u00e1lculo do Total","text":"<ul> <li>F\u00f3rmula: <code>total = subTotEnt + credAnt</code></li> <li>Componentes:</li> <li><code>subTotEnt</code>: Subtotal de entradas do per\u00edodo atual</li> <li><code>credAnt</code>: Saldo credor acumulado de per\u00edodos anteriores</li> <li>Prop\u00f3sito: Calcular o total de cr\u00e9ditos dispon\u00edveis (atuais + anteriores)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#5-calculo-do-saldo-devedor","title":"5. C\u00e1lculo do Saldo Devedor","text":"<ul> <li>Condi\u00e7\u00e3o: Apenas se <code>subTotalSaidas &gt; subTotalEntradas</code></li> <li>F\u00f3rmula: <code>saldoDevedor = subTotalSaidas - total</code></li> <li>L\u00f3gica: </li> <li>Se sa\u00eddas forem maiores que entradas: h\u00e1 d\u00e9bito l\u00edquido</li> <li>Se entradas forem maiores ou iguais: saldo devedor = 0</li> <li>Prop\u00f3sito: Determinar se h\u00e1 saldo devedor ap\u00f3s compensa\u00e7\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#6-calculo-do-imposto-a-recolher","title":"6. C\u00e1lculo do Imposto a Recolher","text":"<ul> <li>F\u00f3rmula: <code>impRecolher = saldoDevedor - deducoes</code></li> <li>Componentes:</li> <li><code>saldoDevedor</code>: D\u00e9bito l\u00edquido ap\u00f3s compensa\u00e7\u00e3o</li> <li><code>deducoes</code>: Dedu\u00e7\u00f5es legalmente permitidas</li> <li>Prop\u00f3sito: Calcular o valor final a pagar ao fisco</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#7-calculo-do-saldo-credor","title":"7. C\u00e1lculo do Saldo Credor","text":"<ul> <li>Condi\u00e7\u00e3o: Apenas se <code>subTotalSaidas &lt;= total</code></li> <li>F\u00f3rmula: <code>saldoCredor = total - subTotalSaidas</code></li> <li>L\u00f3gica:</li> <li>Se cr\u00e9ditos totais forem maiores que d\u00e9bitos totais: h\u00e1 cr\u00e9dito excedente</li> <li>Se d\u00e9bitos forem maiores: saldo credor = 0</li> <li>Prop\u00f3sito: Determinar cr\u00e9dito a compensar em per\u00edodos futuros</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#logica-condicional-dos-saldos","title":"L\u00f3gica Condicional dos Saldos","text":"<ul> <li> <p>Saldo Devedor: S\u00f3 existe se d\u00e9bitos &gt; cr\u00e9ditos Se subTotalSaidas &gt; subTotalEntradas: saldoDevedor = subTotalSaidas - total Sen\u00e3o: saldoDevedor = 0</p> </li> <li> <p>Saldo Credor: S\u00f3 existe se cr\u00e9ditos \u2265 d\u00e9bitos Se subTotalSaidas &lt;= total: saldoCredor = total - subTotalSaidas Sen\u00e3o: saldoCredor = 0</p> </li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#relacionamento-entre-campos","title":"Relacionamento entre Campos","text":"<ul> <li>Exclusividade: Apenas um dos saldos (devedor ou credor) pode ser positivo</li> <li>Compensa\u00e7\u00e3o completa: Saldo anterior \u00e9 totalmente compensado com d\u00e9bitos atuais</li> <li>Dedu\u00e7\u00f5es aplic\u00e1veis: Apenas reduzem o imposto a recolher, n\u00e3o afetam saldo credor</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#tratamento-de-valores","title":"Tratamento de Valores","text":"<ul> <li>Valores zero: Uso de <code>getBigDecimal_Zero()</code> para seguran\u00e7a</li> <li>Campos din\u00e2micos: Uso de <code>getCampo()</code> para flexibilidade</li> <li>Valida\u00e7\u00e3o silenciosa: Retorno antecipado se dados estiverem incompletos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#ordem-dos-calculos","title":"Ordem dos C\u00e1lculos","text":"<ol> <li>Subtotais (sa\u00eddas e entradas)</li> <li>Total (entradas + saldo anterior)</li> <li>Saldo devedor (se aplic\u00e1vel)</li> <li>Imposto a recolher (saldo devedor - dedu\u00e7\u00f5es)</li> <li>Saldo credor (se aplic\u00e1vel)</li> </ol>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que executa toda a sequ\u00eancia de c\u00e1lculos derivados. - Valida presen\u00e7a dos dados necess\u00e1rios - Executa c\u00e1lculos em ordem l\u00f3gica - Atualiza o JSON da apura\u00e7\u00e3o</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#calculos-implementados","title":"C\u00e1lculos Implementados:","text":"<ol> <li>Subtotal de Sa\u00eddas: Consolida\u00e7\u00e3o de todos os d\u00e9bitos</li> <li>Subtotal de Entradas: Consolida\u00e7\u00e3o de todos os cr\u00e9ditos</li> <li>Total: Cr\u00e9ditos totais dispon\u00edveis</li> <li>Saldo Devedor: D\u00e9bito l\u00edquido ap\u00f3s compensa\u00e7\u00e3o</li> <li>Imposto a Recolher: Valor final a pagar</li> <li>Saldo Credor: Cr\u00e9dito excedente para per\u00edodos futuros</li> </ol>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Campos de Entrada (pr\u00e9-calculados): - <code>debImp</code> - D\u00e9bitos do imposto - <code>outrosDeb</code> - Outros d\u00e9bitos - <code>estCred</code> - Estorno de cr\u00e9ditos - <code>credImp</code> - Cr\u00e9ditos do imposto - <code>outrosCred</code> - Outros cr\u00e9ditos - <code>estDeb</code> - Estorno de d\u00e9bitos - <code>credAnt</code> - Saldo credor anterior - <code>deducoes</code> - Dedu\u00e7\u00f5es</p> <p>Campos Calculados (sa\u00edda): - <code>subTotSai</code> - Subtotal de sa\u00eddas subTotSai = debImp + outrosDeb + estCred - <code>subTotEnt</code> - Subtotal de entradas subTotEnt = credImp + outrosCred + estDeb - <code>total</code> - Total de cr\u00e9ditos dispon\u00edveis total = subTotEnt + credAnt - <code>saldoDevedor</code> - Saldo devedor (se d\u00e9bitos &gt; cr\u00e9ditos) Se subTotSai &gt; subTotEnt: saldoDevedor = subTotSai - total Sen\u00e3o: 0 - <code>impRecolher</code> - Imposto a recolher (ap\u00f3s dedu\u00e7\u00f5es) impRecolher = saldoDevedor - deducoes - <code>saldoCredor</code> - Saldo credor (se cr\u00e9ditos \u2265 d\u00e9bitos) Se subTotSai &lt;= total: saldoCredor = total - subTotSai Sen\u00e3o: 0</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>br.com.multitec.utils.collections</code> - TableMap para manipula\u00e7\u00e3o de JSON - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.server.samdev.formula</code> - Base para f\u00f3rmulas</p> <p>Pr\u00e9-requisitos: - Apura\u00e7\u00e3o principal j\u00e1 calculada (Edb01 com JSON preenchido) - Campos b\u00e1sicos j\u00e1 definidos no JSON - Alinhamento 0040 configurado</p> <p>M\u00f3dulos: - M\u00f3dulo de Apura\u00e7\u00f5es Fiscais - M\u00f3dulo de Livros Fiscais - M\u00f3dulo de C\u00e1lculos Derivados</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#natureza-complementar","title":"Natureza Complementar","text":"<ul> <li>F\u00f3rmula auxiliar: N\u00e3o calcula valores prim\u00e1rios, apenas derivados</li> <li>Depend\u00eancia de dados: Requer apura\u00e7\u00e3o principal j\u00e1 processada</li> <li>Execu\u00e7\u00e3o sequencial: Geralmente executada ap\u00f3s f\u00f3rmulas de apura\u00e7\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#tratamento-de-erros","title":"Tratamento de Erros","text":"<ul> <li>Valida\u00e7\u00e3o defensiva: Verifica nulls antes de processar</li> <li>Retorno silencioso: N\u00e3o lan\u00e7a exce\u00e7\u00f5es para dados faltantes</li> <li>Valores padr\u00e3o: Usa zero para valores n\u00e3o existentes</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#performance","title":"Performance","text":"<ul> <li>C\u00e1lculos simples: Opera\u00e7\u00f5es aritm\u00e9ticas b\u00e1sicas</li> <li>Sem consultas ao banco: Trabalha apenas com dados em mem\u00f3ria</li> <li>Execu\u00e7\u00e3o r\u00e1pida: Processamento direto dos valores</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#flexibilidade","title":"Flexibilidade","text":"<ul> <li>Campos din\u00e2micos: Usa <code>getCampo()</code> para adapta\u00e7\u00e3o a diferentes configura\u00e7\u00f5es</li> <li>Alinhamento espec\u00edfico: Configur\u00e1vel para diferentes tipos de apura\u00e7\u00e3o</li> <li>JSON como interface: Estrutura flex\u00edvel para diferentes tributos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#seguranca","title":"Seguran\u00e7a","text":"<ul> <li><code>getBigDecimal_Zero()</code>: Garante valores num\u00e9ricos v\u00e1lidos</li> <li>Verifica\u00e7\u00e3o de null: Previne NullPointerException</li> <li>C\u00e1lculos determin\u00edsticos: Sempre produz mesmo resultado para mesmos inputs</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_LF_ManipulacaoCampos/#integracao","title":"Integra\u00e7\u00e3o","text":"<ul> <li>Encadeamento: Projetada para execu\u00e7\u00e3o em pipeline com outras f\u00f3rmulas</li> <li>Manuten\u00e7\u00e3o de estado: Atualiza o objeto Edb01 original</li> <li>Interface consistente: Mesmo padr\u00e3o de outras f\u00f3rmulas de apura\u00e7\u00e3o</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 08:20 Autor: Bruno Tipo: F\u00f3rmula de Manipula\u00e7\u00e3o de Campos Vers\u00e3o: 1.0 Finalidade: C\u00e1lculos derivados da apura\u00e7\u00e3o fiscal Destino: Livro Fiscal (LF) Depend\u00eancia: Requer apura\u00e7\u00e3o principal j\u00e1 calculada</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/","title":"SGT - Apura\u00e7\u00e3o de Receita PIS/COFINS","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para apura\u00e7\u00e3o de receitas tribut\u00e1veis e n\u00e3o tribut\u00e1veis, c\u00e1lculo da Contribui\u00e7\u00e3o Previdenci\u00e1ria sobre a Receita Bruta (P100) e consolida\u00e7\u00e3o de dados para escritura\u00e7\u00e3o fiscal (PIS/COFINS).</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar a apura\u00e7\u00e3o de receitas e o c\u00e1lculo da contribui\u00e7\u00e3o previdenci\u00e1ria sobre a receita bruta, considerando matriz e filiais, classifica\u00e7\u00f5es de receita, atividades econ\u00f4micas e ajustes por devolu\u00e7\u00f5es.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Faturamento</li> <li>Auditoria Fiscal</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Aac10</code> - Empresas (matriz e filiais) - <code>Edb10</code> - Per\u00edodo de apura\u00e7\u00e3o - <code>Edb1001</code> - Empresas com receita no per\u00edodo - <code>Edb10011</code> - Atividades com contribui\u00e7\u00e3o previdenci\u00e1ria - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens do documento fiscal - <code>Abg02</code> - Atividades econ\u00f4micas (CPRB) - <code>Abc10</code> - Contas cont\u00e1beis - <code>Abb01</code> - Lan\u00e7amentos cont\u00e1beis - <code>Aah01</code> - Tipos de documento</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o edb10 Edb10 Sim Per\u00edodo de apura\u00e7\u00e3o (m\u00eas/ano) campos JSON String Sim Campos da tabela P100 para extra\u00e7\u00e3o dos valores (vlRecTotEst, vlRecAtivEstab, vlExc, aliqCont)"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Sele\u00e7\u00e3o do alinhamento cont\u00e1bil (<code>0044</code>)</li> <li>Busca da matriz e filiais relacionadas</li> <li>Extra\u00e7\u00e3o dos campos JSON da P100</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#2-apuracao-da-receita","title":"2. Apura\u00e7\u00e3o da Receita","text":"<ul> <li>Classifica\u00e7\u00e3o da receita em:</li> <li>Tribut\u00e1vel (classe 1)</li> <li>N\u00e3o tribut\u00e1vel (classe 2)</li> <li>Exporta\u00e7\u00e3o (classe 3)</li> <li>Cumulativo (classe 4)</li> <li>Consolida\u00e7\u00e3o por empresa (matriz + filiais)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#3-calculo-da-contribuicao-previdenciaria-p100","title":"3. C\u00e1lculo da Contribui\u00e7\u00e3o Previdenci\u00e1ria (P100)","text":"<ul> <li>Agrupamento por atividade econ\u00f4mica (<code>Abg02</code>)</li> <li>Soma das receitas totais e receitas com atividade</li> <li>Dedu\u00e7\u00e3o de devolu\u00e7\u00f5es</li> <li>C\u00e1lculo da base de c\u00e1lculo e contribui\u00e7\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#4-consolidacao-dos-resultados","title":"4. Consolida\u00e7\u00e3o dos Resultados","text":"<ul> <li>Preenchimento dos campos <code>Edb10</code>:</li> <li><code>edb10rbTrib</code> - Receita tribut\u00e1vel</li> <li><code>edb10rbNaoTrib</code> - Receita n\u00e3o tribut\u00e1vel</li> <li><code>edb10rbExp</code> - Receita de exporta\u00e7\u00e3o</li> <li><code>edb10rbCumul</code> - Receita cumulativa</li> <li><code>edb10rbTotal</code> - Receita total com atividade</li> <li><code>edb10rbAtivCP</code> - Receita sujeita \u00e0 contribui\u00e7\u00e3o</li> <li><code>edb10rbAtivSemCP</code> - Receita sem contribui\u00e7\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#classificacao-da-receita","title":"Classifica\u00e7\u00e3o da Receita","text":"<ul> <li>Classe 1: Receita tribut\u00e1vel</li> <li>Classe 2: Receita n\u00e3o tribut\u00e1vel</li> <li>Classe 3: Receita de exporta\u00e7\u00e3o</li> <li>Classe 4: Receita cumulativa</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#calculo-da-contribuicao-previdenciaria","title":"C\u00e1lculo da Contribui\u00e7\u00e3o Previdenci\u00e1ria","text":"<ul> <li>Agrupamento: Por atividade econ\u00f4mica (<code>abg02id</code>)</li> <li>Base de c\u00e1lculo: Receita total da atividade menos exclus\u00f5es</li> <li>Al\u00edquota: Espec\u00edfica por atividade</li> <li>F\u00f3rmula: <code>(RB - Exc) * Al\u00edquota / 100</code></li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#tratamento-de-devolucoes","title":"Tratamento de Devolu\u00e7\u00f5es","text":"<ul> <li>Consideradas apenas para atividades com contribui\u00e7\u00e3o</li> <li>Deduzidas do campo <code>vlExc</code> (exclus\u00f5es)</li> <li>N\u00e3o afetam receitas totais, apenas a base de c\u00e1lculo</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#empresas-e-grupos","title":"Empresas e Grupos","text":"<ul> <li>Matriz: Empresa principal do grupo</li> <li>Filial: Empresas vinculadas \u00e0 matriz</li> <li>Grupo Cont\u00e1bil: Vincula\u00e7\u00e3o por empresa e tabela (<code>EA</code>)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de apura\u00e7\u00e3o.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#selecionargcporempresalong-aac10id-string-tabela","title":"<code>selecionarGCPorEmpresa(Long aac10id, String tabela)</code>","text":"<p>Retorna o ID do grupo cont\u00e1bil da empresa para uma tabela espec\u00edfica.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#buscarmatrizefiliais","title":"<code>buscarMatrizEFiliais()</code>","text":"<p>Busca a matriz e todas as filiais relacionadas \u00e0 empresa ativa.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#buscarreceitainteger-mes-integer-ano-long-gcea","title":"<code>buscarReceita(Integer mes, Integer ano, Long gcEA)</code>","text":"<p>Busca receitas classificadas por grupo cont\u00e1bil no per\u00edodo.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#buscarreceitap100integer-mes-integer-ano-string-cpovlrectotest-string-cpovlrecativestab-string-cpovlexc-string-cpoaliqcont-long-gc","title":"<code>buscarReceitaP100(Integer mes, Integer ano, String cpoVlRecTotEst, String cpoVlRecAtivEstab, String cpoVlExc, String cpoAliqCont, Long gc)</code>","text":"<p>Busca receitas para c\u00e1lculo da P100 (ativa\u00e7\u00f5es + contribui\u00e7\u00e3o).</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#buscardevolucoesp100integer-mes-integer-ano-string-cpovlrectotest-string-cpovlrecativestab-string-cpovlexc-string-cpoaliqcont-long-gc","title":"<code>buscarDevolucoesP100(Integer mes, Integer ano, String cpoVlRecTotEst, String cpoVlRecAtivEstab, String cpoVlExc, String cpoAliqCont, Long gc)</code>","text":"<p>Busca devolu\u00e7\u00f5es para ajuste do c\u00e1lculo da P100.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Edb10 Atualizado: - Campos de receita classificada (<code>rbTrib</code>, <code>rbNaoTrib</code>, <code>rbExp</code>, <code>rbCumul</code>) - Campos consolidados da P100 (<code>rbTotal</code>, <code>rbAtivCP</code>, <code>rbAtivSemCP</code>) - Lista de empresas com receita (<code>Edb1001</code>) - Detalhamento por atividade (<code>Edb10011</code>)</p> <p>Edb10011 (Detalhe por Atividade): - <code>ativ</code> - Atividade econ\u00f4mica (<code>Abg02</code>) - <code>rb</code> - Receita bruta da atividade - <code>exc</code> - Exclus\u00f5es/devolu\u00e7\u00f5es - <code>aliq</code> - Al\u00edquota da contribui\u00e7\u00e3o - <code>cprb</code> - Contribui\u00e7\u00e3o calculada - <code>cta</code> - Conta cont\u00e1bil (<code>Abc10</code>)</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios diversos - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.model</code> - Entidades do sistema - <code>java.time</code> - Manipula\u00e7\u00e3o de datas (impl\u00edcita)</p> <p>M\u00f3dulo: SGT (Sistema de Gest\u00e3o Tribut\u00e1ria)</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#campos-json-da-p100","title":"Campos JSON da P100","text":"<ul> <li><code>vlRecTotEst</code> - Receita total do estabelecimento</li> <li><code>vlRecAtivEstab</code> - Receita com atividade do estabelecimento</li> <li><code>vlExc</code> - Exclus\u00f5es da base de c\u00e1lculo</li> <li><code>aliqCont</code> - Al\u00edquota da contribui\u00e7\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#tratamento-de-devolucoes_1","title":"Tratamento de Devolu\u00e7\u00f5es","text":"<ul> <li>Devolu\u00e7\u00f5es s\u00e3o subtra\u00eddas das exclus\u00f5es (<code>vlExc</code>)</li> <li>N\u00e3o reduzem a receita bruta total</li> <li>Apenas atividades com <code>abg02id</code> s\u00e3o ajustadas</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#performance","title":"Performance","text":"<ul> <li>Consultas otimizadas com agrupamento no banco</li> <li>Uso de <code>TableMap</code> para manipula\u00e7\u00e3o eficiente de dados</li> <li>Processamento em lote para matriz + filiais</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Apuracao_Receita_PisCofins/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Apenas documentos n\u00e3o cancelados (<code>eaa01cancData IS NULL</code>)</li> <li>Apenas documentos de entrada (<code>eaa01esMov = 1</code>) ou devolu\u00e7\u00e3o (<code>tipocod = 4</code>)</li> <li>Filtro por grupo cont\u00e1bil (<code>gc</code>)</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 08:20 Autor: Bruno Tipo: F\u00f3rmula de Apura\u00e7\u00e3o Fiscal Vers\u00e3o: 1.0</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/","title":"SGT - Leiaute 15/2021 para PIS/COFINS (EFD Contribui\u00e7\u00f5es)","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para gera\u00e7\u00e3o do arquivo digital da Escritura\u00e7\u00e3o Fiscal Digital (EFD) das Contribui\u00e7\u00f5es (PIS/COFINS), conforme Leiaute 15/2021, com suporte a m\u00faltiplos blocos e registros exigidos pela legisla\u00e7\u00e3o fiscal.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar arquivo texto no formato EFD Contribui\u00e7\u00f5es (PIS/COFINS) contendo todas as opera\u00e7\u00f5es fiscais do per\u00edodo, incluindo documentos fiscais, opera\u00e7\u00f5es diversas, cr\u00e9ditos, d\u00e9bitos e apura\u00e7\u00f5es.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Auditoria Fiscal</li> <li>Compliance Tribut\u00e1rio</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens do documento fiscal - <code>Eaa0102</code> - Complemento do documento - <code>Eaa01034</code> - Declara\u00e7\u00f5es de importa\u00e7\u00e3o - <code>Eaa0113</code> - Pagamentos do documento - <code>Abb01</code> - Lan\u00e7amentos cont\u00e1beis - <code>Aah01</code> - Tipos de documento - <code>Aac10</code> - Empresas (matriz e filiais) - <code>Abe01</code> - Entidades (clientes/fornecedores) - <code>Abm01</code> - Itens (produtos/servi\u00e7os) - <code>Edb10</code> - Per\u00edodo de apura\u00e7\u00e3o - <code>Edb11</code> - Opera\u00e7\u00f5es geradoras de cr\u00e9dito - <code>Edb12</code> - Reten\u00e7\u00f5es na fonte - <code>Edb13</code> - Dedu\u00e7\u00f5es diversas - <code>Edb14</code> - Cr\u00e9ditos por incorpora\u00e7\u00e3o/fus\u00e3o/cis\u00e3o</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o dtInicial LocalDate Sim Data inicial do per\u00edodo dtFinal LocalDate Sim Data final do per\u00edodo situacao Integer Sim Situa\u00e7\u00e3o da EFD (0-normal, 9-retificadora) numRecibo String N\u00e3o N\u00famero do recibo (para retifica\u00e7\u00e3o) aliqPisF150 BigDecimal Sim Al\u00edquota do PIS para registro F150 aliqCofinsF150 BigDecimal Sim Al\u00edquota da COFINS para registro F150"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o dos par\u00e2metros obrigat\u00f3rios</li> <li>Busca da empresa matriz e filiais</li> <li>Verifica\u00e7\u00e3o da apura\u00e7\u00e3o de receita do per\u00edodo</li> <li>Inicializa\u00e7\u00e3o dos contadores e arquivos texto</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#2-geracao-do-bloco-0-abertura-e-identificacao","title":"2. Gera\u00e7\u00e3o do Bloco 0 - Abertura e Identifica\u00e7\u00e3o","text":"<ul> <li>Registro 0000: Abertura do arquivo</li> <li>Registro 0001: Abertura do bloco 0</li> <li>Registro 0100: Dados do contabilista</li> <li>Registro 0110: Regimes de apura\u00e7\u00e3o</li> <li>Registro 0111: Receita bruta mensal para rateio</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#3-geracao-dos-blocos-de-documentos-fiscais","title":"3. Gera\u00e7\u00e3o dos Blocos de Documentos Fiscais","text":"<ul> <li>Bloco A: Documentos fiscais de servi\u00e7os</li> <li>Bloco C: Documentos fiscais de mercadorias (ICMS/IPI)</li> <li>Bloco D: Documentos fiscais de servi\u00e7os (ICMS)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#4-geracao-dos-blocos-de-operacoes-diversas","title":"4. Gera\u00e7\u00e3o dos Blocos de Opera\u00e7\u00f5es Diversas","text":"<ul> <li>Bloco F: Demais documentos e opera\u00e7\u00f5es</li> <li>F100: Opera\u00e7\u00f5es geradoras de contribui\u00e7\u00e3o e cr\u00e9ditos</li> <li>F120: Bens que geram cr\u00e9ditos por deprecia\u00e7\u00e3o</li> <li>F130: Bens que geram cr\u00e9ditos por aquisi\u00e7\u00e3o</li> <li>F150: Cr\u00e9dito presumido sobre estoque</li> <li>F550: Consolida\u00e7\u00e3o para lucro presumido</li> <li>F600: Contribui\u00e7\u00e3o retida na fonte</li> <li>F700: Dedu\u00e7\u00f5es diversas</li> <li>F800: Cr\u00e9ditos por incorpora\u00e7\u00e3o/fus\u00e3o/cis\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#5-geracao-dos-blocos-complementares","title":"5. Gera\u00e7\u00e3o dos Blocos Complementares","text":"<ul> <li>Bloco M: Apura\u00e7\u00e3o do PIS/COFINS</li> <li>Bloco 1: Opera\u00e7\u00f5es extempor\u00e2neas</li> <li>1010: Processos judiciais referenciados</li> <li>1020: Processos administrativos referenciados</li> <li>1900: Consolida\u00e7\u00e3o documentos PJ lucro presumido</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#6-finalizacao-do-bloco-0","title":"6. Finaliza\u00e7\u00e3o do Bloco 0","text":"<ul> <li>Registros 0140-0600: Tabelas cadastrais</li> <li>Registro 0990: Encerramento do bloco 0</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#7-geracao-do-bloco-9-controle-e-encerramento","title":"7. Gera\u00e7\u00e3o do Bloco 9 - Controle e Encerramento","text":"<ul> <li>Registro 9001: Abertura do bloco 9</li> <li>Registro 9900: Quantitativo de registros por tipo</li> <li>Registro 9990: Encerramento do bloco 9</li> <li>Registro 9999: Encerramento do arquivo</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#classificacao-de-documentos","title":"Classifica\u00e7\u00e3o de Documentos","text":"<ul> <li>Bloco A: Notas fiscais de servi\u00e7o (modelos espec\u00edficos)</li> <li>Bloco C: Notas fiscais de produtos (01, 1B, 04, 55, 65)</li> <li>Bloco D: Documentos de transporte (07, 08, 09, 10, 11, 26, 27, 57) e comunica\u00e7\u00e3o (21, 22)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#situacao-de-documentos","title":"Situa\u00e7\u00e3o de Documentos","text":"<ul> <li>Situa\u00e7\u00f5es especiais (02, 03, 04, 05): Geram apenas registros pai sem filhos</li> <li>Documentos normais: Geram registros completos com todos os campos</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#calculos-fiscais","title":"C\u00e1lculos Fiscais","text":"<ul> <li>Base de c\u00e1lculo: Valores extra\u00eddos dos campos JSON dos documentos</li> <li>Al\u00edquotas: Configur\u00e1veis por item/opera\u00e7\u00e3o</li> <li>CST PIS/COFINS: Determinadas conforme movimento e classifica\u00e7\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Documentos devem ter situa\u00e7\u00e3o definida</li> <li>Apura\u00e7\u00e3o de receita deve existir para o per\u00edodo</li> <li>Empresa matriz deve ter informa\u00e7\u00f5es fiscais cadastradas</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra toda a gera\u00e7\u00e3o da EFD.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#metodos-de-geracao-por-bloco","title":"M\u00e9todos de Gera\u00e7\u00e3o por Bloco","text":"<ul> <li><code>gerarAberturaBloco0()</code> - Bloco 0 inicial</li> <li><code>gerarBlocoA()</code> - Documentos de servi\u00e7os</li> <li><code>gerarBlocoC()</code> - Documentos de mercadorias</li> <li><code>gerarBlocoD()</code> - Documentos de servi\u00e7os (ICMS)</li> <li><code>gerarBlocoF()</code> - Opera\u00e7\u00f5es diversas</li> <li><code>gerarBlocoM()</code> - Apura\u00e7\u00e3o</li> <li><code>gerarBloco1()</code> - Opera\u00e7\u00f5es extempor\u00e2neas</li> <li><code>gerarFechamentoBloco0()</code> - Tabelas cadastrais</li> <li><code>gerarBloco9()</code> - Controle e encerramento</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#metodos-de-suporte","title":"M\u00e9todos de Suporte","text":"<ul> <li><code>formatarValor()</code> - Formata\u00e7\u00e3o de valores monet\u00e1rios</li> <li><code>formatarSerie()</code> - Formata\u00e7\u00e3o de s\u00e9rie do documento</li> <li><code>selecionarCSTPis()</code> - Determina\u00e7\u00e3o do CST do PIS</li> <li><code>selecionarCSTCofins()</code> - Determina\u00e7\u00e3o do CST da COFINS</li> <li><code>comporRegistro0150()</code> - Composi\u00e7\u00e3o da tabela de participantes</li> <li><code>comporRegistro0200()</code> - Composi\u00e7\u00e3o da tabela de itens</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Arquivo Texto: - Formato delimitado por pipe (<code>|</code>) - Codifica\u00e7\u00e3o UTF-8 - Layout conforme Leiaute 15/2021 - Dividido em duas partes (txt1 e txt2) para organiza\u00e7\u00e3o</p> <p>Conte\u00fado Gerado: - ~150 tipos de registros diferentes - Tabelas cadastrais (participantes, itens, unidades, etc.) - Documentos fiscais do per\u00edodo - Opera\u00e7\u00f5es diversas e cr\u00e9ditos - Controles quantitativos</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios de data, texto e arquivos - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.model</code> - Entidades do sistema - <code>java.time</code> - Manipula\u00e7\u00e3o de datas</p> <p>Vers\u00e3o do Leiaute: 6 Alinhamento Cont\u00e1bil: 0051</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#performance","title":"Performance","text":"<ul> <li>Processamento paginado para grandes volumes</li> <li>Uso de <code>TableMap</code> para manipula\u00e7\u00e3o eficiente</li> <li>Agrupamento no banco de dados quando poss\u00edvel</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#tratamento-de-dados","title":"Tratamento de Dados","text":"<ul> <li>Campos JSON para valores calculados</li> <li>Formata\u00e7\u00e3o rigorosa conforme layout oficial</li> <li>Valida\u00e7\u00f5es de consist\u00eancia durante a gera\u00e7\u00e3o</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#contadores","title":"Contadores","text":"<ul> <li>Contagem precisa de registros por tipo</li> <li>Atualiza\u00e7\u00e3o em tempo real durante a gera\u00e7\u00e3o</li> <li>Utilizados no registro 9900 (quantitativos)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#fluxo-de-controle","title":"Fluxo de Controle","text":"<ul> <li>Verifica\u00e7\u00e3o peri\u00f3dica de cancelamento</li> <li>Atualiza\u00e7\u00e3o de status do processo</li> <li>Tratamento de exce\u00e7\u00f5es com mensagens claras</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute15_2021_Contribuicoes/#configuracoes-empresariais","title":"Configura\u00e7\u00f5es Empresariais","text":"<ul> <li>Suporte a matriz e filiais</li> <li>Grupos centralizadores por tabela (EA, EC, ED)</li> <li>Informa\u00e7\u00f5es fiscais por empresa</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 08:20 Autor: Bruno Tipo: F\u00f3rmula de Gera\u00e7\u00e3o de EFD Vers\u00e3o: 1.0</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/","title":"SGT - Leiaute 19/2025 (EFD ICMS/IPI)","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para gera\u00e7\u00e3o do arquivo EFD-ICMS/IPI (Escritura\u00e7\u00e3o Fiscal Digital) conforme Leiaute vers\u00e3o 19 (2025), contendo registros dos blocos 0, B, C, D, E, G, H, K, 1 e 9, com suporte a m\u00faltiplos modelos de documentos fiscais e apura\u00e7\u00f5es de ICMS, IPI, ST, DIFAL, CIAP, invent\u00e1rio e controle de produ\u00e7\u00e3o.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar arquivo digital no formato exigido pela Receita Federal (EFD-ICMS/IPI) para entrega obrigat\u00f3ria, consolidando opera\u00e7\u00f5es fiscais, apura\u00e7\u00f5es, invent\u00e1rio, CIAP e movimenta\u00e7\u00f5es de estoque do per\u00edodo.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Auditoria Fiscal</li> <li>Faturamento</li> <li>Controladoria</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> \u2013 Documentos fiscais - <code>Eaa0102</code> \u2013 Dados complementares do documento fiscal - <code>Eaa0103</code> \u2013 Itens do documento fiscal - <code>Eaa01031</code> \u2013 Lan\u00e7amentos fiscais - <code>Eaa01034</code> \u2013 Declara\u00e7\u00f5es de importa\u00e7\u00e3o - <code>Abb01</code> \u2013 Central de documentos - <code>Aah01</code> \u2013 Tipo de documento fiscal - <code>Abe01</code> \u2013 Entidades (clientes/fornecedores) - <code>Abm01</code> \u2013 Itens (produtos/servi\u00e7os) - <code>Aac10</code> \u2013 Empresa - <code>Edb01</code> \u2013 Apura\u00e7\u00f5es fiscais - <code>Ecc01</code> \u2013 Fichas do CIAP - <code>Bcb10</code> / <code>Bcb11</code> \u2013 Invent\u00e1rio f\u00edsico - <code>Bcc01</code> \u2013 Movimenta\u00e7\u00f5es de estoque/produ\u00e7\u00e3o</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o dtInicial LocalDate Sim Data inicial do per\u00edodo de apura\u00e7\u00e3o dtFinal LocalDate Sim Data final do per\u00edodo de apura\u00e7\u00e3o arqSubstituto Integer Sim Indicador de arquivo substituto (0 = N\u00e3o, 1 = Sim) dtInventario LocalDate N\u00e3o Data do invent\u00e1rio f\u00edsico (opcional)"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o dos par\u00e2metros obrigat\u00f3rios</li> <li>Carregamento dos dados da empresa (Aac10)</li> <li>Verifica\u00e7\u00e3o das informa\u00e7\u00f5es fiscais e perfil da empresa</li> <li>Sele\u00e7\u00e3o de alinhamentos (EFD, ICMS, ST, IPI, DIFAL)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#2-geracao-dos-blocos-da-efd","title":"2. Gera\u00e7\u00e3o dos Blocos da EFD","text":"<ul> <li>Bloco 0 \u2013 Abertura, identifica\u00e7\u00e3o e refer\u00eancias</li> <li>Bloco B \u2013 Escritura\u00e7\u00e3o e apura\u00e7\u00e3o do ISS</li> <li>Bloco C \u2013 Documentos fiscais I \u2013 Mercadorias (ICMS/IPI)</li> <li>Bloco D \u2013 Documentos fiscais II \u2013 Servi\u00e7os (ICMS)</li> <li>Bloco E \u2013 Apura\u00e7\u00e3o do ICMS e do IPI</li> <li>Bloco G \u2013 CIAP (Controle de Cr\u00e9dito de ICMS do Ativo Permanente)</li> <li>Bloco H \u2013 Invent\u00e1rio F\u00edsico</li> <li>Bloco K \u2013 Controle da Produ\u00e7\u00e3o e Estoque</li> <li>Bloco 1 \u2013 Outras Informa\u00e7\u00f5es</li> <li>Bloco 9 \u2013 Controle e encerramento do arquivo digital</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#3-consolidacao-e-validacao","title":"3. Consolida\u00e7\u00e3o e Valida\u00e7\u00e3o","text":"<ul> <li>Contagem de linhas por registro</li> <li>Gera\u00e7\u00e3o dos registros totais (0990, C990, D990, E990, etc.)</li> <li>Montagem final do arquivo texto com delimitador \"|\"</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#documentos-fiscais-bloco-c-e-d","title":"Documentos Fiscais (Bloco C e D)","text":"<ul> <li>Filtragem por modelo (01, 1B, 04, 55, 02, 06, 59, etc.)</li> <li>Tratamento por situa\u00e7\u00e3o do documento (cancelado, regular, etc.)</li> <li>C\u00e1lculo de valores (ICMS, IPI, PIS, COFINS, descontos, frete)</li> <li>Gera\u00e7\u00e3o de registros anal\u00edticos (C170, C190, C590, etc.)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#apuracoes-fiscais-bloco-e","title":"Apura\u00e7\u00f5es Fiscais (Bloco E)","text":"<ul> <li>Busca das apura\u00e7\u00f5es de ICMS (011), ST (012), IPI (013) e DIFAL (014)</li> <li>C\u00e1lculo de d\u00e9bitos, cr\u00e9ditos, ajustes e saldos</li> <li>Gera\u00e7\u00e3o de obriga\u00e7\u00f5es a recolher (E116, E250, E316)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#ciap-bloco-g","title":"CIAP (Bloco G)","text":"<ul> <li>Identifica\u00e7\u00e3o de bens do ativo imobilizado</li> <li>C\u00e1lculo de apropria\u00e7\u00e3o de cr\u00e9ditos de ICMS</li> <li>Movimenta\u00e7\u00f5es (entrada, baixa, aliena\u00e7\u00e3o, etc.)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#inventario-bloco-h","title":"Invent\u00e1rio (Bloco H)","text":"<ul> <li>Gera\u00e7\u00e3o a partir de data de invent\u00e1rio informada</li> <li>Valores unit\u00e1rios, totais e classifica\u00e7\u00e3o (pr\u00f3prio/terceiros)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#controle-de-producao-bloco-k","title":"Controle de Produ\u00e7\u00e3o (Bloco K)","text":"<ul> <li>Registro de produ\u00e7\u00e3o pr\u00f3pria, terceiros, corre\u00e7\u00f5es e invent\u00e1rio</li> <li>Movimenta\u00e7\u00f5es internas entre itens (K220)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#outras-informacoes-bloco-1","title":"Outras Informa\u00e7\u00f5es (Bloco 1)","text":"<ul> <li>Exporta\u00e7\u00e3o (1100, 1105)</li> <li>Valores agregados (1400)</li> <li>Instrumentos de pagamento eletr\u00f4nico (1601)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra a gera\u00e7\u00e3o completa da EFD.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#geraraberturabloco0","title":"<code>gerarAberturaBloco0()</code>","text":"<p>Inicializa os contadores e gera registros de abertura (0000, 0001, 0005, 0015, 0100).</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#gerarblococ","title":"<code>gerarBlocoC()</code>","text":"<p>Processa documentos fiscais de mercadorias (C100, C300, C500, C800) e seus registros filhos.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#gerarblocoe","title":"<code>gerarBlocoE()</code>","text":"<p>Gera apura\u00e7\u00f5es de ICMS, ST, DIFAL e IPI com seus ajustes e obriga\u00e7\u00f5es.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#gerarblocog","title":"<code>gerarBlocoG()</code>","text":"<p>Processa o CIAP com movimenta\u00e7\u00f5es de bens e cr\u00e9ditos apropriados.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#gerarblocoh","title":"<code>gerarBlocoH()</code>","text":"<p>Gera o invent\u00e1rio f\u00edsico com itens e valores.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#gerarblocok","title":"<code>gerarBlocoK()</code>","text":"<p>Controle de produ\u00e7\u00e3o e estoque com registros de movimenta\u00e7\u00f5es e corre\u00e7\u00f5es.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#gerarfechamentobloco0","title":"<code>gerarFechamentoBloco0()</code>","text":"<p>Completa o bloco 0 com registros cadastrais (0150, 0190, 0200, 0300, 0400, 0450, etc.).</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#gerarbloco9","title":"<code>gerarBloco9()</code>","text":"<p>Gera o bloco 9 com totais de registros e encerramento do arquivo.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Arquivo de Texto: - Dois arquivos concatenados (<code>txt1</code> e <code>txt2</code>) - Formato delimitado por \"|\" - Codifica\u00e7\u00e3o UTF-8 - Linhas no padr\u00e3o EFD: <code>REG|CAMPO1|CAMPO2|...|CAMPON</code></p> <p>Blocos Gerados: - 0, B, C, D, E, G, H, K, 1, 9</p> <p>Sa\u00edda no Par\u00e2metro: <code>dadosArquivo</code></p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> \u2013 Criteria e consultas ao banco - <code>multitec.utils</code> \u2013 Utilit\u00e1rios de data, texto e valida\u00e7\u00e3o - <code>sam.model</code> \u2013 Entidades do sistema - <code>java.time</code> \u2013 Manipula\u00e7\u00e3o de datas - <code>java.math</code> \u2013 C\u00e1lculos com BigDecimal</p> <p>M\u00f3dulos: Sistema Fiscal SAM</p>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#tratamento-de-perfis-a-b-c","title":"Tratamento de Perfis (A, B, C)","text":"<ul> <li>Perfil A: Completo, todas as opera\u00e7\u00f5es</li> <li>Perfil B: Limitado, algumas opera\u00e7\u00f5es de sa\u00edda</li> <li>Perfil C: Simplificado, apenas entradas e sa\u00eddas essenciais</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#campos-json","title":"Campos JSON","text":"<ul> <li>Valores fiscais armazenados em campos JSON nas tabelas (<code>eaa01json</code>, <code>eaa0103json</code>, <code>edb01json</code>, etc.)</li> <li>Acesso via <code>jGet(campo)::numeric</code></li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#controle-de-paginacao","title":"Controle de Pagina\u00e7\u00e3o","text":"<ul> <li>Consultas paginadas para documentos fiscais (evita estouro de mem\u00f3ria)</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Empresa com munic\u00edpio e informa\u00e7\u00f5es fiscais</li> <li>Documentos com entidade e situa\u00e7\u00e3o definida</li> <li>Apura\u00e7\u00f5es obrigat\u00f3rias conforme perfil</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_Leiaute19_2025_ICMS_IPI/#performance","title":"Performance","text":"<ul> <li>Uso de <code>Set</code> e <code>Map</code> para evitar duplicidades (ex: 0150, 0200, 0300)</li> <li>Consultas otimizadas com filtros por per\u00edodo e empresa</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 08:20 Autor: Bruno Tipo: F\u00f3rmula EFD-ICMS/IPI Vers\u00e3o: Leiaute 19/2025 Sistema: SAM</p>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/","title":"SGT_PER_DCOMP \u2013 Exporta\u00e7\u00e3o de Dados de Apura\u00e7\u00e3o de IPI","text":""},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para exporta\u00e7\u00e3o de dados de IPI (Imposto sobre Produtos Industrializados) conforme layout exigido pela Secretaria da Receita Federal (SRF). Gera registros R11, R12, R13 e R21 para fins de apura\u00e7\u00e3o e escritura\u00e7\u00e3o fiscal.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Exportar dados de IPI de entradas, sa\u00eddas, notas fiscais e livro de apura\u00e7\u00e3o em formato textual padronizado para integra\u00e7\u00e3o com sistemas fiscais externos.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Auditoria Fiscal</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> \u2013 Documentos fiscais - <code>Eaa0102</code> \u2013 Dados complementares do documento - <code>Eaa0103</code> \u2013 Itens do documento fiscal - <code>Abb01</code> \u2013 Documentos centralizadores - <code>Aaj15</code> \u2013 CFOP (C\u00f3digo Fiscal de Opera\u00e7\u00f5es e Presta\u00e7\u00f5es) - <code>Aac10</code> \u2013 Empresa - <code>Edb01</code> \u2013 Per\u00edodo de apura\u00e7\u00e3o - <code>Aac1001</code> \u2013 Grupo centralizador por empresa/tabela - <code>Aag02</code> / <code>Aag0201</code> \u2013 UF/Munic\u00edpio</p>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o whereTipo ClientCriterion N\u00e3o Crit\u00e9rio de filtro por tipo de documento whereData ClientCriterion Sim Intervalo de datas (inicial e final) whereEnt ClientCriterion N\u00e3o Crit\u00e9rio por entidade (cliente/fornecedor) whereNum ClientCriterion N\u00e3o Crit\u00e9rio por n\u00famero do documento"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o e parse das datas inicial e final</li> <li>Obten\u00e7\u00e3o da empresa ativa e matriz (se houver)</li> <li>Inicializa\u00e7\u00e3o do arquivo de texto de sa\u00edda</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#2-geracao-do-registro-r11-apuracao-do-ipi-entradas","title":"2. Gera\u00e7\u00e3o do Registro R11 \u2013 Apura\u00e7\u00e3o do IPI (Entradas)","text":"<ul> <li>Busca dados de entradas (movimento = 0)</li> <li>Filtra CFOP 1604 (isento de registro)</li> <li>Formata e imprime linhas no formato R11</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#3-geracao-do-registro-r12-apuracao-do-ipi-saidas","title":"3. Gera\u00e7\u00e3o do Registro R12 \u2013 Apura\u00e7\u00e3o do IPI (Sa\u00eddas)","text":"<ul> <li>Busca dados de sa\u00eddas (movimento = 1)</li> <li>Formata e imprime linhas no formato R12</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#4-geracao-do-registro-r13-notas-fiscais-de-entradaaquisicao","title":"4. Gera\u00e7\u00e3o do Registro R13 \u2013 Notas Fiscais de Entrada/Aquisi\u00e7\u00e3o","text":"<ul> <li>Busca documentos de entrada com IPI &gt; 0</li> <li>Obt\u00e9m CFOP do primeiro item</li> <li>Ignora CFOP 1604</li> <li>Formata e imprime linhas no formato R13</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#5-geracao-do-registro-r21-livro-de-apuracao-do-ipi","title":"5. Gera\u00e7\u00e3o do Registro R21 \u2013 Livro de Apura\u00e7\u00e3o do IPI","text":"<ul> <li>Busca grupo centralizador \u201cEE\u201d</li> <li>Obt\u00e9m per\u00edodo de apura\u00e7\u00e3o (Edb01)</li> <li>Calcula cr\u00e9ditos e d\u00e9bitos nacionais e do exterior</li> <li>Aplica estornos e outros valores do JSON</li> <li>Define situa\u00e7\u00e3o da apura\u00e7\u00e3o (1 = sem movimento, 2 = com movimento)</li> <li>Formata e imprime linha no formato R21</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#6-finalizacao","title":"6. Finaliza\u00e7\u00e3o","text":"<ul> <li>Arquivo de texto \u00e9 retornado no par\u00e2metro <code>dadosArquivo</code></li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#filtros-de-movimentacao","title":"Filtros de Movimenta\u00e7\u00e3o","text":"<ul> <li>Movimento 0: Entradas</li> <li>Movimento 1: Sa\u00eddas</li> <li>Movimento 3: Notas fiscais de entrada com IPI</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#cfop","title":"CFOP","text":"<ul> <li>CFOP 1604 \u00e9 ignorado nos registros R11 e R13</li> <li>CFOPs iniciados com 1, 2, 3 s\u00e3o considerados entradas</li> <li>CFOPs iniciados com 5, 6, 7 s\u00e3o considerados sa\u00eddas</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#calculos-financeiros","title":"C\u00e1lculos Financeiros","text":"<ul> <li>Valores monet\u00e1rios s\u00e3o multiplicados por 100 (convers\u00e3o para inteiro)</li> <li>Campos JSON (<code>ipi_ipi</code>, <code>ipi_bc</code>, <code>ipi_isento</code>, <code>ipi_outras</code>) s\u00e3o somados por CFOP</li> <li>Cr\u00e9ditos e d\u00e9bitos s\u00e3o calculados separadamente para opera\u00e7\u00f5es nacionais e do exterior</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Apenas documentos n\u00e3o cancelados s\u00e3o considerados</li> <li>A data do documento \u00e9 usada conforme o tipo de movimento (entrada/sa\u00edda)</li> <li>Munic\u00edpio com UF = \u201cEX\u201d indica opera\u00e7\u00e3o com exterior</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra toda a gera\u00e7\u00e3o do arquivo.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#buscardadosclientcriterion-wheretipo-clientcriterion-wheredata-clientcriterion-wherenum-clientcriterion-whereent-integer-mov","title":"<code>buscarDados(ClientCriterion whereTipo, ClientCriterion whereData, ClientCriterion whereNum, ClientCriterion whereEnt, Integer mov)</code>","text":"<p>Busca dados agregados de IPI por CFOP conforme o movimento.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#buscardocumentosclientcriterion-wheretipo-clientcriterion-wheredata-clientcriterion-wherenum-clientcriterion-whereent-integer-mov","title":"<code>buscarDocumentos(ClientCriterion whereTipo, ClientCriterion whereData, ClientCriterion whereNum, ClientCriterion whereEnt, Integer mov)</code>","text":"<p>Busca documentos fiscais completos para o registro R13.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#buscarcfopitemdocumentolong-eaa01id","title":"<code>buscarCfopItemDocumento(Long eaa01id)</code>","text":"<p>Retorna o CFOP do primeiro item de um documento.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#buscargrupocentralizadorporempresatabelalong-aac10id-string-tabela","title":"<code>buscarGrupoCentralizadorPorEmpresaTabela(Long aac10id, String tabela)</code>","text":"<p>Busca ID do grupo centralizador pela tabela (ex: \u201cEE\u201d).</p>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#buscarapuracaoporperiodolong-edb01tipo-integer-edb01ano-integer-edb01mes","title":"<code>buscarApuracaoPorPeriodo(Long edb01tipo, Integer edb01ano, Integer edb01mes)</code>","text":"<p>Busca per\u00edodo de apura\u00e7\u00e3o pelo tipo, ano e m\u00eas.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#buscarsomadeboucredipilocaldate-dataini-localdate-datafin-boolean-isentrada","title":"<code>buscarSomaDebOuCredIPI(LocalDate dataIni, LocalDate dataFin, Boolean isEntrada)</code>","text":"<p>Soma valores de IPI para entradas ou sa\u00eddas no per\u00edodo.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#buscarsomadeboucredipiexteriorlocaldate-dataini-localdate-datafin-boolean-isentrada","title":"<code>buscarSomaDebOuCredIPIExterior(LocalDate dataIni, LocalDate dataFin, Boolean isEntrada)</code>","text":"<p>Soma valores de IPI para opera\u00e7\u00f5es com o exterior.</p>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Arquivo de Texto (TextFile): - Linhas no formato fixo, com campos alinhados e preenchidos - Registros R11, R12, R13 e R21 - Retornado no par\u00e2metro <code>dadosArquivo</code></p>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> \u2013 Criteria e consultas ao banco - <code>multitec.utils</code> \u2013 Utilit\u00e1rios de texto, data e arquivo - <code>sam.dicdados</code> \u2013 Tipos de f\u00f3rmula - <code>sam.model</code> \u2013 Entidades do sistema - <code>java.time</code> \u2013 Manipula\u00e7\u00e3o de datas</p> <p>M\u00f3dulo: SGT (Sistema de Gest\u00e3o Tribut\u00e1ria)</p>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#formato-de-datas","title":"Formato de Datas","text":"<ul> <li>Entrada: <code>yyyyMMdd</code></li> <li>Sa\u00edda: <code>ddMMyyyy</code></li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#campos-monetarios","title":"Campos Monet\u00e1rios","text":"<ul> <li>Convertidos para inteiro (\u00d7100) no arquivo de sa\u00edda</li> <li>Valores nulos s\u00e3o tratados como zero</li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#consultas-sql","title":"Consultas SQL","text":"<ul> <li>Uso de <code>jGet()</code> para extrair valores JSON</li> <li>Jun\u00e7\u00f5es complexas com m\u00faltiplas tabelas</li> <li>Filtros din\u00e2micos via <code>ClientCriterion</code></li> </ul>"},{"location":"LINHASITA/formulas/sgt/SGT_PER_DCOMP/#tratamento-de-exterior","title":"Tratamento de Exterior","text":"<ul> <li>Opera\u00e7\u00f5es com UF = \u201cEX\u201d s\u00e3o consideradas exterior</li> <li>Valores de exterior s\u00e3o subtra\u00eddos dos totais nacionais</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 08:20 Autor: Bruno Tipo: F\u00f3rmula de Exporta\u00e7\u00e3o Fiscal Vers\u00e3o: 1.0  </p>"},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/","title":"SCC Documentos de Comiss\u00f5es","text":""},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio de comiss\u00f5es para representantes com vers\u00f5es anal\u00edtica e sint\u00e9tica, permitindo acompanhamento detalhado ou consolidado dos valores a pagar.</p>"},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Controlar e analisar as comiss\u00f5es de representantes, oferecendo vis\u00e3o detalhada por documento ou vis\u00e3o consolidada por representante, com flexibilidade de filtros por datas e status de c\u00e1lculo.</p>"},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Comercial</li> <li>Controladoria</li> <li>Gest\u00e3o de Representantes</li> <li>Departamento Financeiro</li> </ul>"},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>DCB01</code> - Base de c\u00e1lculo de comiss\u00f5es - <code>ABB01</code> - Documentos de comiss\u00f5es - <code>ABE01</code> - Representantes e entidades - <code>AAH01</code> - Tipos de documento - <code>DAA01</code> - Documentos a receber - <code>DCD01</code> - C\u00e1lculos de comiss\u00f5es</p> <p>Entidades Envolvidas: - <code>Dcb01</code> - C\u00e1lculo de comiss\u00f5es - <code>Abe01</code> - Representantes e clientes - <code>Abb01</code> - Documentos - <code>Aac10</code> - Empresa</p>"},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis layout Integer Sim Tipo de relat\u00f3rio 0=Anal\u00edtico, 1=Sint\u00e9tico dataCalculo Integer Sim Status do c\u00e1lculo 0=N\u00e3o calculado, 1=Calculado, 2=Todos numeroInicial Integer N\u00e3o N\u00famero documento inicial \u2265 0 numeroFinal Integer N\u00e3o N\u00famero documento final \u2265 0 representantes List N\u00e3o Representantes espec\u00edficos IDs representantes emissao LocalDate[] N\u00e3o Per\u00edodo de emiss\u00e3o Data inicial e final dataCredito LocalDate[] N\u00e3o Per\u00edodo de cr\u00e9dito Data inicial e final imprimir Integer Sim Formato de sa\u00edda 0=PDF, 1=XLSX"},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#campos-do-relatorio","title":"\ud83d\udccb Campos do Relat\u00f3rio","text":""},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#layout-analitico","title":"Layout Anal\u00edtico","text":"Campo Descri\u00e7\u00e3o Tipo repCod C\u00f3digo representante String repNome Nome representante String abb01num N\u00famero documento Integer abb01parcela Parcela documento String entCod C\u00f3digo cliente String entNa Nome reduzido cliente String abb01data Data emiss\u00e3o Date dcb01dtCredito Data cr\u00e9dito Date abb01valor Valor documento BigDecimal dcb01bc Base c\u00e1lculo comiss\u00e3o BigDecimal dcb01taxa Taxa comiss\u00e3o BigDecimal dcb01valor Valor comiss\u00e3o BigDecimal"},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#layout-sintetico","title":"Layout Sint\u00e9tico","text":"Campo Descri\u00e7\u00e3o Tipo repCod C\u00f3digo representante String repNome Nome representante String abb01valor Soma valores documentos BigDecimal dcb01bc Soma base c\u00e1lculo BigDecimal dcb01valor Soma valores comiss\u00e3o BigDecimal"},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o de Par\u00e2metros</li> <li>Define layout (anal\u00edtico/sint\u00e9tico)</li> <li>Processa filtros de datas (emiss\u00e3o/cr\u00e9dito)</li> <li> <p>Valida status de c\u00e1lculo</p> </li> <li> <p>Sele\u00e7\u00e3o de Consulta</p> </li> <li>Anal\u00edtico: Detalhamento por documento</li> <li>Sint\u00e9tico: Consolida\u00e7\u00e3o por representante</li> <li> <p>Aplica filtros comuns a ambos</p> </li> <li> <p>Constru\u00e7\u00e3o da Consulta</p> </li> <li>Monta SQL com joins espec\u00edficos</li> <li>Aplica filtros din\u00e2micos</li> <li> <p>Define ordena\u00e7\u00e3o conforme layout</p> </li> <li> <p>Processamento de Dados</p> </li> <li>Busca dados do banco</li> <li>Calcula totais (sint\u00e9tico)</li> <li> <p>Formata informa\u00e7\u00f5es</p> </li> <li> <p>Gera\u00e7\u00e3o de Sa\u00edda</p> </li> <li>Seleciona template conforme layout</li> <li>Exporta para PDF ou XLSX</li> <li>Formata cabe\u00e7alho com per\u00edodo</li> </ol>"},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#filtros-de-data","title":"Filtros de Data","text":"<ul> <li>Emiss\u00e3o: Data do documento original</li> <li>Cr\u00e9dito: Data de cr\u00e9dito da comiss\u00e3o</li> <li>Per\u00edodo exibido no cabe\u00e7alho conforme filtro aplicado</li> </ul>"},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#status-de-calculo","title":"Status de C\u00e1lculo","text":"<ul> <li>N\u00e3o calculado: <code>centralCalc.abb01data is null</code></li> <li>Calculado: <code>centralCalc.abb01data is not null</code></li> <li>Todos: Sem filtro de c\u00e1lculo</li> </ul>"},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Apenas endere\u00e7os principais (<code>abe0101principal = 1</code>)</li> <li>Relacionamento com documentos a receber (<code>abb0101tabela = 'Daa01'</code>)</li> <li>Aplica filtros padr\u00e3o do sistema (<code>obterWherePadrao</code>)</li> </ul>"},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Layout Formato Template M\u00e9todo Anal\u00edtico PDF <code>SCC_DocumentosComissoes_Analitico</code> <code>gerarPDF()</code> Anal\u00edtico XLSX <code>SCC_DocumentosComissoes_Analitico</code> <code>gerarXLSX()</code> Sint\u00e9tico PDF <code>SCC_DocumentosComissoes_Sintetico</code> <code>gerarPDF()</code> Sint\u00e9tico XLSX <code>SCC_DocumentosComissoes_Sintetico</code> <code>gerarXLSX()</code>"},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multitec.utils</code> - Utilit\u00e1rios e datas - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios</p> <p>Configura\u00e7\u00f5es: - Templates Jasper para layouts anal\u00edtico e sint\u00e9tico - Filtros padr\u00e3o do sistema para entidade <code>DCB01</code></p>"},{"location":"LINHASITA/relatorio/scc/SCC_Documentos_de_Comiss%C3%B5es/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>SQL din\u00e2mico com m\u00faltiplos joins para relacionamentos</li> <li>Dois templates distintos para anal\u00edtico/sint\u00e9tico</li> <li>Flexibilidade de filtros por datas diferentes</li> <li>Ordena\u00e7\u00e3o espec\u00edfica por layout</li> <li>Suporte a m\u00faltiplos representantes</li> <li>Controle de status de c\u00e1lculo das comiss\u00f5es</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/","title":"SCF_BoletoBancoBrasil - Gera\u00e7\u00e3o e Envio de Boletos Banco do Brasil","text":""},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema completo de gera\u00e7\u00e3o, impress\u00e3o e envio por email de boletos banc\u00e1rios do Banco do Brasil, seguindo o layout CNAB 400 com c\u00e1lculo autom\u00e1tico de c\u00f3digo de barras, linha digit\u00e1vel e valida\u00e7\u00f5es fiscais.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar todo o processo de cobran\u00e7a banc\u00e1ria, desde a gera\u00e7\u00e3o do boleto at\u00e9 o envio por email, garantindo conformidade com as regras do Banco do Brasil e proporcionando efici\u00eancia operacional para o departamento financeiro.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Financeiro</li> <li>Tesouraria</li> <li>Cobran\u00e7a</li> <li>Faturamento</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o movimento Integer N\u00e3o Movimento espec\u00edfico dataProc LocalDate Sim Data de processamento carteira String N\u00e3o Carteira banc\u00e1ria aceite String N\u00e3o Aceite do t\u00edtulo instrucao1/2/3 String N\u00e3o Instru\u00e7\u00f5es do boleto numeroInicial/Final Integer N\u00e3o Range de n\u00fameros entidades List N\u00e3o Entidades espec\u00edficas dataVenc LocalDate[] N\u00e3o Per\u00edodo de vencimento eaa01id Long N\u00e3o ID documento SRF daa01id Long N\u00e3o ID documento SCF enviaBoletoPorEmail Boolean N\u00e3o Envio autom\u00e1tico"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#estrutura-do-boleto","title":"\ud83d\udccb Estrutura do Boleto","text":""},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#dados-do-cedente-empresa","title":"Dados do Cedente (Empresa):","text":"<ul> <li>Raz\u00e3o social, endere\u00e7o, CNPJ</li> <li>Ag\u00eancia, conta, d\u00edgitos</li> <li>C\u00f3digo do conv\u00eanio</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#dados-do-sacado-cliente","title":"Dados do Sacado (Cliente):","text":"<ul> <li>Nome, CNPJ/CPF, endere\u00e7o</li> <li>Munic\u00edpio, UF, CEP</li> <li>Email para envio</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#dados-do-titulo","title":"Dados do T\u00edtulo:","text":"<ul> <li>Nosso n\u00famero, n\u00famero documento</li> <li>Data vencimento, valor</li> <li>Parcela, juros</li> <li>C\u00f3digo de barras, linha digit\u00e1vel</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#1-validacao-e-filtragem","title":"1. Valida\u00e7\u00e3o e Filtragem","text":"<ul> <li>Processa m\u00faltiplas origens de dados (SRF, SCF, filtros)</li> <li>Aplica filtros por carteira, aceite, movimento</li> <li>Valida exist\u00eancia do banco e dados obrigat\u00f3rios</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#2-calculo-de-componentes-do-boleto","title":"2. C\u00e1lculo de Componentes do Boleto","text":"<ul> <li>Fator vencimento: Dias desde 07/10/1997</li> <li>Campo livre: Conforme regras BB</li> <li>C\u00f3digo de barras: Com d\u00edgito verificador</li> <li>Linha digit\u00e1vel: Formatada para impress\u00e3o</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#3-geracao-do-pdf","title":"3. Gera\u00e7\u00e3o do PDF","text":"<ul> <li>Monta dados para template JasperReports</li> <li>Aplica logo do Banco do Brasil</li> <li>Formata instru\u00e7\u00f5es e dados</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#4-envio-por-email-opcional","title":"4. Envio por Email (Opcional)","text":"<ul> <li>Agrupa boletos por documento origem</li> <li>Busca emails do cliente</li> <li>Envia em thread separada</li> <li>Atualiza status de impress\u00e3o</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#validacoes-de-dados","title":"Valida\u00e7\u00f5es de Dados:","text":"<ul> <li>Banco deve existir (abf01id obrigat\u00f3rio)</li> <li>Documento n\u00e3o pode estar pago (daa01dtPgto null)</li> <li>Endere\u00e7o de cobran\u00e7a obrigat\u00f3rio (abe0101cobranca = 1)</li> <li>Email destino obrigat\u00f3rio para envio</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#calculos-bancarios","title":"C\u00e1lculos Banc\u00e1rios:","text":"<ul> <li>Fator Vencimento: Base 07/10/1997, ajuste para &gt;9999 dias</li> <li>M\u00f3dulo 11: D\u00edgito verificador c\u00f3digo barras</li> <li>M\u00f3dulo 10: D\u00edgitos verificadores linha digit\u00e1vel</li> <li>Valor: Multiplicado por 100 (sem decimais)</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#layout-banco-do-brasil","title":"Layout Banco do Brasil:","text":"<ul> <li>C\u00f3digo banco: 001</li> <li>Moeda: 9 (Real)</li> <li>Campo livre: 6 zeros + 17 nosso n\u00famero + 2 carteira</li> <li>Formata\u00e7\u00e3o espec\u00edfica linha digit\u00e1vel</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#envio-de-email","title":"Envio de Email:","text":"<ul> <li>Agrupamento por documento origem</li> <li>Anexo PDF \u00fanico por grupo</li> <li>C\u00f3pia para boleto@linhasita.com.br</li> <li>Assinatura do usu\u00e1rio logado</li> <li>Thread separada para n\u00e3o bloquear interface</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#saidas-geradas","title":"\ud83c\udfa8 Sa\u00eddas Geradas","text":"Tipo Formato Descri\u00e7\u00e3o PDF Boleto banc\u00e1rio Layout padr\u00e3o BB Email HTML + Anexo Com instru\u00e7\u00f5es e contatos Banco Atualiza\u00e7\u00e3o status daa01imprDoc = 1"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":""},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#bibliotecas","title":"Bibliotecas:","text":"<ul> <li><code>Apache JasperReports</code> - Gera\u00e7\u00e3o PDF</li> <li><code>JavaMail</code> - Envio de emails</li> <li><code>MultiORM</code> - Acesso a dados</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#servicos","title":"Servi\u00e7os:","text":"<ul> <li><code>SCFService</code> - Servi\u00e7os financeiros</li> <li><code>FileSystem</code> - Manipula\u00e7\u00e3o de arquivos</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#entidades","title":"Entidades:","text":"<ul> <li><code>Daa01</code> - Documentos financeiros</li> <li><code>Abe01</code> - Entidades (clientes)</li> <li><code>Abf01</code> - Bancos</li> <li><code>Aac10</code> - Empresas</li> <li><code>Aab10</code> - Usu\u00e1rios</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#performance","title":"Performance:","text":"<ul> <li>Processamento em lote para m\u00faltiplos boletos</li> <li>Thread separada para envio de emails</li> <li>Consultas otimizadas com filtros no banco</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#seguranca","title":"Seguran\u00e7a:","text":"<ul> <li>Valida\u00e7\u00e3o de dados antes do processamento</li> <li>Verifica\u00e7\u00e3o de emails v\u00e1lidos</li> <li>Preven\u00e7\u00e3o de duplo processamento</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#tratamento-de-erros","title":"Tratamento de Erros:","text":"<ul> <li>Valida\u00e7\u00e3o de bancos suportados (apenas BB)</li> <li>Prote\u00e7\u00e3o contra divis\u00e3o por zero</li> <li>Tratamento de campos nulos</li> <li>Log de inconsist\u00eancias</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#customizacoes","title":"Customiza\u00e7\u00f5es:","text":"<ul> <li>Logo espec\u00edfica do Banco do Brasil</li> <li>Instru\u00e7\u00f5es personaliz\u00e1veis</li> <li>Texto de email configur\u00e1vel</li> <li>Assinatura digital do usu\u00e1rio</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_BoletoBancoBrasil/#limitacoes","title":"Limita\u00e7\u00f5es:","text":"<ul> <li>Suporte apenas ao Banco do Brasil (001)</li> <li>Formato CNAB 400 espec\u00edfico</li> <li>Estrutura fixa de campo livre</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/","title":"SCF - Boleto Banco do Brasil (Linhasita)","text":""},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio para gera\u00e7\u00e3o e envio de boletos banc\u00e1rios do Banco do Brasil, incluindo c\u00e1lculo de c\u00f3digo de barras, linha digit\u00e1vel, e funcionalidade de envio por email com personaliza\u00e7\u00e3o para a empresa Linhasita.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar a gera\u00e7\u00e3o de boletos banc\u00e1rios do Banco do Brasil, calcular c\u00f3digos de barras e linhas digit\u00e1veis corretamente, e fornecer op\u00e7\u00e3o de envio autom\u00e1tico por email aos clientes.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Financeiro/Contas a Receber</li> <li>Cobran\u00e7a</li> <li>Faturamento</li> <li>Administrativo</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Daa01</code> - Documentos financeiros - <code>Abb01</code> - Central de documento - <code>Abe01</code> - Entidades (clientes) - <code>Abe0101</code> - Endere\u00e7os da entidade - <code>Abe0104</code> - Emails da entidade - <code>AbF01</code> - Bancos - <code>Aah01</code> - Tipos de documento - <code>Aac10</code> - Empresas - <code>Aag02</code> - Estados (UF) - <code>Aag0201</code> - Munic\u00edpios - <code>Abb0102</code> - Relacionamento de documentos - <code>Aab10</code> - Usu\u00e1rios do sistema - <code>Aab1008</code> - Configura\u00e7\u00f5es de email do usu\u00e1rio</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valor Padr\u00e3o movimento Integer N\u00e3o Tipo de movimento financeiro - dataProc LocalDate Sim Data de processamento Data atual carteira String N\u00e3o Carteira do banco - aceite String N\u00e3o Aceite do t\u00edtulo - instrucao1 String N\u00e3o Instru\u00e7\u00e3o banc\u00e1ria 1 - instrucao2 String N\u00e3o Instru\u00e7\u00e3o banc\u00e1ria 2 - instrucao3 String N\u00e3o Instru\u00e7\u00e3o banc\u00e1ria 3 - numeroInicial Integer Sim N\u00famero inicial do documento 000000000 numeroFinal Integer Sim N\u00famero final do documento 999999999 entidade List N\u00e3o IDs das entidades - dataVenc LocalDate[] N\u00e3o Per\u00edodo de vencimento - eaa01id Long N\u00e3o ID do documento fiscal (SRF) - idDoc Long N\u00e3o ID do documento financeiro - abe01id Long N\u00e3o ID da entidade (filtro SCF0101) - aah01id Long N\u00e3o ID do tipo de documento - parcela String N\u00e3o N\u00famero da parcela - idsDocs List N\u00e3o IDs dos documentos (filtro SCF1001) - enviaBoletoPorEmail Boolean Sim Enviar boleto por email false"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Defini\u00e7\u00e3o dos valores padr\u00e3o dos filtros</li> <li>Carregamento dos par\u00e2metros fornecidos pelo usu\u00e1rio</li> <li>Configura\u00e7\u00e3o do logo do Banco do Brasil</li> <li>Prepara\u00e7\u00e3o dos par\u00e2metros do relat\u00f3rio</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#2-identificacao-dos-documentos","title":"2. Identifica\u00e7\u00e3o dos Documentos","text":"<ul> <li>Via ID \u00fanico: Quando fornecido <code>daa01id</code> ou <code>eaa01id</code></li> <li>Via filtros m\u00faltiplos: Quando usados filtros de carteira, aceite, movimento, etc.</li> <li>Via lista de IDs: Quando fornecida lista <code>idsDocs</code> do SCF1001</li> <li>Valida\u00e7\u00e3o de documentos pendentes e com nosso n\u00famero</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#3-busca-de-dados-dos-boletos","title":"3. Busca de Dados dos Boletos","text":"<ul> <li>Consulta ao banco com m\u00faltiplos joins para obter todos os dados necess\u00e1rios</li> <li>Filtragem por banco do Brasil (n\u00famero 001)</li> <li>Inclus\u00e3o de dados da empresa, entidade, endere\u00e7os e configura\u00e7\u00f5es banc\u00e1rias</li> <li>Aplica\u00e7\u00e3o de filtros de seguran\u00e7a (where padr\u00e3o)</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#4-calculo-dos-codigos-do-boleto","title":"4. C\u00e1lculo dos C\u00f3digos do Boleto","text":"<ul> <li>Fator de vencimento: C\u00e1lculo baseado na data base 07/10/1997</li> <li>Campo livre: Constru\u00e7\u00e3o conforme especifica\u00e7\u00e3o do Banco do Brasil</li> <li>C\u00f3digo de barras: C\u00e1lculo com m\u00f3dulo 11 e d\u00edgito verificador</li> <li>Linha digit\u00e1vel: Formata\u00e7\u00e3o com pontos e espa\u00e7os padr\u00e3o</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#5-processamento-por-documento","title":"5. Processamento por Documento","text":"<ul> <li>Para cada documento encontrado:</li> <li>Extra\u00e7\u00e3o de dados da entidade (nome, endere\u00e7o, CNPJ/CPF)</li> <li>Obten\u00e7\u00e3o de dados banc\u00e1rios (ag\u00eancia, conta, conv\u00eanio)</li> <li>C\u00e1lculo dos c\u00f3digos do boleto</li> <li>Montagem do TableMap com todos os dados</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#6-envio-por-email-opcional","title":"6. Envio por Email (Opcional)","text":"<ul> <li>Agrupamento de boletos por documento de origem</li> <li>Gera\u00e7\u00e3o de PDF individual por grupo</li> <li>Busca de emails do cliente para envio</li> <li>Configura\u00e7\u00e3o do email com anexo, corpo personalizado e assinatura</li> <li>Envio ass\u00edncrono em thread separada</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#7-atualizacao-de-status","title":"7. Atualiza\u00e7\u00e3o de Status","text":"<ul> <li>Marca\u00e7\u00e3o dos documentos como impressos (<code>daa01imprDoc = 1</code>)</li> <li>Persist\u00eancia no banco de dados</li> <li>Tratamento de erros para evitar falhas no processo principal</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#8-geracao-do-relatorio","title":"8. Gera\u00e7\u00e3o do Relat\u00f3rio","text":"<ul> <li>Gera\u00e7\u00e3o do PDF final com todos os boletos</li> <li>Formata\u00e7\u00e3o conforme template JasperReports</li> <li>Retorno do arquivo para download</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#filtros-de-documentos","title":"Filtros de Documentos","text":"<ul> <li>Apenas documentos do Banco do Brasil (n\u00famero 001)</li> <li>Documentos n\u00e3o pagos (<code>daa01dtPgto is null</code>)</li> <li>Com nosso n\u00famero preenchido (<code>daa01nossonum is not null</code>)</li> <li>Endere\u00e7o de cobran\u00e7a da entidade (<code>abe0101cobranca = 1</code>)</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#calculo-do-boleto-banco-do-brasil","title":"C\u00e1lculo do Boleto (Banco do Brasil)","text":"<ul> <li>Fator de vencimento: Dias desde 07/10/1997, com ajuste para &gt;9999</li> <li>Campo livre: 6 zeros + 17 d\u00edgitos do nosso n\u00famero + 2 d\u00edgitos da carteira</li> <li>C\u00f3digo de barras: 3 bancos + 9 + 4 fator + 10 valor + campo livre, com DV m\u00f3dulo 11</li> <li>Linha digit\u00e1vel: Formato grupos de 5 com pontos e espa\u00e7os</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#validacoes-de-dados","title":"Valida\u00e7\u00f5es de Dados","text":"<ul> <li>Banco deve existir e ter configura\u00e7\u00e3o JSON</li> <li>Conv\u00eanio deve estar configurado no JSON do banco</li> <li>Entidade deve ter endere\u00e7o de cobran\u00e7a</li> <li>Email do usu\u00e1rio logado deve estar configurado para envio</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#envio-por-email","title":"Envio por Email","text":"<ul> <li>Agrupamento por documento de origem (nota fiscal)</li> <li>Corpo do email personalizado com dados da empresa Linhasita</li> <li>Anexo \u00fanico PDF com todos os boletos do grupo</li> <li>CC autom\u00e1tico para <code>boleto@linhasita.com.br</code></li> <li>Assinatura do usu\u00e1rio (arquivo ou texto)</li> <li>Envio ass\u00edncrono para n\u00e3o bloquear interface</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#formatacao-de-campos","title":"Formata\u00e7\u00e3o de Campos","text":"<ul> <li>Nosso n\u00famero: 10 d\u00edgitos com zeros \u00e0 esquerda</li> <li>Valores: Multiplicados por 100 para centavos</li> <li>CNPJ/CPF: Apenas n\u00fameros</li> <li>Datas: Formato dd/MM/yyyy</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de gera\u00e7\u00e3o de boletos.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#buscardadosboleto","title":"<code>buscarDadosBoleto()</code>","text":"<p>Busca documentos financeiros com base em m\u00faltiplos filtros.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#buscaridsdocsscfpeloiddocsrf","title":"<code>buscarIdsDocsSCFPeloIdDocSRF()</code>","text":"<p>Relaciona documentos financeiros com documentos fiscais.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#montarcodigobarras","title":"<code>montarCodigoBarras()</code>","text":"<p>Calcula o c\u00f3digo de barras do boleto conforme especifica\u00e7\u00e3o do Banco do Brasil.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#montarlinhadigitavel","title":"<code>montarLinhaDigitavel()</code>","text":"<p>Formata a linha digit\u00e1vel do boleto.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#enviarboletosporemail","title":"<code>enviarBoletosPorEmail()</code>","text":"<p>Gerencia o processo de agrupamento e envio de boletos por email.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#enviarboletoporemail","title":"<code>enviarBoletoPorEmail()</code>","text":"<p>Configura e prepara um email individual com anexo PDF.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#calculos-bancarios","title":"\ud83d\udd27 C\u00e1lculos Banc\u00e1rios","text":""},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#fator-de-vencimento","title":"Fator de Vencimento","text":"<p>fator = data_vencimento - 07/10/1997 (em dias) Se fator &gt; 9999: fator = fator - 10000 + 1000</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#modulo-11-codigo-de-barras","title":"M\u00f3dulo 11 (C\u00f3digo de Barras)","text":"<ul> <li>Pesos de 2 a 9, reiniciando ap\u00f3s 9</li> <li>DV = 11 - (soma % 11)</li> <li>Se DV \u2208 {0,10,11} \u2192 DV = 1</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#modulo-10-linha-digitavel","title":"M\u00f3dulo 10 (Linha Digit\u00e1vel)","text":"<ul> <li>Pesos alternados 2 e 1</li> <li>Soma com decomposi\u00e7\u00e3o de d\u00edgitos (ex: 14 \u2192 1+4)</li> <li>DV = m\u00faltiplo de 10 mais pr\u00f3ximo - soma</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#campo-livre-banco-do-brasil","title":"Campo Livre (Banco do Brasil)","text":""},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#modulo-11-codigo-de-barras_1","title":"M\u00f3dulo 11 (C\u00f3digo de Barras)","text":"<ul> <li>Pesos de 2 a 9, reiniciando ap\u00f3s 9</li> <li>DV = 11 - (soma % 11)</li> <li>Se DV \u2208 {0,10,11} \u2192 DV = 1</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#modulo-10-linha-digitavel_1","title":"M\u00f3dulo 10 (Linha Digit\u00e1vel)","text":"<ul> <li>Pesos alternados 2 e 1</li> <li>Soma com decomposi\u00e7\u00e3o de d\u00edgitos (ex: 14 \u2192 1+4)</li> <li>DV = m\u00faltiplo de 10 mais pr\u00f3ximo - soma</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#campo-livre-banco-do-brasil_1","title":"Campo Livre (Banco do Brasil)","text":""},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#modulo-11-codigo-de-barras_2","title":"M\u00f3dulo 11 (C\u00f3digo de Barras)","text":"<ul> <li>Pesos de 2 a 9, reiniciando ap\u00f3s 9</li> <li>DV = 11 - (soma % 11)</li> <li>Se DV \u2208 {0,10,11} \u2192 DV = 1</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#modulo-10-linha-digitavel_2","title":"M\u00f3dulo 10 (Linha Digit\u00e1vel)","text":"<ul> <li>Pesos alternados 2 e 1</li> <li>Soma com decomposi\u00e7\u00e3o de d\u00edgitos (ex: 14 \u2192 1+4)</li> <li>DV = m\u00faltiplo de 10 mais pr\u00f3ximo - soma</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#campo-livre-banco-do-brasil_2","title":"Campo Livre (Banco do Brasil)","text":"<p>000000 + nosso_numero(17) + carteira(2)</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Dados do Boleto: - Dados da entidade (nome, CNPJ/CPF, endere\u00e7o completo) - Dados da empresa (raz\u00e3o social, endere\u00e7o, CNPJ) - Dados banc\u00e1rios (ag\u00eancia, conta, conv\u00eanio, carteira) - Valores (vencimento, valor, nosso n\u00famero) - C\u00f3digos calculados (barras, linha digit\u00e1vel)</p> <p>Formato de Sa\u00edda: - PDF: Boletos formatados para impress\u00e3o - Email: PDF anexado com corpo personalizado</p> <p>Par\u00e2metros do Relat\u00f3rio: - Data de processamento - Instru\u00e7\u00f5es banc\u00e1rias - Logo do banco - Dados da empresa</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#integracao-com-multiplas-telas","title":"Integra\u00e7\u00e3o com M\u00faltiplas Telas","text":"<ul> <li>SCF0101: Filtros b\u00e1sicos por entidade, tipo, parcela</li> <li>SCF1001: Sele\u00e7\u00e3o m\u00faltipla de documentos via lista de IDs</li> <li>SRF: Relacionamento via <code>eaa01id</code> para documentos fiscais</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#tratamento-de-json","title":"Tratamento de JSON","text":"<ul> <li>Configura\u00e7\u00f5es banc\u00e1rias armazenadas em <code>abf01json</code></li> <li>Dados adicionais do documento em <code>daa01json</code></li> <li>Campos espec\u00edficos: carteira, aceite, conv\u00eanio, juros</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#performance","title":"Performance","text":"<ul> <li>Consultas otimizadas com joins necess\u00e1rios</li> <li>Processamento em lote para m\u00faltiplos documentos</li> <li>Envio de email ass\u00edncrono em thread separada</li> <li>Uso de TableMap para manipula\u00e7\u00e3o eficiente de dados</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#seguranca","title":"Seguran\u00e7a","text":"<ul> <li>Aplica\u00e7\u00e3o de where padr\u00e3o por empresa/usu\u00e1rio</li> <li>Valida\u00e7\u00e3o de permiss\u00f5es atrav\u00e9s da classe base</li> <li>Logs de erro no envio de emails sem interromper processo</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Boleto_Banco_do_Brasil/#personalizacao-empresarial","title":"Personaliza\u00e7\u00e3o Empresarial","text":"<ul> <li>Conte\u00fado do email espec\u00edfico para Linhasita</li> <li>Contatos e informa\u00e7\u00f5es da empresa no corpo do email</li> <li>Logo do Banco do Brasil embutido no relat\u00f3rio</li> <li>CC autom\u00e1tico para email da empresa</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 25/11/2025 \u00e0s 11:11 Autor: Bruno Tipo: Relat\u00f3rio de Boletos Banc\u00e1rios Vers\u00e3o: 1.0</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/","title":"SCF_Documentos.md","text":""},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de relat\u00f3rios para documentos financeiros do SCF (Sistema de Controle Financeiro) da Linhasita, permitindo a gera\u00e7\u00e3o de relat\u00f3rios anal\u00edticos e sint\u00e9ticos de documentos a receber, recebidos, a pagar e pagos.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer relat\u00f3rios financeiros completos e flex\u00edveis para an\u00e1lise de documentos, com diferentes op\u00e7\u00f5es de ordena\u00e7\u00e3o, filtros e formatos de sa\u00edda.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Financeiro</li> <li>Controladoria</li> <li>Cr\u00e9dito e Cobran\u00e7a</li> <li>Diretoria</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - Classe <code>SCF_Documentos</code> - Relat\u00f3rio de documentos financeiros</p> <p>Localiza\u00e7\u00e3o: <code>linhasita/relatorios/scf/</code></p>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>DAA01</code> - Documentos financeiros - <code>ABB01</code> - Documentos fiscais - <code>ABE01</code> - Entidades/Clientes - <code>ABF15</code> - Portadores - <code>ABF16</code> - Opera\u00e7\u00f5es - <code>ABF20</code> - PLF (Plano de Livro Fiscal) - <code>AAC10</code> - Empresas</p> <p>Entidades Envolvidas: - <code>Daa01</code> - Documentos financeiros - <code>Abb01</code> - Documentos fiscais - <code>Abe01</code> - Entidades - <code>Abf15</code> - Portadores - <code>Abf16</code> - Opera\u00e7\u00f5es - <code>Abf20</code> - PLF - <code>Aac10</code> - Empresas</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o ordem Integer Sim Tipo de ordena\u00e7\u00e3o (0-N\u00famero, 1-Vencimento, 2-Entidade, 3-Pagamento, 4-Portador, 5-Representante) classe Integer Sim Tipo de documento (0-\u00c0 Receber, 1-Recebidos, 2-\u00c0 Pagar, 3-Pagos, 4-\u00c0 Receber/Recebidos, 5-\u00c0 Pagar/Pagos) numeroInicial Integer Sim N\u00famero inicial do documento numeroFinal Integer Sim N\u00famero final do documento empresas List N\u00e3o Lista de empresas para filtro entidade List N\u00e3o Lista de entidades para filtro dataVenc LocalDate[] N\u00e3o Per\u00edodo de vencimento dataEmissao LocalDate[] N\u00e3o Per\u00edodo de emiss\u00e3o tipoData Integer N\u00e3o Tipo de data (0-Pagamento, 1-Recebimento) sintetico Boolean N\u00e3o Relat\u00f3rio sint\u00e9tico vencimento Integer N\u00e3o Tipo de vencimento (0-Real, 1-Nominal)"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#saidas-do-processo","title":"\ud83d\udccb Sa\u00eddas do Processo","text":"Campo Descri\u00e7\u00e3o Tipo PDF/XLSX Relat\u00f3rio formatado Arquivo documentos Lista de documentos processados List"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Configura\u00e7\u00e3o Inicial</li> <li>Define valores padr\u00e3o para filtros</li> <li>Obt\u00e9m empresas acess\u00edveis ao usu\u00e1rio</li> <li> <p>Configura t\u00edtulo do relat\u00f3rio baseado na classe selecionada</p> </li> <li> <p>Processamento de Filtros</p> </li> <li>Aplica filtros de data, entidade, documento, etc.</li> <li>Define ordena\u00e7\u00e3o conforme par\u00e2metro</li> <li> <p>Configura condi\u00e7\u00f5es WHERE din\u00e2micas</p> </li> <li> <p>Busca de Documentos</p> </li> <li>Executa consulta SQL com filtros aplicados</li> <li>Processa dados de juros, multa e desconto</li> <li> <p>Calcula dias em atraso</p> </li> <li> <p>Gera\u00e7\u00e3o do Relat\u00f3rio</p> </li> <li>Seleciona template baseado na ordena\u00e7\u00e3o</li> <li>Gera PDF ou XLSX conforme sele\u00e7\u00e3o</li> <li>Retorna arquivo para download</li> </ol>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#filtros-e-ordenacao","title":"Filtros e Ordena\u00e7\u00e3o","text":"<ul> <li>Ordena\u00e7\u00e3o por n\u00famero, vencimento, entidade, pagamento, portador ou representante</li> <li>Filtro por per\u00edodo de emiss\u00e3o, vencimento ou pagamento/recebimento</li> <li>Suporte a documentos \u00e0 receber e a pagar</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#calculos-financeiros","title":"C\u00e1lculos Financeiros","text":"<ul> <li>C\u00e1lculo autom\u00e1tico de juros e multa baseado em JSON do documento</li> <li>C\u00e1lculo de dias em atraso</li> <li>Tratamento de descontos</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#acesso-a-dados","title":"Acesso a Dados","text":"<ul> <li>Restri\u00e7\u00e3o por empresas acess\u00edveis ao usu\u00e1rio</li> <li>Filtro por PLF (Plano de Livro Fiscal)</li> <li>Suporte a documentos transmutados</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#tipos-de-relatorio","title":"\ud83c\udfa8 Tipos de Relat\u00f3rio","text":"Tipo Descri\u00e7\u00e3o Template Anal\u00edtico Detalhado por documento SCF_Documentos Por Entidade Agrupado por entidade SCF_DocumentosEntidade Por Portador Agrupado por portador SCF_DocumentosPortador Por Representante Agrupado por representante SCF_DocumentosRepresentante Sint\u00e9tico Resumido SCF_DocumentosSintetico2"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Persist\u00eancia e consultas - <code>multitec.utils</code> - Utilit\u00e1rios e cole\u00e7\u00f5es - <code>sam.server.samdev.relatorio</code> - Framework de relat\u00f3rios</p> <p>Consultas: - Busca de documentos com m\u00faltiplos filtros - C\u00e1lculo de empresas acess\u00edveis - Agrega\u00e7\u00e3o de dados por diferentes crit\u00e9rios</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Suporte a m\u00faltiplos formatos de sa\u00edda (PDF/XLSX)</li> <li>Consulta otimizada com LEFT JOIN e ROW_NUMBER para dados mais recentes</li> <li>Tratamento de dados JSON para c\u00e1lculos financeiros</li> <li>Flexibilidade total na ordena\u00e7\u00e3o e agrupamento</li> <li>Filtros din\u00e2micos baseados em par\u00e2metros</li> <li>Suporte a documentos pr\u00e9vios (previs\u00e3o) e reais</li> <li>Controle de acesso por empresa</li> </ul>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#metodos-principais","title":"\ud83d\udd04 M\u00e9todos Principais","text":""},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de gera\u00e7\u00e3o do relat\u00f3rio.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#buscadocumentos","title":"<code>buscaDocumentos()</code>","text":"<p>Executa a consulta SQL principal com todos os filtros aplicados.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#criarvaloresiniciais","title":"<code>criarValoresIniciais()</code>","text":"<p>Configura valores padr\u00e3o e acessos iniciais.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#empresasacessiveis","title":"<code>empresasAcessiveis()</code>","text":"<p>Retorna lista de empresas que o usu\u00e1rio logado tem acesso.</p>"},{"location":"LINHASITA/relatorio/scf/SCF_Documentos/#consulta-sql","title":"\ud83d\udca1 Consulta SQL","text":"<p>A consulta principal utiliza: - <code>ROW_NUMBER()</code> para obter o registro mais recente da <code>daa0103</code> - M\u00faltiplos <code>LEFT JOIN</code> para relacionar todas as entidades - Cl\u00e1usulas <code>WHERE</code> din\u00e2micas baseadas nos filtros - <code>ORDER BY</code> flex\u00edvel baseado no par\u00e2metro de ordena\u00e7\u00e3o</p>"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/","title":"SCV_FaturamentoDiarioDetalhado.md","text":""},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de gera\u00e7\u00e3o de relat\u00f3rio de faturamento di\u00e1rio detalhado para a Linhasita, com consolida\u00e7\u00e3o de dados por filial e tipo de opera\u00e7\u00e3o.</p>"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer uma vis\u00e3o detalhada do faturamento di\u00e1rio da empresa, permitindo o acompanhamento do processo de faturamento por filiais e tipos de opera\u00e7\u00e3o comercial.</p>"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Financeiro</li> <li>Faturamento</li> <li>Controladoria</li> <li>Gest\u00e3o Comercial</li> </ul>"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - Template Jasper <code>SCV_FaturamentoDiarioDetalhado</code> - Layout do relat\u00f3rio</p> <p>Localiza\u00e7\u00e3o: <code>linhasita/relatorios/scv/</code></p>"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos fiscais - <code>AAC10</code> - Empresas/Filiais - <code>ABB01</code> - Cabe\u00e7alho de documentos - <code>ABB10</code> - Opera\u00e7\u00f5es comerciais - <code>ABA20</code> - Reposit\u00f3rio de dados (dias n\u00e3o \u00fateis)</p> <p>Entidades Envolvidas: - <code>Eaa01</code> - Documentos fiscais - <code>Aac10</code> - Empresas do grupo - <code>Abb01</code> - Cabe\u00e7alho documentos - <code>Abb10</code> - Opera\u00e7\u00f5es comerciais</p>"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis periodo String Sim Per\u00edodo de an\u00e1lise (MM/aaaa) M\u00eas/ano atual"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#campos-do-relatorio","title":"\ud83d\udccb Campos do Relat\u00f3rio","text":"Campo Descri\u00e7\u00e3o Tipo dtMes Data do m\u00eas LocalDate flagDiaUtil Indicador de dia \u00fatil Integer vlr_Exp Valor exporta\u00e7\u00e3o BigDecimal kg_Exp Peso exporta\u00e7\u00e3o BigDecimal vlr_Ref Valor refugo/sucata BigDecimal kg_Ref Peso refugo/sucata BigDecimal vlr_Ind Valor industrializa\u00e7\u00e3o BigDecimal kg_Ind Peso industrializa\u00e7\u00e3o BigDecimal vlr_Fat Valor faturamento normal BigDecimal kg_Fat Peso faturamento normal BigDecimal vlr_Birigui Valor Birigui BigDecimal kg_Birigui Peso Birigui BigDecimal vlr_Franca Valor Franca BigDecimal kg_Franca Peso Franca BigDecimal vlr_Hamburgo Valor Hamburgo BigDecimal kg_Hamburgo Peso Hamburgo BigDecimal vlr_Serrana Valor Serrana BigDecimal kg_Serrana Peso Serrana BigDecimal vlr_Total Valor total matriz BigDecimal kg_Total Peso total matriz BigDecimal"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o de Par\u00e2metros</li> <li>Processa per\u00edodo informado (MM/aaaa)</li> <li> <p>Define primeiro e \u00faltimo dia do m\u00eas</p> </li> <li> <p>Busca de Dados</p> </li> <li>Consulta documentos fiscais do per\u00edodo</li> <li>Obt\u00e9m devolu\u00e7\u00f5es do m\u00eas</li> <li> <p>Busca dias n\u00e3o \u00fateis do reposit\u00f3rio</p> </li> <li> <p>Processamento de Dias</p> </li> <li>Cria lista com todos os dias do m\u00eas</li> <li>Classifica dias (\u00fatil, s\u00e1bado, domingo, n\u00e3o \u00fatil)</li> <li> <p>Consolida valores por tipo de opera\u00e7\u00e3o e filial</p> </li> <li> <p>C\u00e1lculo de Totais</p> </li> <li>Soma valores e pesos por categoria</li> <li>Calcula totais gerais por filial</li> <li> <p>Registra devolu\u00e7\u00f5es do per\u00edodo</p> </li> <li> <p>Gera\u00e7\u00e3o de Sa\u00edda</p> </li> <li>Gera PDF com dados consolidados</li> <li>Apresenta totais por filial e matriz</li> </ol>"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Considera apenas documentos fiscais ativos (<code>eaa01cancData IS NULL</code>)</li> <li>Apenas documentos com status NFe = 3 (autorizada)</li> <li>Filtra por tipos de documento espec\u00edficos (NF-e pr\u00f3pria)</li> <li>Considera apenas opera\u00e7\u00f5es com <code>resumo_venda = 1</code></li> </ul>"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#classificacao-de-operacoes","title":"Classifica\u00e7\u00e3o de Opera\u00e7\u00f5es","text":"<ul> <li>EXPORTACAO: Ids 331927255, 285603711</li> <li>SUCATA: Ids 331931980, 331931983</li> <li>INDUSTRIALIZACAO: Ids 285367776</li> <li>NORMAL: Demais opera\u00e7\u00f5es</li> </ul>"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#classificacao-de-dias","title":"Classifica\u00e7\u00e3o de Dias","text":"<ul> <li>Flag 1: Dias n\u00e3o \u00fateis (reposit\u00f3rio)</li> <li>Flag 2: S\u00e1bados</li> <li>Flag 3: Domingos</li> <li>Flag null: Dias \u00fateis normais</li> </ul>"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#filiais-incluidas","title":"Filiais Inclu\u00eddas","text":"<ul> <li>LINHASITA MATRIZ</li> <li>LINHASITA BIRIGUI</li> <li>LINHASITA FRANCA</li> <li>LINHASITA HAMBURGO</li> <li>LINHASITA SERRANA</li> </ul>"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Formato Descri\u00e7\u00e3o M\u00e9todo PDF Relat\u00f3rio formatado <code>gerarPDF()</code>"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios - <code>multitec.utils</code> - Utilit\u00e1rios e c\u00e1lculos - <code>java.time</code> - Manipula\u00e7\u00e3o de datas</p> <p>Servi\u00e7os: - Acesso ao banco de dados</p>"},{"location":"LINHASITA/relatorio/scv/SCV_FaturamentoDiarioDetalhado/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Implementa consulta otimizada para grandes volumes de dados</li> <li>Suporte a m\u00faltiplas filiais do grupo Linhasita</li> <li>Classifica\u00e7\u00e3o autom\u00e1tica de dias \u00fateis e n\u00e3o \u00fateis</li> <li>Consolida\u00e7\u00e3o por tipo de opera\u00e7\u00e3o comercial</li> <li>C\u00e1lculo de totais parciais e gerais</li> <li>Integra\u00e7\u00e3o com reposit\u00f3rio de dias n\u00e3o \u00fateis</li> <li>Formata\u00e7\u00e3o espec\u00edfica para relat\u00f3rio financeiro</li> </ul>"},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/","title":"SCV Pedido de Compra","text":""},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio de pedidos de compra da Linhasita com funcionalidade de emiss\u00e3o e envio autom\u00e1tico por e-mail para fornecedores.</p>"},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar e distribuir pedidos de compra para fornecedores, automatizando o processo de solicita\u00e7\u00e3o de compras com envio de documenta\u00e7\u00e3o por e-mail.</p>"},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento de Compras</li> <li>Fornecedores</li> <li>Gestores de Suprimentos</li> <li>Controle Patrimonial</li> </ul>"},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - Arquivo <code>Logo2.png</code> - Logo secund\u00e1ria - Arquivo <code>Logo3.png</code> - Logo terci\u00e1ria - Arquivo <code>NaoAutorizado.png</code> - Imagem para status n\u00e3o autorizado</p> <p>Localiza\u00e7\u00e3o: <code>samdev/resources/linhasita/relatorios/scv/</code></p>"},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos de compra - <code>ABB01</code> - Cabe\u00e7alho pedidos - <code>ABE01</code> - Entidades/Fornecedores - <code>EAA0101</code> - Endere\u00e7os de entrega - <code>EAA0102</code> - Dados de contato - <code>EAA0103</code> - Itens do pedido - <code>ABE0104</code> - E-mails de fornecedores</p> <p>Entidades Envolvidas: - <code>Abe0104</code> - E-mails de entidades - <code>Aab1008</code> - Configura\u00e7\u00e3o de e-mail do usu\u00e1rio - <code>Aab10</code> - Usu\u00e1rio logado - <code>Aac10</code> - Empresa ativa</p>"},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis numeroInicial Integer N\u00e3o N\u00famero inicial do pedido \u2265 0 numeroFinal Integer N\u00e3o N\u00famero final do pedido \u2265 0 emissao LocalDate[] Sim Per\u00edodo de emiss\u00e3o Data inicial e final entidades List N\u00e3o Fornecedores espec\u00edficos IDs das entidades aprovado Boolean Sim Filtro por status true=aprovados, false=todos enviaEmail Boolean Sim Envio autom\u00e1tico true=enviar, false=apenas gerar"},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#campos-do-relatorio","title":"\ud83d\udccb Campos do Relat\u00f3rio","text":"Campo Descri\u00e7\u00e3o Tipo abb01num N\u00famero do pedido Integer abb01data Data de emiss\u00e3o Date abb01aprovado Status de aprova\u00e7\u00e3o Boolean eaa0102codigo C\u00f3digo do fornecedor String eaa0102nome Nome do fornecedor String eaa0102ni CNPJ/CPF String eaa0101endereco Endere\u00e7o de entrega String abm01codigo C\u00f3digo do item String eaa0103descr Descri\u00e7\u00e3o do item String eaa0103qtComl Quantidade BigDecimal eaa0103unit Valor unit\u00e1rio BigDecimal eaa0103total Valor total BigDecimal ipi_aliq Al\u00edquota IPI BigDecimal icm_aliq Al\u00edquota ICMS BigDecimal"},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o de Par\u00e2metros</li> <li>Verifica n\u00fameros de pedido (inicial/final)</li> <li>Valida per\u00edodo de emiss\u00e3o</li> <li> <p>Processa lista de fornecedores</p> </li> <li> <p>Busca de Dados</p> </li> <li>Consulta pedidos com filtros aplicados</li> <li>Busca informa\u00e7\u00f5es completas (itens, endere\u00e7os, contatos)</li> <li> <p>Aplica filtro de aprova\u00e7\u00e3o quando solicitado</p> </li> <li> <p>Processamento de Sa\u00edda</p> </li> <li>Carrega recursos visuais (logos)</li> <li>Gera PDF do pedido de compra</li> <li> <p>Se solicitado, envia e-mail para fornecedores</p> </li> <li> <p>Envio por E-mail (opcional)</p> </li> <li>Busca e-mails cadastrados do fornecedor</li> <li>Valida configura\u00e7\u00e3o de e-mail do usu\u00e1rio</li> <li>Anexa PDF e envia com corpo padronizado</li> </ol>"},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Usu\u00e1rio deve ter e-mail configurado para envio</li> <li>Fornecedor deve ter e-mail cadastrado (classifica\u00e7\u00e3o 9002)</li> <li>Per\u00edodo de emiss\u00e3o obrigat\u00f3rio</li> <li>Filtro de aprova\u00e7\u00e3o aplicado por padr\u00e3o</li> </ul>"},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#processamento","title":"Processamento","text":"<ul> <li>Considera apenas documentos de classe 0 (compras)</li> <li>Endere\u00e7o principal de entrega</li> <li>Itens ordenados por sequ\u00eancia</li> <li>Calcula totais e impostos via campos JSON</li> </ul>"},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#e-mail","title":"E-mail","text":"<ul> <li>Assunto padronizado com n\u00famero do pedido</li> <li>Corpo em HTML com formata\u00e7\u00e3o</li> <li>Anexo PDF com nome identificador</li> <li>Inclui assinatura digital se configurada</li> </ul>"},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Formato Descri\u00e7\u00e3o M\u00e9todo PDF Pedido de compra formatado <code>gerarPDF()</code> E-mail Envio autom\u00e1tico para fornecedores <code>enviarEmail()</code>"},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios - <code>javax.mail</code> - Envio de e-mails - <code>multitec.utils</code> - Utilit\u00e1rios e e-mail</p> <p>Servi\u00e7os: - <code>CAS1010Service</code> - Processamento de assinaturas de e-mail</p> <p>Configura\u00e7\u00f5es: - E-mail do usu\u00e1rio logado (<code>Aab1008</code>) - E-mails de fornecedores (classifica\u00e7\u00e3o 9002)</p>"},{"location":"LINHASITA/relatorio/scv/SCV_Pedido_de_Compra/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Utiliza consulta SQL nativa para performance com m\u00faltiplos joins</li> <li>Processa campos de impostos diretamente do JSON da tabela</li> <li>Suporte a m\u00faltiplos anexos de e-mail</li> <li>Valida\u00e7\u00e3o de recursos de imagem em tempo de execu\u00e7\u00e3o</li> <li>Normaliza\u00e7\u00e3o de texto para remover acentos no corpo do e-mail</li> </ul>"},{"location":"LINHASITA/relatorio/spp/SPP_OrdensProducao/","title":"SPP - Ordens de Produ\u00e7\u00e3o - Linhasita","text":""},{"location":"LINHASITA/relatorio/spp/SPP_OrdensProducao/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio de ordens de produ\u00e7\u00e3o da Linhasita, detalhando processos de acabamento, pesagem e tingimento. Permite diferentes layouts (designs) conforme necessidade, incluindo tingimento \u00fanico e ajustado, com sub-relat\u00f3rios de processos espec\u00edficos.</p>"},{"location":"LINHASITA/relatorio/spp/SPP_OrdensProducao/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer vis\u00e3o completa das ordens de produ\u00e7\u00e3o, incluindo itens, componentes, quantidades, unidades e processos aplicados, permitindo controle operacional e acompanhamento de produ\u00e7\u00e3o.</p>"},{"location":"LINHASITA/relatorio/spp/SPP_OrdensProducao/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Produ\u00e7\u00e3o</li> <li>Planejamento de Produ\u00e7\u00e3o</li> <li>Qualidade</li> <li>Controle de Estoque</li> <li>Auditoria Interna</li> </ul>"},{"location":"LINHASITA/relatorio/spp/SPP_OrdensProducao/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis numeroInicial Integer N\u00e3o N\u00famero inicial da ordem de produ\u00e7\u00e3o Inteiro \u2265 0 numeroFinal Integer N\u00e3o N\u00famero final da ordem de produ\u00e7\u00e3o Inteiro \u2265 0 numAjustada1..4 Integer N\u00e3o N\u00fameros de ordens ajustadas manualmente Inteiros tipoDoc List N\u00e3o Tipos de documentos a considerar Lista de IDs desingRelatorio Integer Sim Layout do relat\u00f3rio 0=Acabamento, 1=Romaneio Pesagem, 2=Tinturaria \u00danica, 3=Tinturaria Ajustada"},{"location":"LINHASITA/relatorio/spp/SPP_OrdensProducao/#campos-do-relatorio","title":"\ud83d\udccb Campos do Relat\u00f3rio","text":"Campo Descri\u00e7\u00e3o Tipo abb01num N\u00famero da ordem de produ\u00e7\u00e3o Integer abb01data Data da ordem Date prodNa Nome do produto String niquelina Niquelina do produto Integer turbo C\u00f3digo turbo do produto Integer kg / bab01qt Quantidade produzida BigDecimal compDescr Nome do componente String ITENS Itens detalhados do processo String PROCESSO C\u00f3digo do processo String NOMEPROCESSO Nome do processo String UNIDADE Unidade de medida String"},{"location":"LINHASITA/relatorio/spp/SPP_OrdensProducao/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Carrega par\u00e2metros de filtro e n\u00fameros de ordem.</li> <li>Inicializa listas de ordens ajustadas e sub-relat\u00f3rios.</li> <li>Seleciona layout (<code>desingRelatorio</code>) e busca dados correspondentes:<ul> <li>0: Acabamento</li> <li>1: Romaneio de Pesagem</li> <li>2: Tinturaria \u00danica (com sub-relat\u00f3rio de processos)</li> <li>3: Tinturaria Ajustada (com itens detalhados)</li> </ul> </li> <li>Monta <code>TableMap</code> ou <code>TableMapDataSource</code> para os dados principais e sub-relat\u00f3rios.</li> <li>Adiciona par\u00e2metros necess\u00e1rios para sub-relat\u00f3rios.</li> <li>Gera PDF final usando <code>gerarPDF(nomeRelatorio, dados)</code>.</li> </ol>"},{"location":"LINHASITA/relatorio/spp/SPP_OrdensProducao/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":"<ul> <li>Layouts distintos determinam quais dados e sub-relat\u00f3rios ser\u00e3o carregados.</li> <li>Processos de tinturaria s\u00e3o mapeados conforme tabela interna <code>codProc</code>.</li> <li>Itens de tingimento s\u00f3 s\u00e3o inclu\u00eddos se correspondem a processos v\u00e1lidos.</li> <li>Ordens ajustadas s\u00e3o filtradas manualmente pelo usu\u00e1rio.</li> <li>Totaliza\u00e7\u00e3o e detalhamento seguem l\u00f3gica espec\u00edfica de produ\u00e7\u00e3o.</li> </ul>"},{"location":"LINHASITA/relatorio/spp/SPP_OrdensProducao/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Formato Descri\u00e7\u00e3o PDF Relat\u00f3rio pronto para impress\u00e3o, com sub-relat\u00f3rios quando aplic\u00e1vel"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/","title":"SRF_FaturamentoXPrecoMedio - Relat\u00f3rio de Faturamento x Pre\u00e7o M\u00e9dio","text":""},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio anal\u00edtico e sint\u00e9tico de faturamento versus pre\u00e7o m\u00e9dio de vendas, com m\u00faltiplos layouts e agrupamentos para an\u00e1lise comercial e estrat\u00e9gica de precifica\u00e7\u00e3o.</p>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer insights sobre o desempenho de vendas atrav\u00e9s da an\u00e1lise do faturamento e pre\u00e7o m\u00e9dio por grupo de itens, permitindo identificar tend\u00eancias de mercado e efic\u00e1cia da estrat\u00e9gia de precifica\u00e7\u00e3o.</p>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Comercial</li> <li>Gestores de Vendas</li> <li>Diretoria Executiva</li> <li>Planejamento Estrat\u00e9gico</li> <li>Controladoria</li> </ul>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis empresas List N\u00e3o Empresas espec\u00edficas IDs empresas emissao LocalDate[] Sim Per\u00edodo de emiss\u00e3o Data inicial e final layout Integer Sim Tipo de layout 0=Sint\u00e9tico, 1=Anal\u00edtico sintetico Integer Sim N\u00edvel de detalhe 0=Padr\u00e3o, 1=Nacional, 2=Por Cor, 3=Exporta\u00e7\u00e3o"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#campos-do-relatorio","title":"\ud83d\udccb Campos do Relat\u00f3rio","text":"Campo Descri\u00e7\u00e3o Tipo grupoItem C\u00f3digo do grupo de item String nomeGrupo Nome do grupo de item String qtComlTotal Quantidade comercial total BigDecimal total Valor total l\u00edquido BigDecimal media Pre\u00e7o m\u00e9dio BigDecimal grupoNat Grupo natural/cor String abm01codigo C\u00f3digo do item String abm01na Nome do item String abb01num N\u00famero do documento Integer valorCotacao Valor da cota\u00e7\u00e3o BigDecimal mediaDolar M\u00e9dia em d\u00f3lar BigDecimal"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Define valores padr\u00e3o (m\u00eas atual, layout sint\u00e9tico)</li> <li>Obt\u00e9m lista de empresas selecionadas</li> <li>Formata per\u00edodo para exibi\u00e7\u00e3o</li> </ul>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#2-selecao-do-layout","title":"2. Sele\u00e7\u00e3o do Layout","text":"<ul> <li>Layout 0 (Sint\u00e9tico): Dados consolidados por grupo</li> <li>Sint\u00e9tico 0: Agrupamento padr\u00e3o</li> <li>Sint\u00e9tico 1: Separa\u00e7\u00e3o NAT/COR</li> <li>Sint\u00e9tico 2: Detalhamento por cor</li> <li>Sint\u00e9tico 3: Exporta\u00e7\u00e3o com cota\u00e7\u00e3o</li> <li>Layout 1 (Anal\u00edtico): Dados detalhados por documento</li> </ul>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#3-busca-de-dados","title":"3. Busca de Dados","text":"<ul> <li>Consulta grupos de itens ativos</li> <li>Executa query espec\u00edfica conforme layout selecionado</li> <li>Calcula m\u00e9dias e totais</li> </ul>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#4-processamento-de-dados","title":"4. Processamento de Dados","text":"<ul> <li>Combina dados de faturamento com grupos de itens</li> <li>Para exporta\u00e7\u00e3o, busca e calcula cota\u00e7\u00f5es de d\u00f3lar</li> <li>Ordena resultados por nome do grupo</li> </ul>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#5-geracao-do-relatorio","title":"5. Gera\u00e7\u00e3o do Relat\u00f3rio","text":"<ul> <li>Seleciona template JasperReports conforme layout</li> <li>Gera PDF com dados processados</li> <li>Retorna arquivo para download</li> </ul>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#filtros-de-dados","title":"Filtros de Dados:","text":"<ul> <li>Documentos de venda: clasDoc = 1, esMov = 1</li> <li>Opera\u00e7\u00f5es comerciais: tipocod = 1</li> <li>Itens v\u00e1lidos: tipo in (0, 1)</li> <li>Exclus\u00f5es: Opera\u00e7\u00f5es 112 e 115 (exceto exporta\u00e7\u00e3o)</li> </ul>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#calculo-de-valores","title":"C\u00e1lculo de Valores:","text":"<ul> <li>Total l\u00edquido: totDoc - ICMS - PIS - COFINS</li> <li>Pre\u00e7o m\u00e9dio: Total l\u00edquido / Quantidade</li> <li>C\u00f3digo grupo: 5 d\u00edgitos (tipo 0) ou 8 d\u00edgitos (tipo 1)</li> </ul>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#agrupamentos-especificos","title":"Agrupamentos Espec\u00edficos:","text":"<ul> <li>NAT/COR: Identifica pelo nome do item contendo \"NAT\"</li> <li>Exporta\u00e7\u00e3o: Inclui apenas opera\u00e7\u00f5es 112 e 115</li> <li>Cota\u00e7\u00e3o: M\u00e9dia das cota\u00e7\u00f5es no per\u00edodo</li> </ul>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#validacoes","title":"Valida\u00e7\u00f5es:","text":"<ul> <li>Divis\u00e3o por zero protegida em c\u00e1lculos de m\u00e9dia</li> <li>Tratamento de exce\u00e7\u00f5es em convers\u00e3o para d\u00f3lar</li> <li>Ordena\u00e7\u00e3o consistente por tipo e c\u00f3digo</li> </ul>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Layout Sint\u00e9tico Template Descri\u00e7\u00e3o 0 0 <code>SRF_FaturamentoXPrecoMedio_Sintetico</code> Agrupamento padr\u00e3o 0 1 <code>SRF_FaturamentoXPrecoMedio_Sintetico_S1</code> Separa\u00e7\u00e3o NAT/COR 0 2 <code>SRF_FaturamentoXPrecoMedio_Sintetico_S2</code> Detalhamento por cor 0 3 <code>SRF_FaturamentoXPrecoMedio_Sintetico_S3</code> Exporta\u00e7\u00e3o com cota\u00e7\u00e3o 1 - <code>SRF_FaturamentoXPrecoMedio_Analitico</code> Detalhado por documento"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios PDF - <code>br.com.multitec.utils</code> - Utilit\u00e1rios e datas</p> <p>Entidades: - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens de documentos - <code>Abm01</code> - Itens cadastrais - <code>Aac10</code> - Empresas - <code>Abb10</code> - Opera\u00e7\u00f5es comerciales</p>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#consultas-sql","title":"Consultas SQL:","text":"<ul> <li>M\u00faltiplas varia\u00e7\u00f5es conforme layout selecionado</li> <li>Uso de substring para agrupamento por c\u00f3digo</li> <li>Extra\u00e7\u00e3o de campos JSON para valores fiscais</li> <li>Agrega\u00e7\u00e3o com GROUP BY din\u00e2mico</li> </ul>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#performance","title":"Performance:","text":"<ul> <li>Consultas otimizadas com filtros aplicados no banco</li> <li>Processamento em mem\u00f3ria apenas para combina\u00e7\u00e3o final</li> <li>Pagina\u00e7\u00e3o tratada pelo JasperReports</li> </ul>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#tratamento-de-dados","title":"Tratamento de Dados:","text":"<ul> <li>Formata\u00e7\u00e3o personalizada do per\u00edodo</li> <li>Concatena\u00e7\u00e3o de nomes de empresas</li> <li>C\u00e1lculo de m\u00e9dias com prote\u00e7\u00e3o contra divis\u00e3o por zero</li> <li>Ordena\u00e7\u00e3o alfab\u00e9tica por nome do grupo</li> </ul>"},{"location":"LINHASITA/relatorio/srf/SRF_FaturamentoXPrecoMedio/#calculo-de-cotacao","title":"C\u00e1lculo de Cota\u00e7\u00e3o:","text":"<ul> <li>Busca cota\u00e7\u00f5es hist\u00f3ricas para datas de emiss\u00e3o</li> <li>Calcula m\u00e9dia ponderada das cota\u00e7\u00f5es</li> <li>Converte valores para d\u00f3lar quando aplic\u00e1vel</li> </ul>"},{"location":"LINHASITA/script/SRF%20-%201002/","title":"SRF   1002","text":""},{"location":"LINHASITA/script/SRF%20-%201002/#funcionalidades-implementadas","title":"\u2699\ufe0f Funcionalidades Implementadas","text":""},{"location":"LINHASITA/script/SRF%20-%201002/#1-gestao-de-campos-personalizados","title":"1. Gest\u00e3o de Campos Personalizados","text":"Funcionalidade Descri\u00e7\u00e3o M\u00e9todo Ocultar Zerados Esconde campos num\u00e9ricos com valor zero <code>ocultarZerados()</code> Mostrar Todos Exibe todos os campos ocultos <code>mostrarTodos()</code>"},{"location":"LINHASITA/script/SRF%20-%201002/#2-operacoes-fiscais","title":"2. Opera\u00e7\u00f5es Fiscais","text":"Funcionalidade Descri\u00e7\u00e3o M\u00e9todo C\u00e1lculo Fiscal Agrupa dados fiscais por CFOP <code>calcularAbaFiscal()</code> Spread Fiscal Exibe resumo fiscal consolidado <code>criarSpreadETab()</code>"},{"location":"LINHASITA/script/SRF%20-%201002/#3-danfe-documento-auxiliar","title":"3. DANFE - Documento Auxiliar","text":"Funcionalidade Descri\u00e7\u00e3o M\u00e9todo Visualiza\u00e7\u00e3o Abre DANFE no navegador <code>abrirBrowser()</code> Impress\u00e3o Imprime DANFE em impressora selecionada <code>selectionBtnImprimirDanfePressed()</code>"},{"location":"LINHASITA/script/SRF%20-%201002/#estrutura-da-tela","title":"\ud83d\udccb Estrutura da Tela","text":""},{"location":"LINHASITA/script/SRF%20-%201002/#componentes-criados","title":"Componentes Criados","text":"Componente Posi\u00e7\u00e3o Dimens\u00f5es Fun\u00e7\u00e3o btnOcultarCampos (550,635) 175x36 Oculta campos zerados btnMostrarCampos (750,635) 175x36 Mostra todos campos btnImprimirDanfe (950,635) 175x36 Imprime DANFE btnAbrirDanfe (1150,635) 175x36 Abre DANFE no browser Aba Fiscal Tab 7 - Dados fiscais consolidados"},{"location":"LINHASITA/script/SRF%20-%201002/#colunas-do-spread-fiscal","title":"Colunas do Spread Fiscal","text":"Campo Tipo Tamanho Descri\u00e7\u00e3o CFOP String 4 chars C\u00f3digo Fiscal de Opera\u00e7\u00f5es Total Doc BigDecimal 15 chars Valor total do documento BC ICMS BigDecimal 15 chars Base de c\u00e1lculo ICMS % ICMS BigDecimal 15 chars Al\u00edquota do ICMS ICMS BigDecimal 15 chars Valor do ICMS ICMS Outras BigDecimal 15 chars ICMS outras opera\u00e7\u00f5es ICMS Isento BigDecimal 15 chars ICMS isento"},{"location":"LINHASITA/script/SRF%20-%201002/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"LINHASITA/script/SRF%20-%201002/#1-inicializacao-da-tela","title":"1. Inicializa\u00e7\u00e3o da Tela","text":"<ul> <li>Ajusta dimens\u00f5es da janela</li> <li>Cria bot\u00f5es de controle</li> <li>Configura componentes fiscais</li> <li>Organiza layout</li> </ul>"},{"location":"LINHASITA/script/SRF%20-%201002/#2-processamento-fiscal","title":"2. Processamento Fiscal","text":"<ul> <li>Captura dados dos itens do pedido (EAA0103)</li> <li>Agrupa informa\u00e7\u00f5es por CFOP</li> <li>Calcula totais e impostos</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/","title":"SRF - Enviar Emails NFe (Mitra)","text":""},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula especializada para envio automatizado de e-mails relacionados a Notas Fiscais Eletr\u00f4nicas no m\u00f3dulo Mitra, com foco em faturamento, cobran\u00e7a, cancelamentos e cartas de corre\u00e7\u00e3o.</p>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar o envio de e-mails para clientes com documentos fiscais eletr\u00f4nicos (XML, DANFE, boletos) de acordo com o tipo de opera\u00e7\u00e3o, adaptado para as necessidades espec\u00edficas do m\u00f3dulo Mitra.</p>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Faturamento</li> <li>Cobran\u00e7a</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos fiscais NF-e - <code>Abb01</code> - Cabe\u00e7alho de documentos - <code>Abe01</code> - Entidades (clientes) - <code>Eaa0102</code> - Dados complementares do documento - <code>Aaa16</code> - Processamento da mensageria - <code>Eaa0114</code> - Cartas de corre\u00e7\u00e3o - <code>Eaa0101</code> - E-mails espec\u00edficos por documento - <code>Abe0101</code> - Endere\u00e7os de e-mail das entidades</p>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01id Long Sim ID do documento fiscal (Eaa01) aaa16id Long Sim ID do processamento da mensageria eaa0114id Long N\u00e3o ID da carta de corre\u00e7\u00e3o (se aplic\u00e1vel)"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Obten\u00e7\u00e3o dos par\u00e2metros de entrada</li> <li>Carregamento das entidades principais (Eaa01, Aaa16, Abb01, Abe01)</li> <li>Verifica\u00e7\u00e3o da exist\u00eancia de e-mail principal no documento</li> <li>Composi\u00e7\u00e3o do assunto com nome da empresa e n\u00famero da nota</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#2-composicao-do-corpo-da-mensagem","title":"2. Composi\u00e7\u00e3o do Corpo da Mensagem","text":"<ul> <li>Cancelamento: Inclui motivo do cancelamento (Aae11)</li> <li>Carta de Corre\u00e7\u00e3o: Inclui texto da corre\u00e7\u00e3o (Eaa0114)</li> <li>Faturamento Normal: Mensagem padr\u00e3o de envio de NF-e</li> <li>Formata\u00e7\u00e3o HTML com dados do cliente e chave de acesso</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#3-definicao-dos-destinatarios-por-tipo","title":"3. Defini\u00e7\u00e3o dos Destinat\u00e1rios por Tipo","text":"<ul> <li>Cancelamento/CC-e: Apenas e-mail principal do cliente com XML</li> <li>Faturamento: E-mail principal com XML + DANFE</li> <li>Cobran\u00e7a: E-mail espec\u00edfico de cobran\u00e7a com boleto</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#4-configuracao-dos-anexos","title":"4. Configura\u00e7\u00e3o dos Anexos","text":"<ul> <li>Cancelamento/CC-e: Apenas XML</li> <li>Faturamento: XML + DANFE (boleto opcional)</li> <li>Cobran\u00e7a: Apenas boleto</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#tipos-de-operacao","title":"Tipos de Opera\u00e7\u00e3o","text":"<ul> <li>Cancelamento: Aaa16.TIPO_CANCELAMENTO_NFE</li> <li>Carta de Corre\u00e7\u00e3o: Aaa16.TIPO_CCEEVENTO  </li> <li>Faturamento: Demais tipos</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#hierarquia-de-e-mails-de-cobranca","title":"Hierarquia de E-mails de Cobran\u00e7a","text":"<ol> <li>E-mail espec\u00edfico no documento (Eaa0101) marcado como cobran\u00e7a</li> <li>E-mail principal da entidade (Abe0101) marcado como cobran\u00e7a</li> <li>E-mail principal do documento (Eaa0102)</li> </ol>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#configuracao-de-remetentes","title":"Configura\u00e7\u00e3o de Remetentes","text":"<ul> <li>Faturamento: Remetente 2 (Faturamento)</li> <li>Cobran\u00e7a: Remetente 1 (Cobran\u00e7a)</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#funcionalidades-desabilitadas","title":"Funcionalidades Desabilitadas","text":"<ul> <li>Representantes: C\u00f3digo comentado - n\u00e3o envia e-mails para representantes</li> <li>Transportadora: C\u00f3digo comentado - n\u00e3o envia e-mails para transportadora</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>N\u00e3o processa se n\u00e3o houver e-mail principal no documento</li> <li>Verifica diferen\u00e7a entre e-mails de faturamento e cobran\u00e7a</li> <li>Envia boleto junto com faturamento se mesmo e-mail</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de envio de e-mails.</p>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#comporcorpomsgaaa16-aaa16-eaa01-eaa01-abe01-abe01-abb01-abb01-long-eaa0114id","title":"<code>comporCorpoMsg(Aaa16 aaa16, Eaa01 eaa01, Abe01 abe01, Abb01 abb01, Long eaa0114id)</code>","text":"<p>Compoi o corpo do e-mail conforme o tipo de opera\u00e7\u00e3o com formata\u00e7\u00e3o HTML.</p>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#obteremailcobrancalong-eaa01id-long-abe01id-eaa0102-eaa0102","title":"<code>obterEmailCobranca(Long eaa01id, Long abe01id, Eaa0102 eaa0102)</code>","text":"<p>Busca o e-mail de cobran\u00e7a seguindo a hierarquia definida.</p>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>EmailNFeDto: - <code>assunto</code> - Assunto do e-mail formatado - <code>corpo</code> - Corpo em HTML da mensagem - <code>emailsDestinoPara</code> - Lista de destinat\u00e1rios - <code>enviarXML</code> - Indica se envia arquivo XML - <code>enviarDanfe</code> - Indica se envia DANFE - <code>enviarBoleto</code> - Indica se envia boleto - <code>emailRemetente</code> - Tipo de remetente (1: Cobran\u00e7a, 2: Faturamento)</p> <p>Lista de E-mails Gerados: - Retornada no par\u00e2metro <code>emails</code> para processamento pela mensageria</p>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e joins para consultas - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.dto.srf</code> - DTOs espec\u00edficos do m\u00f3dulo SRF - <code>sam.model</code> - Entidades do sistema</p> <p>M\u00f3dulo: Mitra</p>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#formatacao-html","title":"Formata\u00e7\u00e3o HTML","text":"<ul> <li>Corpo dos e-mails em HTML com tags b\u00e1sicas</li> <li>Links para portal da NF-e e site da Multitec</li> <li>Dados do cliente, CNPJ e chave de acesso</li> <li>Protocolo de autoriza\u00e7\u00e3o da SEFAZ</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#controle-de-anexos","title":"Controle de Anexos","text":"<ul> <li>XML sempre enviado para cliente</li> <li>DANFE apenas para faturamento</li> <li>Boleto apenas para cobran\u00e7a (separado ou junto)</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_EnviarEmailsNFe/#funcionalidades-comentadas","title":"Funcionalidades Comentadas","text":"<ul> <li>M\u00e9todos <code>obterEmailsRepresentantes()</code> e <code>obterEmailTransportadoraDespacho()</code> dispon\u00edveis mas n\u00e3o utilizados</li> <li>Blocos de c\u00f3digo para representantes e transportadora comentados</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 27/10/2025 \u00e0s 10:45 Autor: Bruno Tipo: F\u00f3rmula de Envio de E-mails NF-e (Mitra) Vers\u00e3o: 1.0</p>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/","title":"Documenta\u00e7\u00e3o de C\u00f3digo Fonte - SRF - Gera\u00e7\u00e3o de XML de Nota Fiscal Eletr\u00f4nica (NFe)","text":""},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula respons\u00e1vel pela gera\u00e7\u00e3o do XML da Nota Fiscal Eletr\u00f4nica (NFe) conforme layout 4.00, aplicando regras de valida\u00e7\u00e3o, composi\u00e7\u00e3o de tags, tratamento de impostos (ICMS, IPI, PIS, COFINS, ISS), informa\u00e7\u00f5es de transporte, pagamento, parcelamento, importa\u00e7\u00e3o, exporta\u00e7\u00e3o, rastreabilidade e demais elementos obrigat\u00f3rios conforme legisla\u00e7\u00e3o vigente.</p>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar o arquivo XML da NFe de forma estruturada e v\u00e1lida para transmiss\u00e3o \u00e0 SEFAZ, incluindo todos os dados do emitente, destinat\u00e1rio, itens, impostos, totais e informa\u00e7\u00f5es complementares, com valida\u00e7\u00f5es pr\u00e9vias para garantir conformidade fiscal.</p>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Faturamento</li> <li>Desenvolvedores</li> <li>Suporte T\u00e9cnico</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Aac10</code> \u2013 Empresa (Emitente) - <code>Aac1002</code> \u2013 Inscri\u00e7\u00e3o Estadual da Empresa por UF - <code>Aag02</code> \u2013 Estados (UF) - <code>Aag0201</code> \u2013 Munic\u00edpios - <code>Aah01</code> \u2013 Tipo de Documento - <code>Aah20</code> \u2013 Ve\u00edculos - <code>Aaj03</code> \u2013 Situa\u00e7\u00e3o do Documento - <code>Aaj04</code> \u2013 C\u00f3digo ANP (Combust\u00edveis) - <code>Aaj10</code> \u2013 CST ICMS - <code>Aaj12</code> \u2013 CST PIS - <code>Aaj13</code> \u2013 CST COFINS - <code>Aaj14</code> \u2013 CSOSN (Simples Nacional) - <code>Aaj15</code> \u2013 CFOP - <code>Abb01</code> \u2013 Central de Documentos - <code>Abd01</code> \u2013 Par\u00e2metros de C\u00e1lculo de Documentos (PCD) - <code>Abe01</code> \u2013 Entidades (Cliente/Fornecedor) - <code>Abe0101</code> \u2013 Endere\u00e7os da Entidade - <code>Abg01</code> \u2013 NCM - <code>Abg0101</code> \u2013 NVE (Nomenclatura de Valor Aduaneiro) - <code>Abm01</code> \u2013 Produtos - <code>Abm0101</code> \u2013 Configura\u00e7\u00f5es do Produto por Empresa - <code>Eaa01</code> \u2013 Documento Fiscal - <code>Eaa0101</code> \u2013 Endere\u00e7os do Documento - <code>Eaa0102</code> \u2013 Dados Gerais do Documento - <code>Eaa0103</code> \u2013 Itens do Documento - <code>Eaa01033</code> \u2013 Itens Devolvidos Referenciados - <code>Eaa01034</code> \u2013 Declara\u00e7\u00e3o de Importa\u00e7\u00e3o - <code>Eaa010341</code> \u2013 Adi\u00e7\u00f5es da DI - <code>Eaa01038</code> \u2013 Rastreabilidade do Item - <code>Eaa0104</code> \u2013 Declara\u00e7\u00e3o de Exporta\u00e7\u00e3o - <code>Eaa0113</code> \u2013 Financeiro do Documento (Parcelas) - <code>Eaa01131</code> \u2013 Formas de Pagamento das Parcelas</p>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01 Eaa01 Sim Documento fiscal a ser processado formaEmis Integer Sim Forma de emiss\u00e3o (1=Normal, 2=Conting\u00eancia) contDt LocalDate N\u00e3o Data de conting\u00eancia (se aplic\u00e1vel) contHr LocalTime N\u00e3o Hora de conting\u00eancia (se aplic\u00e1vel) contJust String N\u00e3o Justificativa da conting\u00eancia"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o dos par\u00e2metros de entrada</li> <li>Carregamento da empresa emitente (Aac10)</li> <li>Carregamento do documento (Eaa01) e seus filhos (endere\u00e7os, itens, financeiro)</li> <li>Obten\u00e7\u00e3o do PCD (Abd01) para regras espec\u00edficas</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#2-validacoes-pre-geracao","title":"2. Valida\u00e7\u00f5es Pr\u00e9-Gera\u00e7\u00e3o","text":"<ul> <li>Valida\u00e7\u00e3o de dados obrigat\u00f3rios do emitente (CNPJ, endere\u00e7o, IE, munic\u00edpio)</li> <li>Valida\u00e7\u00e3o do documento (tipo, modelo, situa\u00e7\u00e3o, dados gerais)</li> <li>Valida\u00e7\u00e3o de endere\u00e7os (entrega, retirada)</li> <li>Valida\u00e7\u00e3o de itens (CFOP, CST, NCM, unidades)</li> <li>Valida\u00e7\u00e3o de ve\u00edculos e transportador</li> <li>Valida\u00e7\u00e3o de documentos referenciados</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#3-geracao-da-estrutura-xml","title":"3. Gera\u00e7\u00e3o da Estrutura XML","text":"<ul> <li>Cria\u00e7\u00e3o do elemento raiz <code>NFe</code> e <code>infNFe</code></li> <li>Composi\u00e7\u00e3o da tag <code>ide</code> (identifica\u00e7\u00e3o)</li> <li>Composi\u00e7\u00e3o da tag <code>emit</code> (emitente)</li> <li>Composi\u00e7\u00e3o da tag <code>dest</code> (destinat\u00e1rio)</li> <li>Composi\u00e7\u00e3o da tag <code>det</code> (itens) com:</li> <li><code>prod</code> (dados do produto)</li> <li><code>imposto</code> (tributos)</li> <li><code>DI</code> (declara\u00e7\u00e3o de importa\u00e7\u00e3o)</li> <li><code>rastro</code> (rastreabilidade)</li> <li><code>comb</code> (combust\u00edveis)</li> <li>Composi\u00e7\u00e3o da tag <code>total</code> (valores totais)</li> <li>Composi\u00e7\u00e3o da tag <code>transp</code> (transporte)</li> <li>Composi\u00e7\u00e3o da tag <code>cobr</code> (cobran\u00e7a)</li> <li>Composi\u00e7\u00e3o da tag <code>pag</code> (pagamento)</li> <li>Composi\u00e7\u00e3o da tag <code>infRespTec</code> (respons\u00e1vel t\u00e9cnico)</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#4-calculos-e-formatacoes","title":"4. C\u00e1lculos e Formata\u00e7\u00f5es","text":"<ul> <li>Gera\u00e7\u00e3o da chave de acesso</li> <li>C\u00e1lculo do c\u00f3digo num\u00e9rico (cNF)</li> <li>Formata\u00e7\u00e3o de valores monet\u00e1rios e quantidades</li> <li>Convers\u00e3o de datas para padr\u00e3o UTC</li> <li>Formata\u00e7\u00e3o de IE, CNPJ, CPF</li> <li>Aplica\u00e7\u00e3o de m\u00e1scaras e limites de campos</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#5-validacoes-finais-e-saida","title":"5. Valida\u00e7\u00f5es Finais e Sa\u00edda","text":"<ul> <li>Valida\u00e7\u00e3o de consist\u00eancia dos dados gerados</li> <li>Gera\u00e7\u00e3o do XML como string</li> <li>Retorno da chave da NFe e do XML gerado</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#validacao-de-dados-do-emitente","title":"Valida\u00e7\u00e3o de Dados do Emitente","text":"<ul> <li>Munic\u00edpio e UF obrigat\u00f3rios</li> <li>IE obrigat\u00f3ria para opera\u00e7\u00f5es internas</li> <li>Endere\u00e7o completo (logradouro, n\u00famero, bairro, CEP)</li> <li>Raz\u00e3o social e nome fantasia preenchidos</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#validacao-de-itens","title":"Valida\u00e7\u00e3o de Itens","text":"<ul> <li>CFOP obrigat\u00f3rio por item</li> <li>CST ICMS obrigat\u00f3rio (exceto para Simples Nacional com CSOSN)</li> <li>CST PIS/COFINS obrigat\u00f3rios</li> <li>Unidades comercial e tribut\u00e1ria preenchidas</li> <li>NCM v\u00e1lido para produtos</li> <li>C\u00f3digo GTIN ou \u201cSEM GTIN\u201d</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#regras-de-impostos","title":"Regras de Impostos","text":"<ul> <li>ICMS: conforme CST (00, 10, 20, 30, 40, 41, 50, 51, 60, 70, 90)</li> <li>ICMS ST: para opera\u00e7\u00f5es com substitui\u00e7\u00e3o tribut\u00e1ria</li> <li>ICMS Simples Nacional: uso de CSOSN (101, 102, 103, 201, 202, 203, 300, 400, 500, 900)</li> <li>IPI: apenas se houver base de c\u00e1lculo</li> <li>PIS/COFINS: conforme CST espec\u00edfico</li> <li>ISS: para servi\u00e7os (tipo de produto 2 ou 3)</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#regras-de-transporte","title":"Regras de Transporte","text":"<ul> <li>Ve\u00edculo obrigat\u00f3rio para opera\u00e7\u00f5es internas</li> <li>Dados do transportador (CNPJ/CPF, nome, IE)</li> <li>Volumes (quantidade, esp\u00e9cie, marca, peso)</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#regras-de-pagamento","title":"Regras de Pagamento","text":"<ul> <li>Formas de pagamento conforme cadastro (Abf40)</li> <li>Indica\u00e7\u00e3o de pagamento \u00e0 vista ou a prazo</li> <li>Parcelamento registrado no financeiro (Eaa0113)</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#regras-de-contingencia","title":"Regras de Conting\u00eancia","text":"<ul> <li>Emiss\u00e3o normal (formaEmis = 1)</li> <li>Emiss\u00e3o em conting\u00eancia (formaEmis = 2) com data, hora e justificativa</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":"M\u00e9todo Descri\u00e7\u00e3o <code>executar()</code> M\u00e9todo principal que orquestra toda a gera\u00e7\u00e3o do XML <code>validarDadosDaNFe()</code> Realiza valida\u00e7\u00f5es abrangentes antes da gera\u00e7\u00e3o <code>emitente()</code> Comp\u00f5e a tag do emitente <code>destinatario()</code> Comp\u00f5e a tag do destinat\u00e1rio <code>item()</code> Processa todos os itens do documento <code>comporFilhosDocumento()</code> Carrega dados relacionados do documento <code>buscarItensDoDocumento()</code> Busca itens do documento ordenados <code>buscarFinanceiroPorDocumento()</code> Busca parcelas do documento <code>buscarFormasDePagamentoPorDocumento()</code> Busca formas de pagamento <code>verificarFormaPgto()</code> Define se pagamento \u00e9 \u00e0 vista ou a prazo"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":""},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#xml-gerado","title":"XML Gerado","text":"<ul> <li>Estrutura completa da NFe no padr\u00e3o 4.00</li> <li>Tags obrigat\u00f3rias e condicionais preenchidas</li> <li>Codifica\u00e7\u00e3o UTF-8</li> <li>Caracteres especiais convertidos (ex: &amp;, &lt;, &gt;)</li> </ul>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#parametros-de-retorno","title":"Par\u00e2metros de Retorno","text":"Campo Tipo Descri\u00e7\u00e3o chaveNfe String Chave de acesso da NFe (44 d\u00edgitos) dados String Conte\u00fado XML da NFe"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#observacoes-tecnicas","title":"\ud83e\udde9 Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Layout: 4.00</li> <li>Namespace: <code>http://www.portalfiscal.inf.br/nfe</code></li> <li>Ambiente: Produ\u00e7\u00e3o ou Homologa\u00e7\u00e3o conforme par\u00e2metro <code>NFeDataProducao</code></li> <li>Forma de Emiss\u00e3o: Normal (1) ou Conting\u00eancia (2)</li> <li>Vers\u00e3o do Processo: <code>SAM4_[vers\u00e3o]</code></li> </ul>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#validacoes-criticas","title":"\u2705 Valida\u00e7\u00f5es Cr\u00edticas","text":"<ol> <li>Emitente sem munic\u00edpio ou UF</li> <li>Item sem CFOP ou CST</li> <li>Documento sem tipo ou modelo</li> <li>Endere\u00e7o de entrega incompleto (para modelo 55)</li> <li>Chave de acesso inv\u00e1lida</li> <li>PCD n\u00e3o encontrado</li> <li>Data de emiss\u00e3o futura</li> <li>Valores totais inconsistentes</li> </ol>"},{"location":"MITRA/formulas/srf/SRF_GerarXMLNfe/#arquivo-relacionado","title":"\ud83d\udcc1 Arquivo Relacionado","text":"<p>SRF_GerarXMLNfe.groovy \u00daltima altera\u00e7\u00e3o: 09/12/2025 16:26 Autor: NAGYLA</p> <p>Nota: Esta documenta\u00e7\u00e3o refere-se \u00e0 vers\u00e3o atual do c\u00f3digo e est\u00e1 alinhada com as regras fiscais vigentes em 2025. Em caso de altera\u00e7\u00f5es na legisla\u00e7\u00e3o, a f\u00f3rmula deve ser revisada e atualizada conforme necess\u00e1rio.</p>"},{"location":"STREMA/formulas/cas/CAS_ImportarFCIEab01011/","title":"CAS_ImportarFCIEab01011.md","text":""},{"location":"STREMA/formulas/cas/CAS_ImportarFCIEab01011/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de importa\u00e7\u00e3o de dados FCI (Ficha de Conte\u00fado de Importa\u00e7\u00e3o) para a tabela EAB01011 no m\u00f3dulo CAS (Controle Aduaneiro e Sped), processando arquivos Excel com informa\u00e7\u00f5es de c\u00e1lculos aduaneiros.</p>"},{"location":"STREMA/formulas/cas/CAS_ImportarFCIEab01011/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar a importa\u00e7\u00e3o em massa de dados de c\u00e1lculos aduaneiros a partir de planilhas Excel, inserindo os registros diretamente na tabela de itens de c\u00e1lculo FCI.</p>"},{"location":"STREMA/formulas/cas/CAS_ImportarFCIEab01011/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Controladoria Aduaneira</li> <li>Gest\u00e3o de Importa\u00e7\u00e3o</li> </ul>"},{"location":"STREMA/formulas/cas/CAS_ImportarFCIEab01011/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - F\u00f3rmula <code>CAS_ImportarFCIEab01011</code> - Importa\u00e7\u00e3o de dados FCI</p> <p>Localiza\u00e7\u00e3o: <code>strema/formulas/cas/</code></p>"},{"location":"STREMA/formulas/cas/CAS_ImportarFCIEab01011/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAB01011</code> - Itens de c\u00e1lculo FCI - <code>EAB0101</code> - Cabe\u00e7alho de c\u00e1lculo FCI</p> <p>Entidades Envolvidas: - <code>Eab0101</code> - Cabe\u00e7alho do c\u00e1lculo FCI - <code>Eab01011</code> - Itens do c\u00e1lculo FCI</p>"},{"location":"STREMA/formulas/cas/CAS_ImportarFCIEab01011/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o arquivo MultipartFile Sim Arquivo Excel (.xlsx) com dados para importa\u00e7\u00e3o"},{"location":"STREMA/formulas/cas/CAS_ImportarFCIEab01011/#saidas-do-processo","title":"\ud83d\udccb Sa\u00eddas do Processo","text":"Campo Descri\u00e7\u00e3o Tipo (nenhuma sa\u00edda expl\u00edcita) Registros inseridos na tabela EAB01011 Opera\u00e7\u00e3o de banco"},{"location":"STREMA/formulas/cas/CAS_ImportarFCIEab01011/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Leitura do Arquivo</li> <li>Obt\u00e9m arquivo Excel do par\u00e2metro</li> <li>Cria workbook a partir do InputStream</li> <li> <p>Seleciona primeira planilha (sheet) para processamento</p> </li> <li> <p>Processamento Linha por Linha</p> </li> <li>Itera sobre todas as linhas da planilha</li> <li>Ignora cabe\u00e7alho (linha 0)</li> <li> <p>Processa apenas linhas com ID v\u00e1lido na primeira coluna</p> </li> <li> <p>Valida\u00e7\u00e3o de Dados</p> </li> <li>Verifica exist\u00eancia do registro EAB0101 correspondente</li> <li>Converte valores das c\u00e9lulas para tipos apropriados</li> <li> <p>Valida dados num\u00e9ricos obrigat\u00f3rios</p> </li> <li> <p>Constru\u00e7\u00e3o do SQL Din\u00e2mico</p> </li> <li>Monta instru\u00e7\u00e3o INSERT otimizada com m\u00faltiplos VALUES</li> <li>Utiliza placeholders (?) para preven\u00e7\u00e3o de SQL injection</li> <li> <p>Agrupa todos os registros em uma \u00fanica execu\u00e7\u00e3o</p> </li> <li> <p>Execu\u00e7\u00e3o em Lote</p> </li> <li>Prepara statement com par\u00e2metros</li> <li>Executa inser\u00e7\u00e3o em massa</li> <li>Utiliza sequence para gera\u00e7\u00e3o de IDs</li> </ol>"},{"location":"STREMA/formulas/cas/CAS_ImportarFCIEab01011/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/cas/CAS_ImportarFCIEab01011/#estrutura-do-arquivo-excel","title":"Estrutura do Arquivo Excel","text":"Coluna Tipo Descri\u00e7\u00e3o Obrigat\u00f3rio 0 Long ID do c\u00e1lculo FCI (EAB0101) Sim 1 Long ID do item Sim 2 BigDecimal Quantidade de composi\u00e7\u00e3o Sim 3 BigDecimal Quantidade Sim 4 BigDecimal Valor Sim 5 BigDecimal Valor por unidade de medida Sim"},{"location":"STREMA/formulas/cas/CAS_ImportarFCIEab01011/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Registro EAB0101 deve existir no banco</li> <li>C\u00e9lulas num\u00e9ricas n\u00e3o podem estar vazias</li> <li>Apenas processa linhas com ID na primeira coluna</li> <li>Ignora linhas completamente vazias</li> </ul>"},{"location":"STREMA/formulas/cas/CAS_ImportarFCIEab01011/#estrutura-do-insert","title":"Estrutura do INSERT","text":"<p>```sql INSERT INTO eab01011  (eab01011id, eab01011calc, eab01011item, eab01011qtdComp, eab01011qtde, eab01011valor, eab01011vmu) VALUES (nextval('default_sequence'), ?, ?, ?, ?, ?, ?), (nextval('default_sequence'), ?, ?, ?, ?, ?, ?), ...</p>"},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/","title":"SCE_ImportarItensLctosXlsx.md","text":""},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de importa\u00e7\u00e3o de itens para lan\u00e7amentos do SCE via arquivo Excel (XLSX) para a Linhasita, permitindo carga em lote de itens com suas quantidades e valores.</p>"},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar o processo de importa\u00e7\u00e3o de itens para lan\u00e7amentos cont\u00e1beis atrav\u00e9s de arquivos Excel, validando e processando os dados antes da inser\u00e7\u00e3o no sistema.</p>"},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Cont\u00e1bil</li> <li>Almoxarifado/Estoque</li> <li>Financeiro</li> <li>Controladoria</li> </ul>"},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - F\u00f3rmula <code>SCE_ImportarItensLctosXlsx</code> - Processamento de importa\u00e7\u00e3o Excel</p> <p>Localiza\u00e7\u00e3o: <code>strema/formulas/sce/</code></p>"},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>ABM01</code> - Cadastro de itens - <code>ABE4001</code> - Pre\u00e7os de itens - <code>ABA20</code> - Reposit\u00f3rio de dados (avisos)</p> <p>Entidades Envolvidas: - <code>Abm01</code> - Itens - <code>Abe4001</code> - Pre\u00e7os - <code>ItemSCEDto</code> - DTO para transfer\u00eancia de itens</p>"},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o arquivo MultipartFile Sim Arquivo Excel com dados dos itens"},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#estrutura-do-arquivo-excel","title":"\ud83d\udccb Estrutura do Arquivo Excel","text":"Coluna Descri\u00e7\u00e3o Tipo Obrigat\u00f3rio 0 Tipo do item Integer Sim 1 C\u00f3digo do item String Sim 4 Quantidade BigDecimal N\u00e3o"},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o Inicial</li> <li>Recebe arquivo Excel multipart</li> <li> <p>Abre a primeira planilha do workbook</p> </li> <li> <p>Processamento Linha a Linha</p> </li> <li>Ignora cabe\u00e7alho (linha 0)</li> <li>Processa a partir da linha 1</li> <li> <p>Valida c\u00e9lulas obrigat\u00f3rias</p> </li> <li> <p>Busca e Valida\u00e7\u00e3o de Itens</p> </li> <li>Localiza item por tipo e c\u00f3digo</li> <li>Verifica exist\u00eancia no cadastro</li> <li> <p>Confirma configura\u00e7\u00e3o de estoque</p> </li> <li> <p>Obten\u00e7\u00e3o de Valores</p> </li> <li>Recupera quantidade da planilha</li> <li>Busca pre\u00e7o unit\u00e1rio do item</li> <li> <p>Prepara DTO para transfer\u00eancia</p> </li> <li> <p>Tratamento de Erros</p> </li> <li>Coleta mensagens de erro</li> <li>Registra itens n\u00e3o encontrados</li> <li>Mant\u00e9m processamento mesmo com falhas</li> </ol>"},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Item deve existir no cadastro (ABM01)</li> <li>Item deve ter configura\u00e7\u00e3o de estoque</li> <li>C\u00e9lulas de tipo e c\u00f3digo s\u00e3o obrigat\u00f3rias</li> <li>Quantidade opcional (default 0)</li> </ul>"},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#processamento","title":"Processamento","text":"<ul> <li>Apenas primeira planilha \u00e9 processada</li> <li>Linha vazia na coluna 0 encerra processamento</li> <li>Continua processamento mesmo com erros parciais</li> <li>Coleta todas as mensagens de erro</li> </ul>"},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#dados-obtidos","title":"Dados Obtidos","text":"<ul> <li>Quantidade: Da planilha Excel</li> <li>Valor Unit\u00e1rio: Do cadastro de pre\u00e7os (ABE4001)</li> <li>Lote/S\u00e9rie: Sempre nulos para importa\u00e7\u00e3o</li> </ul>"},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#saidas-geradas","title":"\ud83c\udfa8 Sa\u00eddas Geradas","text":"Sa\u00edda Descri\u00e7\u00e3o Tipo itensLctos Lista de itens processados List"},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>Apache POI</code> - Manipula\u00e7\u00e3o de arquivos Excel - <code>multiorm</code> - Persist\u00eancia e consultas - <code>spring-web</code> - Upload de arquivos multipart</p> <p>Estruturas de Dados: - <code>ItemSCEDto</code> - Transporte de dados dos itens - <code>TableMap</code> - Armazenamento de dados JSON</p>"},{"location":"STREMA/formulas/sce/SCE_ImportarItensLctosXlsx/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Suporte a arquivos XLSX (Excel moderno)</li> <li>Processamento ass\u00edncrono e tolerante a falhas</li> <li>Valida\u00e7\u00e3o em tempo real durante importa\u00e7\u00e3o</li> <li>Mensagens de erro detalhadas por item</li> <li>Integra\u00e7\u00e3o com DTO padr\u00e3o do SCE</li> <li>Busca otimizada de itens com joins</li> <li>Tratamento de transa\u00e7\u00f5es para persist\u00eancia</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/","title":"SCF_LayoutBancoItauRetorno_CNAB_400 - Processamento de Retorno Banc\u00e1rio Ita\u00fa","text":""},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Classe respons\u00e1vel pelo processamento de arquivos de retorno banc\u00e1rio no layout CNAB 400 do Banco Ita\u00fa, realizando a concilia\u00e7\u00e3o autom\u00e1tica de documentos financeiros com as ocorr\u00eancias informadas pelo banco.</p>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar o processo de concilia\u00e7\u00e3o banc\u00e1ria, validando e processando retornos de cobran\u00e7a, identificando inconsist\u00eancias e aplicando liquida\u00e7\u00f5es autom\u00e1ticas nos documentos do sistema.</p>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Financeiro</li> <li>Tesouraria</li> <li>Contabilidade</li> <li>Backoffice banc\u00e1rio</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o registros TextFileLeitura Sim Arquivo de retorno banc\u00e1rio CNAB 400"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#estrutura-do-arquivo-cnab-400","title":"\ud83d\udccb Estrutura do Arquivo CNAB 400","text":""},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#layout-do-registro-detalhe-tipo-1","title":"Layout do Registro Detalhe (Tipo 1):","text":"Posi\u00e7\u00e3o Tamanho Descri\u00e7\u00e3o 0-1 1 Tipo registro (1) 37-62 25 Identifica\u00e7\u00e3o do documento 108-110 2 C\u00f3digo da ocorr\u00eancia 152-165 13 Valor do documento (com 2 decimais) 240-253 13 Valor do desconto 253-266 13 Valor l\u00edquido 266-279 13 Valor da multa/juros 295-301 6 Data pagamento (DDMMAA)"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#1-leitura-do-arquivo","title":"1. Leitura do Arquivo","text":"<ul> <li>Ignora header (primeira linha)</li> <li>Processa apenas registros do tipo 1 (detalhe)</li> <li>Itera linha por linha do arquivo</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#2-validacao-do-documento","title":"2. Valida\u00e7\u00e3o do Documento","text":"<ul> <li>Extrai ID do documento (posi\u00e7\u00f5es 37-62)</li> <li>Remove zeros \u00e0 esquerda do ID</li> <li>Busca documento no sistema por ID ou campo customizado</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#3-validacoes-de-negocio","title":"3. Valida\u00e7\u00f5es de Neg\u00f3cio","text":"<ul> <li>Verifica se documento j\u00e1 foi quitado</li> <li>Compara valores do documento com retorno banc\u00e1rio</li> <li>Valida c\u00f3digo de ocorr\u00eancia existente</li> <li>Verifica presen\u00e7a de data de pagamento</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#4-processamento-de-ocorrencias","title":"4. Processamento de Ocorr\u00eancias","text":"<ul> <li>Identifica tipo de ocorr\u00eancia (02, 03, 04, 06, 09, 29)</li> <li>Mapeia para PLF (Parametro e Lan\u00e7amento Fiscal) correspondente</li> <li>Aplica liquida\u00e7\u00e3o para ocorr\u00eancia \"06\" (Liquida\u00e7\u00e3o normal)</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#5-atualizacao-de-dados","title":"5. Atualiza\u00e7\u00e3o de Dados","text":"<ul> <li>Define data de pagamento</li> <li>Calcula valor l\u00edquido</li> <li>Registra juros e descontos no JSON do documento</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#validacoes-de-documento","title":"Valida\u00e7\u00f5es de Documento:","text":"<ul> <li>Documento n\u00e3o encontrado: Gera inconsist\u00eancia se ID n\u00e3o existir</li> <li>Documento j\u00e1 quitado: Impede processamento duplicado</li> <li>Valor divergente: Compara valor do documento com retorno (exceto para R$ 0,01)</li> <li>Ocorr\u00eancia inv\u00e1lida: Verifica se c\u00f3digo existe no mapeamento</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#codigos-de-ocorrencia-suportados","title":"C\u00f3digos de Ocorr\u00eancia Suportados:","text":"C\u00f3digo Descri\u00e7\u00e3o A\u00e7\u00e3o 02 Entrada confirmada Informa\u00e7\u00e3o 03 Entrada rejeitada Informa\u00e7\u00e3o 04 Altera\u00e7\u00e3o de Dados Informa\u00e7\u00e3o 06 Liquida\u00e7\u00e3o normal Aplica baixa 09 Baixa Simples Informa\u00e7\u00e3o 29 Tarifa manuten\u00e7\u00e3o Boletos Vencidos Informa\u00e7\u00e3o"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#mapeamento-plf","title":"Mapeamento PLF:","text":"<ul> <li>06 \u2192 C\u00f3digo PLF \"201\" (Liquida\u00e7\u00e3o normal)</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#tratamento-de-valores","title":"Tratamento de Valores:","text":"<ul> <li>Valores monet\u00e1rios divididos por 100 (2 casas decimais)</li> <li>Data no formato DDMMAA convertida para LocalDate</li> <li>Campos num\u00e9ricos com zeros s\u00e3o considerados vazios</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#saidas-geradas","title":"\ud83c\udfa8 Sa\u00eddas Geradas","text":"Campo Tipo Descri\u00e7\u00e3o tmList List Lista de documentos processados daa01 Daa01 Documento financeiro abf20id Long ID do PLF para liquida\u00e7\u00e3o ocorrencia String Descri\u00e7\u00e3o da ocorr\u00eancia inconsistencias List Lista de erros encontrados"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":""},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#bibliotecas","title":"Bibliotecas:","text":"<ul> <li><code>TextFileLeitura</code> - Leitura de arquivos texto</li> <li><code>SCFService</code> - Servi\u00e7o do m\u00f3dulo financeiro</li> <li><code>MultiORM</code> - Acesso a dados</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#entidades","title":"Entidades:","text":"<ul> <li><code>Daa01</code> - Documentos financeiros</li> <li><code>Abf20</code> - PLF (Parametro e Lan\u00e7amento Fiscal)</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#configuracoes","title":"Configura\u00e7\u00f5es:","text":"<ul> <li>Mapeamento fixo de ocorr\u00eancias banc\u00e1rias</li> <li>C\u00f3digos PLF pr\u00e9-definidos</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#busca-de-documentos","title":"Busca de Documentos:","text":"<ul> <li>Primeiro busca por ID direto (daa01id)</li> <li>Fallback para campo customizado (id_sam3)</li> <li>Join com central de documentos para dados complementares</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#tratamento-de-erros","title":"Tratamento de Erros:","text":"<ul> <li>Continua processamento mesmo com documentos inv\u00e1lidos</li> <li>Coleta todas as inconsist\u00eancias por documento</li> <li>Retorna lista completa para decis\u00e3o manual</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#performance","title":"Performance:","text":"<ul> <li>Processamento linha a linha do arquivo</li> <li>Consultas otimizadas com criteria</li> <li>Uso de TableMap para dados tempor\u00e1rios</li> </ul>"},{"location":"STREMA/formulas/scf/SCF_LayoutBancoItauRetorno_CNAB_400/#seguranca","title":"Seguran\u00e7a:","text":"<ul> <li>Valida\u00e7\u00e3o rigorosa de dados antes do processamento</li> <li>Preven\u00e7\u00e3o de dupla liquida\u00e7\u00e3o</li> <li>Verifica\u00e7\u00e3o de consist\u00eancia de valores</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/","title":"SCV_OrcamentoItem - C\u00e1lculo de Itens de Or\u00e7amento","text":""},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Classe respons\u00e1vel pelo c\u00e1lculo de valores, impostos e totais para itens de or\u00e7amento, considerando configura\u00e7\u00f5es espec\u00edficas por empresa, entidade, estado e munic\u00edpio.</p>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Realizar c\u00e1lculos completos de pre\u00e7os, impostos e totais para itens de or\u00e7amento, incluindo ICMS, IPI, PIS, COFINS, descontos e valores comerciais, com base nas configura\u00e7\u00f5es fiscais e comerciais do sistema.</p>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Comercial</li> <li>Vendedores</li> <li>Departamento Fiscal</li> <li>Gestores de Or\u00e7amentos</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o cbe1001 Cbe1001 Sim Item do or\u00e7amento a ser calculado procInvoc String N\u00e3o Processo de invoca\u00e7\u00e3o (CAS0240, CAS0242)"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#estrutura-de-dados-principais","title":"\ud83d\udccb Estrutura de Dados Principais","text":""},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#entidades-envolvidas","title":"Entidades Envolvidas:","text":"<ul> <li>Cbe1001 - Item do or\u00e7amento</li> <li>Cbe10 - Cabe\u00e7alho do or\u00e7amento</li> <li>Abe40 - Tabela de pre\u00e7o</li> <li>Abe4001 - Item da tabela de pre\u00e7o</li> <li>Abb01 - Central de documento</li> <li>Abe01 - Entidade (cliente)</li> <li>Abe0101 - Endere\u00e7o da entidade</li> <li>Abm01 - Item cadastral</li> <li>Abm0101 - Configura\u00e7\u00e3o do item por empresa</li> <li>Abm10 - Valores do item</li> <li>Abm12 - Dados fiscais do item</li> <li>Abm13 - Dados comerciais do item</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#campos-calculados","title":"Campos Calculados:","text":"<ul> <li>Pre\u00e7o de custo</li> <li>Totais do item</li> <li>Peso bruto e l\u00edquido</li> <li>Descontos</li> <li>Base de c\u00e1lculo e valores de impostos (ICMS, IPI, PIS, COFINS)</li> <li>Total do documento</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#1-inicializacao-e-validacao","title":"1. Inicializa\u00e7\u00e3o e Valida\u00e7\u00e3o","text":"<ul> <li>Carrega dados do item do or\u00e7amento</li> <li>Verifica processo de invoca\u00e7\u00e3o</li> <li>Valida exist\u00eancia do item</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#2-carregamento-de-dados-relacionados","title":"2. Carregamento de Dados Relacionados","text":"<ul> <li>Or\u00e7amento (Cbe10)</li> <li>Tabela de pre\u00e7o (Abe40)</li> <li>Entidade e endere\u00e7o (Abe01, Abe0101)</li> <li>Configura\u00e7\u00f5es do item (Abm0101, Abm12, Abm13)</li> <li>Dados geogr\u00e1ficos (munic\u00edpio, UF)</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#3-calculo-do-preco-de-custo","title":"3. C\u00e1lculo do Pre\u00e7o de Custo","text":"<ul> <li>Busca pre\u00e7o na tabela de pre\u00e7o</li> <li>Para itens compostos, calcula valor da composi\u00e7\u00e3o</li> <li>Considera m\u00e3o de obra e itens componentes</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#4-calculos-comerciais","title":"4. C\u00e1lculos Comerciais","text":"<ul> <li>Total do item (quantidade \u00d7 unit\u00e1rio)</li> <li>Convers\u00e3o para volume</li> <li>C\u00e1lculo de pesos</li> <li>Aplica\u00e7\u00e3o de descontos</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#5-calculos-fiscais","title":"5. C\u00e1lculos Fiscais","text":"<ul> <li>IPI: Base de c\u00e1lculo e valor</li> <li>ICMS: Base, al\u00edquota e valor</li> <li>PIS: Base, al\u00edquota e valor</li> <li>COFINS: Base, al\u00edquota e valor</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#6-consolidacao-de-totais","title":"6. Consolida\u00e7\u00e3o de Totais","text":"<ul> <li>Total do documento</li> <li>Total financeiro</li> <li>Atualiza\u00e7\u00e3o do JSON do item</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#hierarquia-de-aliquotas-icms","title":"Hierarquia de Al\u00edquotas ICMS:","text":"<ol> <li>Entidade espec\u00edfica (Abm1003)</li> <li>Munic\u00edpio (Abm1002)</li> <li>Estado (Abm1001)</li> <li>Valores padr\u00e3o do item (Abm10)</li> <li>Configura\u00e7\u00e3o do item (Abm0101)</li> <li>Regras por UF (interior \u00d7 interestadual)</li> </ol>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#calculo-de-preco-para-itens-compostos","title":"C\u00e1lculo de Pre\u00e7o para Itens Compostos:","text":"<ul> <li>Item principal (seq = 1) tem valor base</li> <li>Itens do tipo servi\u00e7o representam % de m\u00e3o de obra</li> <li>Demais itens somam ao custo</li> <li>Total = custo + item principal + (item principal \u00d7 % m\u00e3o de obra)</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#base-de-calculo-de-impostos","title":"Base de C\u00e1lculo de Impostos:","text":"<ul> <li>IPI: Total + frete + seguro + outras despesas</li> <li>ICMS: Total + frete + seguro + outras despesas - desconto</li> <li>PIS/COFINS: Total + frete + seguro + outras despesas - ICMS</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#regras-especificas-por-cst","title":"Regras Espec\u00edficas por CST:","text":"<ul> <li>CST 100, 300, 800: Al\u00edquota interestadual de 4%</li> <li>Demais CSTs: Al\u00edquota de sa\u00edda do estado</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#validacoes-criticas","title":"Valida\u00e7\u00f5es Cr\u00edticas:","text":"<ul> <li>Munic\u00edpio da entidade obrigat\u00f3rio</li> <li>Configura\u00e7\u00e3o fiscal do item obrigat\u00f3ria</li> <li>Tipo fiscal do item obrigat\u00f3rio</li> <li>Composi\u00e7\u00e3o de produto \u00fanica por item</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#saidas-geradas","title":"\ud83c\udfa8 Sa\u00eddas Geradas","text":"Campo Tipo Descri\u00e7\u00e3o preco_custo BigDecimal Pre\u00e7o de custo do item vlr_vlme BigDecimal Valor do volume vlr_pl BigDecimal Valor do peso l\u00edquido vlr_pb BigDecimal Valor do peso bruto ipi_bc BigDecimal Base de c\u00e1lculo do IPI ipi_aliq BigDecimal Al\u00edquota do IPI ipi_ipi BigDecimal Valor do IPI icm_bc BigDecimal Base de c\u00e1lculo do ICMS icm_aliq BigDecimal Al\u00edquota do ICMS icm_icm BigDecimal Valor do ICMS pis_bc BigDecimal Base de c\u00e1lculo do PIS pis_aliq BigDecimal Al\u00edquota do PIS pis_pis BigDecimal Valor do PIS cofins_bc BigDecimal Base de c\u00e1lculo do COFINS cofins_aliq BigDecimal Al\u00edquota do COFINS cofins_cofins BigDecimal Valor do COFINS"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":""},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#bibliotecas","title":"Bibliotecas:","text":"<ul> <li><code>br.com.multiorm</code> - Acesso a dados</li> <li><code>br.com.multitec.utils</code> - Utilit\u00e1rios e valida\u00e7\u00f5es</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#entidades-principais","title":"Entidades Principais:","text":"<ul> <li>Cbe1001 (Item do or\u00e7amento)</li> <li>Abm01 (Item cadastral)</li> <li>Abe40 (Tabela de pre\u00e7o)</li> <li>Abe01 (Entidade)</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#configuracoes","title":"Configura\u00e7\u00f5es:","text":"<ul> <li>Campos livres (JSON) das entidades</li> <li>Par\u00e2metros de c\u00e1lculo fiscal</li> <li>Hierarquia de valores por localidade</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#tratamento-de-dados","title":"Tratamento de Dados:","text":"<ul> <li>Uso extensivo de TableMap para campos JSON</li> <li>Arredondamento para 2-4 casas decimais conforme necessidade</li> <li>Valida\u00e7\u00f5es com MultiValidationException</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#performance","title":"Performance:","text":"<ul> <li>Carregamento lazy de entidades relacionadas</li> <li>Consultas otimizadas para composi\u00e7\u00e3o de produtos</li> <li>Cache de configura\u00e7\u00f5es por item/empresa</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#hierarquia-de-configuracoes","title":"Hierarquia de Configura\u00e7\u00f5es:","text":"<ul> <li>Implementa fallback para valores n\u00e3o encontrados</li> <li>Considera especificidade (entidade &gt; munic\u00edpio &gt; estado &gt; padr\u00e3o)</li> <li>Suporte a regras interestaduais</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_OrcamentoItem/#casos-de-excecao","title":"Casos de Exce\u00e7\u00e3o:","text":"<ul> <li>Processos CAS0240 e CAS0242 s\u00e3o ignorados</li> <li>Itens sem configura\u00e7\u00e3o fiscal geram erro</li> <li>Munic\u00edpio obrigat\u00f3rio para entidade</li> <li>Composi\u00e7\u00e3o duplicada n\u00e3o permitida</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/","title":"SCV_Pre_Gravacao.md","text":""},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de valida\u00e7\u00e3o pr\u00e9-grava\u00e7\u00e3o para documentos do SCV (Sistema de Controle de Vendas) da Linhasita, realizando verifica\u00e7\u00f5es de cr\u00e9dito e consist\u00eancia antes da persist\u00eancia dos dados.</p>"},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Garantir a integridade e conformidade dos documentos de venda atrav\u00e9s de valida\u00e7\u00f5es financeiras e comerciais antes da grava\u00e7\u00e3o definitiva no sistema.</p>"},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Comercial</li> <li>Cr\u00e9dito e Cobran\u00e7a</li> <li>Faturamento</li> <li>Controladoria</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - F\u00f3rmula <code>SCV_Pre_Gravacao</code> - Valida\u00e7\u00e3o pr\u00e9-grava\u00e7\u00e3o</p> <p>Localiza\u00e7\u00e3o: <code>strema/formulas/scv/</code></p>"},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos fiscais - <code>ABE30</code> - Condi\u00e7\u00f5es de pagamento - <code>ABE01</code> - Entidades/Clientes - <code>DAA01</code> - T\u00edtulos a receber - <code>EAA0107</code> - Mensagens de inconsist\u00eancia</p> <p>Entidades Envolvidas: - <code>Eaa01</code> - Documentos fiscais - <code>Abe30</code> - Condi\u00e7\u00f5es de pagamento - <code>Abe01</code> - Entidades - <code>Daa01</code> - T\u00edtulos - <code>Eaa0107</code> - Inconsist\u00eancias</p>"},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01 Eaa01 Sim Documento a ser validado"},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#saidas-do-processo","title":"\ud83d\udccb Sa\u00eddas do Processo","text":"Campo Descri\u00e7\u00e3o Tipo gravar Indicador de grava\u00e7\u00e3o (0-N\u00e3o, 1-Sim) Integer eaa01 Documento com inconsist\u00eancias registradas Eaa01"},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o Inicial</li> <li>Obt\u00e9m documento fiscal (EAA01)</li> <li>Verifica exist\u00eancia de condi\u00e7\u00e3o de pagamento</li> <li> <p>Inicializa flags de controle</p> </li> <li> <p>Processamento por Tipo de Opera\u00e7\u00e3o</p> </li> <li>Aplica valida\u00e7\u00f5es apenas para opera\u00e7\u00e3o \"201\" (Venda)</li> <li> <p>Executa verifica\u00e7\u00f5es financeiras espec\u00edficas</p> </li> <li> <p>Valida\u00e7\u00f5es de Inconsist\u00eancia</p> </li> <li>T\u00edtulos a receber vencidos</li> <li>Limite de cr\u00e9dito excedido</li> <li> <p>Restri\u00e7\u00f5es financeiras da entidade</p> </li> <li> <p>Defini\u00e7\u00e3o de Bloqueio</p> </li> <li>Define se documento ser\u00e1 bloqueado</li> <li>Registra mensagens de inconsist\u00eancia</li> <li>Remove pol\u00edtica de uso do documento</li> </ol>"},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#validacoes-obrigatorias","title":"Valida\u00e7\u00f5es Obrigat\u00f3rias","text":"<ul> <li>Condi\u00e7\u00e3o de pagamento \u00e9 obrigat\u00f3ria</li> <li>Apenas opera\u00e7\u00e3o \"201\" (Venda) sofre valida\u00e7\u00f5es financeiras</li> <li>Documento deve ter classifica\u00e7\u00e3o de documento ativa</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#verificacoes-financeiras","title":"Verifica\u00e7\u00f5es Financeiras","text":"<p>T\u00edtulos Vencidos: - Soma valores de t\u00edtulos com vencimento anterior \u00e0 data atual - Bloqueia documento se existirem t\u00edtulos vencidos</p> <p>Limite de Cr\u00e9dito: - Calcula total financeiro em aberto - Soma t\u00edtulos a receber n\u00e3o quitados - Considera valor do documento atual (se novo) - Bloqueia se exceder limite cadastrado</p> <p>Restri\u00e7\u00f5es: - Verifica flag de restri\u00e7\u00e3o financeira no cadastro da entidade - Bloqueia documento se entidade possui restri\u00e7\u00e3o</p>"},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#comportamento-do-sistema","title":"Comportamento do Sistema","text":"<ul> <li>Documento \u00e9 bloqueado (<code>eaa01bloqueado = 1</code>) se houver inconsist\u00eancias</li> <li>Mensagens detalhadas s\u00e3o registradas em <code>EAA0107</code></li> <li>Pol\u00edtica de uso \u00e9 removida do documento</li> <li>Processamento continua mesmo com inconsist\u00eancias</li> </ul>"},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#inconsistencias-registradas","title":"\ud83c\udfa8 Inconsist\u00eancias Registradas","text":"Tipo Mensagem Identificador T\u00edtulos Vencidos \"T\u00edtulo a receber vencido: [valor]\" BLOQUEIO Limite Excedido \"Limite de cr\u00e9dito excedido...\" BLOQUEIO Sem Limite \"A entidade n\u00e3o possui limite de cr\u00e9dito\" BLOQUEIO Restri\u00e7\u00e3o \"A entidade possui restri\u00e7\u00e3o financeira\" BLOQUEIO"},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Persist\u00eancia e consultas - <code>multitec.utils</code> - Utilit\u00e1rios e cole\u00e7\u00f5es</p> <p>Consultas: - Soma de t\u00edtulos vencidos por entidade - Total financeiro de documentos em aberto - Total de t\u00edtulos a receber n\u00e3o quitados</p>"},{"location":"STREMA/formulas/scv/SCV_Pre_Gravacao/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Valida\u00e7\u00f5es aplicadas apenas para novos documentos/vendas</li> <li>Sistema tolerante a falhas (continua processamento)</li> <li>Mensagens de erro detalhadas e espec\u00edficas</li> <li>Integra\u00e7\u00e3o com sistema de bloqueio de documentos</li> <li>Remo\u00e7\u00e3o autom\u00e1tica de pol\u00edtica de uso</li> <li>Consultas otimizadas com joins</li> <li>Suporte a campos JSON para configura\u00e7\u00f5es flex\u00edveis</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/","title":"CAS_ImportarFCIEab01011 - Importa\u00e7\u00e3o de Ficha de Conte\u00fado de Importa\u00e7\u00e3o","text":""},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Classe respons\u00e1vel pela importa\u00e7\u00e3o de dados de Ficha de Conte\u00fado de Importa\u00e7\u00e3o (FCI) a partir de arquivos Excel (XLSX), realizando a inser\u00e7\u00e3o em lote na tabela <code>eab01011</code> do sistema.</p>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar o processo de importa\u00e7\u00e3o de dados de FCI, permitindo o carregamento em massa de informa\u00e7\u00f5es de c\u00e1lculo, itens, quantidades e valores atrav\u00e9s de planilhas Excel.</p>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Import/Export</li> <li>Contabilidade</li> <li>Administradores do sistema</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o arquivo MultipartFile Sim Arquivo Excel (.xlsx) com dados FCI"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#estrutura-de-dados","title":"\ud83d\udccb Estrutura de Dados","text":""},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#tabela-destino-eab01011","title":"Tabela Destino: <code>eab01011</code>","text":"Campo Tipo Descri\u00e7\u00e3o eab01011id Long ID \u00fanico do registro (sequencial) eab01011calc Long C\u00f3digo do c\u00e1lculo FCI eab01011item Long C\u00f3digo do item eab01011qtdComp BigDecimal Quantidade do componente eab01011qtde BigDecimal Quantidade eab01011valor BigDecimal Valor eab01011vmu BigDecimal Valor por unidade de medida"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#estrutura-do-arquivo-excel","title":"Estrutura do Arquivo Excel:","text":"Coluna Tipo Descri\u00e7\u00e3o Exemplo A Long C\u00f3digo do c\u00e1lculo FCI 1001 B Long C\u00f3digo do item 2050 C BigDecimal Quantidade do componente 2.5 D BigDecimal Quantidade 10.0 E BigDecimal Valor 150.75 F BigDecimal Valor por unidade 15.075"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#1-leitura-do-arquivo","title":"1. Leitura do Arquivo","text":"<ul> <li>Recebe arquivo Excel via MultipartFile</li> <li>Abre workbook e seleciona primeira planilha</li> <li>Itera sobre todas as linhas a partir da linha 1 (cabe\u00e7alho)</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#2-validacao-e-processamento","title":"2. Valida\u00e7\u00e3o e Processamento","text":"<ul> <li>Ignora linhas vazias na coluna A</li> <li>Valida exist\u00eancia do registro Eab0101</li> <li>Converte valores das c\u00e9lulas para tipos apropriados</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#3-construcao-do-sql","title":"3. Constru\u00e7\u00e3o do SQL","text":"<ul> <li>Monta instru\u00e7\u00e3o INSERT em lote</li> <li>Utiliza sequence para gera\u00e7\u00e3o de IDs</li> <li>Prepara statement com par\u00e2metros din\u00e2micos</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#4-execucao-em-lote","title":"4. Execu\u00e7\u00e3o em Lote","text":"<ul> <li>Preenche par\u00e2metros do PreparedStatement</li> <li>Executa inser\u00e7\u00e3o em massa</li> <li>Confirma transa\u00e7\u00e3o automaticamente</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#validacoes","title":"Valida\u00e7\u00f5es:","text":"<ul> <li>Linha vazia: Ignora se c\u00e9lula A estiver vazia</li> <li>Registro existente: Verifica se Eab0101 existe antes de importar</li> <li>Tipos de dados: Converte automaticamente para BigDecimal/Long</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#estrutura-do-arquivo","title":"Estrutura do Arquivo:","text":"<ul> <li>Cabe\u00e7alho: Linha 0 \u00e9 ignorada (considerada cabe\u00e7alho)</li> <li>Dados efetivos: Processa a partir da linha 1</li> <li>Formato num\u00e9rico: Todas as colunas de B a F devem ser num\u00e9ricas</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#processamento-em-lote","title":"Processamento em Lote:","text":"<ul> <li>Constru\u00e7\u00e3o incremental do SQL com m\u00faltiplos VALUES</li> <li>Uso de PreparedStatement para seguran\u00e7a e performance</li> <li>Commit autom\u00e1tico ao final da execu\u00e7\u00e3o</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#saidas-geradas","title":"\ud83c\udfa8 Sa\u00eddas Geradas","text":"Tipo Descri\u00e7\u00e3o Resultado Banco Inser\u00e7\u00e3o em <code>eab01011</code> Registros importados Sistema Transa\u00e7\u00e3o Commit autom\u00e1tico"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":""},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#bibliotecas","title":"Bibliotecas:","text":"<ul> <li><code>Apache POI</code> - Manipula\u00e7\u00e3o de arquivos Excel</li> <li><code>Spring Multipart</code> - Upload de arquivos</li> <li><code>MultiORM</code> - Acesso a dados e criteria</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#entidades","title":"Entidades:","text":"<ul> <li><code>Eab0101</code> - Entidade de valida\u00e7\u00e3o</li> <li><code>Eab01011</code> - Tabela de destino</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#recursos-do-sistema","title":"Recursos do Sistema:","text":"<ul> <li>Sequence: <code>default_sequence</code> para gera\u00e7\u00e3o de IDs</li> <li>Conex\u00e3o ativa com banco de dados</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#performance","title":"Performance:","text":"<ul> <li>Processamento em lote para melhor performance</li> <li>Uso de PreparedStatement para evitar SQL injection</li> <li>Stream processing do arquivo Excel</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#tratamento-de-erros","title":"Tratamento de Erros:","text":"<ul> <li>Valida\u00e7\u00e3o de exist\u00eancia do registro pai</li> <li>Convers\u00e3o segura de tipos de dados</li> <li>Continua processamento mesmo com linhas inv\u00e1lidas</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#seguranca","title":"Seguran\u00e7a:","text":"<ul> <li>PreparedStatement previne SQL injection</li> <li>Valida\u00e7\u00e3o de tipos antes da inser\u00e7\u00e3o</li> <li>Controle de transa\u00e7\u00f5es autom\u00e1tico</li> </ul>"},{"location":"STREMA/formulas/spp/CAS_ImportarFCIEab01011/#limitacoes","title":"Limita\u00e7\u00f5es:","text":"<ul> <li>Processa apenas primeira planilha do workbook</li> <li>Assume estrutura fixa de colunas</li> <li>Requer cabe\u00e7alho na primeira linha</li> </ul>"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/","title":"SPP_F8_SPP1001","text":""},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula F8 para consulta de ordens de produ\u00e7\u00e3o no sistema SPP (Sistema de Produ\u00e7\u00e3o e Planejamento). Implementa busca paginada com filtros din\u00e2micos para visualiza\u00e7\u00e3o de dados de produ\u00e7\u00e3o.</p>"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer interface de consulta r\u00e1pida (F8) para ordens de produ\u00e7\u00e3o, permitindo filtros personalizados e busca textual sobre dados de produ\u00e7\u00e3o.</p>"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Planejamento de Produ\u00e7\u00e3o</li> <li>Controle de Produ\u00e7\u00e3o</li> <li>PCP (Planejamento e Controle de Produ\u00e7\u00e3o)</li> <li>Supervisores de Produ\u00e7\u00e3o</li> </ul>"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#parametrosconfiguracoes","title":"\u2699\ufe0f Par\u00e2metros/Configura\u00e7\u00f5es","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis requisicao RequisicaoDoF8 Sim Objeto com par\u00e2metros da consulta F8 Pagina\u00e7\u00e3o, filtros e buscas"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#estrutura-de-dados","title":"\ud83d\udcca Estrutura de Dados","text":""},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#colunas-retornadas","title":"Colunas Retornadas","text":"Campo Descri\u00e7\u00e3o Tipo aah01codigo C\u00f3digo do tipo de documento String abb01num N\u00famero do documento Integer abb01data Data do documento Date bab01status Status da ordem de produ\u00e7\u00e3o String abp20bomCodigo C\u00f3digo da lista de materiais (BOM) String abm01codigo C\u00f3digo do item String abm01na N\u00famero de alternativo do item String bab01qt Quantidade da ordem BigDecimal abp10codigo C\u00f3digo do processo String abp10descr Descri\u00e7\u00e3o do processo String"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#tabelas-envolvidas","title":"Tabelas Envolvidas","text":"<ul> <li><code>bab01</code> - Ordens de produ\u00e7\u00e3o</li> <li><code>abb01</code> - Cabe\u00e7alho de documentos</li> <li><code>aah01</code> - Tipos de documento</li> <li><code>abp20</code> - Listas de materiais (BOM)</li> <li><code>abm01</code> - Itens (produtos)</li> <li><code>abp10</code> - Processos de produ\u00e7\u00e3o</li> </ul>"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Configura\u00e7\u00e3o das Colunas</li> <li>Define colunas que ser\u00e3o exibidas no resultado</li> <li> <p>Mapeia campos do SAM para colunas do F8</p> </li> <li> <p>Processamento de Filtros</p> </li> <li>Converte filtros da interface em cl\u00e1usulas WHERE</li> <li> <p>Adiciona par\u00e2metros para consulta segura</p> </li> <li> <p>Processamento de Buscas</p> </li> <li>Converte crit\u00e9rios de busca textual em cl\u00e1usulas OR</li> <li> <p>Combina m\u00faltiplos campos de busca</p> </li> <li> <p>Execu\u00e7\u00e3o da Consulta</p> </li> <li>Monta SQL final com pagina\u00e7\u00e3o</li> <li>Aplica filtros de seguran\u00e7a (obterWherePadrao)</li> <li> <p>Ordena por data e n\u00famero decrescente</p> </li> <li> <p>Retorno dos Dados</p> </li> <li>Estrutura resposta no formato F8</li> <li>Inclui metadados das colunas e dados paginados</li> </ol>"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#seguranca","title":"Seguran\u00e7a","text":"<ul> <li>Aplica <code>obterWherePadrao(\"bab01\")</code> para restringir acesso aos dados</li> <li>Utiliza consultas parametrizadas para prevenir SQL injection</li> </ul>"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#paginacao","title":"Pagina\u00e7\u00e3o","text":"<ul> <li>Suporta pagina\u00e7\u00e3o nativa do F8</li> <li>Mant\u00e9m ordena\u00e7\u00e3o consistente entre p\u00e1ginas</li> </ul>"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#filtros","title":"Filtros","text":"<ul> <li>Combina m\u00faltiplos filtros com operador AND</li> <li>Suporta filtros complexos com m\u00faltiplos par\u00e2metros</li> </ul>"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#buscas","title":"Buscas","text":"<ul> <li>Combina m\u00faltiplos crit\u00e9rios de busca com operador OR</li> <li>Permite busca textual em m\u00faltiplos campos</li> </ul>"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#saidasretornos","title":"\ud83c\udfa8 Sa\u00eddas/Retornos","text":"Tipo Descri\u00e7\u00e3o Estrutura RespostaDoF8 Dados paginados + metadados Lista de registros + defini\u00e7\u00e3o de colunas"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Entidades do Sistema: - <code>bab01</code> - Ordem de produ\u00e7\u00e3o - <code>abb01</code> - Cabe\u00e7alho do documento - <code>aah01</code> - Tipo de documento - <code>abp20</code> - Lista de materiais (BOM) - <code>abm01</code> - Item - <code>abp10</code> - Processo</p> <p>Framework: - <code>RequisicaoDoF8</code> - Par\u00e2metros da consulta - <code>RespostaDoF8</code> - Estrutura de retorno - <code>ColunaF8</code> - Defini\u00e7\u00e3o de colunas</p>"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#performance","title":"Performance","text":"<ul> <li>Utiliza pagina\u00e7\u00e3o nativa do banco de dados</li> <li>Aplica \u00edndices atrav\u00e9s de ordena\u00e7\u00e3o por data e n\u00famero</li> <li>Consulta otimizada com JOINs necess\u00e1rios apenas</li> </ul>"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#manutenibilidade","title":"Manutenibilidade","text":"<ul> <li>C\u00f3digo claro e estruturado</li> <li>F\u00e1cil adi\u00e7\u00e3o de novas colunas</li> <li>Tratamento gen\u00e9rico de filtros e buscas</li> </ul>"},{"location":"STREMA/formulas/spp/SPP_F8_SPP1001/#seguranca_1","title":"Seguran\u00e7a","text":"<ul> <li>Where padr\u00e3o aplicado automaticamente</li> <li>Par\u00e2metros tratados contra SQL injection</li> <li>Acesso restrito por permiss\u00f5es do sistema</li> </ul> <p>\u00daltima Atualiza\u00e7\u00e3o: 13/11/2025 Tipo de F\u00f3rmula: F8 (Consulta R\u00e1pida)</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/","title":"Documenta\u00e7\u00e3o de C\u00f3digos Fonte - Sistema Empresarial","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#sumario","title":"Sum\u00e1rio","text":"<ol> <li>CGS - Parcelamento (Equilibrio)</li> <li>SRF - Documento (Eltech)</li> <li>SRF - C\u00e1lculo de Item de Entrada por Importa\u00e7\u00e3o</li> <li>SCV - Pedidos por Item (Eltech)</li> <li>SCF - Boleto Banco do Brasil (Linhasita)</li> <li>SCF - Demonstrativo de Resultados do Exerc\u00edcio (DRE) - LCB</li> <li>CGS - Parcelamento (Eltech)</li> <li>SRF - C\u00e1lculo de Ficha de Conte\u00fado de Importa\u00e7\u00e3o (FCI)</li> </ol>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#1-cgs-parcelamento-equilibrio","title":"1. CGS - Parcelamento (Equilibrio)","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para c\u00e1lculo e gera\u00e7\u00e3o de parcelas de condi\u00e7\u00f5es de pagamento, considerando datas de vencimento, ajustes por dias da semana, feriados, valores m\u00ednimos por parcela e configura\u00e7\u00f5es espec\u00edficas do m\u00f3dulo Equilibrio.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente as parcelas de uma condi\u00e7\u00e3o de pagamento, aplicando regras de vencimento, descontos, juros, multas e valida\u00e7\u00f5es de valores m\u00ednimos por parcela.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Financeiro</li> <li>Faturamento</li> <li>Cr\u00e9dito e Cobran\u00e7a</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Abe30</code> - Condi\u00e7\u00f5es de pagamento - <code>Abe3001</code> - Parcelas da condi\u00e7\u00e3o de pagamento - <code>Abe3002</code> - Dias complementares (ajustes de vencimento) - <code>Eaa01</code> - Documentos fiscais - <code>Abb01</code> - Documentos da central (data de emiss\u00e3o)</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o dtBase LocalDate Sim Data base para c\u00e1lculo das parcelas abe30id Long Sim ID da condi\u00e7\u00e3o de pagamento valor BigDecimal Sim Valor total a ser parcelado eaa01 Eaa01 N\u00e3o Documento fiscal relacionado"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o dos par\u00e2metros obrigat\u00f3rios</li> <li>Carregamento da condi\u00e7\u00e3o de pagamento (Abe30)</li> <li>Defini\u00e7\u00e3o da data de emiss\u00e3o (do documento ou atual)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#2-calculo-dos-ajustes-de-data","title":"2. C\u00e1lculo dos Ajustes de Data","text":"<ul> <li>Aplica\u00e7\u00e3o de dias adicionais conforme dia da semana da data base</li> <li>C\u00e1lculo de vencimentos nominais para cada parcela</li> <li>Ajustes por vencimentos fixos e dias espec\u00edficos</li> <li>Tratamento de meses com menos dias (ex: fevereiro)</li> <li>Aplica\u00e7\u00e3o de ajustes complementares (Abe3002)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#3-calculo-dos-valores-das-parcelas","title":"3. C\u00e1lculo dos Valores das Parcelas","text":"<ul> <li>Distribui\u00e7\u00e3o percentual do valor total</li> <li>C\u00e1lculo do saldo para \u00faltima parcela</li> <li>Aplica\u00e7\u00e3o de juros, multas e encargos</li> <li>C\u00e1lculo de descontos por antecipa\u00e7\u00e3o</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#4-validacoes-e-regras-especiais","title":"4. Valida\u00e7\u00f5es e Regras Especiais","text":"<ul> <li>Verifica\u00e7\u00e3o de valor m\u00ednimo por parcela</li> <li>Op\u00e7\u00e3o de agrupamento em parcela \u00fanica</li> <li>C\u00e1lculo de comiss\u00f5es na \u00faltima parcela</li> <li>Valida\u00e7\u00e3o de documentos financeiros</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#configuracao-de-vencimentos","title":"Configura\u00e7\u00e3o de Vencimentos","text":"<ul> <li>Dias base: Ajustes por dia da semana na data base (abe30diasDtBase1-7)</li> <li>Vencimentos fixos: Datas espec\u00edficas por parcela (dt_vcto_fixo)</li> <li>Dias do m\u00eas: Vencimento em dia espec\u00edfico do m\u00eas (diavcto)</li> <li>Ajustes complementares: Regras por faixa de dias (Abe3002)</li> <li>M\u00eas refer\u00eancia: Ajustes para m\u00eas corrente ou seguinte</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#calculo-financeiro","title":"C\u00e1lculo Financeiro","text":"<ul> <li>Juros: Percentual aplicado sobre o valor da parcela</li> <li>Multa: Percentual ou valor fixo (vlr_fixo)</li> <li>Desconto: Percentual com limite temporal (dias_dtlimite)</li> <li>Encargos: Valores adicionais fixos</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#validacoes-de-parcelas","title":"Valida\u00e7\u00f5es de Parcelas","text":"<ul> <li>Valor m\u00ednimo: Configur\u00e1vel por condi\u00e7\u00e3o de pagamento (abe30vmpValor)</li> <li>Op\u00e7\u00f5es: </li> <li>0 - Agrupar em uma parcela quando valor m\u00ednimo n\u00e3o for atingido</li> <li>1 - Validar valor m\u00ednimo e interromper se n\u00e3o atingido</li> <li>Documentos financeiros: </li> <li>Tipo 1 - Gera na data de vencimento</li> <li>Tipo 2 - Gera na data de emiss\u00e3o</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":"<ul> <li><code>executar()</code> - M\u00e9todo principal que orquestra todo o processo de parcelamento</li> <li><code>obterDiasAdicionaisAData()</code> - Calcula dias adicionais baseado no dia da semana</li> <li><code>buscarCondicaoPagamentoPorId()</code> - Busca a condi\u00e7\u00e3o de pagamento pelo ID</li> <li><code>buscarParcelasPeloIdCondicaoPagamento()</code> - Busca as parcelas configuradas para a condi\u00e7\u00e3o</li> <li><code>buscarDiaComplementarPeloIdCondicaoPagamento()</code> - Busca ajustes complementares de dias</li> <li><code>montarParcelaDto()</code> - Monta o DTO da parcela com todos os dados calculados</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>ParcelaDto: - <code>vctoN</code> - Data de vencimento nominal - <code>valor</code> - Valor da parcela - <code>criaDoc</code> - Tipo de documento financeiro (1 ou 2) - <code>abf15id</code> - ID do portador - <code>abf16id</code> - ID da opera\u00e7\u00e3o - <code>abf01id</code> - ID do banco - <code>abf40id</code> - ID da forma de pagamento - <code>cposLivres</code> - Campos livres (juros, multa, desconto, etc.)</p> <p>Lista de Parcelas: Retornada no par\u00e2metro <code>listaParcelas</code></p>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#2-srf-documento-eltech","title":"2. SRF - Documento (Eltech)","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#descricao_1","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para processamento e composi\u00e7\u00e3o de documentos fiscais, aplicando regras de tributa\u00e7\u00e3o, observa\u00e7\u00f5es fiscais, c\u00e1lculo de comiss\u00f5es, valida\u00e7\u00f5es de itens e tratamento de documentos referenciados.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#finalidade_1","title":"\ud83c\udfaf Finalidade","text":"<p>Processar documentos fiscais (notas fiscais) aplicando regras de neg\u00f3cio espec\u00edficas, como valida\u00e7\u00e3o de itens, c\u00e1lculo de taxas de comiss\u00e3o, composi\u00e7\u00e3o de observa\u00e7\u00f5es e tratamento de documentos referenciados.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#publico-alvo_1","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Faturamento</li> <li>Tesouraria</li> <li>Contabilidade</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#dados-e-fontes_1","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Abe01</code> - Entidades (clientes/fornecedores) - <code>Abe02</code> - Dados comerciais da entidade - <code>Abe03</code> - Dados fiscais da entidade - <code>Abe05</code> - Representantes - <code>Abe40</code> - Tabelas de pre\u00e7o - <code>Abb01</code> - Documentos centrais - <code>Abb10</code> - Opera\u00e7\u00f5es comerciais - <code>Abd01</code> - Par\u00e2metros de c\u00e1lculo de documentos (PCD) - <code>Abd02</code> - Campos fiscais do PCD - <code>Abd05</code> - Campos industriais do PCD - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0101</code> - Endere\u00e7os do documento - <code>Eaa0103</code> - Itens do documento fiscal - <code>Eaa01033</code> - Itens de devolu\u00e7\u00e3o referenciados - <code>Abm01</code> - Produtos - <code>Abm0101</code> - Configura\u00e7\u00f5es do produto por empresa - <code>Abm10</code> - Valores do produto - <code>Abm1001</code> - Valores do produto por UF - <code>Aac10</code> - Empresas - <code>Aac13</code> - Dados fiscais da empresa - <code>Aag02</code> - Estados (UF) - <code>Aag0201</code> - Munic\u00edpios - <code>Aaj10</code> - C\u00f3digos de situa\u00e7\u00e3o tribut\u00e1ria (CST)</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#parametros-da-formula_1","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01 Eaa01 Sim Documento fiscal a ser processado procInvoc String Sim Processo de invoca\u00e7\u00e3o da f\u00f3rmula"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#fluxo-do-processo_1","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#1-configuracao-inicial_1","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o do documento fiscal (Eaa01)</li> <li>Carregamento da opera\u00e7\u00e3o comercial (Abb10)</li> <li>Obten\u00e7\u00e3o do PCD (Abd01)</li> <li>Carregamento da entidade (Abe01) e dados fiscais</li> <li>Carregamento da empresa (Aac10) e dados fiscais</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#2-processamento-por-item","title":"2. Processamento por Item","text":"<ul> <li>Valida\u00e7\u00e3o de itens sem c\u00f3digo de produto</li> <li>Carregamento de configura\u00e7\u00f5es do produto (Abm0101)</li> <li>Obten\u00e7\u00e3o de valores do produto por UF (Abm1001)</li> <li>Aplica\u00e7\u00e3o de observa\u00e7\u00f5es fiscais espec\u00edficas por item</li> <li>Tratamento de CST ICMS com redu\u00e7\u00e3o de base de c\u00e1lculo</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#3-calculo-de-taxas-de-comissao","title":"3. C\u00e1lculo de Taxas de Comiss\u00e3o","text":"<ul> <li>Obten\u00e7\u00e3o de taxas fixadas na entidade (Abe02)</li> <li>Obten\u00e7\u00e3o de taxas fixadas na tabela de pre\u00e7o (Abe40)</li> <li>Obten\u00e7\u00e3o de taxas de representantes (Abe05)</li> <li>Defini\u00e7\u00e3o final das taxas no documento</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#4-composicao-de-observacoes","title":"4. Composi\u00e7\u00e3o de Observa\u00e7\u00f5es","text":"<ul> <li>Composi\u00e7\u00e3o de observa\u00e7\u00f5es de uso interno</li> <li>Composi\u00e7\u00e3o de observa\u00e7\u00f5es fiscais</li> <li>Composi\u00e7\u00e3o de observa\u00e7\u00f5es ao contribuinte</li> <li>Composi\u00e7\u00e3o de observa\u00e7\u00f5es de reten\u00e7\u00e3o/indeniza\u00e7\u00e3o</li> <li>Composi\u00e7\u00e3o de observa\u00e7\u00f5es gerais</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#5-processamento-final","title":"5. Processamento Final","text":"<ul> <li>C\u00e1lculo de fidelidade (para PCD espec\u00edfico)</li> <li>C\u00e1lculo de cr\u00e9dito/cashback (para PCD espec\u00edfico)</li> <li>Composi\u00e7\u00e3o de observa\u00e7\u00f5es com documentos referenciados</li> <li>Atualiza\u00e7\u00e3o do documento fiscal</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#regras-de-negocio_1","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#validacao-de-itens","title":"Valida\u00e7\u00e3o de Itens","text":"<ul> <li>Todos os itens devem ter c\u00f3digo de produto preenchido</li> <li>Configura\u00e7\u00f5es do produto s\u00e3o carregadas por empresa</li> <li>Valores do produto s\u00e3o aplicados conforme UF do endere\u00e7o principal</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#observacoes-fiscais","title":"Observa\u00e7\u00f5es Fiscais","text":"<ul> <li>Observa\u00e7\u00f5es do fisco podem ser definidas por produto/UF</li> <li>Tratamento especial para CST ICMS 20 (redu\u00e7\u00e3o de base de c\u00e1lculo)</li> <li>Regime especial Simples Nacional com aproveitamento de ICMS</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#taxas-de-comissao","title":"Taxas de Comiss\u00e3o","text":"<ul> <li>Hierarquia de fontes: Entidade \u2192 Tabela de Pre\u00e7o \u2192 Representante</li> <li>Taxas podem ser fixadas em m\u00faltiplos n\u00edveis</li> <li>Valores zerados s\u00e3o substitu\u00eddos pelas fontes dispon\u00edveis</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#documentos-referenciados","title":"Documentos Referenciados","text":"<ul> <li>Identifica\u00e7\u00e3o de itens devolvidos referenciados</li> <li>Composi\u00e7\u00e3o autom\u00e1tica de observa\u00e7\u00e3o com dados dos documentos</li> <li>Inclus\u00e3o de n\u00famero, data e chave de acesso da NFe</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#3-srf-calculo-de-item-de-entrada-por-importacao","title":"3. SRF - C\u00e1lculo de Item de Entrada por Importa\u00e7\u00e3o","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#descricao_2","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para c\u00e1lculo de impostos e valores em itens de documentos fiscais de entrada por importa\u00e7\u00e3o, aplicando regras espec\u00edficas de importa\u00e7\u00e3o, tributa\u00e7\u00e3o federal e estadual, convers\u00f5es de unidades e tratamento de moedas estrangeiras.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#finalidade_2","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente os valores fiscais e financeiros de itens em documentos de importa\u00e7\u00e3o, incluindo impostos de importa\u00e7\u00e3o (II), IPI, ICMS, PIS/COFINS, convers\u00f5es monet\u00e1rias e ajustes de base de c\u00e1lculo.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#publico-alvo_2","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Importa\u00e7\u00e3o/Exporta\u00e7\u00e3o</li> <li>Contabilidade</li> <li>Faturamento</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#dados-e-fontes_2","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa0103</code> - Itens do documento fiscal - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0102</code> - Dados gerais do documento - <code>Eaa0101</code> - Endere\u00e7os do documento - <code>Abb01</code> - Central de documento - <code>Abb10</code> - Opera\u00e7\u00f5es comerciais - <code>Abd01</code> - Par\u00e2metros de c\u00e1lculo de documentos (PCD) - <code>Abe01</code> - Entidades (clientes/fornecedores) - <code>Abm01</code> - Produtos - <code>Abm0101</code> - Configura\u00e7\u00f5es do produto por empresa - <code>Abm12</code> - Dados fiscais do item - <code>Abm13</code> - Dados comerciais do item - <code>Abm1301</code> - Fatores de convers\u00e3o de unidade - <code>Abm10</code> - Valores do produto - <code>Abm1001</code> - Valores do produto por UF - <code>Aaj15</code> - CFOP (C\u00f3digo Fiscal de Opera\u00e7\u00f5es) - <code>Abg01</code> - NCM (Nomenclatura Comum do Mercosul) - <code>Aaj10</code> - CST ICMS - <code>Aaj11</code> - CST IPI - <code>Aaj12</code> - CST PIS - <code>Aaj13</code> - CST COFINS - <code>Aac10</code> - Empresas - <code>Aag02</code> - Estados (UF) - <code>Aag0201</code> - Munic\u00edpios</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#parametros-da-formula_2","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa0103 Eaa0103 Sim Item do documento fiscal a ser calculado"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#fluxo-do-processo_2","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#1-configuracao-inicial_2","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o do item do documento (Eaa0103)</li> <li>Carregamento do documento fiscal (Eaa01)</li> <li>Valida\u00e7\u00e3o de pessoa f\u00edsica como contribuinte de ICMS</li> <li>Carregamento da opera\u00e7\u00e3o comercial (Abb10) e PCD (Abd01)</li> <li>Obten\u00e7\u00e3o de dados da entidade (Abe01) e empresa (Aac10)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#2-carregamento-de-dados-geograficos","title":"2. Carregamento de Dados Geogr\u00e1ficos","text":"<ul> <li>Identifica\u00e7\u00e3o do endere\u00e7o principal da entidade</li> <li>Obten\u00e7\u00e3o de munic\u00edpio e UF da entidade</li> <li>Obten\u00e7\u00e3o de munic\u00edpio e UF da empresa</li> <li>Determina\u00e7\u00e3o se opera\u00e7\u00e3o \u00e9 intraestadual ou interestadual</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#3-carregamento-de-dados-do-produto","title":"3. Carregamento de Dados do Produto","text":"<ul> <li>Configura\u00e7\u00f5es fiscais (Abm12) e comerciais (Abm13) do item</li> <li>Fatores de convers\u00e3o de unidades (Abm1301)</li> <li>NCM (Abg01) e CFOP (Aaj15)</li> <li>Valores do produto por UF (Abm1001)</li> <li>C\u00f3digos de situa\u00e7\u00e3o tribut\u00e1ria (CSTs)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#4-calculo-de-cfop","title":"4. C\u00e1lculo de CFOP","text":"<ul> <li>Determina\u00e7\u00e3o autom\u00e1tica de CFOP baseado em:</li> <li>Tipo de opera\u00e7\u00e3o comercial</li> <li>Localiza\u00e7\u00e3o geogr\u00e1fica (dentro/fora do estado)</li> <li>Tipo de inscri\u00e7\u00e3o da entidade (CNPJ/CPF)</li> <li>Presen\u00e7a de IVA no item</li> <li>Tipo de produto (revenda/produ\u00e7\u00e3o)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#5-calculo-de-valores-do-item","title":"5. C\u00e1lculo de Valores do Item","text":"<ul> <li>PCD 114: C\u00e1lculo simples (quantidade \u00d7 valor unit\u00e1rio)</li> <li>PCD 314: C\u00e1lculo complexo de importa\u00e7\u00e3o:</li> <li>Convers\u00e3o monet\u00e1ria (FOB para Real)</li> <li>Soma de fretes, seguros e acr\u00e9scimos</li> <li>C\u00e1lculo de CIF (Custo, Seguro e Frete)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#6-calculo-de-impostos","title":"6. C\u00e1lculo de Impostos","text":"<ul> <li>II (Imposto de Importa\u00e7\u00e3o): Base CIF \u00d7 Al\u00edquota</li> <li>IPI: Base (CIF + II) \u00d7 Al\u00edquota NCM</li> <li>PIS/COFINS: Base valor total \u00d7 Al\u00edquotas</li> <li>ICMS: C\u00e1lculo complexo com base em f\u00f3rmula espec\u00edfica</li> <li>Tratamento de isen\u00e7\u00f5es e al\u00edquotas zero</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#7-ajustes-finais","title":"7. Ajustes Finais","text":"<ul> <li>Convers\u00e3o de quantidades para unidades de estoque</li> <li>C\u00e1lculo de pesos brutos e l\u00edquidos</li> <li>Aplica\u00e7\u00e3o de descontos incondicionais</li> <li>C\u00e1lculo de valor total do documento</li> <li>Defini\u00e7\u00e3o de custo de aquisi\u00e7\u00e3o</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#regras-de-negocio_2","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#validacoes-criticas","title":"Valida\u00e7\u00f5es Cr\u00edticas","text":"<ul> <li>Pessoa f\u00edsica n\u00e3o pode ser contribuinte de ICMS</li> <li>Item deve ter configura\u00e7\u00e3o fiscal cadastrada</li> <li>CFOP deve existir no cadastro ap\u00f3s determina\u00e7\u00e3o autom\u00e1tica</li> <li>Cota\u00e7\u00e3o monet\u00e1ria obrigat\u00f3ria para importa\u00e7\u00e3o em moeda estrangeira</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#calculo-de-cfop","title":"C\u00e1lculo de CFOP","text":"<ul> <li>D\u00edgito inicial fixo em \"3\" para importa\u00e7\u00e3o</li> <li>CFOPs espec\u00edficos para opera\u00e7\u00f5es com IVA (401)</li> <li>Diferencia\u00e7\u00e3o entre venda (102/108) e revenda (101/107)</li> <li>CFOP 109 para opera\u00e7\u00f5es espec\u00edficas</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#calculo-de-importacao-pcd-314","title":"C\u00e1lculo de Importa\u00e7\u00e3o (PCD 314)","text":"<ul> <li>Convers\u00e3o obrigat\u00f3ria de moeda estrangeira</li> <li>CIF = FOB + Frete + Seguro + Acr\u00e9scimos</li> <li>Base de c\u00e1lculo do ICMS inclui todos os impostos</li> <li>Valor total do documento igual \u00e0 base de c\u00e1lculo do ICMS</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#tratamento-de-impostos","title":"Tratamento de Impostos","text":"<ul> <li>II: Zerado quando al\u00edquota for zero</li> <li>IPI: Base inclui CIF + II, isen\u00e7\u00e3o move valor para campo espec\u00edfico</li> <li>PIS/COFINS: Al\u00edquotas diferenciadas para opera\u00e7\u00f5es com exterior</li> <li>ICMS: C\u00e1lculo por f\u00f3rmula ((CIF+impostos)/(1-aliq))\u00d7aliq</li> <li>CST 51: Zera ICMS e al\u00edquota automaticamente</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#4-scv-pedidos-por-item-eltech","title":"4. SCV - Pedidos por Item (Eltech)","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#descricao_3","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio que consolida informa\u00e7\u00f5es de pedidos agrupados por item, permitindo an\u00e1lise de quantidades solicitadas versus quantidades atendidas, com filtros flex\u00edveis para diferentes tipos de pedidos e situa\u00e7\u00f5es.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#finalidade_3","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer uma vis\u00e3o consolidada dos pedidos por item, facilitando o acompanhamento de atendimento, identifica\u00e7\u00e3o de saldos pendentes e an\u00e1lise de movimenta\u00e7\u00e3o de produtos.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#publico-alvo_3","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Comercial/Vendas</li> <li>Compras</li> <li>Planejamento</li> <li>Estoques</li> <li>Ger\u00eancia</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoFCI/#dados-e-fontes_3","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos fiscais - <code>Abb01</code> - Central de documento - <code>Eaa0103</code> - Itens do documento fiscal - <code>Eaa01032</code> - Itens atendidos do SCV - <code>Abm01</code> - Produtos - <code>Aam01</code> - Classes de produtos - <code>Abe01</code> - Entidades (cliente)</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/","title":"SRF_CalculoItem_Entrada_ImportacaoDrawback.md","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para c\u00e1lculo de itens em documentos fiscais de entrada com regime especial de Drawback, respons\u00e1vel pelo processamento de tributos e valores em importa\u00e7\u00f5es.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente os valores tribut\u00e1rios, quantidades e custos de itens em documentos de entrada com regime de Drawback, garantindo conformidade fiscal e precis\u00e3o nos c\u00e1lculos.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Com\u00e9rcio Exterior</li> <li>Contabilidade</li> <li>Almoxarifado/Estoque</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - F\u00f3rmula <code>SRF_CalculoItem_Entrada_ImportacaoDrawback</code> - C\u00e1lculo de itens com Drawback</p> <p>Localiza\u00e7\u00e3o: <code>strema/formulas/srf/</code></p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos fiscais - <code>EAA0103</code> - Itens do documento - <code>ABM01</code> - Cadastro de itens - <code>ABM0101</code> - Configura\u00e7\u00f5es do item por empresa - <code>ABM12</code> - Dados fiscais do item - <code>ABM13</code> - Dados comerciais do item</p> <p>Entidades Envolvidas: - <code>Eaa0103</code> - Item do documento - <code>Abm01</code> - Item - <code>Abm0101</code> - Configura\u00e7\u00e3o empresa-item - <code>Abm12</code> - Configura\u00e7\u00e3o fiscal - <code>Abm13</code> - Configura\u00e7\u00e3o comercial</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa0103 Eaa0103 Sim Item do documento a ser calculado"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Inicializa\u00e7\u00e3o e Valida\u00e7\u00f5es</li> <li>Obt\u00e9m item do documento (EAA0103)</li> <li>Carrega documento pai (EAA01) e central (ABB01)</li> <li> <p>Recupera dados da PCD, entidade e empresa</p> </li> <li> <p>Carregamento de Dados Complementares</p> </li> <li>Endere\u00e7os da entidade e empresa</li> <li>Configura\u00e7\u00f5es do item (fiscal, comercial, valores)</li> <li>Dados tribut\u00e1rios (CFOP, NCM, CSTs)</li> <li> <p>Campos livres (JSON) de diversas entidades</p> </li> <li> <p>C\u00e1lculos Principais</p> </li> <li>Valores do item (total, descontos)</li> <li>Tributos (II, IPI, PIS, COFINS, ICMS)</li> <li>Quantidades e convers\u00f5es de unidades</li> <li>Pesos e volumes</li> <li> <p>Custo de aquisi\u00e7\u00e3o para importa\u00e7\u00e3o</p> </li> <li> <p>Processamento Espec\u00edfico Drawback</p> </li> <li>C\u00e1lculo de base de custo (CIF)</li> <li>Tratamento para opera\u00e7\u00f5es com exterior</li> <li>Ajustes fiscais espec\u00edficos</li> </ol>"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#validacoes-criticas","title":"Valida\u00e7\u00f5es Cr\u00edticas","text":"<ul> <li>Item deve existir no documento</li> <li>Endere\u00e7o principal da entidade \u00e9 obrigat\u00f3rio</li> <li>Configura\u00e7\u00e3o fiscal do item deve existir</li> <li>Dados da empresa e entidade devem estar completos</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#calculos-tributarios","title":"C\u00e1lculos Tribut\u00e1rios","text":"<ul> <li>IPI: Calculado com al\u00edquota do NCM, com isen\u00e7\u00e3o para al\u00edquota zero</li> <li>ICMS: C\u00e1lculo com base na al\u00edquota e ajuste de base de c\u00e1lculo</li> <li>PIS/COFINS: Tratamento especial para opera\u00e7\u00f5es com exterior</li> <li>II: Utiliza al\u00edquota espec\u00edfica do item</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#conversoes-e-ajustes","title":"Convers\u00f5es e Ajustes","text":"<ul> <li>Convers\u00e3o de quantidade comercial para estoque</li> <li>C\u00e1lculo de peso bruto e l\u00edquido</li> <li>Ajuste de volumes quando aplic\u00e1vel</li> <li>C\u00e1lculo de custo de aquisi\u00e7\u00e3o considerando todos os tributos</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#campos-livres-json","title":"Campos Livres (JSON)","text":"<ul> <li><code>vlrfcientrada</code>: Valor fiscal de entrada</li> <li><code>ii_aliq</code>: Al\u00edquota do Imposto de Importa\u00e7\u00e3o</li> <li><code>vlr_vlme</code>: Valor do volume</li> <li><code>ipi_aliq</code>, <code>ipi_bc</code>, <code>ipi_ipi</code>: Dados do IPI</li> <li><code>custo_aquisicao</code>: Custo total de aquisi\u00e7\u00e3o</li> <li><code>cif_imp</code>: Valor CIF da importa\u00e7\u00e3o</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#saidas-geradas","title":"\ud83c\udfa8 Sa\u00eddas Geradas","text":"Sa\u00edda Descri\u00e7\u00e3o Tipo eaa0103 Item do documento com c\u00e1lculos atualizados Eaa0103"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Persist\u00eancia e consultas - <code>sam.dicdados</code> - Defini\u00e7\u00f5es de tipos de f\u00f3rmula - <code>sam.model.entities</code> - Entidades do sistema</p> <p>Entidades Relacionadas: - Todas entidades AA, AB, EA do pacote <code>sam.model.entities</code></p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Processamento: S\u00edncrono, executado para cada item do documento</li> <li>Tratamento de Erros: Valida\u00e7\u00f5es com <code>ValidacaoException</code> para dados inconsistentes</li> <li>Performance: Utiliza carregamento lazy de entidades relacionadas</li> <li>Flexibilidade: Campos livres (JSON) permitem extensibilidade sem altera\u00e7\u00e3o de schema</li> <li>Especificidade: Foco em opera\u00e7\u00f5es de importa\u00e7\u00e3o com regime Drawback</li> <li>Arredondamentos: Aplicados em valores monet\u00e1rios (2 casas) e quantidades (4 casas)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#estrutura-de-calculo","title":"Estrutura de C\u00e1lculo","text":"<ul> <li>Separa\u00e7\u00e3o clara entre carregamento de dados e c\u00e1lculos</li> <li>Reutiliza\u00e7\u00e3o de fatores de convers\u00e3o comerciais</li> <li>Considera\u00e7\u00e3o de m\u00faltiplos endere\u00e7os na entidade</li> <li>Suporte a diferentes unidades de medida</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItemEntradaImportacaoDrawback/#tributacao","title":"Tributa\u00e7\u00e3o","text":"<ul> <li>Tratamento diferenciado para opera\u00e7\u00f5es com exterior (UF \"EX\")</li> <li>C\u00e1lculo de base de ICMS com ajuste de divisor</li> <li>Isen\u00e7\u00e3o autom\u00e1tica de IPI quando al\u00edquota zero</li> <li>Acumula\u00e7\u00e3o de despesas acess\u00f3rias</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/","title":"SRF_CalculoItem_Entrada.md","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula principal para c\u00e1lculo de itens em documentos fiscais de entrada, respons\u00e1vel pelo processamento completo de tributos, valores e ajustes fiscais em opera\u00e7\u00f5es de compra.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente valores tribut\u00e1rios, convers\u00f5es de unidades, custos de aquisi\u00e7\u00e3o e tratamentos fiscais espec\u00edficos para opera\u00e7\u00f5es de entrada, garantindo conformidade fiscal e precis\u00e3o nos c\u00e1lculos.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Compras</li> <li>Contabilidade</li> <li>Almoxarifado/Estoque</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - F\u00f3rmula <code>SRF_CalculoItem_Entrada</code> - C\u00e1lculo principal de itens de entrada</p> <p>Localiza\u00e7\u00e3o: <code>strema/formulas/srf/</code></p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos fiscais - <code>EAA0103</code> - Itens do documento - <code>ABD01</code> - Tipos de documento (PCD) - <code>ABM01</code> - Cadastro de itens - <code>ABM0101</code> - Configura\u00e7\u00f5es do item por empresa - <code>ABM12</code> - Dados fiscais do item</p> <p>Entidades Envolvidas: - <code>Eaa0103</code> - Item do documento - <code>Eaa01</code> - Documento fiscal - <code>Abd01</code> - Tipo de documento (PCD) - <code>Abm01</code> - Item - <code>Abm0101</code> - Configura\u00e7\u00e3o empresa-item</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa0103 Eaa0103 Sim Item do documento a ser calculado"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Inicializa\u00e7\u00e3o e Valida\u00e7\u00f5es</li> <li>Obt\u00e9m item do documento (EAA0103) e documento pai (EAA01)</li> <li>Carrega dados da central (ABB01) e PCD</li> <li>Valida se documento \u00e9 de entrada</li> <li> <p>Verifica endere\u00e7o principal da entidade</p> </li> <li> <p>Carregamento de Dados Complementares</p> </li> <li>Endere\u00e7os da entidade e empresa</li> <li>Configura\u00e7\u00f5es do item (fiscal, comercial, valores)</li> <li>Dados tribut\u00e1rios (CFOP, NCM, CSTs)</li> <li> <p>Fatores de convers\u00e3o de unidades</p> </li> <li> <p>Ajustes Autom\u00e1ticos de CFOP</p> </li> <li>Determina\u00e7\u00e3o se opera\u00e7\u00e3o \u00e9 intra ou interestadual</li> <li>Ajuste de CFOP baseado no tipo de item</li> <li> <p>Tratamento espec\u00edfico para material de uso e consumo</p> </li> <li> <p>C\u00e1lculos Principais</p> </li> <li>Valores do item e totais</li> <li>Convers\u00f5es de quantidades e unidades</li> <li>Tributos (ICMS, IPI, PIS, COFINS)</li> <li>C\u00e1lculo de custo de aquisi\u00e7\u00e3o</li> </ol>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#validacoes-criticas","title":"Valida\u00e7\u00f5es Cr\u00edticas","text":"<ul> <li>Item deve existir no documento</li> <li>Documento deve ser de entrada (PCD com abd01es \u2260 1)</li> <li>Endere\u00e7o principal da entidade \u00e9 obrigat\u00f3rio</li> <li>Configura\u00e7\u00e3o fiscal do item deve existir</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#ajustes-automaticos-de-cfop","title":"Ajustes Autom\u00e1ticos de CFOP","text":"<ul> <li>Mercadoria para Revenda (00): CFOP 1/2102 ou 1/2403 com IVA</li> <li>Mat\u00e9ria-Prima/Embalagem (01/02): CFOP 1/2101 ou 1/2401 com IVA</li> <li>Material de Uso e Consumo (07): CFOP 1/2556 com ajustes espec\u00edficos de CST</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#calculos-tributarios","title":"C\u00e1lculos Tribut\u00e1rios","text":"<ul> <li>ICMS: Tratamento completo por CST (00, 10, 20, 30, 40, 41, 50, 51, 60, 70, 90)</li> <li>IPI: C\u00e1lculo com base no NCM, com observa\u00e7\u00f5es fiscais para Simples Nacional</li> <li>PIS/COFINS: Tratamento por CST com bases de c\u00e1lculo espec\u00edficas</li> <li>Substitui\u00e7\u00e3o Tribut\u00e1ria: C\u00e1lculo de IVA e ICMS-ST quando aplic\u00e1vel</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#regimes-tributarios","title":"Regimes Tribut\u00e1rios","text":"<ul> <li>Regime Normal: C\u00e1lculos completos de todos os tributos</li> <li>Simples Nacional: Ajustes autom\u00e1ticos de CST e al\u00edquotas espec\u00edficas</li> <li>Importa\u00e7\u00e3o: Tratamento diferenciado para empresas importadoras</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#saidas-geradas","title":"\ud83c\udfa8 Sa\u00eddas Geradas","text":"Sa\u00edda Descri\u00e7\u00e3o Tipo eaa0103 Item do documento com c\u00e1lculos atualizados Eaa0103"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Persist\u00eancia e consultas - <code>sam.dicdados</code> - Defini\u00e7\u00f5es de tipos de f\u00f3rmula - <code>sam.model.entities</code> - Entidades do sistema</p> <p>Entidades Relacionadas: - Todas entidades AA, AB, EA do pacote <code>sam.model.entities</code></p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Processamento: S\u00edncrono, executado para cada item do documento</li> <li>Valida\u00e7\u00f5es: Utiliza <code>ValidacaoException</code> para dados inconsistentes</li> <li>Performance: Carregamento otimizado de entidades relacionadas</li> <li>Flexibilidade: Campos livres (JSON) permitem extensibilidade</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#tratamentos-especificos","title":"Tratamentos Espec\u00edficos","text":"<ul> <li>Material de Uso e Consumo: Ajuste autom\u00e1tico de CST para 90 e CFOP espec\u00edfico</li> <li>Observa\u00e7\u00f5es Fiscais de IPI: Geradas automaticamente para opera\u00e7\u00f5es espec\u00edficas</li> <li>Redu\u00e7\u00f5es de Base de C\u00e1lculo: Aplicadas conforme configura\u00e7\u00f5es do item</li> <li>Custo de Aquisi\u00e7\u00e3o: Calculado considerando todos os tributos e descontos</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada/#campos-livres-json-utilizados","title":"Campos Livres (JSON) Utilizados","text":"<ul> <li><code>ipi_obs</code>: Observa\u00e7\u00e3o fiscal de IPI</li> <li><code>custo_aquisicao</code>: Custo total de aquisi\u00e7\u00e3o</li> <li><code>tx_iva_st</code>: Percentual de IVA para substitui\u00e7\u00e3o tribut\u00e1ria</li> <li><code>icm_reduc_bc</code>: Percentual de redu\u00e7\u00e3o de base de c\u00e1lculo do ICMS</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/","title":"SRF_CalculoItem_Entrada_Cte.md","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula especializada para c\u00e1lculo de itens em documentos fiscais de entrada com foco em opera\u00e7\u00f5es de Conhecimento de Transporte Eletr\u00f4nico (CT-e), incluindo tratamento completo de tributos e ajustes fiscais.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular valores tribut\u00e1rios, convers\u00f5es de unidades, custos de aquisi\u00e7\u00e3o e tratamentos fiscais espec\u00edficos para opera\u00e7\u00f5es de entrada via CT-e, garantindo conformidade fiscal e precis\u00e3o nos c\u00e1lculos.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Log\u00edstica/Transportes</li> <li>Contabilidade</li> <li>Almoxarifado/Estoque</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - F\u00f3rmula <code>SRF_CalculoItem_Entrada_Cte</code> - C\u00e1lculo de itens de entrada via CT-e</p> <p>Localiza\u00e7\u00e3o: <code>strema/formulas/srf/</code></p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos fiscais - <code>EAA0103</code> - Itens do documento - <code>ABD01</code> - Tipos de documento (PCD) - <code>ABM01</code> - Cadastro de itens - <code>ABM0101</code> - Configura\u00e7\u00f5es do item por empresa - <code>ABM12</code> - Dados fiscais do item</p> <p>Entidades Envolvidas: - <code>Eaa0103</code> - Item do documento - <code>Eaa01</code> - Documento fiscal - <code>Abd01</code> - Tipo de documento (PCD) - <code>Abm01</code> - Item - <code>Abm0101</code> - Configura\u00e7\u00e3o empresa-item</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa0103 Eaa0103 Sim Item do documento a ser calculado"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Inicializa\u00e7\u00e3o e Valida\u00e7\u00f5es</li> <li>Obt\u00e9m item do documento (EAA0103) e documento pai (EAA01)</li> <li>Carrega dados da central (ABB01) e PCD</li> <li>Valida endere\u00e7o principal da entidade</li> <li> <p>Verifica se documento \u00e9 de entrada</p> </li> <li> <p>Carregamento de Dados Complementares</p> </li> <li>Endere\u00e7os da entidade e empresa</li> <li>Configura\u00e7\u00f5es do item (fiscal, comercial, valores)</li> <li>Dados tribut\u00e1rios (CFOP, NCM, CSTs)</li> <li> <p>Tabela de pre\u00e7os e fatores de convers\u00e3o</p> </li> <li> <p>C\u00e1lculos Principais</p> </li> <li>Valores do item e totais</li> <li>Convers\u00f5es de quantidades e unidades</li> <li>Tributos (ICMS, IPI, PIS, COFINS)</li> <li>Ajustes de CFOP autom\u00e1ticos</li> <li> <p>C\u00e1lculo de custo de aquisi\u00e7\u00e3o</p> </li> <li> <p>Tratamentos Espec\u00edficos CT-e</p> </li> <li>Diferencial de al\u00edquota para opera\u00e7\u00f5es interestaduais</li> <li>Ajustes fiscais espec\u00edficos para transporte</li> <li>Observa\u00e7\u00f5es fiscais autom\u00e1ticas</li> </ol>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#validacoes-criticas","title":"Valida\u00e7\u00f5es Cr\u00edticas","text":"<ul> <li>Item deve existir no documento</li> <li>Documento deve ser de entrada (PCD com abd01es \u2260 1)</li> <li>Endere\u00e7o principal da entidade \u00e9 obrigat\u00f3rio</li> <li>Configura\u00e7\u00e3o fiscal do item deve existir</li> <li>Fator de convers\u00e3o de unidade \u00e9 obrigat\u00f3rio</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#ajustes-automaticos-de-cfop","title":"Ajustes Autom\u00e1ticos de CFOP","text":"<ul> <li>Mercadoria para Revenda (00): CFOP 1/2102 ou 1/2403 com IVA</li> <li>Mat\u00e9ria-Prima/Embalagem (01/02): CFOP 1/2101 ou 1/2401 com IVA</li> <li>Material de Uso e Consumo (07): CFOP 1/2556 com ajustes espec\u00edficos</li> <li>Opera\u00e7\u00f5es com ST: CFOP 1/2403 com tratamentos diferenciados</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#calculos-tributarios","title":"C\u00e1lculos Tribut\u00e1rios","text":"<ul> <li>ICMS: Tratamento completo por CST (00, 10, 20, 30, 40, 50, 51, 60, 61, 70, 90)</li> <li>IPI: C\u00e1lculo com base no NCM, com observa\u00e7\u00f5es fiscais espec\u00edficas</li> <li>PIS/COFINS: Tratamento por CST com bases de c\u00e1lculo ajustadas</li> <li>Diferencial de Al\u00edquota: Aplicado para opera\u00e7\u00f5es interestaduais de uso/consumo</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#conversoes-e-ajustes","title":"Convers\u00f5es e Ajustes","text":"<ul> <li>Convers\u00e3o de quantidade comercial para estoque</li> <li>C\u00e1lculo autom\u00e1tico de valores unit\u00e1rios da tabela de pre\u00e7os</li> <li>Ajustes de redu\u00e7\u00e3o de base de c\u00e1lculo</li> <li>Tratamento de IVA para substitui\u00e7\u00e3o tribut\u00e1ria</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#saidas-geradas","title":"\ud83c\udfa8 Sa\u00eddas Geradas","text":"Sa\u00edda Descri\u00e7\u00e3o Tipo eaa0103 Item do documento com c\u00e1lculos atualizados Eaa0103"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Persist\u00eancia e consultas - <code>sam.dicdados</code> - Defini\u00e7\u00f5es de tipos de f\u00f3rmula - <code>sam.model.entities</code> - Entidades do sistema</p> <p>Entidades Relacionadas: - Todas entidades AA, AB, EA do pacote <code>sam.model.entities</code></p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Processamento: S\u00edncrono, executado para cada item do documento</li> <li>Valida\u00e7\u00f5es: Utiliza <code>ValidacaoException</code> para dados inconsistentes</li> <li>Flexibilidade: Campos livres (JSON) permitem extensibilidade</li> <li>Performance: Carregamento otimizado de entidades relacionadas</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#tratamentos-especificos","title":"Tratamentos Espec\u00edficos","text":"<ul> <li>Simples Nacional: Ajustes autom\u00e1ticos de CST e al\u00edquotas</li> <li>Opera\u00e7\u00f5es com ST: C\u00e1lculo completo de IVA e base de c\u00e1lculo</li> <li>Observa\u00e7\u00f5es Fiscais: Gera\u00e7\u00e3o autom\u00e1tica para IPI e diferencial de al\u00edquota</li> <li>CFOP Din\u00e2mico: Ajuste autom\u00e1tico baseado no tipo de item e opera\u00e7\u00e3o</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Cte/#campos-livres-json-utilizados","title":"Campos Livres (JSON) Utilizados","text":"<ul> <li><code>unit_tabela</code>: Valor unit\u00e1rio da tabela de pre\u00e7os</li> <li><code>ipi_obs</code>: Observa\u00e7\u00e3o fiscal de IPI</li> <li><code>custo_simples</code>: Percentual de custo para Simples Nacional</li> <li><code>custo_aquisicao</code>: Custo total de aquisi\u00e7\u00e3o</li> <li><code>bc_difaliq</code>, <code>valor_difal</code>: Dados do diferencial de al\u00edquota</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/","title":"SRF - C\u00e1lculo de Item de Entrada por Importa\u00e7\u00e3o","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula para c\u00e1lculo de impostos e valores em itens de documentos fiscais de entrada por importa\u00e7\u00e3o, aplicando regras espec\u00edficas de importa\u00e7\u00e3o, tributa\u00e7\u00e3o federal e estadual, convers\u00f5es de unidades e tratamento de moedas estrangeiras.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Calcular automaticamente os valores fiscais e financeiros de itens em documentos de importa\u00e7\u00e3o, incluindo impostos de importa\u00e7\u00e3o (II), IPI, ICMS, PIS/COFINS, convers\u00f5es monet\u00e1rias e ajustes de base de c\u00e1lculo.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Importa\u00e7\u00e3o/Exporta\u00e7\u00e3o</li> <li>Contabilidade</li> <li>Faturamento</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa0103</code> - Itens do documento fiscal - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0102</code> - Dados gerais do documento - <code>Eaa0101</code> - Endere\u00e7os do documento - <code>Abb01</code> - Central de documento - <code>Abb10</code> - Opera\u00e7\u00f5es comerciais - <code>Abd01</code> - Par\u00e2metros de c\u00e1lculo de documentos (PCD) - <code>Abe01</code> - Entidades (clientes/fornecedores) - <code>Abm01</code> - Produtos - <code>Abm0101</code> - Configura\u00e7\u00f5es do produto por empresa - <code>Abm12</code> - Dados fiscais do item - <code>Abm13</code> - Dados comerciais do item - <code>Abm1301</code> - Fatores de convers\u00e3o de unidade - <code>Abm10</code> - Valores do produto - <code>Abm1001</code> - Valores do produto por UF - <code>Aaj15</code> - CFOP (C\u00f3digo Fiscal de Opera\u00e7\u00f5es) - <code>Abg01</code> - NCM (Nomenclatura Comum do Mercosul) - <code>Aaj10</code> - CST ICMS - <code>Aaj11</code> - CST IPI - <code>Aaj12</code> - CST PIS - <code>Aaj13</code> - CST COFINS - <code>Aac10</code> - Empresas - <code>Aag02</code> - Estados (UF) - <code>Aag0201</code> - Munic\u00edpios</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa0103 Eaa0103 Sim Item do documento fiscal a ser calculado"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o do item do documento (Eaa0103)</li> <li>Carregamento do documento fiscal (Eaa01)</li> <li>Valida\u00e7\u00e3o de pessoa f\u00edsica como contribuinte de ICMS</li> <li>Carregamento da opera\u00e7\u00e3o comercial (Abb10) e PCD (Abd01)</li> <li>Obten\u00e7\u00e3o de dados da entidade (Abe01) e empresa (Aac10)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#2-carregamento-de-dados-geograficos","title":"2. Carregamento de Dados Geogr\u00e1ficos","text":"<ul> <li>Identifica\u00e7\u00e3o do endere\u00e7o principal da entidade</li> <li>Obten\u00e7\u00e3o de munic\u00edpio e UF da entidade</li> <li>Obten\u00e7\u00e3o de munic\u00edpio e UF da empresa</li> <li>Determina\u00e7\u00e3o se opera\u00e7\u00e3o \u00e9 intraestadual ou interestadual</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#3-carregamento-de-dados-do-produto","title":"3. Carregamento de Dados do Produto","text":"<ul> <li>Configura\u00e7\u00f5es fiscais (Abm12) e comerciais (Abm13) do item</li> <li>Fatores de convers\u00e3o de unidades (Abm1301)</li> <li>NCM (Abg01) e CFOP (Aaj15)</li> <li>Valores do produto por UF (Abm1001)</li> <li>C\u00f3digos de situa\u00e7\u00e3o tribut\u00e1ria (CSTs)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#4-calculo-de-cfop","title":"4. C\u00e1lculo de CFOP","text":"<ul> <li>Determina\u00e7\u00e3o autom\u00e1tica de CFOP baseado em:</li> <li>Tipo de opera\u00e7\u00e3o comercial</li> <li>Localiza\u00e7\u00e3o geogr\u00e1fica (dentro/fora do estado)</li> <li>Tipo de inscri\u00e7\u00e3o da entidade (CNPJ/CPF)</li> <li>Presen\u00e7a de IVA no item</li> <li>Tipo de produto (revenda/produ\u00e7\u00e3o)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#5-calculo-de-valores-do-item","title":"5. C\u00e1lculo de Valores do Item","text":"<ul> <li>PCD 114: C\u00e1lculo simples (quantidade \u00d7 valor unit\u00e1rio)</li> <li>PCD 314: C\u00e1lculo complexo de importa\u00e7\u00e3o:</li> <li>Convers\u00e3o monet\u00e1ria (FOB para Real)</li> <li>Soma de fretes, seguros e acr\u00e9scimos</li> <li>C\u00e1lculo de CIF (Custo, Seguro e Frete)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#6-calculo-de-impostos","title":"6. C\u00e1lculo de Impostos","text":"<ul> <li>II (Imposto de Importa\u00e7\u00e3o): Base CIF \u00d7 Al\u00edquota</li> <li>IPI: Base (CIF + II) \u00d7 Al\u00edquota NCM</li> <li>PIS/COFINS: Base valor total \u00d7 Al\u00edquotas</li> <li>ICMS: C\u00e1lculo complexo com base em f\u00f3rmula espec\u00edfica</li> <li>Tratamento de isen\u00e7\u00f5es e al\u00edquotas zero</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#7-ajustes-finais","title":"7. Ajustes Finais","text":"<ul> <li>Convers\u00e3o de quantidades para unidades de estoque</li> <li>C\u00e1lculo de pesos brutos e l\u00edquidos</li> <li>Aplica\u00e7\u00e3o de descontos incondicionais</li> <li>C\u00e1lculo de valor total do documento</li> <li>Defini\u00e7\u00e3o de custo de aquisi\u00e7\u00e3o</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#validacoes-criticas","title":"Valida\u00e7\u00f5es Cr\u00edticas","text":"<ul> <li>Pessoa f\u00edsica n\u00e3o pode ser contribuinte de ICMS</li> <li>Item deve ter configura\u00e7\u00e3o fiscal cadastrada</li> <li>CFOP deve existir no cadastro ap\u00f3s determina\u00e7\u00e3o autom\u00e1tica</li> <li>Cota\u00e7\u00e3o monet\u00e1ria obrigat\u00f3ria para importa\u00e7\u00e3o em moeda estrangeira</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#calculo-de-cfop","title":"C\u00e1lculo de CFOP","text":"<ul> <li>D\u00edgito inicial fixo em \"3\" para importa\u00e7\u00e3o</li> <li>CFOPs espec\u00edficos para opera\u00e7\u00f5es com IVA (401)</li> <li>Diferenci\u00e7\u00e3o entre venda (102/108) e revenda (101/107)</li> <li>CFOP 109 para opera\u00e7\u00f5es espec\u00edficas</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#calculo-de-importacao-pcd-314","title":"C\u00e1lculo de Importa\u00e7\u00e3o (PCD 314)","text":"<ul> <li>Convers\u00e3o obrigat\u00f3ria de moeda estrangeira</li> <li>CIF = FOB + Frete + Seguro + Acr\u00e9scimos</li> <li>Base de c\u00e1lculo do ICMS inclui todos os impostos</li> <li>Valor total do documento igual \u00e0 base de c\u00e1lculo do ICMS</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#tratamento-de-impostos","title":"Tratamento de Impostos","text":"<ul> <li>II: Zerado quando al\u00edquota for zero</li> <li>IPI: Base inclui CIF + II, isen\u00e7\u00e3o move valor para campo espec\u00edfico</li> <li>PIS/COFINS: Al\u00edquotas diferenciadas para opera\u00e7\u00f5es com exterior</li> <li>ICMS: C\u00e1lculo por f\u00f3rmula ((CIF+impostos)/(1-aliq))\u00d7aliq</li> <li>CST 51: Zera ICMS e al\u00edquota automaticamente</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#conversoes-e-ajustes","title":"Convers\u00f5es e Ajustes","text":"<ul> <li>Convers\u00e3o de quantidade comercial para quantidade de uso</li> <li>C\u00e1lculo de volume baseado em fator do produto</li> <li>Desconto incondicional aplicado sobre valor total</li> <li>Arredondamentos em 2 casas decimais para valores monet\u00e1rios</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o c\u00e1lculo do item de importa\u00e7\u00e3o.</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#calcularitem","title":"`calcularItem()**","text":"<p>Executa todos os c\u00e1lculos fiscais e financeiros do item, incluindo: - Determina\u00e7\u00e3o de CFOP - C\u00e1lculo de valores totais - C\u00e1lculo de todos os impostos - Convers\u00f5es de unidades e moedas - Ajustes finais do item</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#estrutura-de-calculo","title":"\ud83d\udcca Estrutura de C\u00e1lculo","text":"<p>Dados de Entrada: - Item do documento (Eaa0103) com quantidade e valor unit\u00e1rio - Documento fiscal (Eaa01) com PCD e dados de importa\u00e7\u00e3o - Dados geogr\u00e1ficos de entidade e empresa - Configura\u00e7\u00f5es do produto e NCM</p> <p>C\u00e1lculos Intermedi\u00e1rios: - Determina\u00e7\u00e3o de CFOP - Convers\u00e3o monet\u00e1ria (para importa\u00e7\u00e3o) - C\u00e1lculo de CIF - Bases de c\u00e1lculo de cada imposto</p> <p>Resultados: - Valores calculados de cada imposto (II, IPI, ICMS, PIS, COFINS) - Valores totais do item (comercial, documento, financeiro) - Bases de c\u00e1lculo ajustadas - Campos JSON com detalhes do c\u00e1lculo</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios e exce\u00e7\u00f5es - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.model</code> - Entidades do sistema - <code>java.math</code> - Opera\u00e7\u00f5es com BigDecimal</p> <p>M\u00f3dulo: SRF (Sistema de Faturamento)</p>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#estrutura-de-json","title":"Estrutura de JSON","text":"<ul> <li><code>jsonEaa0103</code>: Campos calculados do item (impostos, bases, valores)</li> <li><code>jsonAbm0101</code>: Configura\u00e7\u00f5es do produto por empresa</li> <li><code>jsonAbm1001_UF_Item</code>: Valores do produto por UF</li> <li><code>jsonAag02Ent</code>: Configura\u00e7\u00f5es da UF da entidade</li> <li><code>jsonAbe01</code>: Dados adicionais da entidade</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#tratamento-de-moedas","title":"Tratamento de Moedas","text":"<ul> <li>Cota\u00e7\u00e3o obtida por data espec\u00edfica ou mais recente</li> <li>Valida\u00e7\u00e3o de cota\u00e7\u00e3o existente</li> <li>Convers\u00e3o de valores FOB para Real</li> <li>C\u00e1lculo de valores em moeda nacional</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#validacoes-de-negocio","title":"Valida\u00e7\u00f5es de Neg\u00f3cio","text":"<ul> <li>Interrup\u00e7\u00e3o por exce\u00e7\u00e3o em erros cr\u00edticos</li> <li>Valida\u00e7\u00f5es preventivas em dados obrigat\u00f3rios</li> <li>Mensagens claras para corre\u00e7\u00e3o pelo usu\u00e1rio</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_CalculoItem_Entrada_Importacao/#performance","title":"Performance","text":"<ul> <li>Carregamento otimizado de entidades relacionadas</li> <li>Uso de Criteria para consultas eficientes</li> <li>Minimiza\u00e7\u00e3o de consultas ao banco de dados</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 27/11/2025 \u00e0s 15:00 Autor: Bruno Tipo: F\u00f3rmula de C\u00e1lculo de Item de Importa\u00e7\u00e3o Vers\u00e3o: 1.0</p>"},{"location":"STREMA/formulas/srf/SRF_Documento/","title":"SRF_Documento","text":""},{"location":"STREMA/formulas/srf/SRF_Documento/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula respons\u00e1vel pelo processamento e c\u00e1lculo de informa\u00e7\u00f5es fiscais de documentos, incluindo preenchimento de observa\u00e7\u00f5es fiscais, contribuintes, comiss\u00f5es e campos adicionais. Integra dados de entidades, itens, opera\u00e7\u00f5es comerciais e regras espec\u00edficas de regime tribut\u00e1rio, visando a correta escritura\u00e7\u00e3o de documentos para fins fiscais e cont\u00e1beis.</p>"},{"location":"STREMA/formulas/srf/SRF_Documento/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<ul> <li>Configurar observa\u00e7\u00f5es fiscais e internas do documento.</li> <li>Calcular taxas de comiss\u00e3o de representantes e da entidade.</li> <li>Processar campos JSON de visualiza\u00e7\u00e3o e controle fiscal.</li> <li>Validar dados obrigat\u00f3rios e regras de neg\u00f3cio espec\u00edficas, como regime especial de tributa\u00e7\u00e3o e CSTs.</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Documento/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Contabilidade</li> <li>Auditoria Fiscal</li> <li>Desenvolvedores de sistemas de EFD e gest\u00e3o fiscal</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Documento/#parametrosconfiguracoes","title":"\u2699\ufe0f Par\u00e2metros/Configura\u00e7\u00f5es","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01 Eaa01 Sim Documento fiscal principal a ser processado procInvoc String N\u00e3o Indicador do processo de invoca\u00e7\u00e3o"},{"location":"STREMA/formulas/srf/SRF_Documento/#estrutura-de-processamento","title":"\ud83d\udcca Estrutura de Processamento","text":""},{"location":"STREMA/formulas/srf/SRF_Documento/#inicializacao","title":"Inicializa\u00e7\u00e3o","text":"<ul> <li>Recupera documento (<code>eaa01</code>) e dados relacionados (entidade, endere\u00e7o principal, opera\u00e7\u00e3o comercial, par\u00e2metros de c\u00e1lculo).</li> <li>Inicializa campos JSON (<code>jsonAbe01</code>, <code>jsonEaa01</code>) e objetos auxiliares.</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Documento/#processamento-de-itens","title":"Processamento de Itens","text":"<ul> <li>Itera sobre os itens do documento (<code>eaa0103s</code>) e:<ul> <li>Recupera dados do item (<code>Abm01</code>, <code>Abm0101</code>, <code>Abm10</code>, <code>Abm1001</code>).</li> <li>Preenche campos JSON por estado e empresa.</li> <li>Atualiza observa\u00e7\u00f5es fiscais quando aplic\u00e1vel (ex.: CST 20).</li> </ul> </li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Documento/#regras-fiscais","title":"Regras Fiscais","text":"<ul> <li>Valida regime especial (<code>simples nacional</code>) e ajusta observa\u00e7\u00f5es fiscais.</li> <li>Calcula campos adicionais de fidelidade ou cr\u00e9dito, dependendo do PCD.</li> <li>Determina se a opera\u00e7\u00e3o \u00e9 dentro ou fora do estado (<code>ufEnt</code>).</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Documento/#taxas-de-comissao","title":"Taxas de Comiss\u00e3o","text":"<ul> <li>Obt\u00e9m taxas da entidade, tabela de pre\u00e7o e representantes.</li> <li>Ajusta valores nulos para zero e grava no documento.</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Documento/#composicao-de-observacoes","title":"Composi\u00e7\u00e3o de Observa\u00e7\u00f5es","text":"<ul> <li><code>comporObservacoesDocumento()</code>: monta observa\u00e7\u00f5es internas, fiscais e de contribuintes.</li> <li>Substitui placeholders (<code>&amp;1</code>, <code>&amp;2</code>, <code>&amp;3</code>, <code>&amp;4</code>) pelos valores reais de impostos ou c\u00f3digos.</li> <li><code>comporObsContribuinteComChaveNFeDocumentosReferenciados()</code>: inclui informa\u00e7\u00f5es de documentos referenciados com n\u00famero, data e chave de acesso.</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Documento/#validacoes-e-controles","title":"Valida\u00e7\u00f5es e Controles","text":"<ul> <li>Verifica exist\u00eancia de endere\u00e7o principal da entidade.</li> <li>Assegura que campos obrigat\u00f3rios estejam preenchidos.</li> <li>Atualiza campos JSON e observa\u00e7\u00f5es conforme regras fiscais.</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Documento/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/srf/SRF_Documento/#observacoes-fiscais","title":"Observa\u00e7\u00f5es Fiscais","text":"<ul> <li>Observa\u00e7\u00f5es podem ser preenchidas por entidade, PCD ou tabela de pre\u00e7o.</li> <li>Campos como <code>eaa01obsFisco</code> e <code>eaa01obsContrib</code> s\u00e3o concatenados e formatados.</li> <li>CSTs espec\u00edficos podem gerar observa\u00e7\u00f5es adicionais.</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Documento/#comissoes","title":"Comiss\u00f5es","text":"<ul> <li>Taxas podem vir de:<ul> <li>Entidade (<code>Abe01</code>, <code>Abe02</code>)</li> <li>Tabela de pre\u00e7o (<code>Abe40</code>)</li> <li>Representantes do documento</li> </ul> </li> <li>Nulos ou zero s\u00e3o substitu\u00eddos pelos valores dispon\u00edveis.</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Documento/#calculos-adicionais","title":"C\u00e1lculos Adicionais","text":"<ul> <li>Fidelidade: 1% do total do documento para PCD 10001.</li> <li>Cr\u00e9dito: igual ao total do documento para PCD 11100.</li> <li>Valores arredondados a duas casas decimais.</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Documento/#regime-especial","title":"Regime Especial","text":"<ul> <li>Para Simples Nacional, adiciona observa\u00e7\u00f5es fiscais com al\u00edquota e valor do ICMS.</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Documento/#documentos-referenciados","title":"Documentos Referenciados","text":"<ul> <li>Inclui informa\u00e7\u00f5es de documentos referenciados (n\u00famero, data, chave NFe) nas observa\u00e7\u00f5es do contribuinte.</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Documento/#saidasretornos","title":"\ud83c\udfa8 Sa\u00eddas/Retornos","text":"Tipo Descri\u00e7\u00e3o Formato Documento atualizado Objeto <code>Eaa01</code> com campos preenchidos e observa\u00e7\u00f5es ajustadas Objeto Java (JSON interno)"},{"location":"STREMA/formulas/srf/SRF_Documento/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>sam.server.samdev.formula.FormulaBase</code> - Base da f\u00f3rmula - <code>sam.dicdados.FormulaTipo</code> - Tipo de f\u00f3rmula - <code>br.com.multitec.utils.ValidacaoException</code> - Tratamento de exce\u00e7\u00f5es - <code>br.com.multitec.utils.collections.TableMap</code> - Estrutura para campos JSON - <code>java.time.format.DateTimeFormatter</code> - Formata\u00e7\u00e3o de datas</p> <p>Entidades do Sistema: - <code>Eaa01</code>, <code>Eaa0101</code>, <code>Eaa0103</code>, <code>Eaa01033</code> - Documentos e itens - <code>Abb01</code>, <code>Abb10</code> - Opera\u00e7\u00e3o comercial - <code>Abe01</code>, <code>Abe40</code> - Entidade/cliente - <code>Abm01</code>, <code>Abm0101</code>, <code>Abm10</code>, <code>Abm1001</code> - Itens e tabelas de pre\u00e7o - <code>Aaj10</code> - CST ICMS - <code>Aac10</code>, <code>Aac13</code> - Empresa e dados fiscais - <code>Aag02</code>, <code>Aag0201</code> - UF e munic\u00edpio</p>"},{"location":"STREMA/formulas/srf/SRF_Documento/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Processamento baseado em streams para manipula\u00e7\u00e3o de listas.</li> <li>Campos JSON acessados dinamicamente via <code>TableMap</code>.</li> <li>Substitui\u00e7\u00e3o de placeholders em observa\u00e7\u00f5es \u00e9 condicional conforme tipo de PCD.</li> <li>Performance otimizada com consultas espec\u00edficas para entidade, representantes e itens.</li> <li>Tratamento de nulos e inicializa\u00e7\u00e3o de campos cr\u00edticos.</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/","title":"SRF_EnviarEmailsNFe.md","text":""},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de envio automatizado de e-mails para Notas Fiscais Eletr\u00f4nicas (NF-e), incluindo documentos fiscais, boletos e cartas de corre\u00e7\u00e3o para m\u00faltiplos destinat\u00e1rios.</p>"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar o processo de distribui\u00e7\u00e3o de documentos fiscais eletr\u00f4nicos via e-mail para clientes, representantes, transportadoras e setores internos, garantindo conformidade com a legisla\u00e7\u00e3o fiscal.</p>"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Faturamento</li> <li>Cobran\u00e7a</li> <li>Representantes Comerciais</li> <li>Transportadoras</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - F\u00f3rmula <code>SRF_EnviarEmailsNFe</code> - Sistema de envio de e-mails NF-e</p> <p>Localiza\u00e7\u00e3o: <code>strema/formulas/srf/</code></p>"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos fiscais - <code>AAA16</code> - Processamento de mensageria - <code>ABB01</code> - Centrais de documento - <code>ABE01</code> - Entidades/clientes - <code>EAA0102</code> - Dados gerais do documento - <code>EAA0114</code> - Cartas de corre\u00e7\u00e3o</p> <p>Entidades Envolvidas: - <code>EmailNFeDto</code> - DTO para transporte de dados de e-mail - <code>Eaa01</code> - Documento fiscal - <code>Abe01</code> - Entidade/cliente</p>"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01id Long Sim ID do documento fiscal aaa16id Long Sim ID do processamento da mensageria eaa0114id Long N\u00e3o ID da carta de corre\u00e7\u00e3o (quando aplic\u00e1vel)"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Inicializa\u00e7\u00e3o e Valida\u00e7\u00f5es</li> <li>Recebe par\u00e2metros de entrada (documento, processamento, carta de corre\u00e7\u00e3o)</li> <li>Carrega dados do documento fiscal e entidade</li> <li> <p>Verifica tipo de processamento (faturamento, cancelamento, carta de corre\u00e7\u00e3o)</p> </li> <li> <p>Composi\u00e7\u00e3o da Mensagem</p> </li> <li>Monta assunto padr\u00e3o com dados da empresa e n\u00famero da NF</li> <li>Comp\u00f5e corpo do e-mail conforme tipo de opera\u00e7\u00e3o</li> <li> <p>Inclui dados do cliente, chave de acesso e protocolo</p> </li> <li> <p>Distribui\u00e7\u00e3o de Destinat\u00e1rios</p> </li> <li>Faturamento: E-mail principal do cliente</li> <li>Cobran\u00e7a: E-mail espec\u00edfico de cobran\u00e7a quando diferente</li> <li>Representantes: E-mails dos representantes comerciais</li> <li>Transportadora: E-mail da transportadora quando houver despacho</li> <li>Contatos da Entidade: E-mails adicionais por classifica\u00e7\u00e3o (9002, 9003, 9004)</li> <li> <p>C\u00f3pia Interna: E-mail nfe@stremasbaterias.com.br</p> </li> <li> <p>Configura\u00e7\u00e3o de Anexos</p> </li> <li>XML da NF-e</li> <li>DANFE (PDF)</li> <li>Boleto banc\u00e1rio</li> <li>Configura\u00e7\u00e3o por tipo de destinat\u00e1rio</li> </ol>"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#tipos-de-envio","title":"Tipos de Envio","text":"<ul> <li>Faturamento: XML + DANFE (obrigat\u00f3rio) + Boleto (condicional)</li> <li>Cobran\u00e7a: Boleto (quando e-mail diferente do faturamento)</li> <li>Cancelamento/CC-e: XML apenas</li> <li>Representantes: XML + DANFE + Boleto</li> <li>Transportadora: XML + DANFE</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#classificacao-de-contatos-da-entidade","title":"Classifica\u00e7\u00e3o de Contatos da Entidade","text":"<ul> <li>9002: Envia somente boleto</li> <li>9003: Envia somente XML e PDF</li> <li>9004: Envia boleto, XML e PDF</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#remetentes","title":"Remetentes","text":"<ul> <li>0: Principal</li> <li>1: Cobran\u00e7a  </li> <li>2: Faturamento</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>E-mail de faturamento \u00e9 obrigat\u00f3rio</li> <li>Cancelamentos e cartas de corre\u00e7\u00e3o enviam apenas XML</li> <li>Representantes recebem todos os anexos</li> <li>C\u00f3pia sempre enviada para nfe@stremasbaterias.com.br</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#saidas-geradas","title":"\ud83c\udfa8 Sa\u00eddas Geradas","text":"Sa\u00edda Descri\u00e7\u00e3o Tipo emails Lista de e-mails configurados para envio List"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Persist\u00eancia e consultas - <code>sam.dto.srf</code> - DTOs do m\u00f3dulo SRF</p> <p>Estruturas de Dados: - <code>EmailNFeDto</code> - Transporte de configura\u00e7\u00f5es de e-mail - <code>TableMap</code> - Armazenamento de dados de contatos</p>"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Processamento: S\u00edncrono, executado durante processamento fiscal</li> <li>Formata\u00e7\u00e3o: E-mails em HTML com dados formatados</li> <li>Flexibilidade: M\u00faltiplos destinat\u00e1rios com configura\u00e7\u00f5es espec\u00edficas</li> <li>Rastreabilidade: Inclui chave de acesso e protocolo da SEFAZ</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#estrutura-do-emailnfedto","title":"Estrutura do EmailNFeDto","text":"<ul> <li><code>assunto</code>: Assunto do e-mail</li> <li><code>corpo</code>: Corpo da mensagem em HTML</li> <li><code>emailsDestinoPara</code>: Lista de destinat\u00e1rios</li> <li><code>enviarXML</code>: Flag para envio do XML</li> <li><code>enviarDanfe</code>: Flag para envio do DANFE</li> <li><code>enviarBoleto</code>: Flag para envio do boleto</li> <li><code>emailRemetente</code>: Tipo de remetente (0, 1, 2)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_EnviarEmailsNFe/#busca-de-destinatarios","title":"Busca de Destinat\u00e1rios","text":"<ul> <li>Cobran\u00e7a: Prioridade para endere\u00e7o no documento &gt; endere\u00e7o principal da entidade</li> <li>Representantes: Busca em at\u00e9 5 representantes vinculados ao documento</li> <li>Transportadora: Obtido do campo de despacho do documento</li> <li>Contatos: Consulta direta via SQL por classifica\u00e7\u00e3o espec\u00edfica</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/","title":"SRF_ImportaXmlCTe_Entrada.md","text":""},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de importa\u00e7\u00e3o de XML de Conhecimento de Transporte Eletr\u00f4nico (CT-e) para documentos de entrada, respons\u00e1vel por extrair e processar dados fiscais, valores e informa\u00e7\u00f5es de transporte do arquivo XML.</p>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar o processo de importa\u00e7\u00e3o de dados fiscais de CT-e de entrada, garantindo a correta extra\u00e7\u00e3o e mapeamento de informa\u00e7\u00f5es tribut\u00e1rias, valores da presta\u00e7\u00e3o de servi\u00e7o e dados de transporte para o sistema.</p>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Log\u00edstica/Transportes</li> <li>Compras</li> <li>Contabilidade</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - F\u00f3rmula <code>SRF_ImportaXmlCTe_Entrada</code> - Processamento de XML CT-e entrada</p> <p>Localiza\u00e7\u00e3o: <code>strema/formulas/srf/</code></p>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos fiscais - <code>EAA0103</code> - Itens do documento - <code>EAA0102</code> - Dados gerais do documento - <code>EAA0101</code> - Endere\u00e7os do documento - <code>AAG0201</code> - Munic\u00edpios</p> <p>Entidades Envolvidas: - <code>Eaa01</code> - Documento fiscal - <code>Eaa0103</code> - Item do documento - <code>ElementXml</code> - Parser de XML</p>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01 Eaa01 Sim Documento fiscal a ser processado elementXmlCte ElementXml Sim Estrutura XML do CT-e a ser importada"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Valida\u00e7\u00e3o Inicial</li> <li>Verifica estrutura do XML (cteProc &gt; CTe &gt; infCte)</li> <li>Obt\u00e9m primeiro item do documento para processamento</li> <li> <p>Valida n\u00f3 principal do documento fiscal</p> </li> <li> <p>Processamento de Dados B\u00e1sicos</p> </li> <li>Define tipo do CT-e (tpCTe) nos dados gerais</li> <li>Configura quantidades padr\u00e3o (1 unidade)</li> <li> <p>Extrai valores da presta\u00e7\u00e3o de servi\u00e7o</p> </li> <li> <p>Processamento Tribut\u00e1rio</p> </li> <li>ICMS 00: Tributa\u00e7\u00e3o normal</li> <li>ICMS 20: Com redu\u00e7\u00e3o de base de c\u00e1lculo</li> <li>ICMS 60: Substitui\u00e7\u00e3o tribut\u00e1ria</li> <li>ICMS 90: Outros casos</li> <li> <p>ICMS Outra UF: Opera\u00e7\u00f5es interestaduais</p> </li> <li> <p>Gest\u00e3o de Endere\u00e7os</p> </li> <li>Remove endere\u00e7os de sa\u00edda e entrega existentes</li> <li>Cria novos endere\u00e7os baseados no XML</li> <li>Busca munic\u00edpios por c\u00f3digo IBGE</li> <li> <p>Define endere\u00e7os de sa\u00edda e entrega</p> </li> <li> <p>Dados Complementares</p> </li> <li>Informa\u00e7\u00f5es adicionais do fisco</li> <li>Valores da carga e averba\u00e7\u00e3o</li> <li>Observa\u00e7\u00f5es fiscais</li> </ol>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#validacoes-de-estrutura","title":"Valida\u00e7\u00f5es de Estrutura","text":"<ul> <li>XML deve conter estrutura cteProc &gt; CTe &gt; infCte</li> <li>Pelo menos um item deve existir no documento</li> <li>Campos num\u00e9ricos s\u00e3o convertidos com casas decimais espec\u00edficas</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#processamento-de-valores","title":"Processamento de Valores","text":"<ul> <li>Quantidade: Fixa em 1 unidade para servi\u00e7os de transporte</li> <li>Valores: Extra\u00eddos da presta\u00e7\u00e3o de servi\u00e7o (vRec)</li> <li>Totais: Replicados para totais do documento e financeiro</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#tributacao-do-ct-e","title":"Tributa\u00e7\u00e3o do CT-e","text":"<ul> <li>ICMS 00: Base de c\u00e1lculo, al\u00edquota e valor normal</li> <li>ICMS 20: Redu\u00e7\u00e3o de base de c\u00e1lculo aplicada</li> <li>ICMS 60: Valores de reten\u00e7\u00e3o por substitui\u00e7\u00e3o tribut\u00e1ria</li> <li>ICMS 90: Tributa\u00e7\u00e3o com redu\u00e7\u00e3o e cr\u00e9dito</li> <li>ICMS Outra UF: Tratamento espec\u00edfico para opera\u00e7\u00f5es interestaduais</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#gestao-de-enderecos","title":"Gest\u00e3o de Endere\u00e7os","text":"<ul> <li>Endere\u00e7os de sa\u00edda e entrega s\u00e3o recriados a cada importa\u00e7\u00e3o</li> <li>Munic\u00edpios s\u00e3o buscados exclusivamente por c\u00f3digo IBGE</li> <li>Endere\u00e7os s\u00e3o marcados com flags espec\u00edficas (saida, entrega)</li> <li>Endere\u00e7o principal permanece inalterado</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#saidas-geradas","title":"\ud83c\udfa8 Sa\u00eddas Geradas","text":"Sa\u00edda Descri\u00e7\u00e3o Tipo eaa01 Documento fiscal com dados importados Eaa01"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Persist\u00eancia e consultas - <code>br.com.multitec.utils.xml</code> - Processamento de XML</p> <p>Estruturas de Dados: - <code>ElementXml</code> - Parser e navega\u00e7\u00e3o de XML - <code>TableMap</code> - Armazenamento de dados JSON</p>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Processamento: S\u00edncrono, execu\u00e7\u00e3o completa do XML</li> <li>Alinhamento: Utiliza alinhamento \"0013\" espec\u00edfico para CT-e</li> <li>Flexibilidade: Suporte a m\u00faltiplos regimes de ICMS</li> <li>Precis\u00e3o: Arredondamentos espec\u00edficos por tipo de campo</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#mapeamento-de-campos-xml","title":"Mapeamento de Campos XML","text":"<ul> <li>Dados B\u00e1sicos: Tipo do CT-e, valores da presta\u00e7\u00e3o</li> <li>Tributa\u00e7\u00e3o: Todos os grupos de ICMS aplic\u00e1veis ao CT-e</li> <li>Endere\u00e7os: C\u00f3digos IBGE de munic\u00edpios de sa\u00edda e entrega</li> <li>Complementares: Informa\u00e7\u00f5es fiscais e valores da carga</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#tratamento-de-dados","title":"Tratamento de Dados","text":"<ul> <li>Convers\u00e3o autom\u00e1tica de valores monet\u00e1rios</li> <li>Busca otimizada de munic\u00edpios por c\u00f3digo IBGE</li> <li>Valida\u00e7\u00e3o de consist\u00eancia de dados municipais</li> <li>Preserva\u00e7\u00e3o de dados originais do XML</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_ImportaXmlCTe_Entrada/#integracao-com-sistema","title":"Integra\u00e7\u00e3o com Sistema","text":"<ul> <li>Atualiza\u00e7\u00e3o em tempo real do documento fiscal</li> <li>Gest\u00e3o din\u00e2mica de endere\u00e7os de transporte</li> <li>Compatibilidade com estrutura de itens de servi\u00e7o</li> <li>Manuten\u00e7\u00e3o de relacionamentos entre entidades</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/","title":"SRF - Pr\u00e9-Grava\u00e7\u00e3o (Strema)","text":""},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula executada antes da grava\u00e7\u00e3o de um documento, respons\u00e1vel por criar/atualizar registros de estoque por item com base em regras espec\u00edficas de recebimento e tipo de documento.</p>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Processar itens de documentos de recebimento (tipos 202/203) para criar ou atualizar lotes e s\u00e9ries no estoque, garantindo rastreabilidade e controle de invent\u00e1rio.</p>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento de Estoque</li> <li>Recebimento</li> <li>Log\u00edstica</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0103</code> - Itens do documento fiscal - <code>Eaa01038</code> - Estoque por item - <code>Abb01</code> - Central de documento - <code>Abd01</code> - PCD (Processo/Condi\u00e7\u00e3o de Documento) - <code>Aah01</code> - Tipo de documento - <code>Abb11</code> - Departamento (Strema) - <code>Aam04</code> - Status (Dispon\u00edvel) - <code>Abm15</code> - Dep\u00f3sito</p>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01 Eaa01 Sim Documento fiscal sendo processado"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Obten\u00e7\u00e3o do documento fiscal (Eaa01)</li> <li>Carregamento da central de documento (Abb01)</li> <li>Identifica\u00e7\u00e3o do tipo de documento (Aah01)</li> <li>Carregamento do PCD (Abd01)</li> <li>Leitura dos campos livres (JSON) do documento</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#2-validacao-de-contexto","title":"2. Valida\u00e7\u00e3o de Contexto","text":"<ul> <li>Verifica se \u00e9 um movimento de recebimento (<code>eaa01esMov == 0</code>)</li> <li>Confirma se o PCD \u00e9 \"314\" (recebimento espec\u00edfico)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#3-processamento-por-item","title":"3. Processamento por Item","text":"<ul> <li>Para cada item do documento (Eaa0103):</li> <li>Caso 1: Item j\u00e1 possui estoque registrado (Eaa01038)<ul> <li>Atualiza lote e s\u00e9rie nos registros existentes</li> </ul> </li> <li>Caso 2: Item n\u00e3o possui estoque<ul> <li>Cria novo registro Eaa01038 com:</li> <li>Departamento fixo (Strema - ID 67660)</li> <li>Status fixo (Dispon\u00edvel - ID 4224)</li> <li>Dep\u00f3sito fixo (ID 67479)</li> <li>Lote = n\u00famero do documento</li> <li>S\u00e9rie = invoice do JSON (se existir)</li> <li>Quantidade = quantidade de uso do item</li> </ul> </li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#4-controle-de-gravacao","title":"4. Controle de Grava\u00e7\u00e3o","text":"<ul> <li>Define flag <code>gravar = 1</code> para permitir grava\u00e7\u00e3o</li> <li>Retorna flag via par\u00e2metro de sa\u00edda</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#contexto-de-execucao","title":"Contexto de Execu\u00e7\u00e3o","text":"<ul> <li>Executa apenas para recebimentos (<code>eaa01esMov == 0</code>)</li> <li>Aplica apenas para PCD 314 (Processo espec\u00edfico de recebimento)</li> <li>Atua sobre tipos de documento 202 ou 203</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#gestao-de-estoque","title":"Gest\u00e3o de Estoque","text":"<ul> <li>Itens com estoque existente: Apenas atualiza lote e s\u00e9rie</li> <li>Itens sem estoque: Cria registro completo com:</li> <li>Departamento: Strema (fixo)</li> <li>Status: Dispon\u00edvel (fixo)</li> <li>Dep\u00f3sito: Configurado (fixo)</li> <li>Campos din\u00e2micos:</li> <li>Lote: N\u00famero do documento (abb01num)</li> <li>S\u00e9rie: Invoice do JSON (se dispon\u00edvel)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>Verifica exist\u00eancia de registros Eaa01038 antes de criar</li> <li>Utiliza dados do JSON apenas se existirem</li> <li>Mant\u00e9m estrutura hier\u00e1rquica (Eaa01 \u2192 Eaa0103 \u2192 Eaa01038)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de pr\u00e9-grava\u00e7\u00e3o.</p>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#criarestoqueitem","title":"<code>criarEstoqueItem()</code>","text":"<p>Processa todos os itens do documento para criar/atualizar estoque: - Identifica itens com estoque existente - Cria novos registros quando necess\u00e1rio - Aplica regras espec\u00edficas de recebimento</p>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#obtertipoformula","title":"<code>obterTipoFormula()</code>","text":"<p>Retorna o tipo da f\u00f3rmula: <code>SCV_SRF_PRE_GRAVACAO</code></p>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>Par\u00e2metros de Sa\u00edda: - <code>gravar</code> - Integer (0-N\u00e3o gravar, 1-Gravar)</p> <p>Altera\u00e7\u00f5es no Modelo: - Atualiza <code>eaa01038lote</code> e <code>eaa01038serie</code> nos itens existentes - Adiciona novos registros <code>Eaa01038</code> aos itens sem estoque</p>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Acesso ao banco de dados - <code>sam.model</code> - Entidades do sistema - <code>sam.server.samdev.formula</code> - Base para f\u00f3rmulas - <code>sam.dicdados</code> - Tipos de f\u00f3rmula</p> <p>M\u00f3dulo: Strema</p>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#tratamento-de-json","title":"Tratamento de JSON","text":"<ul> <li>Campos livres do Eaa01 armazenados em <code>TableMap</code></li> <li>Campo \"invoice\" utilizado para s\u00e9rie do estoque</li> <li>Compat\u00edvel com estrutura JSON existente</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#ids-fixos","title":"IDs Fixos","text":"<ul> <li>Departamento Strema: 67660</li> <li>Status Dispon\u00edvel: 4224</li> <li>Dep\u00f3sito: 67479 (Nota: Considerar parametriza\u00e7\u00e3o futura)</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#performance","title":"Performance","text":"<ul> <li>Processamento por lote (todos os itens do documento)</li> <li>Acesso otimizado via <code>getSession().get()</code></li> <li>Evita consultas desnecess\u00e1rias</li> </ul>"},{"location":"STREMA/formulas/srf/SRF_Pre_Gravacao/#validacoes-de-negocio","title":"Valida\u00e7\u00f5es de Neg\u00f3cio","text":"<ul> <li>Execu\u00e7\u00e3o condicional baseada em PCD e tipo de movimento</li> <li>Preserva\u00e7\u00e3o de dados existentes</li> <li>Cria\u00e7\u00e3o apenas quando necess\u00e1rio</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 02/12/2025 \u00e0s 09:35 Autor: Bruno Tipo: F\u00f3rmula de Pr\u00e9-Grava\u00e7\u00e3o Vers\u00e3o: 1.0 M\u00f3dulo: Strema</p>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/","title":"SCV_Orcamento.md","text":""},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de gera\u00e7\u00e3o de relat\u00f3rios de or\u00e7amentos para o SCV (Sistema de Controle de Vendas) da Strema, com funcionalidades de impress\u00e3o e envio autom\u00e1tico por e-mail.</p>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar relat\u00f3rios detalhados de or\u00e7amentos comerciais com op\u00e7\u00f5es de visualiza\u00e7\u00e3o, exporta\u00e7\u00e3o e distribui\u00e7\u00e3o automatizada para clientes.</p>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Comercial</li> <li>Vendedores</li> <li>Atendimento ao Cliente</li> <li>Gest\u00e3o Comercial</li> </ul>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - Classe <code>SCV_Orcamento</code> - Relat\u00f3rio de or\u00e7amentos - Arquivos de imagem (Logo.png, canceladas.png)</p> <p>Localiza\u00e7\u00e3o: <code>strema/relatorios/scv/</code></p>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>CBE10</code> - Cabe\u00e7alho de or\u00e7amentos - <code>ABB01</code> - Documentos fiscais - <code>ABE01</code> - Entidades/Clientes - <code>CBE1001</code> - Itens do or\u00e7amento - <code>ABM01</code> - Materiais/Produtos - <code>AAB10</code> - Usu\u00e1rios - <code>ABE0104</code> - Classifica\u00e7\u00e3o de entidades (e-mails)</p> <p>Entidades Envolvidas: - <code>Cbe10</code> - Or\u00e7amento - <code>Abb01</code> - Documento fiscal - <code>Abe01</code> - Entidade/Cliente - <code>Aab10</code> - Usu\u00e1rio - <code>Abe0104</code> - Classifica\u00e7\u00e3o de entidade - <code>Aac10</code> - Empresa</p>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o numeroInicial Integer N\u00e3o N\u00famero inicial do or\u00e7amento numeroFinal Integer N\u00e3o N\u00famero final do or\u00e7amento entidades List N\u00e3o Lista de entidades para filtro emissao LocalDate[] N\u00e3o Per\u00edodo de emiss\u00e3o status List Sim Status dos or\u00e7amentos (0-Criado, 1-Conclu\u00eddo, 2-Cancelado) impressao Integer Sim Tipo de sa\u00edda (0-PDF, 1-XLSX) enviaEmail Boolean N\u00e3o Enviar por e-mail automaticamente tipoSCV7010 Long N\u00e3o Filtro espec\u00edfico da tela SCV7010"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#saidas-do-processo","title":"\ud83d\udccb Sa\u00eddas do Processo","text":"Campo Descri\u00e7\u00e3o Tipo PDF/XLSX Relat\u00f3rio formatado Arquivo E-mail Or\u00e7amento enviado por e-mail Mensagem"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Configura\u00e7\u00e3o Inicial</li> <li>Define valores padr\u00e3o para filtros</li> <li>Carrega logos e recursos visuais</li> <li> <p>Comp\u00f5e dados da empresa</p> </li> <li> <p>Processamento de Filtros</p> </li> <li>Aplica filtros de n\u00famero, entidade, data e status</li> <li>Processa filtro espec\u00edfico da tela SCV7010</li> <li> <p>Valida par\u00e2metros obrigat\u00f3rios</p> </li> <li> <p>Busca de Dados</p> </li> <li>Executa consulta SQL com m\u00faltiplos joins</li> <li>Aplica where padr\u00e3o do sistema</li> <li> <p>Ordena resultados por n\u00famero e c\u00f3digo do material</p> </li> <li> <p>Gera\u00e7\u00e3o de Sa\u00edda</p> </li> <li>Gera PDF ou XLSX conforme sele\u00e7\u00e3o</li> <li>Opcionalmente envia e-mail com anexo</li> <li>Aplica formata\u00e7\u00e3o e assinatura de e-mail</li> </ol>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#filtros-e-validacoes","title":"Filtros e Valida\u00e7\u00f5es","text":"<ul> <li>Status padr\u00e3o: Criado e Conclu\u00eddo</li> <li>Filtro por n\u00famero range opcional</li> <li>Filtro por per\u00edodo de emiss\u00e3o</li> <li>Where padr\u00e3o aplicado para seguran\u00e7a</li> </ul>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#envio-de-e-mail","title":"Envio de E-mail","text":"<ul> <li>E-mail obrigat\u00f3rio no cadastro do usu\u00e1rio</li> <li>Destinat\u00e1rios obtidos da classifica\u00e7\u00e3o \"9001\"</li> <li>Assinatura personalizada quando dispon\u00edvel</li> <li>Anexo PDF com nome personalizado</li> <li>Corpo do e-mail com tratamento de caracteres</li> </ul>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#dados-da-empresa","title":"Dados da Empresa","text":"<ul> <li>Raz\u00e3o social, CNPJ, IE</li> <li>Endere\u00e7o completo formatado</li> <li>Contatos e site</li> <li>Dados fiscais por UF</li> </ul>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#estrutura-do-relatorio","title":"\ud83c\udfa8 Estrutura do Relat\u00f3rio","text":"<p>Cabe\u00e7alho: - Logo da empresa - Dados cadastrais da empresa - Filtros aplicados</p> <p>Detalhes do Or\u00e7amento: - N\u00famero, data, cliente - Condi\u00e7\u00e3o de pagamento - Itens com c\u00f3digo, descri\u00e7\u00e3o, quantidade, unit\u00e1rio, total - Tributos (IPI, ICMS, ST) - Observa\u00e7\u00f5es internas</p> <p>Rodap\u00e9: - Totais do documento - Status do or\u00e7amento - Informa\u00e7\u00f5es de frete</p>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Crit\u00e9rios e joins - <code>multitec.utils</code> - Utilit\u00e1rios e e-mail - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios - <code>javax.mail</code> - Envio de e-mail</p> <p>Servi\u00e7os: - <code>CAS1010Service</code> - Processamento de assinaturas de e-mail</p> <p>Consultas: - Busca de or\u00e7amentos com m\u00faltiplos relacionamentos - Dados da empresa ativa - E-mails de destino por classifica\u00e7\u00e3o - Configura\u00e7\u00e3o de e-mail do usu\u00e1rio</p>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Recursos Visuais: Logos carregadas dinamicamente do filesystem</li> <li>Formata\u00e7\u00e3o de Dados: Endere\u00e7os concatenados, telefones formatados</li> <li>Tratamento de Caracteres: Normaliza\u00e7\u00e3o para remover acentos no e-mail</li> <li>Seguran\u00e7a: Aplica\u00e7\u00e3o de where padr\u00e3o em todas as consultas</li> <li>Performance: Joins otimizados com fetch estrat\u00e9gico</li> </ul>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#metodos-principais","title":"\ud83d\udd04 M\u00e9todos Principais","text":""},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo do relat\u00f3rio.</p>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#compordadosempresa","title":"<code>comporDadosEmpresa()</code>","text":"<p>Busca e formata dados cadastrais da empresa ativa.</p>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#buscardadosorcamento","title":"<code>buscarDadosOrcamento()</code>","text":"<p>Executa consulta principal com todos os filtros aplicados.</p>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#enviaremail","title":"<code>enviarEmail()</code>","text":"<p>Processa envio autom\u00e1tico do or\u00e7amento por e-mail.</p>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#buscaremaildestino","title":"<code>buscarEmailDestino()</code>","text":"<p>Obt\u00e9m lista de e-mails de destino baseado na classifica\u00e7\u00e3o.</p>"},{"location":"STREMA/relatorio/scv/SCV_Orcamento/#template-de-e-mail","title":"\ud83d\udca1 Template de E-mail","text":"<p>Assunto: \"PROPOSTA COMERCIAL STREMA BATERIAS N\u00b0 [n\u00famero]\"</p> <p>Corpo:</p>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/","title":"SCV_PedidoVenda.md","text":""},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de gera\u00e7\u00e3o de relat\u00f3rios de pedidos de venda para o SCV (Sistema de Controle de Vendas) da Strema, com funcionalidades de impress\u00e3o e envio autom\u00e1tico por e-mail.</p>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar relat\u00f3rios detalhados de pedidos de venda com op\u00e7\u00f5es de visualiza\u00e7\u00e3o, exporta\u00e7\u00e3o e distribui\u00e7\u00e3o automatizada para clientes, incluindo controle de estoque e informa\u00e7\u00f5es fiscais.</p>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Comercial</li> <li>Vendedores</li> <li>Expedi\u00e7\u00e3o</li> <li>Atendimento ao Cliente</li> <li>Gest\u00e3o Comercial</li> </ul>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - Classe <code>SCV_PedidoVenda</code> - Relat\u00f3rio de pedidos de venda - Arquivos de imagem (Logo.png, LogoEx-Power.png) - Subrelat\u00f3rios: SCV_PedidoVendaExpedicao_S1, SCV_PedidoVendaExpedicao_S2</p> <p>Localiza\u00e7\u00e3o: <code>strema/relatorios/scv/</code></p>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos fiscais - <code>ABB01</code> - Cabe\u00e7alho de documentos - <code>ABE01</code> - Entidades/Clientes - <code>EAA0103</code> - Itens do pedido - <code>ABM01</code> - Materiais/Produtos - <code>AAB10</code> - Usu\u00e1rios - <code>ABE0104</code> - Classifica\u00e7\u00e3o de entidades (e-mails) - <code>AAC10</code> - Empresa</p> <p>Entidades Envolvidas: - <code>Eaa01</code> - Documento fiscal - <code>Abb01</code> - Cabe\u00e7alho do documento - <code>Abe01</code> - Entidade/Cliente - <code>Eaa0103</code> - Item do pedido - <code>Abm01</code> - Material/Produto - <code>Aab10</code> - Usu\u00e1rio - <code>Abe0104</code> - Classifica\u00e7\u00e3o de entidade - <code>Aac10</code> - Empresa</p>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o pedido Integer Sim Tipo de pedido (1-Venda, 2-Expedi\u00e7\u00e3o, 3-Venda/Expedi\u00e7\u00e3o) numIni Integer N\u00e3o N\u00famero inicial do pedido numFim Integer N\u00e3o N\u00famero final do pedido tipo List N\u00e3o Lista de tipos de documento entidade List N\u00e3o Lista de entidades representante List N\u00e3o Lista de representantes classeItens List N\u00e3o Lista de classes de itens dataEmissao LocalDate[] N\u00e3o Per\u00edodo de emiss\u00e3o dataEntrega LocalDate[] N\u00e3o Per\u00edodo de entrega enviaEmail Boolean N\u00e3o Enviar por e-mail automaticamente tipoSCV2002 Long N\u00e3o Filtro espec\u00edfico da tela SCV2002"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#saidas-do-processo","title":"\ud83d\udccb Sa\u00eddas do Processo","text":"Campo Descri\u00e7\u00e3o Tipo PDF Relat\u00f3rio formatado Arquivo E-mail Pedido enviado por e-mail Mensagem"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Configura\u00e7\u00e3o Inicial</li> <li>Define valores padr\u00e3o para filtros</li> <li>Carrega logos e recursos visuais</li> <li> <p>Comp\u00f5e dados da empresa e inscri\u00e7\u00e3o estadual</p> </li> <li> <p>Processamento de Filtros</p> </li> <li>Aplica filtros de n\u00famero, tipo, entidade, representante</li> <li>Processa filtros de data de emiss\u00e3o e entrega</li> <li> <p>Aplica filtro espec\u00edfico da tela SCV2002</p> </li> <li> <p>Busca de Dados</p> </li> <li>Executa consulta SQL com m\u00faltiplos joins</li> <li>Busca view de itens com c\u00e1lculos de estoque</li> <li> <p>Calcula totais l\u00edquidos por item</p> </li> <li> <p>Gera\u00e7\u00e3o de Relat\u00f3rio</p> </li> <li>Seleciona template baseado no tipo de pedido</li> <li>Configura subrelat\u00f3rios para detalhamento</li> <li> <p>Gera PDF com estrutura complexa</p> </li> <li> <p>Envio de E-mail (Opcional)</p> </li> <li>Envia pedido automaticamente por e-mail</li> <li>Aplica formata\u00e7\u00e3o e assinatura</li> </ol>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#tipos-de-pedido","title":"Tipos de Pedido","text":"<ul> <li>1 - Venda: Relat\u00f3rio padr\u00e3o de pedido de venda</li> <li>2 - Expedi\u00e7\u00e3o: Relat\u00f3rio focado em expedi\u00e7\u00e3o</li> <li>3 - Venda/Expedi\u00e7\u00e3o: Relat\u00f3rio combinado</li> </ul>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#filtros-e-validacoes","title":"Filtros e Valida\u00e7\u00f5es","text":"<ul> <li>Filtro padr\u00e3o por opera\u00e7\u00e3o diferente de 46045860</li> <li>Apenas documentos de classifica\u00e7\u00e3o 0 (venda)</li> <li>Apenas movimenta\u00e7\u00f5es de sa\u00edda (esMov = 1)</li> <li>Documentos n\u00e3o cancelados</li> <li>Endere\u00e7os principais apenas</li> </ul>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#calculos-de-estoque","title":"C\u00e1lculos de Estoque","text":"<ul> <li>Total Saldo: Quantidade em estoque</li> <li>Total Vendido: Quantidade em pedidos de venda</li> <li>Total Compra: Quantidade em pedidos de compra</li> <li>Total Produ\u00e7\u00e3o: Quantidade em produ\u00e7\u00e3o</li> <li>Total L\u00edquido: Saldo - Vendido + Compra + Produ\u00e7\u00e3o</li> </ul>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#estrutura-do-relatorio","title":"\ud83c\udfa8 Estrutura do Relat\u00f3rio","text":"<p>Cabe\u00e7alho: - Logos da empresa - Dados cadastrais da empresa (endere\u00e7o, CNPJ, IE) - Filtros aplicados</p> <p>Detalhes do Pedido: - N\u00famero, data, cliente - Endere\u00e7o de entrega completo - Condi\u00e7\u00e3o de pagamento - Representante comercial</p> <p>Itens do Pedido: - C\u00f3digo, descri\u00e7\u00e3o, quantidade, unidade, unit\u00e1rio, total - Tributos (ICMS, ST, IPI, al\u00edquotas) - Informa\u00e7\u00f5es de frete</p> <p>Subrelat\u00f3rios: - S1: Detalhes adicionais do pedido - S2: Informa\u00e7\u00f5es complementares</p>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Crit\u00e9rios e joins - <code>multitec.utils</code> - Utilit\u00e1rios e e-mail - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios - <code>javax.mail</code> - Envio de e-mail</p> <p>Servi\u00e7os: - <code>CAS1010Service</code> - Processamento de assinaturas de e-mail</p> <p>Consultas: - Busca de pedidos com m\u00faltiplos relacionamentos - View de itens com c\u00e1lculos de estoque - E-mails de destino por classifica\u00e7\u00e3o - Configura\u00e7\u00e3o de e-mail do usu\u00e1rio</p>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Recursos Visuais: Logos carregadas dinamicamente do filesystem</li> <li>Formata\u00e7\u00e3o de Dados: CEP formatado (XXXXX-XXX), endere\u00e7os concatenados</li> <li>Subrelat\u00f3rios: Estrutura complexa com m\u00faltiplos n\u00edveis de detalhe</li> <li>C\u00e1lculos em Tempo Real: Totais l\u00edquidos calculados dinamicamente</li> <li>Seguran\u00e7a: Aplica\u00e7\u00e3o de where padr\u00e3o em todas as consultas</li> </ul>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#metodos-principais","title":"\ud83d\udd04 M\u00e9todos Principais","text":""},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo do relat\u00f3rio.</p>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#buscardados","title":"<code>buscarDados()</code>","text":"<p>Executa consulta principal com todos os filtros aplicados.</p>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#buscarviewitens","title":"<code>buscarViewItens()</code>","text":"<p>Cria view complexa com c\u00e1lculos de estoque.</p>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#buscarvalorliqtotal","title":"<code>buscarValorLiqTotal()</code>","text":"<p>Calcula total l\u00edquido por item baseado na view.</p>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#enviaremail","title":"<code>enviarEmail()</code>","text":"<p>Processa envio autom\u00e1tico do pedido por e-mail.</p>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#buscaremaildestino","title":"<code>buscarEmailDestino()</code>","text":"<p>Obt\u00e9m lista de e-mails de destino baseado na classifica\u00e7\u00e3o.</p>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#view-de-itens","title":"\ud83d\udca1 View de Itens","text":"<p>A view calcula: - Saldo em estoque - Quantidade vendida (pedidos de venda n\u00e3o atendidos) - Quantidade comprada (pedidos de compra n\u00e3o atendidos) - Quantidade em produ\u00e7\u00e3o (ordens de produ\u00e7\u00e3o pendentes) - Saldo l\u00edquido = Saldo - Vendido + Comprado + Produ\u00e7\u00e3o</p>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#validacoes-de-e-mail","title":"\u26a0\ufe0f Valida\u00e7\u00f5es de E-mail","text":"<ul> <li>Usu\u00e1rio deve ter e-mail cadastrado (AAB1008)</li> <li>Entidade deve ter contato classificado como \"9001\"</li> <li>Assinatura opcional do usu\u00e1rio</li> <li>Tratamento de caracteres especiais no corpo</li> <li>Valida\u00e7\u00e3o de exist\u00eancia de destinat\u00e1rios</li> </ul>"},{"location":"STREMA/relatorio/scv/SCV_PedidoVenda/#template-de-e-mail","title":"\ud83d\udcb0 Template de E-mail","text":"<p>Assunto: \"PEDIDO N\u00b0 [n\u00famero] STREMA BATERIAS \u2013 APROVADO\"</p> <p>Corpo:</p>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/","title":"SPP_OrdemProducao - Relat\u00f3rio de Ordem de Produ\u00e7\u00e3o","text":""},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Relat\u00f3rio de ordens de produ\u00e7\u00e3o com filtros por status, n\u00famero, tipo, entidade, itens, lotes e data de emiss\u00e3o, gerando PDF com informa\u00e7\u00f5es completas do processo produtivo.</p>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Fornecer uma vis\u00e3o consolidada das ordens de produ\u00e7\u00e3o, permitindo acompanhamento do status, componentes utilizados, quantidades planejadas e realizadas, al\u00e9m de informa\u00e7\u00f5es espec\u00edficas do processo.</p>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento de Produ\u00e7\u00e3o</li> <li>PCP (Planejamento e Controle de Produ\u00e7\u00e3o)</li> <li>Gestores Industriais</li> <li>Supervisores de Produ\u00e7\u00e3o</li> </ul>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#parametros-do-relatorio","title":"\u2699\ufe0f Par\u00e2metros do Relat\u00f3rio","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o Valores Poss\u00edveis status Integer Sim Status da ordem de produ\u00e7\u00e3o 0=Todos numIni Integer N\u00e3o N\u00famero inicial 0-999999 numFim Integer N\u00e3o N\u00famero final 0-999999 tipo List N\u00e3o Tipos de documento IDs tipos documento entidade List N\u00e3o Entidades espec\u00edficas IDs entidades itens List N\u00e3o Itens espec\u00edficos IDs itens lotes List N\u00e3o Lotes espec\u00edficos C\u00f3digos de lote dataEmissao LocalDate[] N\u00e3o Per\u00edodo de emiss\u00e3o Data inicial e final"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#campos-do-relatorio","title":"\ud83d\udccb Campos do Relat\u00f3rio","text":"Campo Descri\u00e7\u00e3o Tipo abb01num N\u00famero do documento Integer abb01data Data do documento Date bab01dtE Data da ordem Date rep Representante String entCodigo C\u00f3digo da entidade String entNome Nome da entidade String bab01qt Quantidade BigDecimal prodDesc Descri\u00e7\u00e3o do produto String prodCodigo C\u00f3digo do produto String abp20bomNumRev N\u00famero revis\u00e3o BOM String abp20bomDtRev Data revis\u00e3o BOM Date compCodigo C\u00f3digo componente String compDesc Descri\u00e7\u00e3o componente String aam06codigo Unidade medida String bab0101qtP Qtde planejada BigDecimal bab0101qtA Qtde realizada BigDecimal bab01obs Observa\u00e7\u00f5es String bab01detProd Detalhes produ\u00e7\u00e3o String carga Informa\u00e7\u00f5es de carga String transporte Informa\u00e7\u00f5es transporte String etiqueta Informa\u00e7\u00f5es etiqueta String outros_itens Outros itens String prioridade Prioridade String"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#1-validacao-de-parametros","title":"1. Valida\u00e7\u00e3o de Par\u00e2metros","text":"<ul> <li>Define valores padr\u00e3o (status = 0)</li> <li>Processa intervalos num\u00e9ricos</li> <li>Converte lista de lotes (separados por \";\")</li> </ul>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#2-configuracao-do-relatorio","title":"2. Configura\u00e7\u00e3o do Relat\u00f3rio","text":"<ul> <li>Localiza arquivo de logo</li> <li>Obt\u00e9m dados da empresa ativa</li> <li>Constr\u00f3i endere\u00e7o completo da empresa</li> </ul>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#3-construcao-da-consulta","title":"3. Constru\u00e7\u00e3o da Consulta","text":"<ul> <li>Monta SQL din\u00e2mico com filtros aplicados</li> <li>Aplica cl\u00e1usulas WHERE conforme par\u00e2metros</li> <li>Define ordena\u00e7\u00e3o por n\u00famero e descri\u00e7\u00e3o do componente</li> </ul>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#4-busca-de-dados","title":"4. Busca de Dados","text":"<ul> <li>Consulta ordens de produ\u00e7\u00e3o no banco</li> <li>Inclui informa\u00e7\u00f5es de produto, componentes e entidades</li> <li>Extrai campos JSON espec\u00edficos</li> </ul>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#5-geracao-de-saida","title":"5. Gera\u00e7\u00e3o de Sa\u00edda","text":"<ul> <li>Passa par\u00e2metros para template JasperReports</li> <li>Gera PDF com dados consultados</li> <li>Retorna arquivo para download</li> </ul>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#filtros-de-busca","title":"Filtros de Busca","text":"<ul> <li>Status: Filtro obrigat\u00f3rio, padr\u00e3o = 0 (todos)</li> <li>N\u00fameros: Intervalo inclusivo (inicial \u2264 n\u00famero \u2264 final)</li> <li>Lotes: Separados por ponto e v\u00edrgula, espa\u00e7os removidos</li> <li>Datas: Per\u00edodo inclusivo (data inicial \u2264 data \u2264 data final)</li> </ul>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#estrutura-de-dados","title":"Estrutura de Dados","text":"<ul> <li>Join com m\u00faltiplas tabelas (bab01, abb01, abe01, abp20, abm01)</li> <li>Componentes listados individualmente por ordem</li> <li>Campos JSON extra\u00eddos para informa\u00e7\u00f5es espec\u00edficas</li> </ul>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#ordenacao","title":"Ordena\u00e7\u00e3o","text":"<ul> <li>Prim\u00e1ria: N\u00famero do documento (abb01num)</li> <li>Secund\u00e1ria: Descri\u00e7\u00e3o do componente (comp.abm01descr)</li> </ul>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#saidas-disponiveis","title":"\ud83c\udfa8 Sa\u00eddas Dispon\u00edveis","text":"Formato Descri\u00e7\u00e3o Template M\u00e9todo PDF Layout padr\u00e3o <code>SPP_OrdemProducao</code> <code>gerarPDF()</code>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>jasperreports</code> - Gera\u00e7\u00e3o de relat\u00f3rios PDF - <code>br.com.multitec.utils</code> - Utilit\u00e1rios e cole\u00e7\u00f5es</p> <p>Recursos: - Arquivo de logo: <code>/resources/strema/relatorios/spp/Logo.png</code> - Template JasperReports</p>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#consulta-sql","title":"Consulta SQL","text":"<ul> <li>SQL din\u00e2mico com m\u00faltiplos filtros opcionais</li> <li>Uso de JSON extraction para campos espec\u00edficos</li> <li>Join complexo com aliases para entidades e itens</li> </ul>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#parametros-do-relatorio_1","title":"Par\u00e2metros do Relat\u00f3rio","text":"<ul> <li>LOGO: Caminho completo do arquivo de logo</li> <li>ENDERECO: Endere\u00e7o formatado da empresa</li> </ul>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#tratamento-de-dados","title":"Tratamento de Dados","text":"<ul> <li>Limpeza de espa\u00e7os em lista de lotes</li> <li>Formata\u00e7\u00e3o de endere\u00e7o multi-linha</li> <li>Valores padr\u00e3o para par\u00e2metros num\u00e9ricos</li> </ul>"},{"location":"STREMA/relatorio/spp/SPP_OrdemProducao/#performance","title":"Performance","text":"<ul> <li>Filtros aplicados no banco de dados</li> <li>Pagina\u00e7\u00e3o tratada pelo JasperReports</li> <li>Consulta otimizada com \u00edndices apropriados</li> </ul>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/","title":"SRF_Danfe.md","text":""},{"location":"STREMA/relatorio/srf/SRF_Danfe/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>Sistema de gera\u00e7\u00e3o e envio de Documento Auxiliar da Nota Fiscal Eletr\u00f4nica (DANFE) para documentos fiscais, com suporte a impress\u00e3o e distribui\u00e7\u00e3o autom\u00e1tica por e-mail.</p>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar o DANFE em formato PDF para documentos fiscais eletr\u00f4nicos, permitindo visualiza\u00e7\u00e3o, impress\u00e3o e distribui\u00e7\u00e3o eletr\u00f4nica autom\u00e1tica para clientes e destinat\u00e1rios.</p>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Faturamento</li> <li>Clientes/Fornecedores</li> <li>Transportadoras</li> </ul>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#configuracao","title":"\u2699\ufe0f Configura\u00e7\u00e3o","text":"<p>Recursos Necess\u00e1rios: - Relat\u00f3rio <code>SRF_Danfe</code> - Gera\u00e7\u00e3o do DANFE - Sub-relat\u00f3rio <code>SRF_Danfe_S1</code> - Detalhamento de itens</p> <p>Localiza\u00e7\u00e3o: <code>strema/relatorios/srf/</code></p>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>EAA01</code> - Documentos fiscais - <code>ABB01</code> - Centrais de documento - <code>ABE01</code> - Entidades/clientes - <code>EAA0101</code> - Endere\u00e7os do documento - <code>EAA0102</code> - Dados gerais do documento - <code>EAA0103</code> - Itens do documento - <code>EAA0113</code> - Duplicatas</p> <p>Recursos Externos: - <code>Logo.png</code> - Logotipo da empresa - <code>canceladas.png</code> - Imagem para documentos cancelados - <code>SemValorFiscal.png</code> - Imagem para documentos sem valor fiscal</p>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#parametros-do-processo","title":"\u2699\ufe0f Par\u00e2metros do Processo","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o numeroInicial Integer Sim N\u00famero inicial do documento numeroFinal Integer Sim N\u00famero final do documento entidade List N\u00e3o Filtro por entidades emissao LocalDate[] N\u00e3o Per\u00edodo de emiss\u00e3o entraSai LocalDate[] N\u00e3o Per\u00edodo de entrada/sa\u00edda eaa01id Long N\u00e3o ID espec\u00edfico do documento entInicial String N\u00e3o C\u00f3digo inicial da entidade entFinal String N\u00e3o C\u00f3digo final da entidade serie String N\u00e3o S\u00e9rie do documento enviaEmail Boolean N\u00e3o Flag para envio autom\u00e1tico por e-mail"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":"<ol> <li>Configura\u00e7\u00e3o Inicial</li> <li>Carrega recursos gr\u00e1ficos (logos, imagens)</li> <li>Define par\u00e2metros padr\u00e3o do relat\u00f3rio</li> <li> <p>Configura sub-relat\u00f3rios</p> </li> <li> <p>Busca de Documentos</p> </li> <li>Filtra documentos por n\u00famero, s\u00e9rie, per\u00edodo e entidade</li> <li>Valida documentos do modelo 55 (NF-e)</li> <li> <p>Ordena por n\u00famero do documento</p> </li> <li> <p>Composi\u00e7\u00e3o de Dados</p> </li> <li>Empresa: Dados do emitente</li> <li>Documento: Informa\u00e7\u00f5es fiscais e numera\u00e7\u00e3o</li> <li>Entidade: Dados do destinat\u00e1rio</li> <li>Itens: Produtos/servi\u00e7os com tributos</li> <li>Valores: Totais e impostos</li> <li> <p>Transporte: Dados de frete e ve\u00edculo</p> </li> <li> <p>Gera\u00e7\u00e3o do PDF</p> </li> <li>Processa relat\u00f3rio principal com sub-relat\u00f3rios</li> <li>Aplica formata\u00e7\u00e3o espec\u00edfica do DANFE</li> <li> <p>Gera arquivo PDF para download</p> </li> <li> <p>Envio por E-mail (Opcional)</p> </li> <li>Busca e-mails do destinat\u00e1rio por classifica\u00e7\u00e3o</li> <li>Configura e-mail com anexo PDF</li> <li>Envia automaticamente para contatos cadastrados</li> </ol>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"STREMA/relatorio/srf/SRF_Danfe/#filtros-de-documentos","title":"Filtros de Documentos","text":"<ul> <li>Apenas documentos do modelo 55 (NF-e)</li> <li>Documentos com emiss\u00e3o pr\u00f3pria (eaa01emissao = 1)</li> <li>Ordena\u00e7\u00e3o por n\u00famero do documento</li> <li>Suporte a filtros por s\u00e9rie e per\u00edodo</li> </ul>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#validacoes-de-dados","title":"Valida\u00e7\u00f5es de Dados","text":"<ul> <li>Empresa deve ter munic\u00edpio cadastrado</li> <li>Endere\u00e7o principal do documento \u00e9 obrigat\u00f3rio</li> <li>Munic\u00edpio do endere\u00e7o deve estar preenchido</li> <li>Dados de IE devem estar dispon\u00edveis por estado</li> </ul>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#estrutura-do-danfe","title":"Estrutura do DANFE","text":"<ul> <li>Cabe\u00e7alho: Dados do emitente e destinat\u00e1rio</li> <li>Itens: Descri\u00e7\u00e3o, quantidades, valores unit\u00e1rios e totais</li> <li>Tributos: ICMS, IPI, PIS, COFINS</li> <li>Transporte: Dados do frete e ve\u00edculo</li> <li>Duplicatas: Parcelas e datas de vencimento</li> <li>Informa\u00e7\u00f5es Adicionais: Observa\u00e7\u00f5es fiscais</li> </ul>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#envio-por-e-mail","title":"Envio por E-mail","text":"<ul> <li>Destinat\u00e1rios definidos por classifica\u00e7\u00e3o \"9001\"</li> <li>Assinatura digital do usu\u00e1rio quando dispon\u00edvel</li> <li>Anexo PDF com nome personalizado</li> <li>Corpo da mensagem em HTML formatado</li> </ul>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#saidas-geradas","title":"\ud83c\udfa8 Sa\u00eddas Geradas","text":"Sa\u00edda Descri\u00e7\u00e3o Tipo PDF DANFE em formato PDF DadosParaDownload E-mail Mensagem com anexo (opcional) Email"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>JasperReports</code> - Gera\u00e7\u00e3o de relat\u00f3rios - <code>JavaMail</code> - Envio de e-mails - <code>multiorm</code> - Persist\u00eancia e consultas</p> <p>Servi\u00e7os: - <code>CAS1010Service</code> - Processamento de assinaturas de e-mail</p>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":"<ul> <li>Processamento: Batch para m\u00faltiplos documentos</li> <li>Performance: Consultas otimizadas com joins</li> <li>Formata\u00e7\u00e3o: Layout fiel ao DANFE oficial</li> <li>Internacionaliza\u00e7\u00e3o: Suporte a caracteres especiais</li> </ul>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#recursos-graficos","title":"Recursos Gr\u00e1ficos","text":"<ul> <li>Logotipo da empresa em PNG</li> <li>Carimbo para documentos cancelados</li> <li>Marca d'\u00e1gua para documentos sem valor fiscal</li> <li>Formata\u00e7\u00e3o espec\u00edfica para cada tipo de documento</li> </ul>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#tratamento-de-dados","title":"Tratamento de Dados","text":"<ul> <li>Normaliza\u00e7\u00e3o de caracteres para e-mail</li> <li>Formata\u00e7\u00e3o de valores monet\u00e1rios</li> <li>Convers\u00e3o de datas e horas</li> <li>C\u00e1lculo de percentuais de impostos</li> </ul>"},{"location":"STREMA/relatorio/srf/SRF_Danfe/#integracao-com-e-mail","title":"Integra\u00e7\u00e3o com E-mail","text":"<ul> <li>Configura\u00e7\u00e3o SMTP do usu\u00e1rio logado</li> <li>Suporte a anexos em Base64</li> <li>Assinatura digital em HTML</li> <li>Destinat\u00e1rios m\u00faltiplos por classifica\u00e7\u00e3o</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/","title":"SRF - Enviar Emails NFe (Vetro)","text":""},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula especializada para envio automatizado de e-mails relacionados a Notas Fiscais Eletr\u00f4nicas no m\u00f3dulo Vetro, incluindo faturamento, cobran\u00e7a, cancelamentos e cartas de corre\u00e7\u00e3o.</p>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Automatizar o envio de e-mails para clientes e transportadoras com documentos fiscais eletr\u00f4nicos (XML, DANFE, boletos) de acordo com o tipo de opera\u00e7\u00e3o, adaptado para as necessidades espec\u00edficas do m\u00f3dulo Vetro.</p>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Faturamento</li> <li>Cobran\u00e7a</li> <li>Log\u00edstica/Transporte</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos fiscais NF-e - <code>Abb01</code> - Cabe\u00e7alho de documentos - <code>Abe01</code> - Entidades (clientes) - <code>Eaa0102</code> - Dados complementares do documento - <code>Aaa16</code> - Processamento da mensageria - <code>Eaa0114</code> - Cartas de corre\u00e7\u00e3o - <code>Eaa0101</code> - E-mails espec\u00edficos por documento - <code>Abe0101</code> - Endere\u00e7os de e-mail das entidades</p>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01id Long Sim ID do documento fiscal (Eaa01) aaa16id Long Sim ID do processamento da mensageria eaa0114id Long N\u00e3o ID da carta de corre\u00e7\u00e3o (se aplic\u00e1vel)"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Obten\u00e7\u00e3o dos par\u00e2metros de entrada</li> <li>Carregamento das entidades principais (Eaa01, Aaa16, Abb01, Abe01)</li> <li>Verifica\u00e7\u00e3o da exist\u00eancia de e-mail principal no documento</li> <li>Composi\u00e7\u00e3o do assunto com nome da empresa e n\u00famero da nota</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#2-composicao-do-corpo-da-mensagem","title":"2. Composi\u00e7\u00e3o do Corpo da Mensagem","text":"<ul> <li>Cancelamento: Inclui motivo do cancelamento (Aae11)</li> <li>Carta de Corre\u00e7\u00e3o: Inclui texto da corre\u00e7\u00e3o (Eaa0114)</li> <li>Faturamento Normal: Mensagem padr\u00e3o de envio de NF-e</li> <li>Formata\u00e7\u00e3o HTML com dados do cliente e chave de acesso</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#3-definicao-dos-destinatarios-por-tipo","title":"3. Defini\u00e7\u00e3o dos Destinat\u00e1rios por Tipo","text":"<ul> <li>Cancelamento/CC-e: Apenas e-mail principal do cliente com XML</li> <li>Faturamento: E-mail principal com XML + DANFE</li> <li>Cobran\u00e7a: E-mail espec\u00edfico de cobran\u00e7a com boleto</li> <li>Transportadora: E-mail da empresa de despacho com XML + DANFE</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#4-configuracao-dos-anexos","title":"4. Configura\u00e7\u00e3o dos Anexos","text":"<ul> <li>Cancelamento/CC-e: Apenas XML</li> <li>Faturamento: XML + DANFE (boleto opcional)</li> <li>Cobran\u00e7a: Apenas boleto</li> <li>Transportadora: XML + DANFE</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#tipos-de-operacao","title":"Tipos de Opera\u00e7\u00e3o","text":"<ul> <li>Cancelamento: Aaa16.TIPO_CANCELAMENTO_NFE</li> <li>Carta de Corre\u00e7\u00e3o: Aaa16.TIPO_CCEEVENTO  </li> <li>Faturamento: Demais tipos</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#hierarquia-de-e-mails-de-cobranca","title":"Hierarquia de E-mails de Cobran\u00e7a","text":"<ol> <li>E-mail espec\u00edfico no documento (Eaa0101) marcado como cobran\u00e7a</li> <li>E-mail principal da entidade (Abe0101) marcado como cobran\u00e7a</li> <li>E-mail principal do documento (Eaa0102)</li> </ol>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#configuracao-de-remetentes","title":"Configura\u00e7\u00e3o de Remetentes","text":"<ul> <li>Faturamento/Transportadora: Remetente 2 (Faturamento)</li> <li>Cobran\u00e7a: Remetente 1 (Cobran\u00e7a)</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#validacoes","title":"Valida\u00e7\u00f5es","text":"<ul> <li>N\u00e3o processa se n\u00e3o houver e-mail principal no documento</li> <li>Verifica diferen\u00e7a entre e-mails de faturamento e cobran\u00e7a</li> <li>Transportadora apenas se houver empresa de despacho informada</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de envio de e-mails.</p>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#comporcorpomsgaaa16-aaa16-eaa01-eaa01-abe01-abe01-abb01-abb01-long-eaa0114id","title":"<code>comporCorpoMsg(Aaa16 aaa16, Eaa01 eaa01, Abe01 abe01, Abb01 abb01, Long eaa0114id)</code>","text":"<p>Compoi o corpo do e-mail conforme o tipo de opera\u00e7\u00e3o com formata\u00e7\u00e3o HTML.</p>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#obteremailcobrancalong-eaa01id-long-abe01id-eaa0102-eaa0102","title":"<code>obterEmailCobranca(Long eaa01id, Long abe01id, Eaa0102 eaa0102)</code>","text":"<p>Busca o e-mail de cobran\u00e7a seguindo a hierarquia definida.</p>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#obteremailtransportadoradespachoeaa0102-eaa0102","title":"<code>obterEmailTransportadoraDespacho(Eaa0102 eaa0102)</code>","text":"<p>Busca e-mail da transportadora respons\u00e1vel pelo despacho.</p>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>EmailNFeDto: - <code>assunto</code> - Assunto do e-mail formatado - <code>corpo</code> - Corpo em HTML da mensagem - <code>emailsDestinoPara</code> - Lista de destinat\u00e1rios - <code>enviarXML</code> - Indica se envia arquivo XML - <code>enviarDanfe</code> - Indica se envia DANFE - <code>enviarBoleto</code> - Indica se envia boleto - <code>emailRemetente</code> - Tipo de remetente (1: Cobran\u00e7a, 2: Faturamento)</p> <p>Lista de E-mails Gerados: - Retornada no par\u00e2metro <code>emails</code> para processamento pela mensageria</p>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e joins para consultas - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.dto.srf</code> - DTOs espec\u00edficos do m\u00f3dulo SRF - <code>sam.model</code> - Entidades do sistema</p> <p>M\u00f3dulo: Vetro</p>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#formatacao-html","title":"Formata\u00e7\u00e3o HTML","text":"<ul> <li>Corpo dos e-mails em HTML com tags b\u00e1sicas</li> <li>Links para portal da NF-e e site da Multitec</li> <li>Dados do cliente, CNPJ e chave de acesso</li> <li>Protocolo de autoriza\u00e7\u00e3o da SEFAZ</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#controle-de-anexos","title":"Controle de Anexos","text":"<ul> <li>XML sempre enviado para cliente e transportadora</li> <li>DANFE para faturamento e transportadora</li> <li>Boleto apenas para cobran\u00e7a (separado ou junto)</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_EnviarEmailsNFe/#performance","title":"Performance","text":"<ul> <li>Consultas otimizadas com campos espec\u00edficos</li> <li>Uso de criteria para buscas relacionadas</li> <li>Carregamento lazy de entidades</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 27/10/2025 \u00e0s 10:42 Autor: Bruno Tipo: F\u00f3rmula de Envio de E-mails NF-e (Vetro) Vers\u00e3o: 1.0</p>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/","title":"SRF - Gerar XML de NFe (Fiscal) - Mitra","text":""},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#descricao","title":"\ud83d\udcd6 Descri\u00e7\u00e3o","text":"<p>F\u00f3rmula customizada para gera\u00e7\u00e3o do arquivo XML da Nota Fiscal Eletr\u00f4nica (NFe) conforme layout 4.00, com implementa\u00e7\u00f5es espec\u00edficas para o cliente Mitra, incluindo tratamento especial para PCD (Pessoas com Defici\u00eancia) e ajustes nos valores de frete.</p>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#finalidade","title":"\ud83c\udfaf Finalidade","text":"<p>Gerar automaticamente o XML da NFe a partir dos dados do documento fiscal, aplicando valida\u00e7\u00f5es, formata\u00e7\u00f5es, regras fiscais e tratamentos espec\u00edficos para opera\u00e7\u00f5es com PCD conforme a legisla\u00e7\u00e3o vigente.</p>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#publico-alvo","title":"\ud83d\udc65 P\u00fablico-Alvo","text":"<ul> <li>Departamento Fiscal</li> <li>Faturamento</li> <li>Contabilidade</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#dados-e-fontes","title":"\ud83d\udcca Dados e Fontes","text":"<p>Tabelas Principais: - <code>Eaa01</code> - Documentos fiscais - <code>Eaa0101</code> - Endere\u00e7os do documento - <code>Eaa0102</code> - Dados gerais do documento - <code>Eaa0103</code> - Itens do documento - <code>Eaa01033</code> - Itens vinculados (devolu\u00e7\u00e3o) - <code>Eaa01034</code> - Declara\u00e7\u00e3o de importa\u00e7\u00e3o - <code>Eaa010341</code> - Adi\u00e7\u00f5es da DI - <code>Eaa01038</code> - Rastreabilidade - <code>Eaa0104</code> - Declara\u00e7\u00e3o de exporta\u00e7\u00e3o - <code>Eaa0113</code> - Financeiro do documento - <code>Eaa01131</code> - Formas de pagamento - <code>Aac10</code> - Empresa emitente - <code>Aac1002</code> - Inscri\u00e7\u00f5es estaduais da empresa - <code>Abe01</code> - Entidades (clientes/fornecedores) - <code>Abe0101</code> - Endere\u00e7os das entidades - <code>Abb01</code> - Central de documentos - <code>Abm01</code> - Itens cadastrais - <code>Abm0101</code> - Configura\u00e7\u00e3o de itens por empresa - <code>Abg01</code> - NCM - <code>Abg0101</code> - NVE - <code>Aaj03</code> - Situa\u00e7\u00e3o do documento - <code>Aaj04</code> - C\u00f3digo ANP - <code>Aaj10</code> - CST ICMS - <code>Aaj11</code> - CST IPI - <code>Aaj12</code> - CST PIS - <code>Aaj13</code> - CST COFINS - <code>Aaj14</code> - CSOSN - <code>Aaj15</code> - CFOP - <code>Aam06</code> - Unidades de medida - <code>Aah20</code> - Ve\u00edculos/transportes - <code>Aag01</code> - Pa\u00edses - <code>Aag02</code> - Estados/UF - <code>Abd01</code> - PCD (Pessoas com Defici\u00eancia)</p>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#parametros-da-formula","title":"\u2699\ufe0f Par\u00e2metros da F\u00f3rmula","text":"Par\u00e2metro Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o eaa01 Eaa01 Sim Documento fiscal a ser processado formaEmis Integer N\u00e3o Forma de emiss\u00e3o (1=Normal, 2=Conting\u00eancia) contDt LocalDate N\u00e3o Data da conting\u00eancia contHr LocalTime N\u00e3o Hora da conting\u00eancia contJust String N\u00e3o Justificativa da conting\u00eancia"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#fluxo-do-processo","title":"\ud83d\udd04 Fluxo do Processo","text":""},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#1-configuracao-inicial","title":"1. Configura\u00e7\u00e3o Inicial","text":"<ul> <li>Valida\u00e7\u00e3o dos par\u00e2metros obrigat\u00f3rios</li> <li>Carregamento da empresa emitente</li> <li>Carregamento do PCD associado ao documento</li> <li>Sele\u00e7\u00e3o do alinhamento fiscal (0010)</li> <li>Composi\u00e7\u00e3o dos dados do documento (central, dados gerais, endere\u00e7os)</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#2-validacoes-de-dados","title":"2. Valida\u00e7\u00f5es de Dados","text":"<ul> <li>Valida\u00e7\u00e3o de dados obrigat\u00f3rios do emitente</li> <li>Valida\u00e7\u00e3o de dados do documento fiscal</li> <li>Valida\u00e7\u00e3o de itens, impostos e formas de pagamento</li> <li>Valida\u00e7\u00e3o de documentos referenciados e transportes</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#3-geracao-da-estrutura-xml","title":"3. Gera\u00e7\u00e3o da Estrutura XML","text":"<ul> <li>Cria\u00e7\u00e3o do elemento raiz <code>NFe</code></li> <li>Defini\u00e7\u00e3o das informa\u00e7\u00f5es b\u00e1sicas (<code>infNFe</code>)</li> <li>Montagem da identifica\u00e7\u00e3o (<code>ide</code>)</li> <li>Inclus\u00e3o de documentos referenciados (<code>NFref</code>)</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#4-montagem-das-secoes-da-nfe","title":"4. Montagem das Se\u00e7\u00f5es da NFe","text":"<ul> <li>Emitente (<code>emit</code>)</li> <li>Destinat\u00e1rio (<code>dest</code>)</li> <li>Itens (<code>det</code>) com produtos, impostos e informa\u00e7\u00f5es espec\u00edficas</li> <li>Totais (<code>total</code>) com valores de ICMS, ISS, reten\u00e7\u00f5es</li> <li>Transporte (<code>transp</code>) com ve\u00edculos e volumes</li> <li>Cobran\u00e7a (<code>cobr</code>) com faturas e duplicatas</li> <li>Pagamento (<code>pag</code>) com formas de pagamento</li> <li>Informa\u00e7\u00f5es adicionais (<code>infAdic</code>)</li> <li>Exporta\u00e7\u00e3o (<code>exporta</code>)</li> <li>Respons\u00e1vel t\u00e9cnico (<code>infRespTec</code>)</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#5-finalizacao","title":"5. Finaliza\u00e7\u00e3o","text":"<ul> <li>Gera\u00e7\u00e3o do XML final</li> <li>Retorno da chave de acesso e dados do XML</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#regras-de-negocio","title":"\u26a0\ufe0f Regras de Neg\u00f3cio","text":""},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#implementacoes-especificas-mitra","title":"Implementa\u00e7\u00f5es Espec\u00edficas Mitra","text":""},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#tratamento-de-pcd","title":"Tratamento de PCD","text":"<ul> <li>Carregamento do PCD associado ao documento (<code>Abd01</code>)</li> <li>Verifica\u00e7\u00e3o do c\u00f3digo do PCD para aplicar regras espec\u00edficas</li> <li>Quando PCD c\u00f3digo \"314\": valor do frete definido como 0 na tag <code>vFrete</code></li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#alteracoes-na-geracao","title":"Altera\u00e7\u00f5es na Gera\u00e7\u00e3o","text":"<ul> <li>Alinhamento fixo: \"0010\" (n\u00e3o h\u00e1 sele\u00e7\u00e3o por classifica\u00e7\u00e3o tribut\u00e1ria)</li> <li>Tipo de impress\u00e3o (<code>tpImp</code>): 1 (Documento Nacional)</li> <li>Formata\u00e7\u00e3o de valores unit\u00e1rios com 9 decimais (<code>vUnCom</code>, <code>vUnTrib</code>)</li> <li>Busca de declara\u00e7\u00f5es de exporta\u00e7\u00e3o com fetch da UF de embarque</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#regras-de-pagamento","title":"Regras de Pagamento","text":"<ul> <li>C\u00e1lculo do total parcelado sem formas de pagamento espec\u00edficas</li> <li>Quando houver parcelamento sem forma de pagamento: gera tag com <code>tPag = 15</code> (Boleto Banc\u00e1rio)</li> <li>Ordena\u00e7\u00e3o do financeiro por data de vencimento nominal</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#validacoes-obrigatorias","title":"Valida\u00e7\u00f5es Obrigat\u00f3rias","text":"<ul> <li>Empresa emitente deve ter munic\u00edpio, IE, endere\u00e7o e CNPJ/CPF v\u00e1lidos</li> <li>Documento deve ter tipo, modelo, situa\u00e7\u00e3o e dados gerais</li> <li>Itens devem ter unidade de medida, descri\u00e7\u00e3o, CFOP e CST/CSOSN conforme classifica\u00e7\u00e3o tribut\u00e1ria</li> <li>Para Simples Nacional (classTrib = \"001\"): CSOSN obrigat\u00f3rio</li> <li>Para outras classifica\u00e7\u00f5es: CST ICMS obrigat\u00f3rio (exceto para itens com ISS)</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#regras-fiscais","title":"Regras Fiscais","text":"<ul> <li>Identifica\u00e7\u00e3o do destino (1=Interna, 2=Interestadual, 3=Exterior)</li> <li>Tratamento diferenciado para opera\u00e7\u00f5es com e sem ISS</li> <li>C\u00e1lculo de impostos (ICMS, IPI, PIS, COFINS, ISS) conforme CST/CSOSN</li> <li>Informa\u00e7\u00f5es de ST, FCP e reten\u00e7\u00f5es conforme configura\u00e7\u00e3o</li> <li>Tratamento especial para combust\u00edveis (ANP, CIDE)</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#formatacao-e-estrutura","title":"Formata\u00e7\u00e3o e Estrutura","text":"<ul> <li>Formata\u00e7\u00e3o de valores monet\u00e1rios com 2 decimais</li> <li>Formata\u00e7\u00e3o de quantidades com 4 decimais</li> <li>Formata\u00e7\u00e3o de valores unit\u00e1rios com 9 decimais</li> <li>Ajuste de caracteres especiais no XML</li> <li>Gera\u00e7\u00e3o de chave de acesso com d\u00edgito verificador</li> <li>Vers\u00e3o do layout: 4.00</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#metodos-principais","title":"\ud83d\udd27 M\u00e9todos Principais","text":""},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#executar","title":"<code>executar()</code>","text":"<p>M\u00e9todo principal que orquestra todo o processo de gera\u00e7\u00e3o do XML.</p>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#validardadosdanfe","title":"<code>validarDadosDaNFe()</code>","text":"<p>Realiza valida\u00e7\u00f5es abrangentes dos dados necess\u00e1rios para a gera\u00e7\u00e3o da NFe.</p>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#comporfilhosdocumento","title":"<code>comporFilhosDocumento()</code>","text":"<p>Carrega e associa os dados relacionados ao documento (central, dados gerais, endere\u00e7os).</p>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#emitente","title":"<code>emitente()</code>","text":"<p>Monta a se\u00e7\u00e3o do emitente com dados da empresa.</p>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#destinatario","title":"<code>destinatario()</code>","text":"<p>Monta a se\u00e7\u00e3o do destinat\u00e1rio com dados da entidade.</p>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#item","title":"<code>item()</code>","text":"<p>Processa todos os itens do documento, incluindo produtos, impostos e informa\u00e7\u00f5es espec\u00edficas.</p>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#metodos-de-busca","title":"M\u00e9todos de Busca","text":"<ul> <li><code>buscarInscricaoEstadualPorEstado()</code>: Busca IE da empresa por UF</li> <li><code>buscarDocumentosReferenciados()</code>: Busca notas referenciadas</li> <li><code>buscarItensDoDocumento()</code>: Busca itens do documento</li> <li><code>buscarNVEsPorNCM()</code>: Busca NVE relacionados ao NCM</li> <li><code>buscarDeclaracaoDeImportacaoPorItem()</code>: Busca DI dos itens</li> <li><code>buscarAdicoesPorDI()</code>: Busca adi\u00e7\u00f5es da DI</li> <li><code>buscarDeclaracoesDeExportacao()</code>: Busca declara\u00e7\u00f5es de exporta\u00e7\u00e3o (com fetch da UF)</li> <li><code>buscarRastreabilidadeDoItem()</code>: Busca dados de rastreabilidade</li> <li><code>buscarLancamentosDoItem()</code>: Busca lan\u00e7amentos de estoque</li> <li><code>buscarFinanceiroPorDocumento()</code>: Busca parcelas financeiras ordenadas por vencimento</li> <li><code>buscarFormasDePagamentoPorDocumento()</code>: Busca formas de pagamento</li> <li><code>buscarTotalParcelado()</code>: Busca total das parcelas sem forma de pagamento espec\u00edfica</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#estrutura-de-saida","title":"\ud83d\udcca Estrutura de Sa\u00edda","text":"<p>XML da NFe: String formatada conforme layout 4.00</p> <p>Par\u00e2metros de Retorno: - <code>chaveNfe</code>: Chave de acesso da NFe (44 d\u00edgitos) - <code>dados</code>: XML completo da NFe</p>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#dependencias","title":"\ud83d\udd27 Depend\u00eancias","text":"<p>Bibliotecas: - <code>multiorm</code> - Criteria e consultas ao banco - <code>multitec.utils</code> - Utilit\u00e1rios (DateUtils, StringUtils, ValidacaoException) - <code>sam.dicdados</code> - Tipos de f\u00f3rmula - <code>sam.model</code> - Entidades do sistema - <code>sam.server.samdev.utils</code> - Utilit\u00e1rios do SAM (NFeUtils, Parametro) - <code>java.time</code> - Manipula\u00e7\u00e3o de datas - <code>java.math</code> - C\u00e1lculos com BigDecimal</p> <p>M\u00f3dulo: Fiscal</p>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#observacoes-tecnicas","title":"\ud83d\udcdd Observa\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#versao-do-layout","title":"Vers\u00e3o do Layout","text":"<ul> <li>Layout 4.00 da NFe</li> <li>Suporte a NFC-e (modelo 65) e NFe normal (modelo 55)</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#ambiente","title":"Ambiente","text":"<ul> <li>Produ\u00e7\u00e3o: <code>tpAmb = 1</code></li> <li>Homologa\u00e7\u00e3o: <code>tpAmb = 2</code></li> <li>CNPJ de homologa\u00e7\u00e3o: 99999999000191</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#contingencia","title":"Conting\u00eancia","text":"<ul> <li>Forma de emiss\u00e3o normal: <code>tpEmis = 1</code></li> <li>Conting\u00eancia: <code>tpEmis = 2</code> com data/hora e justificativa</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#tratamento-de-dados","title":"Tratamento de Dados","text":"<ul> <li>Formata\u00e7\u00e3o de IE (remo\u00e7\u00e3o de caracteres n\u00e3o num\u00e9ricos)</li> <li>Ajuste de fone (DDD + n\u00famero)</li> <li>Substitui\u00e7\u00e3o de caracteres especiais no XML (&amp;, &lt;, &gt;, \", ')</li> <li>Formata\u00e7\u00e3o de datas no padr\u00e3o UTC</li> </ul>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#campos-livres-json","title":"Campos Livres (JSON)","text":"<p>Os dados fiscais detalhados s\u00e3o armazenados em campos livres (JSON) nas tabelas: - <code>eaa01json</code> para totais do documento - <code>eaa0103json</code> para valores por item</p>"},{"location":"VETRO/formulas/srf/SRF_GerarXMLNfe/#implementacoes-especificas","title":"Implementa\u00e7\u00f5es Espec\u00edficas","text":"<ul> <li>PCD c\u00f3digo 314: Zera o valor do frete na NFe</li> <li>Tipo de impress\u00e3o: Fixo em 1 (Documento Nacional)</li> <li>Alinhamento: Fixo em \"0010\"</li> <li>Busca de exporta\u00e7\u00e3o: Com fetch da UF para otimiza\u00e7\u00e3o</li> </ul> <p>\u00daltima Altera\u00e7\u00e3o: 09/12/2025 \u00e0s 16:26 Autor: NAGYLA Tipo: F\u00f3rmula de Gera\u00e7\u00e3o de Arquivos de NFe Vers\u00e3o: 2.0 (Customizada para Mitra)</p>"}]}